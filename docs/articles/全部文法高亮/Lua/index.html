<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        Document
    </title>
    <link rel='stylesheet' href=../../../css/index.css />
    <link rel='stylesheet' href=../../../css/asm.css /><link rel='stylesheet' href=../../../css/shell.css /><link rel='stylesheet' href=../../../css/json.css /><link rel='stylesheet' href=../../../css/lua.css /><link rel='stylesheet' href=../../../css/bnf.css /><link rel='stylesheet' href=../../../css/toml.css /><link rel='stylesheet' href=../../../css/c.css /><link rel='stylesheet' href=../../../css/xml.css />
    <link rel="icon" href="https://raw.githubusercontent.com/learner-lu/picbed/master/logo.png">
</head>

<body class="light">
    <a href="https://github.com/luzhixing12345/syntaxlight.git" target="_blank" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    <div class="header-navigator"><ul><li><a href="#h1-0">lua</a><ul><li><a href="#h2-1">1.lua</a></li></ul><ul><li><a href="#h2-2">2.lua</a></li></ul><ul><li><a href="#h2-3">3.lua</a></li></ul><ul><li><a href="#h2-4">4.lua</a></li></ul><ul><li><a href="#h2-5">5.lua</a></li></ul><ul><li><a href="#h2-6">6.lua</a></li></ul><ul><li><a href="#h2-7">7.lua</a></li></ul><ul><li><a href="#h2-8">8.lua</a></li></ul><ul><li><a href="#h2-9">9.lua</a></li></ul><ul><li><a href="#h2-10">10.lua</a></li></ul><ul><li><a href="#h2-11">11.lua</a></li></ul><ul><li><a href="#h2-12">12.lua</a></li></ul><ul><li><a href="#h2-13">13.lua</a></li></ul><ul><li><a href="#h2-14">14.lua</a></li></ul></li></ul></div><div class='markdown-body'><h1 id="h1-0">lua</h1><h2 id="h2-1"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/1.lua" target="_blank">1.lua</a></h2><pre class="language-lua"><code><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">k0aux</span><span class="Identifier Token AttributeName SPACE"> </span><span class="brace-depth-0 Token Attribute AttributeName LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="brace-depth-0 Token Attribute AttributeName RANGLE_BRACE">&gt;</span><span class="Token Attribute AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Number LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">k0</span><span class="Identifier Token AttributeName SPACE"> </span><span class="brace-depth-0 Token Attribute AttributeName LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="brace-depth-0 Token Attribute AttributeName RANGLE_BRACE">&gt;</span><span class="Token Attribute AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">k0aux</span><span class="Identifier Token Variable LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">k1</span><span class="Identifier Token AttributeName SPACE"> </span><span class="brace-depth-0 Token Attribute AttributeName LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="brace-depth-0 Token Attribute AttributeName RANGLE_BRACE">&gt;</span><span class="Token Attribute AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">k3</span><span class="Identifier Token AttributeName SPACE"> </span><span class="brace-depth-0 Token Attribute AttributeName LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="brace-depth-0 Token Attribute AttributeName RANGLE_BRACE">&gt;</span><span class="Token Attribute AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Number LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">k6</span><span class="Identifier Token AttributeName SPACE"> </span><span class="brace-depth-0 Token Attribute AttributeName LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="brace-depth-0 Token Attribute AttributeName RANGLE_BRACE">&gt;</span><span class="Token Attribute AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">k3</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression brace-depth-0 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">k3</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token SHL">&lt;&lt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">k0</span><span class="Expression brace-depth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">kFF0</span><span class="Identifier Token AttributeName SPACE"> </span><span class="brace-depth-0 Token Attribute AttributeName LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="brace-depth-0 Token Attribute AttributeName RANGLE_BRACE">&gt;</span><span class="Token Attribute AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0xFF0</span><span class="Token Number LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">k3_78</span><span class="Identifier Token AttributeName SPACE"> </span><span class="brace-depth-0 Token Attribute AttributeName LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="brace-depth-0 Token Attribute AttributeName RANGLE_BRACE">&gt;</span><span class="Token Attribute AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">3.78</span></code></pre><h2 id="h2-2"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/2.lua" target="_blank">2.lua</a></h2><pre class="language-lua"><code><span class="Token COMMENT">-- 1. 变量和数据类型</span><span class="Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">numberVar</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">42</span><span class="Token Number LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">stringVar</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;Hello, Lua!&quot;</span><span class="Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">booleanVar</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">tableVar</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Token Number Field NUMBER">1</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">3</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName FunctionName ID">functionVar</span><span class="Identifier Token AttributeName FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MUL">*</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody COMMENT">-- 2. 条件语句</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">numberVar</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token brace-depth-0 RANGLE_BRACE">&gt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">50</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;Number is greater than 50&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Keyword Token ElseIfStatement ELSEIF">elseif</span><span class="Keyword Token ElseIfStatement SPACE"> </span><span class="Identifier Token Variable ID">numberVar</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">50</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token ElseIfStatement THEN">then</span><span class="Keyword Token ElseIfStatement LF">
</span><span class="Keyword Token ElseIfStatement SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;Number is equal to 50&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;Number is less than 50&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- 3. 循环语句</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;Iteration&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">counter</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Number LF">
</span><span class="Statement Keyword Token WHILE">while</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">counter</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token brace-depth-1 LANGLE_BRACE">&lt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">5</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">counter</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">counter</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number LF">
</span><span class="Expression Token Number SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;Counter:&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">counter</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- 4. 函数定义</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FunctionName FuncName ID">sayHello</span><span class="brace-depth-2 Statement Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">name</span><span class="brace-depth-2 Statement Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;Hello,&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">name</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody COMMENT">-- 5. 函数调用</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">sayHello</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;Alice&quot;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- 6. 表(Table)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">person</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Token TableConstructor brace-depth-2 LCURLY_BRACE">{</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Identifier Token Field ID">name</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Token String STR">&quot;Bob&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">    </span><span class="Identifier Token Field ID">age</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Token Number Field NUMBER">30</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">    </span><span class="Identifier Token Field ID">isMale</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Keyword Token Field TRUE">true</span><span class="Keyword Token Field LF">
</span><span class="Expression Token TableConstructor brace-depth-2 RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">person</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">name</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Argument Token VarSuffix COMMENT">-- Output: Bob</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- 7. 匿名函数</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName FunctionName ID">add</span><span class="Identifier Token AttributeName FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">b</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">add</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Argument Token VarSuffix COMMENT">-- Output: 7</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- 8. 迭代器(Pairs和ipairs)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">fruits</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Token TableConstructor brace-depth-2 LCURLY_BRACE">{</span><span class="Token String STR">&quot;apple&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token String STR">&quot;banana&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token String STR">&quot;orange&quot;</span><span class="Expression Token TableConstructor brace-depth-2 RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token ID">index</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">fruit</span><span class="Identifier Token SPACE"> </span><span class="Statement Keyword Token IN">in</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">ipairs</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">fruits</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;Fruit&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">index</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;is&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">fruit</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- 9. 模块(Module)</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">myModule</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Token TableConstructor brace-depth-2 LCURLY_BRACE">{</span><span class="Expression Token TableConstructor brace-depth-2 RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FuncName ID">myModule</span><span class="Statement Token FuncName DOT">.</span><span class="Identifier Token FunctionName FuncName ID">sayGoodbye</span><span class="brace-depth-2 Statement Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">name</span><span class="brace-depth-2 Statement Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;Goodbye,&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">name</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">myModule</span><span class="Identifier Token Variable LF">
</span></code></pre><h2 id="h2-3"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/3.lua" target="_blank">3.lua</a></h2><pre class="language-lua"><code><span class="Token COMMENT">-- 定义斐波那契数列函数</span><span class="Token LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FunctionName FuncName ID">fibonacci</span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">n</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">fib</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Token Number Field NUMBER">0</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">1</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">        </span><span class="Identifier Token Variable ID">fib</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">fib</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">fib</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix LF">
</span><span class="Token VarSuffix SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">fib</span><span class="Identifier Token Variable LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody COMMENT">-- 打印前n个斐波那契数</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FunctionName FuncName ID">print_fibonacci</span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">n</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">fib</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">fibonacci</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;前&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token CONCAT">..</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token CONCAT">..</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;个斐波那契数列:&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">        </span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">write</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">fib</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token CONCAT">..</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot; &quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- 换行</span><span class="Argument Token VarSuffix LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody COMMENT">-- 调用函数打印前10个斐波那契数</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">print_fibonacci</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span></code></pre><h2 id="h2-4"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/4.lua" target="_blank">4.lua</a></h2><pre class="language-lua"><code><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FunctionName FuncName ID">factorial</span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">n</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token LE">&lt;=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">        </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">        </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MUL">*</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">factorial</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">result</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">factorial</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">5</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;Factorial of 5:&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">result</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number LF">
</span><span class="Token Number LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FunctionName FuncName ID">modifyGlobal</span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Number LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FunctionName FuncName ID">accessGlobal</span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;Global a:&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">modifyGlobal</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">accessGlobal</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">largeNumber</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Punctuator Token Number CARET">^</span><span class="Token Number NUMBER">100</span><span class="Token Number LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;Large number:&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">largeNumber</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">largeTable</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Punctuator Token Number CARET">^</span><span class="Token Number NUMBER">6</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">largeTable</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;Large table length:&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">largeTable</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">longString</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="Token LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Punctuator Token Number CARET">^</span><span class="Token Number NUMBER">5</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">longString</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">longString</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token CONCAT">..</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">tostring</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;Length of longString:&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">longString</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">nestedTable</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Identifier Token Field ID">a</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Token Number Field NUMBER">1</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">    </span><span class="Identifier Token Field ID">b</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">        </span><span class="Identifier Token Field ID">c</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Token Number Field NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">        </span><span class="Identifier Token Field ID">d</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Expression Token TableConstructor brace-depth-2 LCURLY_BRACE">{</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">            </span><span class="Identifier Token Field ID">e</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Token Number Field NUMBER">3</span><span class="Token Number Field LF">
</span><span class="Token Number Field SPACE">        </span><span class="Expression Token TableConstructor brace-depth-2 RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;Value of nestedTable.b.d.e:&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">nestedTable</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">b</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">d</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">e</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FunctionName FuncName ID">multipleReturns</span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Number LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">c</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">multipleReturns</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;Values:&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">mixedTable</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Token String STR">&quot;first&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">    </span><span class="Token String STR">&quot;second&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">    </span><span class="Identifier Token Field ID">key1</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Token String STR">&quot;value1&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">    </span><span class="Identifier Token Field ID">key2</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Token String STR">&quot;value2&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">    </span><span class="Identifier Token Field ID">key3</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">        </span><span class="Identifier Token Field ID">key1</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">        </span><span class="Keyword Token FunctionBody END">end</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">        </span><span class="Identifier Token Field ID">key2</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Token Number Field NUMBER">1</span><span class="Token Number Field LF">
</span><span class="Token Number Field SPACE">    </span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;Value at index 2:&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">mixedTable</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;Value of key &#x27;key1&#x27;:&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">mixedTable</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">key1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">mixedTable</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">key3</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">key1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">mixedTable</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">key3</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">key2</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">mixedTable</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">key3</span><span class="Token VarSuffix COLON">:</span><span class="Identifier FunctionCall Token VarSuffix ID">asd</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">value</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">42</span><span class="Token Number LF">
</span><span class="Token Number LF">
</span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">value</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;Value is truthy&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;Value is falsy&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span></code></pre><h2 id="h2-5"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/5.lua" target="_blank">5.lua</a></h2><pre class="language-lua"><code><span class="Token LF">
</span><span class="Token COMMENT">-- $Id: testes/all.lua $</span><span class="Token LF">
</span><span class="Token COMMENT">-- See Copyright Notice at the end of this file</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">version</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;Lua 5.4&quot;</span><span class="Token LF">
</span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">_VERSION</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">version</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">stderr</span><span class="Token VarSuffix COLON">:</span><span class="Identifier FunctionCall Token VarSuffix ID">write</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;This test suite is for &quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">version</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">                  </span><span class="Token String STR">&quot;, not for &quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">_VERSION</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;</span><span class="Control Token String STR">\n</span><span class="Token String STR">Exiting tests&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">ARG</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">arg</span><span class="Identifier Token Variable SPACE">   </span><span class="Identifier Token Variable COMMENT">-- save arg for other tests</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable COMMENT">-- next variables control the execution of some tests</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable COMMENT">-- true means no test (so an undefined variable does not skip a test)</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable COMMENT">-- defaults are for Linux; test everything.</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable COMMENT">-- Make true to avoid long or memory consuming tests</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable ID">_soft</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">rawget</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">_G</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;_soft&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Expression Keyword Token OR">or</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Keyword Token FALSE">false</span><span class="Expression Keyword Token LF">
</span><span class="Expression Keyword Token COMMENT">-- Make true to avoid non-portable tests</span><span class="Expression Keyword Token LF">
</span><span class="Identifier Token Variable ID">_port</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">rawget</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">_G</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;_port&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Expression Keyword Token OR">or</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Keyword Token FALSE">false</span><span class="Expression Keyword Token LF">
</span><span class="Expression Keyword Token COMMENT">-- Make true to avoid messages about tests not performed</span><span class="Expression Keyword Token LF">
</span><span class="Identifier Token Variable ID">_nomsg</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">rawget</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">_G</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;_nomsg&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Expression Keyword Token OR">or</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Keyword Token FALSE">false</span><span class="Expression Keyword Token LF">
</span><span class="Expression Keyword Token LF">
</span><span class="Expression Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">usertests</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">rawget</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">_G</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;_U&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">usertests</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- tests for sissies ;)  Avoid problems</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">_soft</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">_port</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">_nomsg</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Keyword Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- tests should require debug when needed</span><span class="Statement Keyword Token LF">
</span><span class="Identifier Token Variable ID">debug</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token LF">
</span><span class="Keyword Token LF">
</span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">usertests</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token SPACE">    </span><span class="Keyword Token COMMENT">-- no &quot;internal&quot; tests for user tests</span><span class="Keyword Token LF">
</span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">rawget</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">_G</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;T&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- avoid problems with &#x27;strict&#x27; module</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">--[=[
  example of a long [comment],
  [[spanning several [lines]]]
]=]</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;</span><span class="Control Token String STR">\n</span><span class="Control Token String STR">\t</span><span class="Token String STR">Starting Tests&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- set random seed</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">random_x</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">random_y</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">randomseed</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">format</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;random seeds: </span><span class="Token String Format STR">%d</span><span class="Token String STR">, </span><span class="Token String Format STR">%d</span><span class="Token String STR">&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">random_x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">random_y</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;current path:</span><span class="Control Token String STR">\n</span><span class="Token String STR">****&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token CONCAT">..</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">path</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token CONCAT">..</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;****</span><span class="Control Token String STR">\n</span><span class="Token String STR">&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">initclock</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">os</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">clock</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">lastclock</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">initclock</span><span class="Identifier Token Variable LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">walltime</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">os</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">time</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">collectgarbage</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">collectgarbage</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- (</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- track messages for tests not performed</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">msgs</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FunctionName FuncName ID">Message</span><span class="Identifier Token FunctionName FuncName SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">m</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">_nomsg</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">m</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">msgs</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">msgs</span><span class="Punctuator Expression Token PLUS">+</span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">sub</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">m</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">3</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">os</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">setlocale</span><span class="Token String STR">&quot;C&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">T</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">print</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">format</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">write</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">assert</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">type</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">unpack</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">floor</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">      </span><span class="Identifier Token Variable ID">T</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">print</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">format</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">write</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">assert</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">type</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">table</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">unpack</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">floor</span><span class="Identifier TableKey Token VarSuffix LF">
</span><span class="Identifier TableKey Token VarSuffix COMMENT">-- use K for 1000 and M for 1000000 (not 2^10 -- 2^20)</span><span class="Identifier TableKey Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">F</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">m</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">round</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">m</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier Token Variable ID">m</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0.04999</span><span class="Expression Token Number LF">
</span><span class="Expression Token Number SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">format</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;%.1f&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">      </span><span class="Argument Token VarSuffix COMMENT">-- keep one decimal digit</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token brace-depth-0 LANGLE_BRACE">&lt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1000</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">m</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token DIV">/</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1000</span><span class="Expression Token Number LF">
</span><span class="Expression Token Number SPACE">    </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token brace-depth-1 LANGLE_BRACE">&lt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1000</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">round</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">m</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Punctuator Expression Token CONCAT">..</span><span class="Token String STR">&quot;K&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">      </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">round</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">m</span><span class="Punctuator Expression Token DIV">/</span><span class="Expression Token Number NUMBER">1000</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Punctuator Expression Token CONCAT">..</span><span class="Token String STR">&quot;M&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">Cstacklevel</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">showmem</span><span class="Identifier Token AttributeName LF">
</span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">max</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Identifier Token Variable FunctionName ID">showmem</span><span class="Identifier Token Variable FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">m</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;count&quot;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token MUL">*</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1024</span><span class="Expression Token Number LF">
</span><span class="Expression Token Number SPACE">    </span><span class="Identifier Token Variable ID">max</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Token Variable brace-depth-2 LPAREN">(</span><span class="Identifier Token Variable ID">m</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token brace-depth-0 RANGLE_BRACE">&gt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">max</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token OR">or</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">max</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">format</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;    ---- total memory: </span><span class="Token String Format STR">%s</span><span class="Token String STR">, max memory: </span><span class="Token String Format STR">%s</span><span class="Token String STR"> ----</span><span class="Control Token String STR">\n</span><span class="Token String STR">&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">          </span><span class="Identifier FunctionCall Token Variable ID">F</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">m</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">F</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">max</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier Token Variable FunctionName ID">Cstacklevel</span><span class="Identifier Token Variable FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody SPACE">   </span><span class="Keyword Token FunctionBody COMMENT">-- no info about stack level</span><span class="Keyword Token FunctionBody LF">
</span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">  </span><span class="Identifier Token Variable FunctionName ID">showmem</span><span class="Identifier Token Variable FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">checkmemory</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">total</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">numblocks</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">maxmem</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">totalmem</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">count</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;count&quot;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">format</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">      </span><span class="Token String STR">&quot;</span><span class="Control Token String STR">\n</span><span class="Token String STR">    ---- total memory: </span><span class="Token String Format STR">%s</span><span class="Token String STR"> (%.0fK), max use: </span><span class="Token String Format STR">%s</span><span class="Token String STR">,  blocks: </span><span class="Token String Format STR">%d</span><span class="Control Token String STR">\n</span><span class="Token String STR">&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">      </span><span class="Identifier FunctionCall Token Variable ID">F</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">total</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">count</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">F</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">maxmem</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">numblocks</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">format</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;</span><span class="Control Token String STR">\t</span><span class="Token String STR">(strings:  </span><span class="Token String Format STR">%d</span><span class="Token String STR">, tables: </span><span class="Token String Format STR">%d</span><span class="Token String STR">, functions: </span><span class="Token String Format STR">%d</span><span class="Token String STR">, &quot;</span><span class="Punctuator Expression Token CONCAT">..</span><span class="Punctuator Expression Token LF">
</span><span class="Punctuator Expression Token SPACE">                 </span><span class="Token String STR">&quot;</span><span class="Control Token String STR">\n</span><span class="Control Token String STR">\t</span><span class="Token String STR">udata: </span><span class="Token String Format STR">%d</span><span class="Token String STR">, threads: </span><span class="Token String Format STR">%d</span><span class="Token String STR">)&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">                 </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">totalmem</span><span class="Token String STR">&quot;string&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">totalmem</span><span class="Token String STR">&quot;table&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">totalmem</span><span class="Token String STR">&quot;function&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">                 </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">totalmem</span><span class="Token String STR">&quot;userdata&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">totalmem</span><span class="Token String STR">&quot;thread&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier Token Variable FunctionName ID">Cstacklevel</span><span class="Identifier Token Variable FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">_</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">_</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">ncalls</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">stacklevel</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">ncalls</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable COMMENT">-- number of C calls</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">Cstack</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">Cstacklevel</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">--</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- redefine dofile to run files through dump/undump</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">--</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">report</span><span class="Identifier Statement Token SPACE"> </span><span class="brace-depth-2 Statement Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">n</span><span class="brace-depth-2 Statement Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;</span><span class="Control Token String STR">\n</span><span class="Token String STR">***** FILE &#x27;&quot;</span><span class="Punctuator Expression Token CONCAT">..</span><span class="Identifier Token Variable ID">n</span><span class="Punctuator Expression Token CONCAT">..</span><span class="Token String STR">&quot;&#x27;*****&quot;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">olddofile</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">dofile</span><span class="Identifier Token Variable LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName FunctionName ID">dofile</span><span class="Identifier Token AttributeName FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">n</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">strip</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">showmem</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">c</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">os</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">clock</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">format</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;time: </span><span class="Token String Format STR">%g</span><span class="Token String STR"> (+</span><span class="Token String Format STR">%g</span><span class="Token String STR">)&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">initclock</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">lastclock</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">lastclock</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">report</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">loadfile</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">dump</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">strip</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;main.lua&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- trace GC cycles</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">require</span><span class="Token String STR">&quot;tracegc&quot;</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">start</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">report</span><span class="Token String STR">&quot;gc.lua&quot;</span><span class="Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">loadfile</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;gc.lua&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;db.lua&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;calls.lua&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">deep</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">deep</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">deep</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">olddofile</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;strings.lua&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">olddofile</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;literals.lua&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;tpack.lua&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;attrib.lua&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">27</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;gengc.lua&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;locals.lua&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">5</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;constructs.lua&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;code.lua&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">_soft</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">report</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;big.lua&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">coroutine</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">wrap</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">loadfile</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&#x27;big.lua&#x27;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;b&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;a&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;cstack.lua&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;nextvar.lua&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;pm.lua&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;utf8.lua&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;api.lua&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;events.lua&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">12</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;vararg.lua&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;closure.lua&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;coroutine.lua&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;goto.lua&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;errors.lua&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;math.lua&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;sort.lua&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;bitwise.lua&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;verybig.lua&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;files.lua&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">msgs</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token brace-depth-2 RANGLE_BRACE">&gt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">m</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">table</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">concat</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">msgs</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;</span><span class="Control Token String STR">\n</span><span class="Token String STR">  &quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">warn</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;#tests not performed:</span><span class="Control Token String STR">\n</span><span class="Token String STR">  &quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;</span><span class="Control Token String STR">\n</span><span class="Token String STR">&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;(there should be two warnings now)&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">warn</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;@on&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">warn</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;#This is &quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;an expected&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot; warning&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">warn</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;@off&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">warn</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;******** THIS WARNING SHOULD NOT APPEAR **********&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">warn</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;******** THIS WARNING ALSO SHOULD NOT APPEAR **********&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">warn</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;@on&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">warn</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;#This is&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot; another one&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- no test module should define &#x27;debug&#x27;</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">debug</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Token String STR">&quot;debug&quot;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">format</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;</span><span class="Token String Format STR">%d</span><span class="Token String STR">-bit integers, </span><span class="Token String Format STR">%d</span><span class="Token String STR">-bit floats&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">        </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">packsize</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;j&quot;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token MUL">*</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">8</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">packsize</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;n&quot;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token MUL">*</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">8</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">sethook</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">a</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;string&#x27;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;cr&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- to survive outside block</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">showmem</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">showmem</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">Cstack</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">Cstacklevel</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token String STR">&quot;should be at the same C-stack level it was when started the tests&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">--)</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">_G</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">showmem</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">print</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">format</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">clock</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">time</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">difftime</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName LF">
</span><span class="Token AttributeName SPACE">      </span><span class="Identifier Token AttributeName ID">assert</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">open</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">warn</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">      </span><span class="Identifier Token Variable ID">_G</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">showmem</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">format</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">os</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">clock</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">os</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">time</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">os</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">difftime</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">      </span><span class="Identifier Token Variable ID">assert</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">open</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">warn</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable COMMENT">-- file with time of last performed test</span><span class="Identifier Token Variable LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">fname</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Token String STR">&quot;time-debug.txt&quot;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token OR">or</span><span class="Expression Keyword Token SPACE"> </span><span class="Token String STR">&quot;time.txt&quot;</span><span class="Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">lasttime</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName LF">
</span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">usertests</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- open file with time of last performed test</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">open</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">fname</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">lasttime</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">tonumber</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token VarSuffix COLON">:</span><span class="Identifier FunctionCall Token VarSuffix ID">read</span><span class="Token String STR">&#x27;a&#x27;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">f</span><span class="Token VarSuffix COLON">:</span><span class="Identifier FunctionCall Token VarSuffix ID">close</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token SPACE">   </span><span class="ElseStatement Keyword Token COMMENT">-- no such file; assume it is recording time for first time</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">lasttime</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- erase (almost) all globals</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;cleaning all!!!!&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token ID">n</span><span class="Identifier Token SPACE"> </span><span class="Statement Keyword Token IN">in</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pairs</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">_G</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression brace-depth-0 Token Variable LPAREN">(</span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">___Glob</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Token Number Field NUMBER">1</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Identifier Token Field ID">tostring</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Token Number Field NUMBER">1</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Expression brace-depth-0 Token Variable RPAREN">)</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">n</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">_G</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">n</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">undef</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Identifier FunctionCall Token Variable ID">showmem</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">clocktime</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">clock</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">initclock</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable ID">walltime</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">difftime</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">time</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">walltime</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">format</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;</span><span class="Control Token String STR">\n</span><span class="Control Token String STR">\n</span><span class="Token String STR">total time: %.2fs (wall time: </span><span class="Token String Format STR">%gs</span><span class="Token String STR">)</span><span class="Control Token String STR">\n</span><span class="Token String STR">&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">clocktime</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">walltime</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">usertests</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">lasttime</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">lasttime</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token OR">or</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">clocktime</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable COMMENT">-- if no last time, ignore difference</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable COMMENT">-- check whether current test time differs more than 5% from last time</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">diff</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">clocktime</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">lasttime</span><span class="Expression brace-depth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token DIV">/</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">lasttime</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">tolerance</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0.05</span><span class="Token Number SPACE">    </span><span class="Token Number COMMENT">-- 5%</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Expression brace-depth-0 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">diff</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token GE">&gt;=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">tolerance</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token OR">or</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">diff</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token LE">&lt;=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Identifier Token Variable ID">tolerance</span><span class="Expression brace-depth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">warn</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">format</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;#time difference from previous test: %+.1f%%&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">                  </span><span class="Identifier Token Variable ID">diff</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MUL">*</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">100</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">open</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">fname</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;w&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Token VarSuffix COLON">:</span><span class="Identifier FunctionCall Token VarSuffix ID">write</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">clocktime</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Token VarSuffix COLON">:</span><span class="Identifier FunctionCall Token VarSuffix ID">close</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;final OK !!!&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">--[[
*****************************************************************************
* Copyright (C) 1994-2016 Lua.org, PUC-Rio.
*
* Permission is hereby granted, free of charge, to any person obtaining
* a copy of this software and associated documentation files (the
* &quot;Software&quot;), to deal in the Software without restriction, including
* without limitation the rights to use, copy, modify, merge, publish,
* distribute, sublicense, and/or sell copies of the Software, and to
* permit persons to whom the Software is furnished to do so, subject to
* the following conditions:
*
* The above copyright notice and this permission notice shall be
* included in all copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
* MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
* IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY
* CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
* TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
* SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
*****************************************************************************
]]</span></code></pre><h2 id="h2-6"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/6.lua" target="_blank">6.lua</a></h2><pre class="language-lua"><code><span class="Token COMMENT">-- $Id: testes/api.lua $</span><span class="Token LF">
</span><span class="Token COMMENT">-- See Copyright Notice in file all.lua</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Keyword Token NIL">nil</span><span class="Expression Keyword Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="brace-depth-0 Token Variable LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">Message</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Expression Keyword Token FunctionCall OR">or</span><span class="Expression Keyword Token FunctionCall SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Token Variable RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;</span><span class="Control Token String STR">\n</span><span class="Token String STR"> &gt;&gt;&gt; testC not active: skipping API tests &lt;&lt;&lt;</span><span class="Control Token String STR">\n</span><span class="Token String STR">&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment LF">
</span><span class="Keyword Token ReturnStatment SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">debug</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Token String STR">&quot;debug&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">pack</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">table</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">pack</span><span class="Identifier TableKey Token VarSuffix LF">
</span><span class="Identifier TableKey Token VarSuffix SPACE">  </span><span class="Identifier TableKey Token VarSuffix COMMENT">-- standard error message for memory errors</span><span class="Identifier TableKey Token VarSuffix LF">
</span><span class="Identifier TableKey Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">MEMERRMSG</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;not enough memory&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">tcheck</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">t1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">t2</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t1</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">n</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">t2</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">n</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Expression Keyword Token OR">or</span><span class="Expression Keyword Token SPACE"> </span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">t2</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t1</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">n</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t1</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">t2</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">checkerr</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">f</span><span class="Token FunctionBody ParameterList COMMA">,</span><span class="Token FunctionBody ParameterList SPACE"> </span><span class="Punctuator Token ParameterList VARARGS">...</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">stat</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">err</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token VARARGS">...</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">stat</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">find</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">err</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">msg</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;testing C API&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;pushvalue R; return 1&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">getregistry</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- absindex</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;settop 10; absindex -1; return 1&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;settop 5; absindex -5; return 1&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;settop 10; absindex 1; return 1&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;settop 10; absindex R; return 1&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token brace-depth-1 LANGLE_BRACE">&lt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">10</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- testing alignment</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">d2s</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">12458954321123.0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">pack</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;d&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">12458954321123.0</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">s2d</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">12458954321123.0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">b</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">c</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;pushnum 1; pushnum 2; pushnum 3; return 2&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">makeCfunc</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;pushnum 1; pushnum 2; pushnum 3; return 2&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- test that all trues are equal</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;pushbool 1; pushbool 2; pushbool 0; return 3&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token TRUE">true</span><span class="Expression Keyword Token SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token FALSE">false</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Token String STR">&quot;pushbool 0; pushbool 10; pushnil;\
                        tobool -3; tobool -3; tobool -3; return 3&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Keyword Token FALSE">false</span><span class="Expression Keyword Token SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Keyword Token TRUE">true</span><span class="Expression Keyword Token SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Keyword Token FALSE">false</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;gettop; return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">30</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">40</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">40</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">5</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;settop 5; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">n</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Number Field NUMBER">4</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">3</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;settop 0; settop 15; return 10&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">23</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">n</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="Expression Keyword Token SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">10</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;remove -2; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">n</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Number Field NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">4</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;insert -1; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">n</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Number Field NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">3</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;insert 3; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">n</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Number Field NUMBER">4</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">5</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">4</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;replace 2; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">n</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Number Field NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">5</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">4</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;replace -2; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">n</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Number Field NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">5</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;remove 3; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">n</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Number Field NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">4</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">5</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;copy 3 4; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">n</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Number Field NUMBER">4</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">5</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;copy -3 -1; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">n</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Number Field NUMBER">4</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">4</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">3</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- testing &#x27;rotate&#x27;</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Token Number Field NUMBER">10</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">20</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">30</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">40</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">50</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">60</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">6</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">6</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">s</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">format</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;rotate 2 </span><span class="Token String Format STR">%d</span><span class="Token String STR">; return 7&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">      </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">t1</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">s</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">30</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">40</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">50</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">60</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">      </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">      </span><span class="Identifier Token Variable ID">table</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">insert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">table</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">remove</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;rotate -2 1; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">30</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">40</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Token Number Field NUMBER">10</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">20</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">40</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">30</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;rotate -2 -1; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">30</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">40</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Token Number Field NUMBER">10</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">20</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">40</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">30</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Argument Token VarSuffix COMMENT">-- some corner cases</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;rotate -1 0; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">30</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">40</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Token Number Field NUMBER">10</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">20</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">30</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">40</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;rotate -1 1; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">30</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">40</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Token Number Field NUMBER">10</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">20</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">30</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">40</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;rotate 5 -1; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">30</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">40</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Token Number Field NUMBER">10</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">20</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">30</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">40</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- testing warnings</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">[[
    warningC &quot;#This shold be a&quot;
    warningC &quot; single &quot;
    warning &quot;warning&quot;
    warningC &quot;#This should be &quot;
    warning &quot;another one&quot;
  ]]</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- testing message handlers</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">makeCfunc</span><span class="Token String STR">[[
      getglobal error
      pushstring bola
      pcall 1 1 1   # call &#x27;error&#x27; with given handler
      pushstatus
      return 2     # return error message and status
    ]]</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">msg</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">st</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">upper</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">   </span><span class="Argument Token VarSuffix COMMENT">-- function handler</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">st</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;ERRRUN&quot;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">msg</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;BOLA&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">msg</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">st</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">len</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">     </span><span class="Argument Token VarSuffix COMMENT">-- function handler</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">st</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;ERRRUN&quot;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">msg</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">4</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;insert 3; pushvalue 3; remove 3; pushvalue 2; remove 2; \
                    insert 2; pushvalue 1; remove 1; insert 1; \
        insert -2; pushvalue -2; remove -3; return *&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">        </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">40</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">90</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">n</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Number Field NUMBER">7</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">4</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">5</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">10</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">40</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">90</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;concat 5; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;alo&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;joao&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">12</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">n</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Number Field NUMBER">1</span><span class="Punctuator Token COMMA">,</span><span class="Token String STR">&quot;alo23joao12&quot;</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- testing MULTRET</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;call 2,-1; return *&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">       </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;alo&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;joao&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">n</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Number Field NUMBER">6</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">1</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">4</span><span class="Punctuator Token COMMA">,</span><span class="Token String STR">&quot;alo&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token String STR">&quot;joao&quot;</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- test returning more results than fit in the caller stack</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Token Number NUMBER">1000</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Keyword Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">999</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">[[pcall 1 -1 0; pop 1; tostring -1; return 1]]</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">                      </span><span class="Identifier Token Variable ID">table</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">unpack</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;10&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- testing globals</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">AA</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">14</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">BB</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;a31&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Token TableConstructor brace-depth-2 LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Token String STR">[[
    getglobal AA;
    getglobal BB;
    getglobal BB;
    setglobal AA;
    return *
  ]]</span><span class="Expression Token TableConstructor brace-depth-2 RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">14</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">3</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;a31&quot;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">4</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="Expression Keyword Token SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">AA</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;a31&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix ID">AA</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix ID">BB</span><span class="Identifier Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Keyword Token COMMENT">-- testing arith</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;pushnum 10; pushnum 20; arith /; return 1&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0.5</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;pushnum 10; pushnum 20; arith -; return 1&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;pushnum 10; pushnum -20; arith *; return 1&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">200</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;pushnum 10; pushnum 3; arith ^; return 1&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1000</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;pushnum 10; pushstring 20; arith /; return 1&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0.5</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;pushstring 10; pushnum 20; arith -; return 1&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;pushstring 10; pushstring -20; arith *; return 1&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">200</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;pushstring 10; pushstring 3; arith ^; return 1&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1000</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;arith /; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10.0</span><span class="Punctuator Token Number DIV">/</span><span class="Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;pushnum 10; pushint 3; arith </span><span class="Control Token String STR">\\</span><span class="Token String STR">; return 1&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3.0</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">type</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;float&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;pushint 10; pushint 3; arith </span><span class="Control Token String STR">\\</span><span class="Token String STR">; return 1&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">type</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;integer&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;pushint 10; pushint 3; arith +; return 1&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">13</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">type</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;integer&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;pushnum 10; pushint 3; arith +; return 1&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">13</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">type</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;float&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">[[pushnum 1;
                    pushstring 10; arith _;
                    pushstring 5; return 3]]</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">10</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;5&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">mt</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">        </span><span class="Identifier Token Field ID">__add</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Expression Token TableConstructor brace-depth-2 LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Expression Token TableConstructor brace-depth-2 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">mt</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">        </span><span class="Identifier Token Field ID">__mod</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Expression Token TableConstructor brace-depth-2 LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token MOD">%</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Expression Token TableConstructor brace-depth-2 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">mt</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">        </span><span class="Identifier Token Field ID">__unm</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">a</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Expression Token TableConstructor brace-depth-2 LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Punctuator Expression Token MUL">*</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token TableConstructor brace-depth-2 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">mt</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Token Number Field NUMBER">4</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">mt</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">          </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Token Number Field NUMBER">8</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">mt</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">          </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">3</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">mt</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">y</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">z</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;arith +; return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">12</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">z</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;arith %; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">4</span><span class="Punctuator Token Number MOD">%</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">3</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;arith _; arith +; arith %; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token LF">
</span><span class="Punctuator Expression Token SPACE">                 </span><span class="Expression Token Number NUMBER">8</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number MOD">%</span><span class="Punctuator Token Number SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">4</span><span class="Token Variable Number SPACE"> </span><span class="Punctuator Token Number PLUS">+</span><span class="Punctuator Token Number SPACE"> </span><span class="Expression Token Variable brace-depth-2 LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">3</span><span class="Expression Token Variable brace-depth-2 RPAREN">)</span><span class="Punctuator Expression Token MUL">*</span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- errors in arithmetic</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkerr</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;divide by zero&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">testC</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;arith </span><span class="Control Token String STR">\\</span><span class="Token String STR">&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkerr</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;%</span><span class="Token String Format STR">%0</span><span class="Token String STR">&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">testC</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;arith %&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- testing lessthan and lessequal</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;compare LT 2 5, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;compare LE 2 5, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;compare LT 3 4, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;compare LE 3 4, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;compare LT 5 2, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;compare LT 2 -3, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;4&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;3&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;2&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;compare LT -3 2, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;3&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;4&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;2&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- non-valid indices produce false</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;compare LT 1 4, return 1&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;compare LE 9 1, return 1&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;compare EQ 9 9, return 1&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__lt</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token brace-depth-1 LANGLE_BRACE">&lt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Expression Token TableConstructor brace-depth-2 RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a1</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">a3</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">a4</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Token Number Field NUMBER">1</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">                   </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Token Number Field NUMBER">3</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">                   </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Token Number Field NUMBER">4</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;compare LT 2 5, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;compare LE 2 5, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;compare LT 5 -6, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;compare LT 5 -6, return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">20</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token FALSE">false</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;compare LE 5 -6, return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">20</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token FALSE">false</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;compare LE 5 -6, return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">20</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token TRUE">true</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- testing lessthan and lessequal with metamethods</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">mt</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__lt</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token brace-depth-1 LANGLE_BRACE">&lt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">                </span><span class="Identifier Token Field ID">__le</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token LE">&lt;=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">                </span><span class="Identifier Token Field ID">__eq</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Expression Token TableConstructor brace-depth-2 RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">O</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">      </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">x</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">mt</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;compare LT 2 3; pushint 10; return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">O</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">O</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">2</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token TRUE">true</span><span class="Expression Keyword Token SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;compare LE 2 3; pushint 10; return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">O</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">3</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">O</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">2</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token FALSE">false</span><span class="Expression Keyword Token SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;compare EQ 2 3; pushint 10; return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">O</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">3</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">O</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">3</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token TRUE">true</span><span class="Expression Keyword Token SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- testing length</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">x</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Token Number Field NUMBER">20</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__len</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">t</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">x</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">[[
     len 2;
     Llen 2;
     objsize 2;
     return 3
  ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">20</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">20</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">x</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;234&quot;</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">[[
     len 2;
     Llen 2;
     objsize 2;
     return 3
  ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;234&quot;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">234</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">x</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">[[
     len 2;
     objsize 2;
     return 2
  ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- testing __concat</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">x</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token String STR">&quot;u&quot;</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__concat</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">x</span><span class="Punctuator Expression Token CONCAT">..</span><span class="Token String STR">&#x27;.&#x27;</span><span class="Punctuator Expression Token CONCAT">..</span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">x</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">[[
    pushnum 5
    pushvalue 2;
    pushvalue 2;
    concat 2;
    pushvalue -2;
    return 2;
  ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Punctuator Expression Token CONCAT">..</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">5</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- concat with 0 elements</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;concat 0; return 1&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- concat with 1 element</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;concat 1; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;xuxu&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;xuxu&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- testing lua_is</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">B</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number OR">or</span><span class="Keyword Token Number SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">count</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">n</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token OR">or</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Number LF">
</span><span class="Expression Token Number SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">prog</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">[[
      isnumber </span><span class="Token String Format STR">%d</span><span class="Token String STR">;
      isstring </span><span class="Token String Format STR">%d</span><span class="Token String STR">;
      isfunction </span><span class="Token String Format STR">%d</span><span class="Token String STR">;
      iscfunction </span><span class="Token String Format STR">%d</span><span class="Token String STR">;
      istable </span><span class="Token String Format STR">%d</span><span class="Token String STR">;
      isuserdata </span><span class="Token String Format STR">%d</span><span class="Token String STR">;
      isnil </span><span class="Token String Format STR">%d</span><span class="Token String STR">;
      isnull </span><span class="Token String Format STR">%d</span><span class="Token String STR">;
      return 8
    ]]</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">format</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">b</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">c</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">d</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">e</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">f</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">g</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">h</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">B</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Punctuator Expression Token PLUS">+</span><span class="Identifier FunctionCall Token Variable ID">B</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Punctuator Expression Token PLUS">+</span><span class="Identifier FunctionCall Token Variable ID">B</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Punctuator Expression Token PLUS">+</span><span class="Identifier FunctionCall Token Variable ID">B</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">d</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Punctuator Expression Token PLUS">+</span><span class="Identifier FunctionCall Token Variable ID">B</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">e</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Punctuator Expression Token PLUS">+</span><span class="Identifier FunctionCall Token Variable ID">B</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Punctuator Expression Token PLUS">+</span><span class="Identifier FunctionCall Token Variable ID">B</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">g</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Punctuator Expression Token PLUS">+</span><span class="Expression brace-depth-0 Token Variable LPAREN">(</span><span class="Token Variable Number NUMBER">100</span><span class="Punctuator Token Number MUL">*</span><span class="Identifier FunctionCall Token Variable ID">B</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">h</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Expression brace-depth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">count</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">3</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">count</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&#x27;alo&#x27;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">count</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&#x27;32&#x27;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">count</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Expression Token TableConstructor brace-depth-2 LCURLY_BRACE">{</span><span class="Expression Token TableConstructor brace-depth-2 RCURLY_BRACE">}</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">count</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">print</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">count</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">count</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Keyword Token NIL">nil</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">count</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">stdin</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">count</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">15</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">100</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- testing lua_to...</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">to</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">s</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">n</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token OR">or</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Number LF">
</span><span class="Expression Token Number SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">format</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;</span><span class="Token String Format STR">%s</span><span class="Token String STR"> </span><span class="Token String Format STR">%d</span><span class="Token String STR">; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">s</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">null</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">pushuserdata</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">hfunc</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">gmatch</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Argument Token VarSuffix COMMENT">-- a &quot;heavy C function&quot; (with upvalues)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">getupvalue</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">hfunc</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;tostring&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token TableConstructor brace-depth-2 LCURLY_BRACE">{</span><span class="Expression Token TableConstructor brace-depth-2 RCURLY_BRACE">}</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;tostring&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;alo&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;alo&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;tostring&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">12</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;12&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;tostring&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">12</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;objsize&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token TableConstructor brace-depth-2 LCURLY_BRACE">{</span><span class="Expression Token TableConstructor brace-depth-2 RCURLY_BRACE">}</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;objsize&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token TableConstructor brace-depth-2 LCURLY_BRACE">{</span><span class="Token Number Field NUMBER">1</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">3</span><span class="Expression Token TableConstructor brace-depth-2 RCURLY_BRACE">}</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;objsize&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;alo\0\0a&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">6</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;objsize&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">newuserdata</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;objsize&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">newuserdata</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">101</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">101</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;objsize&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">124</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;objsize&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;tonumber&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token TableConstructor brace-depth-2 LCURLY_BRACE">{</span><span class="Expression Token TableConstructor brace-depth-2 RCURLY_BRACE">}</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;tonumber&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;12&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">12</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;tonumber&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;s2&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;tonumber&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">null</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">null</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">null</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;abc&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">null</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">rep</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;x&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token LF">
</span><span class="Punctuator Expression Token SPACE">         </span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">rep</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;x&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Argument Token VarSuffix COMMENT">-- short strings</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token COMMENT">-- long strings</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">s1</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">rep</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;x&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">300</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">s2</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">rep</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;x&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">300</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">s1</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">s2</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">pushuserdata</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">20</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">null</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">read</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">null</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">           </span><span class="Argument Token VarSuffix COMMENT">-- light C function</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">hfunc</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">null</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">        </span><span class="Argument Token VarSuffix COMMENT">-- &quot;heavy&quot; C function</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">null</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">   </span><span class="Argument Token VarSuffix COMMENT">-- Lua function</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">stdin</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">null</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">   </span><span class="Argument Token VarSuffix COMMENT">-- full userdata</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;func2num&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;func2num&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">pushuserdata</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;func2num&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">read</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">     </span><span class="Argument Token VarSuffix COMMENT">-- light C function</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;func2num&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">hfunc</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- &quot;heavy&quot; C function (with upvalue)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;tocfunction&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">deg</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">3</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">deg</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">3</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">deg</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;testing panic function&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token COMMENT">-- trivial error</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">checkpanic</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;pushstring hi; error&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;hi&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Argument Token VarSuffix COMMENT">-- using the stack inside panic</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">checkpanic</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;pushstring hi; error;&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">      </span><span class="Token String STR">[[checkstack 5 XX
        pushstring &#x27; alo&#x27;
        pushstring &#x27; mundo&#x27;
        concat 3]]</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;hi alo mundo&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Argument Token VarSuffix COMMENT">-- &quot;argerror&quot; without frames</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">checkpanic</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;loadstring 4&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token LF">
</span><span class="Punctuator Expression Token SPACE">        </span><span class="Token String STR">&quot;bad argument #4 (string expected, got no value)&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Argument Token VarSuffix COMMENT">-- memory error</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">totalmem</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">totalmem</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Punctuator Expression Token PLUS">+</span><span class="Expression Token Number NUMBER">10000</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">   </span><span class="Argument Token VarSuffix COMMENT">-- set low memory limit (+10k)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">checkpanic</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;newuserdata 20000&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">MEMERRMSG</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">totalmem</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">          </span><span class="Argument Token VarSuffix COMMENT">-- restore high limit</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Argument Token VarSuffix COMMENT">-- stack error</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">_soft</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">msg</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">checkpanic</span><span class="Token String STR">[[
        pushstring &quot;function f() f() end&quot;
        loadstring -1; call 0 0
        getglobal f; call 0 0
      ]]</span><span class="Token LF">
</span><span class="Token SPACE">      </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">find</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;stack overflow&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token COMMENT">-- exit in panic still close to-be-closed variables</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">checkpanic</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">[[
      pushstring &quot;return {__close = function () Y = &#x27;ho&#x27;; end}&quot;
      newtable
      loadstring -2
      call 0 1
      setmetatable -2
      toclose -1
      pushstring &quot;hi&quot;
      error
    ]]</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">[[
      getglobal Y
      concat 2         # concat original error with global Y
    ]]</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;hiho&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- testing deep C stack</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">_soft</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;testing stack overflow&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;stop&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">checkerr</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;XXXX&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">testC</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;checkstack 1000023 XXXX&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">   </span><span class="Argument Token VarSuffix COMMENT">-- too deep</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Argument Token VarSuffix COMMENT">-- too deep (with no message)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">checkerr</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;^stack overflow$&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">testC</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;checkstack 1000023 &#x27;&#x27;&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">s</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">rep</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;pushnil;checkstack 1 XX;&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1000000</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">checkerr</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;overflow&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">testC</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">s</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;restart&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Token String STR">&#x27;+&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">lim</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">_soft</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Token Number NUMBER">500</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number OR">or</span><span class="Keyword Token Number SPACE"> </span><span class="Token Number NUMBER">12000</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">prog</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Token String STR">&quot;checkstack &quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token CONCAT">..</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MUL">*</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number PLUS">+</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">100</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token CONCAT">..</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;msg&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token String STR">&quot;newtable&quot;</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">prog</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;pushnum &quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token CONCAT">..</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable ID">prog</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;pushnum &quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token CONCAT">..</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MUL">*</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="Expression Token Number LF">
</span><span class="Expression Token Number SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;rawgeti R 2&quot;</span><span class="Token SPACE">   </span><span class="Token COMMENT">-- get global table in registry</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;insert &quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token CONCAT">..</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression brace-depth-0 Token Variable LPAREN">(</span><span class="Token Variable Number NUMBER">2</span><span class="Punctuator Token Number MUL">*</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="Expression brace-depth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">prog</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;settable &quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token CONCAT">..</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression brace-depth-0 Token Variable LPAREN">(</span><span class="Token Variable Number NUMBER">2</span><span class="Punctuator Token Number MUL">*</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression brace-depth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;return 2&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">table</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">concat</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;;&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">g</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">g</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Punctuator Expression Token MUL">*</span><span class="Expression Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">undef</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">next</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">g</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Keyword Token COMMENT">-- testing errors</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">[[
    loadstring 2; pcall 0 1 0;
    pushvalue 3; insert -2; pcall 1 1 0;
    pcall 0 0 0;
    return 1
  ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;XX=150&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">a</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Keyword Token NIL">nil</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;string&#x27;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">XX</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">150</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">XX</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">check3</span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">p</span><span class="Token FunctionBody ParameterList COMMA">,</span><span class="Token FunctionBody ParameterList SPACE"> </span><span class="Punctuator Token ParameterList VARARGS">...</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">arg</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Punctuator Expression Token VARARGS">...</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">arg</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">find</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">arg</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">3</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check3</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;:1:&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;loadstring 2; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;x=&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check3</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;%.&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;loadfile 2; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;.&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check3</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;xxxx&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;loadfile 2; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;xxxx&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- test errors in non protected threads</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">checkerrnopro</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">code</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">msg</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">th</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">coroutine</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">create</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- create new thread</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">stt</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">err</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">testC</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">th</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">code</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">   </span><span class="Argument Token VarSuffix COMMENT">-- run code there</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">stt</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">find</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">err</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">msg</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">_soft</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;stop&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">   </span><span class="Argument Token VarSuffix COMMENT">-- avoid __gc with full stack</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">checkerrnopro</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;pushnum 3; call 0 0&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;attempt to call&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Token String STR">&quot;testing stack overflow in unprotected thread&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FunctionName FuncName ID">F</span><span class="Identifier Token FunctionName FuncName SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">F</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">checkerrnopro</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;getglobal &#x27;F&#x27;; call 0 0;&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;stack overflow&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">F</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;restart&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Token String STR">&quot;+&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token COMMENT">-- testing table access</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- getp/setp</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a1</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;rawsetp 2 1; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">a1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">pushuserdata</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">20</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a1</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;rawgetp -1 1; return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">a1</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">20</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- using the table itself as index</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">prog</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;gettable -1; return *&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">prog</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;settable -2; return *&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">20</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Argument Token VarSuffix COMMENT">-- raw</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">prog</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;rawget -1; return *&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">prog</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;rawset -2; return *&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">20</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Argument Token VarSuffix COMMENT">-- using the table as the value to set</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">prog</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;rawset -1; return *&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">30</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">30</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">prog</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;settable -1; return *&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">40</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">40</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">prog</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;rawseti -1 100; return *&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">100</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">prog</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;seti -1 200; return *&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">200</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">x</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Number Field NUMBER">0</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Identifier Token Field ID">y</span><span class="Token Field ASSIGN">=</span><span class="Token Number Field NUMBER">12</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;gettable 2; pushvalue 4; gettable 2; return 2&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">                  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;y&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;x&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">12</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;settable -5&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;x&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">15</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">x</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">15</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;gettable 2; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- table and key are the same object!</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;settable 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;x&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Argument Token VarSuffix COMMENT">-- table and key are the same object!</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;x&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">p</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">getmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionName Token TableKey VarSuffix ID">__index</span><span class="Identifier FunctionName Token TableKey VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">i</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">p</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">k</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;gettable 3, return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">35</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;x&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">15</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">k</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">35</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">k</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;getfield 2 y, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">k</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">12</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">getmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionName Token TableKey VarSuffix ID">__index</span><span class="Identifier FunctionName Token TableKey VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">i</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier Token Variable ID">getmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionName Token TableKey VarSuffix ID">__newindex</span><span class="Identifier FunctionName Token TableKey VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">i</span><span class="Token COMMA">,</span><span class="Identifier Token ID">v</span><span class="Identifier Token SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">v</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;insert 2; gettable -5; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;y&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">12</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">k</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;settable -5, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;x&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">16</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">x</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">16</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">k</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">4</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&#x27;xuxu&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;gettable 2, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;xuxu&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;settable 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">19</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">19</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">--</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- testing getfield/setfield with long keys</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">_012345678901234567890123456789012345678901234567890123456789</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Token Number Field NUMBER">32</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">[[
      getfield 2 _012345678901234567890123456789012345678901234567890123456789
      return 1
    ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">32</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">[[
      pushnum 33
      setglobal _012345678901234567890123456789012345678901234567890123456789
    ]]</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">_012345678901234567890123456789012345678901234567890123456789</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">33</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">_012345678901234567890123456789012345678901234567890123456789</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- testing next</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;next; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">n</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Number Field NUMBER">1</span><span class="Punctuator Token COMMA">,</span><span class="Identifier Token Variable ID">a</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">a</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Number Field NUMBER">3</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;next; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">n</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Number Field NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Identifier Token Variable ID">a</span><span class="Punctuator Token COMMA">,</span><span class="Token String STR">&#x27;a&#x27;</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">3</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;next; pop 1; next; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">n</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Number Field NUMBER">1</span><span class="Punctuator Token COMMA">,</span><span class="Identifier Token Variable ID">a</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- testing upvalues</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">A</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Token String STR">[[ pushnum 10; pushnum 20; pushcclosure 2; return 1]]</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">A</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">[[pushvalue U0; pushvalue U1; pushvalue U2; return 3]]</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">20</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;table&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">A</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">[[tostring U3; tonumber U4; return 2]]</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="Expression Keyword Token SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">A</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">[[pushnum 100; pushnum 200; replace U2; replace U1]]</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">A</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">[[pushvalue U1; pushvalue U2; return 2]]</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">100</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">200</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">A</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">[[replace U2; replace U1]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">x</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Number Field NUMBER">1</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">x</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Number Field NUMBER">2</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">A</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">[[pushvalue U1; pushvalue U2; return 2]]</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">x</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">x</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">checkmemory</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- testing absent upvalues from C-function pointers</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Token String STR">[[isnull U1; return 1]]</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token TRUE">true</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Token String STR">[[isnull U100; return 1]]</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token TRUE">true</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Token String STR">[[pushvalue U1; return 1]]</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Token String STR">[[ pushnum 10; pushnum 20; pushcclosure 2; return 1]]</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalue</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number LF">
</span><span class="Keyword Token Number SPACE">         </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalue</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">20</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number LF">
</span><span class="Keyword Token Number SPACE">         </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalue</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalue</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;xuxu&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalue</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;xuxu&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- large closures</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">A</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;checkstack 300 msg;&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token CONCAT">..</span><span class="Punctuator Expression Token LF">
</span><span class="Punctuator Expression Token SPACE">              </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">rep</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;pushnum 10;&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">255</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token CONCAT">..</span><span class="Punctuator Expression Token LF">
</span><span class="Punctuator Expression Token SPACE">              </span><span class="Token String STR">&quot;pushcclosure 255; return 1&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">A</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Token Number NUMBER">255</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">A</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Expression Token Variable brace-depth-2 LPAREN">(</span><span class="Token String STR">&quot;pushvalue U</span><span class="Token String Format STR">%d</span><span class="Token String STR">; return 1&quot;</span><span class="Expression Token Variable brace-depth-2 RPAREN">)</span><span class="Token VarSuffix COLON">:</span><span class="Identifier FunctionCall Token VarSuffix ID">format</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">A</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;isnull U256; return 1&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">A</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;isnil U256; return 1&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- testing get/setuservalue</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- bug in 5.1.2</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkerr</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;got number&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">setuservalue</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkerr</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;got nil&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">setuservalue</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkerr</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;got light userdata&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">setuservalue</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">pushuserdata</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- testing multiple user values</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">newuserdata</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">v</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">p</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">getuservalue</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">v</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="Expression Keyword Token SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- indices out of range</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">v</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">p</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">getuservalue</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">2</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">v</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="Expression Keyword Token SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">v</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">p</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">getuservalue</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">11</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">v</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="Expression Keyword Token SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Keyword Token Field TRUE">true</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Keyword Token Field FALSE">false</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">4.56</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token String STR">&quot;XYZ&quot;</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token ID">k</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">v</span><span class="Identifier Token SPACE"> </span><span class="Statement Keyword Token IN">in</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">ipairs</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">setuservalue</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">v</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">k</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token ID">k</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">v</span><span class="Identifier Token SPACE"> </span><span class="Statement Keyword Token IN">in</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">ipairs</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">v1</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">p</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">getuservalue</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">k</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">v1</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">v</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">getuservalue</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">4</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">setuservalue</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">   </span><span class="Argument Token VarSuffix COMMENT">-- function should not be collected</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">getuservalue</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">setuservalue</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">134</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">   </span><span class="Argument Token VarSuffix COMMENT">-- number should not be a problem for collector</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">getuservalue</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">134</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- test barrier for uservalues</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">oldmode</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;incremental&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">gcstate</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;atomic&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">gccolor</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;black&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">setuservalue</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">x</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Token Number Field NUMBER">100</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">gcstate</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;pause&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- complete collection</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">getuservalue</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">x</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">100</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- uvalue should be there</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">oldmode</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- long chain of userdata</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1000</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">bb</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">newuserdata</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">setuservalue</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bb</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">bb</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">     </span><span class="Argument Token VarSuffix COMMENT">-- nothing should not be collected</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1000</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">getuservalue</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">getuservalue</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">x</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">100</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Keyword Token COMMENT">-- testing locks (refs)</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Keyword Token COMMENT">-- reuse of references</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">i</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">ref</span><span class="brace-depth-0 Argument Token TableConstructor LCURLY_BRACE">{</span><span class="brace-depth-0 Argument Token TableConstructor RCURLY_BRACE">}</span><span class="Argument Token TableConstructor LF">
</span><span class="Argument Token TableConstructor SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">unref</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">ref</span><span class="Argument Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Argument Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Argument Token TableConstructor SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">Arr</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">Lim</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">100</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Identifier Token Variable ID">Lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- lock many objects</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">Arr</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">ref</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">ref</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Keyword Token NIL">nil</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">getref</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">unref</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">unref</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Identifier Token Variable ID">Lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- unlock all them</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">unref</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">Arr</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">printlocks</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">makeCfunc</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;gettable R; return 1&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">n</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;n&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;n&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">0</span><span class="Statement Token COMMA">,</span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Identifier Token Variable ID">Lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- lock many objects</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">Arr</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">ref</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Identifier Token Variable ID">Lim</span><span class="Statement Token COMMA">,</span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- unlock half of them</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">unref</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">Arr</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">getref</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">Arr</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;table&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">getref</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">ref</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">getref</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;table&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- colect in cl the `val&#x27; of all collected userdata</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">tt</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">cl</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">n</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Number Field NUMBER">0</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">B</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">F</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">  </span><span class="Identifier Token Variable FunctionName ID">F</span><span class="Identifier Token Variable FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">udval</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">udataval</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">table</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">insert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">cl</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">udval</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">d</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">newuserdata</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">100</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">   </span><span class="Argument Token VarSuffix COMMENT">-- create garbage</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">getmetatable</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">__gc</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">F</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;table.insert({}, {})&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">   </span><span class="Argument Token VarSuffix COMMENT">-- create more garbage</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Argument Token VarSuffix COMMENT">-- GC during GC (no op)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">dummy</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Expression Token TableConstructor COMMENT">-- create more garbage during GC</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="Expression Keyword Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">A</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;userdata&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">      </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">udataval</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">A</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">B</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">      </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">getmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">A</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Argument Token VarSuffix COMMENT">-- just access it</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE">   </span><span class="Identifier Token Variable COMMENT">-- ressurect userdata</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable ID">B</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">udval</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">3</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier Token Variable ID">tt</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">__gc</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">F</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable COMMENT">-- test whether udate collection frees memory in the right time</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;count&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">newuserdata</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">5001</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;objsize 2; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">5001</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;count&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token GE">&gt;=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Punctuator Expression Token PLUS">+</span><span class="Expression Token Number NUMBER">4</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;count&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token LE">&lt;=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Punctuator Expression Token PLUS">+</span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Argument Token VarSuffix COMMENT">-- udata without finalizer</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;count&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;stop&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Token Number NUMBER">1000</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">newuserdata</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;count&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token brace-depth-1 RANGLE_BRACE">&gt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Punctuator Expression Token PLUS">+</span><span class="Expression Token Number NUMBER">10</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;count&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token LE">&lt;=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Punctuator Expression Token PLUS">+</span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Argument Token VarSuffix COMMENT">-- udata with finalizer</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;count&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;stop&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__gc</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Token Number NUMBER">1000</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">setmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">newuserdata</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;count&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token GE">&gt;=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Punctuator Expression Token PLUS">+</span><span class="Expression Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- this collection only calls TM, without freeing memory</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;count&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token GE">&gt;=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Punctuator Expression Token PLUS">+</span><span class="Expression Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- now frees memory</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;count&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token LE">&lt;=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Punctuator Expression Token PLUS">+</span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;restart&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;stop&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- create 3 userdatas with tag `tt&#x27;</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">newuserdata</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">setmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">tt</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">na</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">udataval</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">newuserdata</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">setmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">tt</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">nb</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">udataval</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">newuserdata</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">setmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">tt</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">nc</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">udataval</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- create userdata without meta table</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">newuserdata</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">4</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">newuserdata</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkerr</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;FILE%* expected, got userdata&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">input</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkerr</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;FILE%* expected, got userdata&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">input</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">getmetatable</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="Expression Keyword Token SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">getmetatable</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">y</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">d</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">ref</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">e</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">ref</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">ref</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">getref</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">d</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">getref</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">e</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">getref</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">3</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Statement Token ASSIGN">=</span><span class="Keyword Token NIL">nil</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Statement Token ASSIGN">=</span><span class="Keyword Token NIL">nil</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Statement Token ASSIGN">=</span><span class="Keyword Token NIL">nil</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">unref</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">e</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">unref</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- check that unref objects have been collected</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">cl</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">cl</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">nc</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">getref</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">d</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;userdata&#x27;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">getmetatable</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">tt</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">tt</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">b</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable COMMENT">-- create cycle</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable ID">tt</span><span class="Statement Token ASSIGN">=</span><span class="Keyword Token NIL">nil</span><span class="Keyword Token SPACE">    </span><span class="Keyword Token COMMENT">-- frees tt for GC</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">unref</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">d</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">n5</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">newuserdata</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">setmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">n5</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__gc</span><span class="Token Field FieldList ASSIGN">=</span><span class="Identifier Token Variable ID">F</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">n5</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">udataval</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">n5</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">cl</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">4</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- check order of collection</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">cl</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">n5</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">cl</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">3</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">nb</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">cl</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">4</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">na</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="Token String STR">&quot;restart&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">na</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">30</span><span class="Statement Token COMMA">,</span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">newuserdata</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">setmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__gc</span><span class="Token Field FieldList ASSIGN">=</span><span class="Identifier Token Variable ID">F</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">na</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">udataval</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">cl</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Token TableConstructor brace-depth-2 LCURLY_BRACE">{</span><span class="Expression Token TableConstructor brace-depth-2 RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">cl</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">30</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Token Number NUMBER">30</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">cl</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">na</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">na</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">2</span><span class="Statement Token COMMA">,</span><span class="Identifier Token Variable ID">Lim</span><span class="Statement Token COMMA">,</span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- unlock the other half</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">unref</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">Arr</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">newuserdata</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">41</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">setmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__gc</span><span class="Token Field FieldList ASSIGN">=</span><span class="Identifier Token Variable ID">F</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;objsize 2; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">41</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">cl</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Token brace-depth-1 Field FieldList LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">x</span><span class="Token brace-depth-1 Field FieldList RSQUAR_PAREN">]</span><span class="Token Field FieldList SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Token Number Field NUMBER">1</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">udataval</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- old `x&#x27; cannot be collected (`a&#x27; still uses it)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">cl</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token ID">n</span><span class="Identifier Token SPACE"> </span><span class="Statement Keyword Token IN">in</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pairs</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">n</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">undef</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">cl</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">cl</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">   </span><span class="Argument Token VarSuffix COMMENT">-- old `x&#x27; must be collected</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- testing lua_equal</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;compare EQ 2 4; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;compare EQ 3 2; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;alo&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;alo&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;compare EQ 2 3; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;compare EQ 2 3; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token TableConstructor brace-depth-2 LCURLY_BRACE">{</span><span class="Expression Token TableConstructor brace-depth-2 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token TableConstructor brace-depth-2 LCURLY_BRACE">{</span><span class="Expression Token TableConstructor brace-depth-2 RCURLY_BRACE">}</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;compare EQ 2 3; return 1&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;compare EQ 2 3; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- testing lua_equal with fallbacks</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">map</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__eq</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">map</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">map</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">f</span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">      </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">u</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">newuserdata</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">      </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">setmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">u</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">      </span><span class="Identifier Token Variable ID">map</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">u</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">      </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">u</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">11</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;compare EQ 2 3; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;compare EQ 2 3; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">20</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">__eq</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Token String STR">&#x27;+&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token COMMENT">-- testing changing hooks during hooks</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">TT</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">sethook</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">[[
    # set a line hook after 3 count hooks
    sethook 4 0 &#x27;
      getglobal TT;
      pushvalue -3; append -2
      pushvalue -2; append -2
    &#x27;]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;c&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE">   </span><span class="Token Number COMMENT">-- counting</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE">   </span><span class="Token Number COMMENT">-- counting</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE">   </span><span class="Token Number COMMENT">-- count hook (set line hook)</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE">   </span><span class="Token Number COMMENT">-- line hook</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE">   </span><span class="Token Number COMMENT">-- line hook</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">sethook</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">TT</span><span class="Identifier TableKey Token VarSuffix LF">
</span><span class="Identifier TableKey Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;line&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">line</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix LF">
</span><span class="Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">3</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;line&quot;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">4</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">line</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">5</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;line&quot;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">6</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">line</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">7</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">TT</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Keyword Token COMMENT">-------------------------------------------------------------------------</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- testing errors during GC</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">warn</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;@off&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;stop&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Token Number NUMBER">20</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">newuserdata</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">   </span><span class="Argument Token VarSuffix COMMENT">-- creates several udata</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Token Number NUMBER">20</span><span class="Statement Token COMMA">,</span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- mark half of them to raise errors during GC</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">setmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">        </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__gc</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">error</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;@expected error in gc&quot;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">2</span><span class="Statement Token COMMA">,</span><span class="Token Number NUMBER">20</span><span class="Statement Token COMMA">,</span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- mark the other half to count and to create more garbage</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">setmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__gc</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;A=A+1&quot;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">A</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- number of normal collections</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;restart&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">warn</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;@on&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">A</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Keyword Token COMMENT">-------------------------------------------------------------------------</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Keyword Token COMMENT">-- test for userdata vals</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">lim</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">30</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">0</span><span class="Statement Token COMMA">,</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">pushuserdata</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">0</span><span class="Statement Token COMMA">,</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">udataval</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">0</span><span class="Statement Token COMMA">,</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">pushuserdata</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">0</span><span class="Statement Token COMMA">,</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">0</span><span class="Statement Token COMMA">,</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">pushuserdata</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">tostring</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;string&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-------------------------------------------------------------------------</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- testing multiple states</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">closestate</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">newstate</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Identifier Token Variable ID">L1</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">newstate</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">doremote</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;X=&#x27;a&#x27;; return &#x27;a&#x27;&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;a&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">doremote</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;function f () return &#x27;alo&#x27;, 3 end; f()&quot;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">doremote</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;return f()&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;alo&#x27;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;3&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">doremote</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;_ERRORMESSAGE = nil&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- error: `sin&#x27; is not defined</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">doremote</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;return sin(1)&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="Expression Keyword Token SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">   </span><span class="Argument Token VarSuffix COMMENT">-- 2 == run-time error</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- error: syntax error</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">doremote</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;return a+&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="Expression Keyword Token SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;string&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">   </span><span class="Argument Token VarSuffix COMMENT">-- 3 == syntax error</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">loadlib</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">doremote</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">[[
    string = require&#x27;string&#x27;
    a = require&#x27;_G&#x27;; assert(a == _G and require(&quot;_G&quot;) == a)
    io = require&#x27;io&#x27;; assert(type(io.read) == &quot;function&quot;)
    assert(require(&quot;io&quot;) == io)
    a = require&#x27;table&#x27;; assert(type(a.insert) == &quot;function&quot;)
    a = require&#x27;debug&#x27;; assert(type(a.getlocal) == &quot;function&quot;)
    a = require&#x27;math&#x27;; assert(type(a.sin) == &quot;function&quot;)
    return string.sub(&#x27;okinama&#x27;, 1, 2)
  ]]</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;ok&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">closestate</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Identifier Token Variable ID">L1</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">newstate</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">loadlib</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">doremote</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;a = {}&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">[[getglobal &quot;a&quot;; pushstring &quot;x&quot;; pushint 1;
               settable -3]]</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">doremote</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;return a.x&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;1&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">closestate</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">L1</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;+&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-------------------------------------------------------------------------</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- testing to-be-closed variables</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-------------------------------------------------------------------------</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Token String STR">&quot;testing to-be-closed variables&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">openresource</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">newresource</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">      </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Token Number Field NUMBER">10</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__close</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">y</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">        </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">openresource</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">openresource</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">        </span><span class="Identifier Token Variable ID">openresource</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">openresource</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">        </span><span class="Identifier Token Variable ID">y</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number LF">
</span><span class="Expression Token Number SPACE">      </span><span class="Keyword Token FunctionBody END">end</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">      </span><span class="Identifier Token Variable ID">openresource</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">openresource</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">      </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">[[
      call 0 1   # create resource
      pushnil
      toclose -2  # mark call result to be closed
      toclose -1  # mark nil to be closed (will be ignored)
      return 2
    ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">newresource</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">11</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">openresource</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Argument Token VarSuffix COMMENT">-- was closed</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Argument Token VarSuffix COMMENT">-- repeat the test, but calling function in a &#x27;multret&#x27; context</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">[[
      call 0 1   # create resource
      toclose 2 # mark it to be closed
      return 2
    ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">newresource</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;string&quot;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">11</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">openresource</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Argument Token VarSuffix COMMENT">-- was closed</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Argument Token VarSuffix COMMENT">-- closing by error</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">makeCfunc</span><span class="Token String STR">[[
      call 0 1   # create resource
      toclose -1 # mark it to be closed
      error       # resource is the error object
    ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">newresource</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token FALSE">false</span><span class="Expression Keyword Token SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">11</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">openresource</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Argument Token VarSuffix COMMENT">-- was closed</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Argument Token VarSuffix COMMENT">-- non-closable value</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">makeCfunc</span><span class="Token String STR">[[
      newtable   # create non-closable object
      toclose -1 # mark it to be closed (should raise an error)
      abort  # will not be executed
    ]]</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token FALSE">false</span><span class="Expression Keyword Token SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">      </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">find</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;non%-closable value&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">check</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">n</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">      </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">openresource</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Keyword Token FunctionBody COMMENT">-- closing resources with &#x27;closeslot&#x27;</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Identifier Token Variable ID">_ENV</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">xxx</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">[[
      pushvalue 2  # stack: S, NR, CH, NR
      call 0 1   # create resource; stack: S, NR, CH, R
      toclose -1 # mark it to be closed
      pushvalue 2  #  stack: S, NR, CH, R, NR
      call 0 1   # create another resource; stack: S, NR, CH, R, R
      toclose -1 # mark it to be closed
      pushvalue 3  # stack: S, NR, CH, R, R, CH
      pushint 2   # there should be two open resources
      call 1 0  #  stack: S, NR, CH, R, R
      closeslot -1   # close second resource
      pushvalue 3  # stack: S, NR, CH, R, R, CH
      pushint 1   # there should be one open resource
      call 1 0  # stack: S, NR, CH, R, R
      closeslot 4
      setglobal &quot;xxx&quot;  # previous op. erased the slot
      pop 1       # pop other resource from the stack
      pushint *
      return 1    # return stack size
    ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">newresource</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">_ENV</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">xxx</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">   </span><span class="Argument Token VarSuffix COMMENT">-- no extra items left in the stack</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Argument Token VarSuffix COMMENT">-- closing resources with &#x27;pop&#x27;</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">[[
      pushvalue 2  # stack: S, NR, CH, NR
      call 0 1   # create resource; stack: S, NR, CH, R
      toclose -1 # mark it to be closed
      pushvalue 2  #  stack: S, NR, CH, R, NR
      call 0 1   # create another resource; stack: S, NR, CH, R, R
      toclose -1 # mark it to be closed
      pushvalue 3  # stack: S, NR, CH, R, R, CH
      pushint 2   # there should be two open resources
      call 1 0  #  stack: S, NR, CH, R, R
      pop 1   # pop second resource
      pushvalue 3  # stack: S, NR, CH, R, CH
      pushint 1   # there should be one open resource
      call 1 0  # stack: S, NR, CH, R
      pop 1       # pop other resource from the stack
      pushvalue 3  # stack: S, NR, CH, CH
      pushint 0   # there should be no open resources
      call 1 0  # stack: S, NR, CH
      pushint *
      return 1    # return stack size
    ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">newresource</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">   </span><span class="Argument Token VarSuffix COMMENT">-- no extra items left in the stack</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Argument Token VarSuffix COMMENT">-- non-closable value</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">makeCfunc</span><span class="Token String STR">[[
      pushint 32
      toclose -1
    ]]</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">find</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;(C temporary)&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">--[[
  ** {==================================================================
  ** Testing memory limits
  ** ===================================================================
  --]]</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;memory-allocation errors&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkerr</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;block too big&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">newuserdata</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">maxinteger</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="Token String STR">&quot;local a={}; for i=1,100000 do a[i]=i end&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">alloccount</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkerr</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">MEMERRMSG</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">alloccount</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">          </span><span class="Argument Token VarSuffix COMMENT">-- remove limit</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- test memory errors; increase limit for maximum memory by steps,</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- o that we get memory errors in all allocations of a given</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- task, until there is enough memory to complete the task without</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- errors.</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">testbytes</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">s</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">f</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">M</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">totalmem</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">oldM</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">M</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">    </span><span class="Statement Keyword Token WHILE">while</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token TRUE">true</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">      </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">totalmem</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">M</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">      </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;pcall 0 1 0; pushstatus; return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">      </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">totalmem</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- remove limit</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">      </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;OK&quot;</span><span class="Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token BREAK">break</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE">       </span><span class="Statement Keyword Token COMMENT">-- stop when no more errors</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;OK&quot;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">MEMERRMSG</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token COMMENT">-- not a memory error?</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">        </span><span class="Identifier FunctionCall Token Variable ID">error</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">   </span><span class="Argument Token VarSuffix COMMENT">-- propagate it</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">      </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Identifier Token Variable ID">M</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">M</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">7</span><span class="Expression Token Number SPACE">   </span><span class="Expression Token Number COMMENT">-- increase memory limit</span><span class="Expression Token Number LF">
</span><span class="Expression Token Number SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">format</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;minimum memory for </span><span class="Token String Format STR">%s</span><span class="Token String STR">: </span><span class="Token String Format STR">%d</span><span class="Token String STR"> bytes&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">s</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">M</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">oldM</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Keyword Token FunctionBody COMMENT">-- test memory errors; increase limit for number of allocations one</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Keyword Token FunctionBody COMMENT">-- by one, so that we get memory errors in all allocations of a given</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Keyword Token FunctionBody COMMENT">-- task, until there is enough allocations to complete the task without</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Keyword Token FunctionBody COMMENT">-- errors.</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">testalloc</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">s</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">f</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">M</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">    </span><span class="Statement Keyword Token WHILE">while</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token TRUE">true</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">      </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">alloccount</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">M</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">      </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;pcall 0 1 0; pushstatus; return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">      </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">alloccount</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- remove limit</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">      </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;OK&quot;</span><span class="Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token BREAK">break</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE">       </span><span class="Statement Keyword Token COMMENT">-- stop when no more errors</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;OK&quot;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">MEMERRMSG</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token COMMENT">-- not a memory error?</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">        </span><span class="Identifier FunctionCall Token Variable ID">error</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">   </span><span class="Argument Token VarSuffix COMMENT">-- propagate it</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">      </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Identifier Token Variable ID">M</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">M</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE">   </span><span class="Expression Token Number COMMENT">-- increase allocation limit</span><span class="Expression Token Number LF">
</span><span class="Expression Token Number SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">format</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;minimum allocations for </span><span class="Token String Format STR">%s</span><span class="Token String STR">: </span><span class="Token String Format STR">%d</span><span class="Token String STR"> allocations&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">s</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">M</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">testamem</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">s</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">f</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">testalloc</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">s</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">testbytes</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">s</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Keyword Token FunctionBody COMMENT">-- doing nothing</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;doing nothing&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- testing memory errors when creating a new state</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;state creation&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">st</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">newstate</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">st</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">closestate</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">st</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- close new state</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">st</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;empty-table creation&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;string creation&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token String STR">&quot;XXX&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token CONCAT">..</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;YYY&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;coroutine creation&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">             </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">coroutine</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">create</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">print</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- testing to-be-closed variables</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;to-be-closed variables&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">flag</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">    </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Attribute AttributeName brace-depth-1 LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">close</span><span class="Token Attribute AttributeName brace-depth-1 RANGLE_BRACE">&gt;</span><span class="Token Attribute AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">                </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Expression Token TableConstructor brace-depth-2 LCURLY_BRACE">{</span><span class="Expression Token TableConstructor brace-depth-2 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token TableConstructor brace-depth-2 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__close</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Identifier Token Variable ID">flag</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Expression Token TableConstructor brace-depth-2 RCURLY_BRACE">}</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">      </span><span class="Identifier Token Variable ID">flag</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FALSE">false</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">      </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">flag</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- testing threads</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- get main thread from registry (at index LUA_RIDX_MAINTHREAD == 1)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">mt</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;rawgeti R 1; return 1&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">mt</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;thread&quot;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">coroutine</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">running</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">mt</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">expand</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">n</span><span class="Token COMMA">,</span><span class="Identifier Token ID">s</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">e</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">rep</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;=&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">format</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;T.doonnewstack([</span><span class="Token String Format STR">%s</span><span class="Token String STR">[ </span><span class="Token String Format STR">%s</span><span class="Token String STR">;</span><span class="Control Token String STR">\n</span><span class="Token String STR"> collectgarbage(); </span><span class="Token String Format STR">%s</span><span class="Token String STR">]</span><span class="Token String Format STR">%s</span><span class="Token String STR">])</span><span class="Control Token String STR">\n</span><span class="Token String STR">&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">                                </span><span class="Identifier Token Variable ID">e</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">s</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">expand</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">s</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">e</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier Token Variable ID">G</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">0</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;count&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">expand</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">20</span><span class="Token COMMA">,</span><span class="Token String STR">&quot;G=G+1&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">G</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">20</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE">  </span><span class="Statement Token COMMENT">-- assert(gcinfo() &lt;= a+1)</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Identifier Token Variable ID">G</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;running code on new thread&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">doonnewstack</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;local x=1&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Number SPACE">  </span><span class="Expression Token Number COMMENT">-- try to create thread</span><span class="Expression Token Number LF">
</span><span class="Expression Token Number SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- testing memory x compiler</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;loadstring&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;x=1&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- try to do load a string</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">testprog</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">[[
  local function foo () return end
  local t = {&quot;x&quot;}
  AA = &quot;aaa&quot;
  for i = 1, #t do AA = AA .. t[i] end
  return true
  ]]</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token COMMENT">-- testing memory x dofile</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">AA</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Identifier Token Variable ID">os</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">tmpname</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">open</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;w&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">f</span><span class="Token VarSuffix COLON">:</span><span class="Identifier FunctionCall Token VarSuffix ID">write</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">testprog</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">f</span><span class="Token VarSuffix COLON">:</span><span class="Identifier FunctionCall Token VarSuffix ID">close</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;dofile&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">loadfile</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">os</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">remove</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">AA</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;aaax&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- other generic tests</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;gsub&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">gsub</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;alo alo&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;(a)&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Punctuator Expression Token CONCAT">..</span><span class="Token String STR">&#x27;b&#x27;</span><span class="Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;ablo ablo&#x27;</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;dump/undump&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">testprog</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">dump</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">AA</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">os</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">tmpname</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;file creation&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">open</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;w&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">open</span><span class="Token String STR">&quot;nomenaoexistente&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">close</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">loadfile</span><span class="Token String STR">&#x27;nomenaoexistente&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">os</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">remove</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;table creation&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">lim</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Punctuator Expression Token CONCAT">..</span><span class="Token String STR">&#x27;a&#x27;</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">lim</span><span class="Punctuator Expression Token CONCAT">..</span><span class="Token String STR">&#x27;a&#x27;</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;table&#x27;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">lim</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">lim</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;constructors&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Token Number Field NUMBER">10</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">20</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">30</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">40</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">50</span><span class="Punctuator Token SEMI">;</span><span class="Punctuator Token SPACE"> </span><span class="Identifier Token Field ID">a</span><span class="Token Field ASSIGN">=</span><span class="Token Number Field NUMBER">1</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Identifier Token Field ID">b</span><span class="Token Field ASSIGN">=</span><span class="Token Number Field NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Identifier Token Field ID">c</span><span class="Token Field ASSIGN">=</span><span class="Token Number Field NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Identifier Token Field ID">d</span><span class="Token Field ASSIGN">=</span><span class="Token Number Field NUMBER">4</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Identifier Token Field ID">e</span><span class="Token Field ASSIGN">=</span><span class="Token Number Field NUMBER">5</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;table&#x27;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">e</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">5</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">close</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;closure creation&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FunctionName FuncName ID">close</span><span class="Identifier Token FunctionName FuncName SPACE"> </span><span class="Statement Token FunctionBody brace-depth-1 LPAREN">(</span><span class="Identifier Token ID">b</span><span class="Statement Token FunctionBody brace-depth-1 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">     </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">close</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">2</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">4</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">6</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;using coroutines&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">coroutine</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">wrap</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">                </span><span class="Identifier Token Variable ID">coroutine</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">yield</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">rep</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;a&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">                </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Expression Token TableConstructor brace-depth-2 LCURLY_BRACE">{</span><span class="Expression Token TableConstructor brace-depth-2 RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">              </span><span class="Keyword Token FunctionBody END">end</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">len</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- auxiliary buffer</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">lim</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">100</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;01234567890123456789&quot;</span><span class="Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;auxiliary buffer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">      </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">table</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">concat</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;,&quot;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">20</span><span class="Punctuator Token Number MUL">*</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">    </span><span class="Keyword Token FunctionBody END">end</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;growing stack&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">foo</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-1 LPAREN">(</span><span class="Identifier Token ID">n</span><span class="Statement Token FunctionBody brace-depth-1 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">      </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE"> </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number PLUS">+</span><span class="Punctuator Token Number SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">100</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- }==================================================================</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- testing failing in &#x27;lua_checkstack&#x27;</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">[[rawcheckstack 500000; return 1]]</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token FALSE">false</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">L</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">newstate</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">alloccount</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">   </span><span class="Argument Token VarSuffix COMMENT">-- will be unable to reallocate the stack</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">[[rawcheckstack 5000; return 1]]</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">alloccount</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">closestate</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token FALSE">false</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- closing state with no extra memory</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">L</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">newstate</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">alloccount</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">closestate</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">alloccount</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- garbage collection with no extra memory</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">L</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">newstate</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">loadlib</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">doremote</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">L</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">[[
      _ENV = require&quot;_G&quot;
      local T = require&quot;T&quot;
      local a = {}
      for i = 1, 1000 do a[i] = &#x27;i&#x27; .. i end    -- grow string table
      local stsize, stuse = T.querystr()
      assert(stuse &gt; 1000)
      local function foo (n)
        if n &gt; 0 then foo(n - 1) end
      end
      foo(180)    -- grow stack
      local _, stksize = T.stacklevel()
      assert(stksize &gt; 180)
      a = nil
      T.alloccount(0)
      collectgarbage()
      T.alloccount()
      -- stack and string table could not be reallocated,
      -- so they kept their sizes (without errors)
      assert(select(2, T.stacklevel()) == stksize)
      assert(T.querystr() == stsize)
      return &#x27;ok&#x27;
    ]]</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Expression brace-depth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;ok&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">closestate</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Token String STR">&#x27;+&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token COMMENT">-- testing some auxlib functions</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">gsub</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">c</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;gsub 2 3 4; gettop; return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">5</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">gsub</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;alo.alo.uhuh.&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;.&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;//&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;alo//alo//uhuh//&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">gsub</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;alo.alo.uhuh.&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;alo&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;//&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;//.//.uhuh.&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">gsub</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;alo&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;//&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">gsub</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;...&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;.&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;/.&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;/././.&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">gsub</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;...&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;...&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- testing luaL_newmetatable</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">mt_xuxu</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">top</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;newmetatable xuxu; gettop; return 3&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">mt_xuxu</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;table&quot;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">top</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">d</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">top</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;newmetatable xuxu; gettop; return 3&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">mt_xuxu</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">top</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">d</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">top</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;newmetatable xuxu1; gettop; return 3&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">mt_xuxu</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">top</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">newuserdata</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">newuserdata</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;pushstring xuxu; gettable R; setmetatable 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">getmetatable</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">mt_xuxu</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- testing luaL_testudata</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- correct metatable</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">res1</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">res2</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">top</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">[[testudata -1 xuxu
                        testudata 2 xuxu
                    gettop
                    return 3]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">res1</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">res2</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">top</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">4</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- wrong metatable</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">res1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">res2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">top</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">[[testudata -1 xuxu1
                  testudata 2 xuxu1
                  gettop
                  return 3]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">res1</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">res2</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">top</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">4</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- non-existent type</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">res1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">res2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">top</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">[[testudata -1 xuxu2
                  testudata 2 xuxu2
                  gettop
                  return 3]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">res1</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">res2</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">top</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">4</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- userdata has no metatable</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">res1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">res2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">top</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">testC</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">[[testudata -1 xuxu
                  testudata 2 xuxu
                  gettop
                  return 3]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">res1</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">res2</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">top</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">4</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- erase metatables</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">r</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">getregistry</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">r</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">xuxu</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">mt_xuxu</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">r</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">xuxu1</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">r</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">xuxu</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">r</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">xuxu1</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Token String STR">&#x27;OK&#x27;</span></code></pre><h2 id="h2-7"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/7.lua" target="_blank">7.lua</a></h2><pre class="language-lua"><code><span class="Token COMMENT">-- $Id: testes/attrib.lua $</span><span class="Token LF">
</span><span class="Token COMMENT">-- See Copyright Notice in file all.lua</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Token String STR">&quot;testing require&quot;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;string&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;math&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;table&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">table</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;io&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">io</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;os&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">os</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;coroutine&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">coroutine</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">path</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;string&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">cpath</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;string&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">loaded</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;table&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">preload</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;table&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">config</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;string&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;package config: &quot;</span><span class="Punctuator Expression Token CONCAT">..</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">gsub</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">config</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;</span><span class="Control Token String STR">\n</span><span class="Token String STR">&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;|&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- create a path with &#x27;max&#x27; templates,</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- each with 1-10 repetitions of &#x27;?&#x27;</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">max</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">_soft</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Token Number NUMBER">100</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number OR">or</span><span class="Keyword Token Number SPACE"> </span><span class="Token Number NUMBER">2000</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Identifier Token Variable ID">max</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">rep</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;?&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Punctuator Expression Token MOD">%</span><span class="Expression Token Number NUMBER">10</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number PLUS">+</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;;&quot;</span><span class="Token SPACE">    </span><span class="Token COMMENT">-- empty template</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">path</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">table</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">concat</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;;&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- use that path in a search</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">s</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">err</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">searchpath</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;xuxu&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">path</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- search fails; check that message has an occurrence of</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- &#x27;??????????&#x27; with ? replaced by xuxu and at least &#x27;max&#x27; lines</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">s</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token LF">
</span><span class="Expression Keyword Token SPACE">         </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">find</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">err</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">rep</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;xuxu&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token LF">
</span><span class="Expression Keyword Token SPACE">         </span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">gsub</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">err</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;[^</span><span class="Control Token String STR">\n</span><span class="Token String STR">]&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token GE">&gt;=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">max</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- path with one very long template</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">path</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">rep</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;?&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">max</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">s</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">err</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">searchpath</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;xuxu&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">path</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">s</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">find</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">err</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">rep</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;xuxu&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">max</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">oldpath</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">path</span><span class="Identifier TableKey Token VarSuffix LF">
</span><span class="Identifier TableKey Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">path</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">s</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">err</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">require</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;no-such-file&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">s</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">find</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">err</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;package.path&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">path</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">oldpath</span><span class="Identifier Token Variable LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Token String STR">&quot;testing &#x27;require&#x27; message&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">oldpath</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">path</span><span class="Identifier TableKey Token VarSuffix LF">
</span><span class="Identifier TableKey Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">oldcpath</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">cpath</span><span class="Identifier TableKey Token VarSuffix LF">
</span><span class="Identifier TableKey Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">path</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;?.lua;?/?&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">cpath</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;?.so;?/init&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">st</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">msg</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">require</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;XXX&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">expected</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">[[module &#x27;XXX&#x27; not found:
    no field package.preload[&#x27;XXX&#x27;]
    no file &#x27;XXX.lua&#x27;
    no file &#x27;XXX/XXX&#x27;
    no file &#x27;XXX.so&#x27;
    no file &#x27;XXX/init&#x27;]]</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">msg</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">expected</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">path</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">oldpath</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">cpath</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">oldcpath</span><span class="Identifier Token Variable LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;+&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- The next tests for &#x27;require&#x27; assume some specific directories and</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- libraries.</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">_port</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token COMMENT">--[</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">dirsep</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">match</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">config</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;^([^</span><span class="Control Token String STR">\n</span><span class="Token String STR">]+)</span><span class="Control Token String STR">\n</span><span class="Token String STR">&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- auxiliary directory with C modules and temporary files</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">DIR</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;libs&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token CONCAT">..</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">dirsep</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable COMMENT">-- prepend DIR to a name and correct directory separators</span><span class="Identifier Token Variable LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">D</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">gsub</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;/&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">dirsep</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">DIR</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token CONCAT">..</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody COMMENT">-- prepend DIR and pospend proper C lib. extension to a name</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">DC</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">ext</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">dirsep</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;</span><span class="Control Token String STR">\\</span><span class="Token String STR">&#x27;</span><span class="Expression brace-depth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Token String STR">&quot;.dll&quot;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token OR">or</span><span class="Expression Keyword Token SPACE"> </span><span class="Token String STR">&quot;.so&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token CONCAT">..</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">ext</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">createfiles</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">files</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">preextras</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">posextras</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token ID">n</span><span class="Token COMMA">,</span><span class="Identifier Token ID">c</span><span class="Identifier Token SPACE"> </span><span class="Statement Keyword Token IN">in</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pairs</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">files</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">output</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">write</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">format</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">preextras</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">write</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">write</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">format</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">posextras</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">close</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">output</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">removefiles</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">files</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token ID">n</span><span class="Identifier Token SPACE"> </span><span class="Statement Keyword Token IN">in</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pairs</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">files</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">os</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">remove</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">files</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Token brace-depth-1 Field FieldList LSQUAR_PAREN">[</span><span class="Token String STR">&quot;names.lua&quot;</span><span class="Token brace-depth-1 Field FieldList RSQUAR_PAREN">]</span><span class="Token Field FieldList SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Token String STR">&quot;do return {...} end</span><span class="Control Token String STR">\n</span><span class="Token String STR">&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">  </span><span class="Token brace-depth-1 Field LSQUAR_PAREN">[</span><span class="Token String STR">&quot;err.lua&quot;</span><span class="Token brace-depth-1 Field RSQUAR_PAREN">]</span><span class="Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Token String STR">&quot;B = 15; a = a + 1;&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">  </span><span class="Token brace-depth-1 Field LSQUAR_PAREN">[</span><span class="Token String STR">&quot;synerr.lua&quot;</span><span class="Token brace-depth-1 Field RSQUAR_PAREN">]</span><span class="Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Token String STR">&quot;B =&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">  </span><span class="Token brace-depth-1 Field LSQUAR_PAREN">[</span><span class="Token String STR">&quot;A.lua&quot;</span><span class="Token brace-depth-1 Field RSQUAR_PAREN">]</span><span class="Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">  </span><span class="Token brace-depth-1 Field LSQUAR_PAREN">[</span><span class="Token String STR">&quot;B.lua&quot;</span><span class="Token brace-depth-1 Field RSQUAR_PAREN">]</span><span class="Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Token String STR">&quot;assert(...==&#x27;B&#x27;);require &#x27;A&#x27;&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">  </span><span class="Token brace-depth-1 Field LSQUAR_PAREN">[</span><span class="Token String STR">&quot;A.lc&quot;</span><span class="Token brace-depth-1 Field RSQUAR_PAREN">]</span><span class="Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">  </span><span class="Token brace-depth-1 Field LSQUAR_PAREN">[</span><span class="Token String STR">&quot;A&quot;</span><span class="Token brace-depth-1 Field RSQUAR_PAREN">]</span><span class="Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">  </span><span class="Token brace-depth-1 Field LSQUAR_PAREN">[</span><span class="Token String STR">&quot;L&quot;</span><span class="Token brace-depth-1 Field RSQUAR_PAREN">]</span><span class="Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">  </span><span class="Token brace-depth-1 Field LSQUAR_PAREN">[</span><span class="Token String STR">&quot;XXxX&quot;</span><span class="Token brace-depth-1 Field RSQUAR_PAREN">]</span><span class="Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">  </span><span class="Token brace-depth-1 Field LSQUAR_PAREN">[</span><span class="Token String STR">&quot;C.lua&quot;</span><span class="Token brace-depth-1 Field RSQUAR_PAREN">]</span><span class="Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Token String STR">&quot;package.loaded[...] = 25; require&#x27;C&#x27;&quot;</span><span class="Punctuator Token FieldList COMMA">,</span><span class="Punctuator Token FieldList LF">
</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor LF">
</span><span class="Identifier Token Variable ID">AA</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">extras</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">[[
NAME = &#x27;</span><span class="Token String Format STR">%s</span><span class="Token String STR">&#x27;
REQUIRED = ...
return AA]]</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">createfiles</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">files</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">extras</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- testing explicit &quot;dir&quot; separator in &#x27;searchpath&#x27;</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">searchpath</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;C.lua&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Token String STR">&quot;?&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Token String STR">&quot;C.lua&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">searchpath</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;C.lua&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Token String STR">&quot;?&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;.&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;.&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Token String STR">&quot;C.lua&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">searchpath</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;--x-&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Token String STR">&quot;?&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;-&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;X&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Token String STR">&quot;XXxX&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">searchpath</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;---xX&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Token String STR">&quot;?&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;---&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;XX&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Token String STR">&quot;XXxX&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">searchpath</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Token String STR">&quot;C.lua&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;?&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">dirsep</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Token String STR">&quot;C.lua&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">searchpath</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;.</span><span class="Control Token String STR">\\</span><span class="Token String STR">C.lua&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Token String STR">&quot;?&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;</span><span class="Control Token String STR">\\</span><span class="Token String STR">&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Token String STR">&quot;./C.lua&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">oldpath</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">path</span><span class="Identifier TableKey Token VarSuffix LF">
</span><span class="Identifier TableKey Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">path</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">gsub</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;D/?.lua;D/?.lc;D/?;D/??x?;D/L&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;D/&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">DIR</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName FunctionName ID">try</span><span class="Identifier Token AttributeName FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">p</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">n</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">r</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">ext</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">  </span><span class="Identifier Token Variable ID">NAME</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">rr</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">p</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">NAME</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">REQUIRED</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">rr</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">r</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">ext</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;names&quot;</span><span class="Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;names&quot;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Token String STR">&quot;names.lua&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">st</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">msg</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">require</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;err&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">st</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">find</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;arithmetic&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">B</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">15</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">st</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">msg</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">require</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;synerr&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">st</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">find</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;error loading module&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">searchpath</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;C&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">path</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Token String STR">&quot;C.lua&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;C&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">25</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;C&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">25</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">AA</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">try</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;B&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;B.lua&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;libs/B.lua&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">loaded</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">B</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;B&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token TRUE">true</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">loaded</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">A</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;C&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">25</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">loaded</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">A</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">try</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;B&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">   </span><span class="Argument Token VarSuffix COMMENT">-- should not reload package</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">try</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;A&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;A.lua&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;libs/A.lua&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">loaded</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">A</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Identifier Token Variable ID">os</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">remove</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Token String STR">&#x27;A.lua&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">AA</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Identifier FunctionCall Token Variable ID">try</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;A&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;A.lc&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">AA</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;libs/A.lc&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- now must find second option</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">searchpath</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;A&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">path</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Token String STR">&quot;A.lc&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;A&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">AA</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">AA</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FALSE">false</span><span class="Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">try</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;K&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;L&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token FALSE">false</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;libs/L&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">     </span><span class="Argument Token VarSuffix COMMENT">-- default option</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">try</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;K&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;L&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token FALSE">false</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;libs/L&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">     </span><span class="Argument Token VarSuffix COMMENT">-- default option (should reload it)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">rawget</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">_G</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;_REQUIREDNAME&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">AA</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;x&quot;</span><span class="Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">try</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;X&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;XXxX&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">AA</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;libs/XXxX&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">removefiles</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">files</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">NAME</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">REQUIRED</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">AA</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">B</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token LF">
</span><span class="Keyword Token LF">
</span><span class="Keyword Token COMMENT">-- testing require of sub-packages</span><span class="Keyword Token LF">
</span><span class="Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">_G</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">path</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">gsub</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;D/?.lua;D/?/init.lua&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;D/&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">DIR</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">files</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Token brace-depth-1 Field FieldList LSQUAR_PAREN">[</span><span class="Token String STR">&quot;P1/init.lua&quot;</span><span class="Token brace-depth-1 Field FieldList RSQUAR_PAREN">]</span><span class="Token Field FieldList SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Token String STR">&quot;AA = 10&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">  </span><span class="Token brace-depth-1 Field LSQUAR_PAREN">[</span><span class="Token String STR">&quot;P1/xuxu.lua&quot;</span><span class="Token brace-depth-1 Field RSQUAR_PAREN">]</span><span class="Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Token String STR">&quot;AA = 20&quot;</span><span class="Punctuator Token FieldList COMMA">,</span><span class="Punctuator Token FieldList LF">
</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor LF">
</span><span class="Identifier FunctionCall Token Variable ID">createfiles</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">files</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;_ENV = {}</span><span class="Control Token String STR">\n</span><span class="Token String STR">&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;</span><span class="Control Token String STR">\n</span><span class="Token String STR">return _ENV</span><span class="Control Token String STR">\n</span><span class="Token String STR">&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">AA</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Number LF">
</span><span class="Token Number LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">m</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">ext</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;P1&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">ext</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;libs/P1/init.lua&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">AA</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">AA</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;P1&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;P1&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">searchpath</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;P1.xuxu&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">path</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Token String STR">&quot;P1/xuxu.lua&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">m</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix ID">xuxu</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">ext</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;P1.xuxu&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">AA</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">xuxu</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">AA</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">20</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">ext</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;libs/P1/xuxu.lua&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;P1.xuxu&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">xuxu</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;P1.xuxu&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">xuxu</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;P1&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">AA</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">removefiles</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">files</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">AA</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token LF">
</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">path</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">require</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;file_does_not_exist&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">path</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;??\0?&quot;</span><span class="Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">require</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;file_does_not_exist1&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">path</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">oldpath</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable COMMENT">-- check &#x27;require&#x27; error message</span><span class="Identifier Token Variable LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">fname</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;file_does_not_exist2&quot;</span><span class="Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">m</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">err</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">require</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">fname</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token ID">t</span><span class="Identifier Token SPACE"> </span><span class="Statement Keyword Token IN">in</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">gmatch</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">path</span><span class="Punctuator Expression Token CONCAT">..</span><span class="Token String STR">&quot;;&quot;</span><span class="Punctuator Expression Token CONCAT">..</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">cpath</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;[^;]+&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">gsub</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;?&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">fname</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">find</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">err</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- testing &#x27;package.searchers&#x27; not being a table</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">searchers</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">searchers</span><span class="Identifier TableKey Token VarSuffix LF">
</span><span class="Identifier TableKey Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">searchers</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">st</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">msg</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">require</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;a&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">st</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">find</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;must be a table&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">searchers</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">searchers</span><span class="Identifier Token Variable LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">import</span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Punctuator Token FunctionBody VARARGS">...</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Punctuator Expression Token VARARGS">...</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">m</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">f</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">f</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody COMMENT">-- cannot change environment of a C function</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">module</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;XUXU&#x27;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- testing require of C libraries</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">p</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="Token SPACE">   </span><span class="Token COMMENT">-- On Mac OS X, redefine this to &quot;_&quot;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token COMMENT">-- check whether loadlib works in this system</span><span class="Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">st</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">err</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">when</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">loadlib</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">DC</span><span class="Token String STR">&quot;lib1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;*&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">st</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">err</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">when</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">loadlib</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;donotexist&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="Punctuator Expression Token CONCAT">..</span><span class="Token String STR">&quot;xuxu&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">err</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;string&quot;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">when</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;absent&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Token SEMI">;</span><span class="brace-depth-0 Token Variable LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">Message</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Expression Keyword Token FunctionCall OR">or</span><span class="Expression Keyword Token FunctionCall SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Token Variable RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;</span><span class="Control Token String STR">\n</span><span class="Token String STR"> &gt;&gt;&gt; cannot load dynamic library &lt;&lt;&lt;</span><span class="Control Token String STR">\n</span><span class="Token String STR">&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">err</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">when</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">  </span><span class="ElseStatement Keyword Token COMMENT">-- tests for loadlib</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">loadlib</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">DC</span><span class="Token String STR">&quot;lib1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="Punctuator Expression Token CONCAT">..</span><span class="Token String STR">&quot;onefunction&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">15</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">25</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">25</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">15</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">loadlib</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">DC</span><span class="Token String STR">&quot;lib1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="Punctuator Expression Token CONCAT">..</span><span class="Token String STR">&quot;anotherfunc&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;10</span><span class="Token String Format STR">%20</span><span class="Control Token String STR">\n</span><span class="Token String STR">&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- check error messages</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">err</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">when</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">loadlib</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">DC</span><span class="Token String STR">&quot;lib1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="Punctuator Expression Token CONCAT">..</span><span class="Token String STR">&quot;xuxu&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">err</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;string&quot;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">when</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;init&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">err</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">when</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">loadlib</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;donotexist&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="Punctuator Expression Token CONCAT">..</span><span class="Token String STR">&quot;xuxu&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">err</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;string&quot;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">when</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;open&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- symbols from &#x27;lib1&#x27; must be visible to other libraries</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">loadlib</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">DC</span><span class="Token String STR">&quot;lib11&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="Punctuator Expression Token CONCAT">..</span><span class="Token String STR">&quot;luaopen_lib11&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;exported&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- test C modules with prefixes in names</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">cpath</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">DC</span><span class="Token String STR">&quot;?&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">lib2</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">ext</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;lib2-v2&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">find</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">ext</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;libs/lib2-v2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- check correct access to global environment and correct</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- parameters</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">_ENV</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">x</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;lib2-v2&quot;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">_ENV</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">y</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">DC</span><span class="Token String STR">&quot;lib2-v2&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">lib2</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">id</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;x&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token TRUE">true</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">   </span><span class="Argument Token VarSuffix COMMENT">-- a different &quot;id&quot; implementation</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- test C submodules</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">fs</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">ext</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;lib1.sub&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">_ENV</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">x</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;lib1.sub&quot;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">_ENV</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">y</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">DC</span><span class="Token String STR">&quot;lib1&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">find</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">ext</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;libs/lib1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">fs</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">id</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">45</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">45</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">_ENV</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">_ENV</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix ID">y</span><span class="Identifier Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier Token Variable ID">_ENV</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable COMMENT">-- testing preload</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">p</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable ID">package</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Identifier Token Variable ID">p</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">preload</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionName Token TableKey VarSuffix ID">pl</span><span class="Identifier FunctionName Token TableKey VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Punctuator Token FunctionBody VARARGS">...</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">_ENV</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Punctuator Expression Token VARARGS">...</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FunctionName FuncName ID">xuxu</span><span class="Identifier Token FunctionName FuncName SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Punctuator Expression Token PLUS">+</span><span class="Expression Token Number NUMBER">20</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">_ENV</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">pl</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">ext</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;pl&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;pl&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">pl</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">pl</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">xuxu</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">30</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">pl</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;pl&quot;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">pl</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;:preload:&quot;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">ext</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;:preload:&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">package</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">path</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;string&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;+&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">--]</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;testing assignments, logical operators, and constructors&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">res2</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">27</span><span class="Token Number LF">
</span><span class="Token Number LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Punctuator Token Number PLUS">+</span><span class="Token Number NUMBER">3</span><span class="Token Number LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">5</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Statement Token ASSIGN">=</span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">f</span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">11</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">12</span><span class="Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">x</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Punctuator Expression Token PLUS">+</span><span class="Expression Token Number NUMBER">3</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;x&#x27;</span><span class="Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">10</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">13</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;x&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName FunctionName ID">f</span><span class="Identifier Token AttributeName FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">n</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Statement Token ASSIGN">=</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">                         </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">table</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">unpack</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">b</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">c</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">5</span><span class="Token COMMA">,</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">4</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">5</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">5</span><span class="Token COMMA">,</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">5</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">c</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">d</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Keyword Token Number NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE"> </span><span class="Keyword Token Number OR">or</span><span class="Keyword Token Number SPACE"> </span><span class="Keyword Token Number NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression brace-depth-0 Token Variable LPAREN">(</span><span class="Token Variable Number NUMBER">1</span><span class="Token Variable Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Keyword Token Variable NIL">nil</span><span class="Keyword Token Variable SPACE"> </span><span class="Keyword Token OR">or</span><span class="Keyword Token SPACE"> </span><span class="Keyword Token Number NUMBER">1</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression brace-depth-0 Token Variable RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">6</span><span class="Token Number LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">6</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Number LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">10</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">11</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">12</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">10</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Punctuator Expression Token brace-depth-1 LANGLE_BRACE">&lt;</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token FALSE">false</span><span class="Expression Keyword Token SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Punctuator Expression Token brace-depth-1 RANGLE_BRACE">&gt;</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token TRUE">true</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">10</span><span class="Token Variable Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">10</span><span class="Token Variable Number SPACE"> </span><span class="Keyword Token Number OR">or</span><span class="Keyword Token Number SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">10</span><span class="Token Variable Number SPACE"> </span><span class="Keyword Token Number OR">or</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token NIL">nil</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Keyword Token Variable NIL">nil</span><span class="Keyword Token Variable SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token NIL">nil</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Keyword Token Variable NIL">nil</span><span class="Keyword Token Variable SPACE"> </span><span class="Keyword Token OR">or</span><span class="Keyword Token SPACE"> </span><span class="Token String STR">&quot;alo&quot;</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;alo&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Keyword Token Variable NIL">nil</span><span class="Keyword Token Variable SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Keyword Token Number NUMBER">10</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Keyword Token Variable FALSE">false</span><span class="Keyword Token Variable SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Keyword Token Number NUMBER">10</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token FALSE">false</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Keyword Token Variable TRUE">true</span><span class="Keyword Token Variable SPACE"> </span><span class="Keyword Token OR">or</span><span class="Keyword Token SPACE"> </span><span class="Keyword Token Number NUMBER">10</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token TRUE">true</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Keyword Token Variable FALSE">false</span><span class="Keyword Token Variable SPACE"> </span><span class="Keyword Token OR">or</span><span class="Keyword Token SPACE"> </span><span class="Keyword Token Number NUMBER">10</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FALSE">false</span><span class="Keyword Token SPACE"> </span><span class="Punctuator Keyword Token NORE">~=</span><span class="Punctuator Keyword Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token NIL">nil</span><span class="Keyword Token SPACE"> </span><span class="Punctuator Keyword Token NORE">~=</span><span class="Punctuator Keyword Token SPACE"> </span><span class="Keyword Token FALSE">false</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="Expression Keyword Token SPACE"> </span><span class="Punctuator Keyword Token EQ">==</span><span class="Punctuator Keyword Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="Expression Keyword Token SPACE"> </span><span class="Punctuator Keyword Token EQ">==</span><span class="Punctuator Keyword Token SPACE"> </span><span class="Keyword Token FALSE">false</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number EQ">==</span><span class="Punctuator Token Number SPACE"> </span><span class="Keyword Token Number TRUE">true</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token TRUE">true</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">6</span><span class="Token Variable Number SPACE"> </span><span class="Keyword Token Number OR">or</span><span class="Keyword Token Number SPACE"> </span><span class="Keyword Token Number NIL">nil</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token TRUE">true</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Keyword Token Variable NIL">nil</span><span class="Keyword Token Variable SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Keyword Token Number NUMBER">56</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token FALSE">false</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Keyword Token Variable NIL">nil</span><span class="Keyword Token Variable SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token FALSE">false</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number EQ">==</span><span class="Punctuator Token Number SPACE"> </span><span class="Keyword Token Number FALSE">false</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token FALSE">false</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Token Number NUMBER">0.5</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number EQ">==</span><span class="Punctuator Token Number SPACE"> </span><span class="Keyword Token Number FALSE">false</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Token String STR">&quot;x&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token FALSE">false</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;+&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Keyword Token VarSuffix TRUE">true</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Number LF">
</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Keyword Token VarSuffix FALSE">false</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Punctuator Token Number brace-depth-2 LANGLE_BRACE">&lt;</span><span class="Token Number NUMBER">2</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">20</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Punctuator Token Number brace-depth-2 RANGLE_BRACE">&gt;</span><span class="Token Number NUMBER">2</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FunctionName FuncName ID">f</span><span class="brace-depth-2 Statement Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="brace-depth-2 Statement Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Token TableConstructor brace-depth-2 LCURLY_BRACE">{</span><span class="Expression Token TableConstructor brace-depth-2 RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">3000</span><span class="Statement Token COMMA">,</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">3000</span><span class="Statement Token COMMA">,</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0.0</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">10e30</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;alo&quot;</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Keyword Token VarSuffix TRUE">true</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Keyword Token VarSuffix FALSE">false</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Number LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">10e30</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;alo&#x27;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">20</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">10</span><span class="Punctuator Token brace-depth-1 Number LANGLE_BRACE">&lt;</span><span class="Token Number NUMBER">20</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">3000</span><span class="Statement Token COMMA">,</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">3000</span><span class="Statement Token COMMA">,</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">print</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">assert</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">f</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">print</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">print</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">f</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">print</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Keyword Token VarSuffix NIL">nil</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Token brace-depth-1 Field FieldList LSQUAR_PAREN">[</span><span class="Keyword Token Field NIL">nil</span><span class="Token brace-depth-1 Field FieldList RSQUAR_PAREN">]</span><span class="Token Field FieldList SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Token Number Field NUMBER">10</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Keyword Token VarSuffix NIL">nil</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">undef</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">c</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Token Number Field NUMBER">10</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">9</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">8</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">7</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">6</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">5</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">4</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">2</span><span class="Punctuator Token SEMI">;</span><span class="Punctuator Token SPACE"> </span><span class="brace-depth-0 Token Field LSQUAR_PAREN">[</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">3</span><span class="brace-depth-0 Token Field RSQUAR_PAREN">]</span><span class="Token Field ASSIGN">=</span><span class="Token String STR">&#x27;a&#x27;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="brace-depth-0 Token Field LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">f</span><span class="brace-depth-0 Token Field RSQUAR_PAREN">]</span><span class="Token Field ASSIGN">=</span><span class="Identifier Token Variable ID">print</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Identifier Token Field ID">a</span><span class="Token Field ASSIGN">=</span><span class="Token String STR">&#x27;a&#x27;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Identifier Token Field ID">b</span><span class="Token Field ASSIGN">=</span><span class="Token String STR">&#x27;ab&#x27;</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix ID">y</span><span class="Identifier Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">3</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">10</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">3</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Punctuator Expression Token EQ">==</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">a</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">f</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Punctuator Expression Token EQ">==</span><span class="Identifier Token Variable ID">print</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">x</span><span class="Punctuator Expression Token EQ">==</span><span class="Token String STR">&#x27;a&#x27;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">y</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="brace-depth-2 Token Field FieldList LSQUAR_PAREN">[</span><span class="Token String STR">&#x27;alo&#x27;</span><span class="brace-depth-2 Token Field FieldList RSQUAR_PAREN">]</span><span class="Token Field FieldList ASSIGN">=</span><span class="Identifier Token Variable ID">assert</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">f</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">6</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">23</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">alo</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">10</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">10</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Punctuator Expression Token EQ">==</span><span class="Identifier Token Variable ID">print</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">aVeryLongName012345678901234567890123456789012345678901234567890123456789</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">foo</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-1 LPAREN">(</span><span class="Statement Token FunctionBody brace-depth-1 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">aVeryLongName012345678901234567890123456789012345678901234567890123456789</span><span class="Identifier TableKey Token VarSuffix LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">foo</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">aVeryLongName012345678901234567890123456789012345678901234567890123456789</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token LF">
</span><span class="Expression Token Number NUMBER">10</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- _ENV constant</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">foo</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-1 LPAREN">(</span><span class="Statement Token FunctionBody brace-depth-1 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">_ENV</span><span class="Identifier Token AttributeName SPACE"> </span><span class="brace-depth-0 Token Attribute AttributeName LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="brace-depth-0 Token Attribute AttributeName RANGLE_BRACE">&gt;</span><span class="Token Attribute AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">11</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token Variable ID">X</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;hi&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">st</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">msg</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">foo</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">st</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">find</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;number&quot;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- test of large float/integer indices</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- compute maximum integer where all bits fit in a float</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">maxint</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">maxinteger</span><span class="Identifier TableKey Token VarSuffix LF">
</span><span class="Identifier TableKey Token VarSuffix LF">
</span><span class="Identifier TableKey Token VarSuffix COMMENT">-- trim (if needed) to fit in a float</span><span class="Identifier TableKey Token VarSuffix LF">
</span><span class="Statement Keyword Token WHILE">while</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">maxint</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">maxint</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0.0</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Keyword Token OR">or</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">maxint</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">maxint</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1.0</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">maxint</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">maxint</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token DOUBLE_DIV">//</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Number LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">maxintF</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">maxint</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0.0</span><span class="Expression Token Number SPACE">   </span><span class="Expression Token Number COMMENT">-- float version</span><span class="Expression Token Number LF">
</span><span class="Expression Token Number LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">maxintF</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">maxint</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">type</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">maxintF</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;float&quot;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token LF">
</span><span class="Expression Keyword Token SPACE">       </span><span class="Identifier Token Variable ID">maxintF</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token GE">&gt;=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2.0</span><span class="Punctuator Token Number CARET">^</span><span class="Token Number NUMBER">14</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- floats and integers must index the same places</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">maxintF</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">maxintF</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1.0</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">11</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Punctuator Expression Token MINUS">-</span><span class="Identifier Token Variable ID">maxintF</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">12</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Punctuator Expression Token MINUS">-</span><span class="Identifier Token Variable ID">maxintF</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1.0</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">13</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">maxint</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">maxint</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">11</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number LF">
</span><span class="Keyword Token Number SPACE">       </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Punctuator Expression Token MINUS">-</span><span class="Identifier Token Variable ID">maxint</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">12</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Punctuator Expression Token MINUS">-</span><span class="Identifier Token Variable ID">maxint</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">13</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">maxint</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Number LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Punctuator Expression Token MINUS">-</span><span class="Identifier Token Variable ID">maxint</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">22</span><span class="Token Number LF">
</span><span class="Token Number LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">maxintF</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">20</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">maxintF</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1.0</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">11</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number LF">
</span><span class="Keyword Token Number SPACE">       </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Punctuator Expression Token MINUS">-</span><span class="Identifier Token Variable ID">maxintF</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">22</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Punctuator Expression Token MINUS">-</span><span class="Identifier Token Variable ID">maxintF</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1.0</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">13</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token LF">
</span><span class="Keyword Token LF">
</span><span class="Keyword Token COMMENT">-- test conflicts in multiple assignment</span><span class="Keyword Token LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">i</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">j</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Token String STR">&#x27;a&#x27;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;b&#x27;</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">j</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">2</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Statement Token ASSIGN">=</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">j</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">j</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Punctuator Expression Token PLUS">+</span><span class="Identifier Token Variable ID">j</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">j</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">j</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">j</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number LF">
</span><span class="Keyword Token Number SPACE">         </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">3</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">foo</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-1 LPAREN">(</span><span class="Statement Token FunctionBody brace-depth-1 RPAREN">)</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Token FunctionBody COMMENT">-- assigining to upvalues</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">foo</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">20</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">x</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- repeat test with upvalues</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">i</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">j</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Token String STR">&#x27;a&#x27;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;b&#x27;</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">j</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">2</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Statement Token ASSIGN">=</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">foo</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-1 LPAREN">(</span><span class="Statement Token FunctionBody brace-depth-1 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">j</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">j</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Punctuator Expression Token PLUS">+</span><span class="Identifier Token Variable ID">j</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">j</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">j</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">foo</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">j</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number LF">
</span><span class="Keyword Token Number SPACE">         </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">3</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Token Variable brace-depth-1 LPAREN">(</span><span class="Keyword Token FunctionCall FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionCall FunctionDefinition SPACE"> </span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token FunctionCall ID">a</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">t</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token FunctionCall Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token FunctionCall Number NUMBER">20</span><span class="Token FunctionCall Number SPACE">  </span><span class="FunctionCall Keyword Token FunctionBody END">end</span><span class="Token Variable brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- bug in 5.2 beta</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">foo</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-1 LPAREN">(</span><span class="Statement Token FunctionBody brace-depth-1 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">  </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">14</span><span class="Token Number SPACE">    </span><span class="Token Number COMMENT">-- local and upvalue have same index</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">14</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&#x27;OK&#x27;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">res</span></code></pre><h2 id="h2-8"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/8.lua" target="_blank">8.lua</a></h2><pre class="language-lua"><code><span class="Token COMMENT">-- $Id: testes/big.lua $</span><span class="Token LF">
</span><span class="Token COMMENT">-- See Copyright Notice in file all.lua</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">_soft</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token String STR">&#x27;a&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Token String STR">&quot;testing large tables&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">debug</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;debug&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">lim</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Punctuator Token Number CARET">^</span><span class="Token Number NUMBER">18</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number PLUS">+</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">1000</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">prog</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression Token TableConstructor SPACE"> </span><span class="Token String STR">&quot;local y = {0&quot;</span><span class="Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;}</span><span class="Control Token String STR">\n</span><span class="Token String STR">&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;X = y</span><span class="Control Token String STR">\n</span><span class="Token String STR">&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token Variable LPAREN">(</span><span class="Token String STR">&quot;assert(X[</span><span class="Token String Format STR">%d</span><span class="Token String STR">] == </span><span class="Token String Format STR">%d</span><span class="Token String STR">)&quot;</span><span class="Expression brace-depth-0 Token Variable RPAREN">)</span><span class="Token VarSuffix COLON">:</span><span class="Identifier FunctionCall Token VarSuffix ID">format</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;return 0&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">table</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">concat</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;;&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">env</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">string</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Identifier Token Field ID">assert</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Identifier Token Variable ID">assert</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">env</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">env</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">X</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">lim</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">env</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">X</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">lim</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token ID">k</span><span class="Identifier Token SPACE"> </span><span class="Statement Keyword Token IN">in</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pairs</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">env</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">env</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">k</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">undef</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- yields during accesses larger than K (in RK)</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">env</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Identifier Token Field ID">__index</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">n</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Identifier Token Variable ID">coroutine</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">yield</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;g&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">n</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">    </span><span class="Identifier Token Field ID">__newindex</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">n</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">v</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Identifier Token Variable ID">coroutine</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">yield</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;s&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">n</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">v</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Punctuator Token FieldList COMMA">,</span><span class="Punctuator Token FieldList LF">
</span><span class="Punctuator Token FieldList SPACE">  </span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">X</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">co</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">coroutine</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">wrap</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">co</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;s&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">co</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;g&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">co</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;g&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">co</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">X</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">lim</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">X</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">lim</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- errors in accesses larger than K (in RK)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">getmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">env</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionName Token TableKey VarSuffix ID">__index</span><span class="Identifier FunctionName Token TableKey VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier Token Variable ID">getmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">env</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionName Token TableKey VarSuffix ID">__newindex</span><span class="Identifier FunctionName Token TableKey VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">e</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">m</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">e</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Token VarSuffix COLON">:</span><span class="Identifier FunctionCall Token VarSuffix ID">find</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;global &#x27;X&#x27;&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- errors in metamethods</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">getmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">env</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionName Token TableKey VarSuffix ID">__newindex</span><span class="Identifier FunctionName Token TableKey VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">error</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;hi&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">e</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">m</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">xpcall</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">traceback</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">e</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Token VarSuffix COLON">:</span><span class="Identifier FunctionCall Token VarSuffix ID">find</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;&#x27;newindex&#x27;&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">X</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">coroutine</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">yield</span><span class="Token String STR">&#x27;b&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Token Number NUMBER">2</span><span class="Punctuator Token Number CARET">^</span><span class="Token Number NUMBER">32</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number EQ">==</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- (small integers) {</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Token String STR">&quot;testing string length overflow&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">repstrings</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">192</span><span class="Token Number SPACE">          </span><span class="Token Number COMMENT">-- number of strings to be concatenated</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">ssize</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">ceil</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">2.0</span><span class="Punctuator Token Number CARET">^</span><span class="Token Number NUMBER">32</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number DIV">/</span><span class="Punctuator Token Number SPACE"> </span><span class="Identifier Token Variable ID">repstrings</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE">   </span><span class="Expression Token Number COMMENT">-- size of each string</span><span class="Expression Token Number LF">
</span><span class="Expression Token Number SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">repstrings</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MUL">*</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">ssize</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token brace-depth-1 RANGLE_BRACE">&gt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2.0</span><span class="Punctuator Token Number CARET">^</span><span class="Token Number NUMBER">32</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- it should be larger than maximum size</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">longs</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">rep</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;\0&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">ssize</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">   </span><span class="Argument Token VarSuffix COMMENT">-- create one long string</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- create function to concatenate &#x27;repstrings&#x27; copies of its argument</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">rep</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Token String STR">&quot;local a = ...; return &quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token CONCAT">..</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">rep</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;a&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">repstrings</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;..&quot;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">rep</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">longs</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">   </span><span class="Argument Token VarSuffix COMMENT">-- call that function</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- it should fail without creating string (result would be too large)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">find</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;overflow&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- }</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Token String STR">&#x27;OK&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token String STR">&#x27;a&#x27;</span></code></pre><h2 id="h2-9"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/9.lua" target="_blank">9.lua</a></h2><pre class="language-lua"><code><span class="Token COMMENT">-- $Id: testes/bitwise.lua $</span><span class="Token LF">
</span><span class="Token COMMENT">-- See Copyright Notice in file all.lua</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;testing bitwise operations&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Token String STR">&quot;bwcoercion&quot;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">numbits</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">packsize</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;j&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token MUL">*</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">8</span><span class="Expression Token Number LF">
</span><span class="Expression Token Number LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token TILDE">~</span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number EQ">==</span><span class="Punctuator Token Number SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">1</span><span class="Token Variable Number SPACE"> </span><span class="Punctuator Token Number SHL">&lt;&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Expression Token Variable brace-depth-2 LPAREN">(</span><span class="Identifier Token Variable ID">numbits</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Variable brace-depth-2 RPAREN">)</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">mininteger</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- basic tests for bitwise operators;</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- use variables to avoid constant folding</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">c</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">d</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0xFFFFFFFFFFFFFFFF</span><span class="Token Number LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number EQ">==</span><span class="Punctuator Token Number SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">35</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number EQ">==</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">35</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0xF0F0F0F0F0F0F0F0</span><span class="Token Number LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PIPE">|</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number EQ">==</span><span class="Punctuator Token Number SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token TILDE">~</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token TILDE">~</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number EQ">==</span><span class="Punctuator Token Number SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token TILDE">~</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token TILDE">~</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token SHR">&gt;&gt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">4</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number EQ">==</span><span class="Punctuator Token Number SPACE"> </span><span class="Punctuator Expression Token TILDE">~</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0xF0</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0xCC</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0xAA</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0xFD</span><span class="Token Number LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PIPE">|</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token TILDE">~</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xF4</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0xF0.0</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0xCC.0</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;0xAA.0&quot;</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;0xFD.0&quot;</span><span class="Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PIPE">|</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token TILDE">~</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xF4</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0xF0000000</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0xCC000000</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0xAA000000</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0xFD000000</span><span class="Token Number LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PIPE">|</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token TILDE">~</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xF4000000</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token TILDE">~</span><span class="Punctuator Expression Token TILDE">~</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Punctuator Expression Token TILDE">~</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number TILDE">~</span><span class="Punctuator Token Number SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token TILDE">~</span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token SHL">&lt;&lt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">32</span><span class="Expression Token Number LF">
</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token SHL">&lt;&lt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">32</span><span class="Expression Token Number LF">
</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token SHL">&lt;&lt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">32</span><span class="Expression Token Number LF">
</span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token SHL">&lt;&lt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">32</span><span class="Expression Token Number LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PIPE">|</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token TILDE">~</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xF4000000</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number SHL">&lt;&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">32</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token TILDE">~</span><span class="Punctuator Expression Token TILDE">~</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Punctuator Expression Token TILDE">~</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number TILDE">~</span><span class="Punctuator Token Number SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token TILDE">~</span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- constant folding</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">code</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">format</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;return -1 &gt;&gt; </span><span class="Token String Format STR">%d</span><span class="Token String STR">&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">maxinteger</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">code</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">code</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">format</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;return -1 &gt;&gt; </span><span class="Token String Format STR">%d</span><span class="Token String STR">&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">mininteger</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">code</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">code</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">format</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;return -1 &lt;&lt; </span><span class="Token String Format STR">%d</span><span class="Token String STR">&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">maxinteger</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">code</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">code</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">format</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;return -1 &lt;&lt; </span><span class="Token String Format STR">%d</span><span class="Token String STR">&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">mininteger</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">code</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number SHR">&gt;&gt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number EQ">==</span><span class="Punctuator Token Number SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">1</span><span class="Token Variable Number SPACE"> </span><span class="Punctuator Token Number SHL">&lt;&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Expression Token Variable brace-depth-2 LPAREN">(</span><span class="Identifier Token Variable ID">numbits</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Variable brace-depth-2 RPAREN">)</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number SHL">&lt;&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">31</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number EQ">==</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">0x80000000</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number SHR">&gt;&gt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">numbits</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number SHR">&gt;&gt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Identifier Token Variable ID">numbits</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number LF">
</span><span class="Keyword Token Number SPACE">       </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number SHR">&gt;&gt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Identifier Token Variable ID">numbits</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number LF">
</span><span class="Keyword Token Number SPACE">       </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number SHL">&lt;&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Identifier Token Variable ID">numbits</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number LF">
</span><span class="Keyword Token Number SPACE">       </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number SHL">&lt;&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Identifier Token Variable ID">numbits</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number SHR">&gt;&gt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">mininteger</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number SHR">&gt;&gt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">maxinteger</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number SHL">&lt;&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">mininteger</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number SHL">&lt;&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">maxinteger</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">2</span><span class="Punctuator Token Number CARET">^</span><span class="Token Number NUMBER">30</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number MINUS">-</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token SHL">&lt;&lt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="Punctuator Token Number CARET">^</span><span class="Token Number NUMBER">30</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number EQ">==</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">2</span><span class="Punctuator Token Number CARET">^</span><span class="Token Number NUMBER">30</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number MINUS">-</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token SHR">&gt;&gt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="Punctuator Token Number CARET">^</span><span class="Token Number NUMBER">30</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number EQ">==</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number SHR">&gt;&gt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">3</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number EQ">==</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number SHL">&lt;&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Token Number NUMBER">1000</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number SHR">&gt;&gt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number EQ">==</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">1000</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number SHL">&lt;&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">5</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- coercion from strings to integers</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;0xffffffffffffffff&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token PIPE">|</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number EQ">==</span><span class="Punctuator Token Number SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;0xfffffffffffffffe&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;-1&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">2</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot; </span><span class="Control Token String STR">\t</span><span class="Token String STR">-0xfffffffffffffffe</span><span class="Control Token String STR">\n</span><span class="Control Token String STR">\t</span><span class="Token String STR">&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;-1&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;   </span><span class="Control Token String STR">\n</span><span class="Token String STR">  -45  </span><span class="Control Token String STR">\t</span><span class="Token String STR"> &quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token SHR">&gt;&gt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;  -2  &quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">45</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number MUL">*</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">4</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;1234.0&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token SHL">&lt;&lt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;5.0&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1234</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number MUL">*</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">32</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;0xffff.0&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token TILDE">~</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;0xAAAA&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0x5555</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token TILDE">~</span><span class="Token String STR">&quot;0x0.000p4&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;7&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token CONCAT">..</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token SHL">&lt;&lt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number EQ">==</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">146</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0xffffffff</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number SHR">&gt;&gt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">1</span><span class="Token Variable Number SPACE"> </span><span class="Punctuator Token Number CONCAT">..</span><span class="Punctuator Token Number SPACE"> </span><span class="Token String STR">&quot;9&quot;</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0x1fff</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number PIPE">|</span><span class="Punctuator Token Number SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">1</span><span class="Token Variable Number SPACE"> </span><span class="Punctuator Token Number CONCAT">..</span><span class="Punctuator Token Number SPACE"> </span><span class="Token String STR">&quot;9&quot;</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">27</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">st</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">msg</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number AMPERSAND">&amp;</span><span class="Punctuator Token Number SPACE"> </span><span class="Token String STR">&quot;a&quot;</span><span class="Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">find</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;&#x27;band&#x27;&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">st</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">msg</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Punctuator Expression Token TILDE">~</span><span class="Token String STR">&quot;a&quot;</span><span class="Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">find</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;&#x27;bnot&#x27;&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- out of range number</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token String STR">&quot;0xffffffffffffffff.0&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token PIPE">|</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- embedded zeros</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token String STR">&quot;0xffffffffffffffff\0&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token PIPE">|</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Token String STR">&#x27;+&#x27;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">preload</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionName Token TableKey VarSuffix ID">bit32</span><span class="Identifier FunctionName Token TableKey VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE">     </span><span class="Token FunctionBody FunctionDefinition COMMENT">--{</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition COMMENT">-- no built-in &#x27;bit32&#x27; library: implement it using bitwise operators</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">bit</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FuncName ID">bit</span><span class="Statement Token FuncName DOT">.</span><span class="Identifier Token FunctionName FuncName ID">bnot</span><span class="Identifier Token FunctionName FuncName SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Punctuator Expression Token TILDE">~</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xFFFFFFFF</span><span class="Expression Token Number LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody COMMENT">--</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody COMMENT">-- in all vararg functions, avoid creating &#x27;arg&#x27; table when there are</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody COMMENT">-- only 2 (or less) parameters, as 2 parameters is the common case</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody COMMENT">--</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FuncName ID">bit</span><span class="Statement Token FuncName DOT">.</span><span class="Identifier Token FunctionName FuncName ID">band</span><span class="Identifier Token FunctionName FuncName SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">z</span><span class="Token FunctionBody ParameterList COMMA">,</span><span class="Token FunctionBody ParameterList SPACE"> </span><span class="Punctuator Token ParameterList VARARGS">...</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">z</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Expression brace-depth-0 Token Variable LPAREN">(</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token OR">or</span><span class="Expression Keyword Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token OR">or</span><span class="Expression Keyword Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression brace-depth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xFFFFFFFF</span><span class="Expression Token Number LF">
</span><span class="Expression Token Number SPACE">  </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">arg</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Punctuator Expression Token VARARGS">...</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">z</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">arg</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">arg</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xFFFFFFFF</span><span class="Expression Token Number LF">
</span><span class="Expression Token Number SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FuncName ID">bit</span><span class="Statement Token FuncName DOT">.</span><span class="Identifier Token FunctionName FuncName ID">bor</span><span class="Identifier Token FunctionName FuncName SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">z</span><span class="Token FunctionBody ParameterList COMMA">,</span><span class="Token FunctionBody ParameterList SPACE"> </span><span class="Punctuator Token ParameterList VARARGS">...</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">z</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Expression brace-depth-0 Token Variable LPAREN">(</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token OR">or</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token PIPE">|</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token OR">or</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression brace-depth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xFFFFFFFF</span><span class="Expression Token Number LF">
</span><span class="Expression Token Number SPACE">  </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">arg</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Punctuator Expression Token VARARGS">...</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PIPE">|</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PIPE">|</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">z</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">arg</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PIPE">|</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">arg</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xFFFFFFFF</span><span class="Expression Token Number LF">
</span><span class="Expression Token Number SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FuncName ID">bit</span><span class="Statement Token FuncName DOT">.</span><span class="Identifier Token FunctionName FuncName ID">bxor</span><span class="Identifier Token FunctionName FuncName SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">z</span><span class="Token FunctionBody ParameterList COMMA">,</span><span class="Token FunctionBody ParameterList SPACE"> </span><span class="Punctuator Token ParameterList VARARGS">...</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">z</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Expression brace-depth-0 Token Variable LPAREN">(</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token OR">or</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token TILDE">~</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token OR">or</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression brace-depth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xFFFFFFFF</span><span class="Expression Token Number LF">
</span><span class="Expression Token Number SPACE">  </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">arg</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Punctuator Expression Token VARARGS">...</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token TILDE">~</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token TILDE">~</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">z</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">arg</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token TILDE">~</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">arg</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xFFFFFFFF</span><span class="Expression Token Number LF">
</span><span class="Expression Token Number SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FuncName ID">bit</span><span class="Statement Token FuncName DOT">.</span><span class="Identifier Token FunctionName FuncName ID">btest</span><span class="Identifier Token FunctionName FuncName SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Punctuator Token FunctionBody VARARGS">...</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">bit</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">band</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token VARARGS">...</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Number LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FuncName ID">bit</span><span class="Statement Token FuncName DOT">.</span><span class="Identifier Token FunctionName FuncName ID">lshift</span><span class="Identifier Token FunctionName FuncName SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">b</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Expression brace-depth-0 Token Variable LPAREN">(</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xFFFFFFFF</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token SHL">&lt;&lt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression brace-depth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xFFFFFFFF</span><span class="Expression Token Number LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FuncName ID">bit</span><span class="Statement Token FuncName DOT">.</span><span class="Identifier Token FunctionName FuncName ID">rshift</span><span class="Identifier Token FunctionName FuncName SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">b</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Expression brace-depth-0 Token Variable LPAREN">(</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xFFFFFFFF</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token SHR">&gt;&gt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression brace-depth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xFFFFFFFF</span><span class="Expression Token Number LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FuncName ID">bit</span><span class="Statement Token FuncName DOT">.</span><span class="Identifier Token FunctionName FuncName ID">arshift</span><span class="Identifier Token FunctionName FuncName SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">b</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xFFFFFFFF</span><span class="Expression Token Number LF">
</span><span class="Expression Token Number SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token LE">&lt;=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number OR">or</span><span class="Keyword Token Number SPACE"> </span><span class="Expression brace-depth-0 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0x80000000</span><span class="Expression brace-depth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Expression brace-depth-0 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token SHR">&gt;&gt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression brace-depth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xFFFFFFFF</span><span class="Expression Token Number LF">
</span><span class="Expression Token Number SPACE">  </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Expression brace-depth-0 Token Variable LPAREN">(</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token SHR">&gt;&gt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token PIPE">|</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token TILDE">~</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">0xFFFFFFFF</span><span class="Token Variable Number SPACE"> </span><span class="Punctuator Token Number SHR">&gt;&gt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression brace-depth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xFFFFFFFF</span><span class="Expression Token Number LF">
</span><span class="Expression Token Number SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FuncName ID">bit</span><span class="Statement Token FuncName DOT">.</span><span class="Identifier Token FunctionName FuncName ID">lrotate</span><span class="Identifier Token FunctionName FuncName SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Identifier Token SPACE"> </span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">31</span><span class="Expression Token Number LF">
</span><span class="Expression Token Number SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xFFFFFFFF</span><span class="Expression Token Number LF">
</span><span class="Expression Token Number SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token SHL">&lt;&lt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression brace-depth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token PIPE">|</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression brace-depth-0 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token SHR">&gt;&gt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">32</span><span class="Token Variable Number SPACE"> </span><span class="Punctuator Token Number MINUS">-</span><span class="Punctuator Token Number SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression brace-depth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">  </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xFFFFFFFF</span><span class="Expression Token Number LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FuncName ID">bit</span><span class="Statement Token FuncName DOT">.</span><span class="Identifier Token FunctionName FuncName ID">rrotate</span><span class="Identifier Token FunctionName FuncName SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">b</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">bit</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">lrotate</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">checkfield</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">w</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Identifier Token Variable ID">w</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">w</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token OR">or</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number LF">
</span><span class="Expression Token Number SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token GE">&gt;=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;field cannot be negative&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">w</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token brace-depth-1 RANGLE_BRACE">&gt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;width must be positive&quot;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">w</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token LE">&lt;=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">32</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;trying to access non-existent bits&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token TILDE">~</span><span class="Expression brace-depth-0 Token Variable LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number SHL">&lt;&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Identifier Token Variable ID">w</span><span class="Expression brace-depth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FuncName ID">bit</span><span class="Statement Token FuncName DOT">.</span><span class="Identifier Token FunctionName FuncName ID">extract</span><span class="Identifier Token FunctionName FuncName SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">w</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">mask</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">checkfield</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">w</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Expression brace-depth-0 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token SHR">&gt;&gt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="Expression brace-depth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">mask</span><span class="Identifier Token Variable LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FuncName ID">bit</span><span class="Statement Token FuncName DOT">.</span><span class="Identifier Token FunctionName FuncName ID">replace</span><span class="Identifier Token FunctionName FuncName SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">v</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">w</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">mask</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">checkfield</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">w</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">v</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">v</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">mask</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token TILDE">~</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">mask</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token SHL">&lt;&lt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression brace-depth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token PIPE">|</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression brace-depth-0 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">v</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token SHL">&lt;&lt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="Expression brace-depth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">  </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xFFFFFFFF</span><span class="Expression Token Number LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">bit</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Keyword Token FunctionBody COMMENT">--}</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;testing bitwise library&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">bit32</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&#x27;bit32&#x27;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">band</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">bnot</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">btest</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token TRUE">true</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">bor</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">bxor</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">band</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">band</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0xffffffff</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">band</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">2</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- out-of-range numbers</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">band</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xffffffff</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">band</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Expression Token Variable brace-depth-2 LPAREN">(</span><span class="Token Variable Number NUMBER">1</span><span class="Token Variable Number SPACE"> </span><span class="Punctuator Token Number SHL">&lt;&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">33</span><span class="Expression Token Variable brace-depth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xffffffff</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">band</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Variable brace-depth-2 LPAREN">(</span><span class="Token Variable Number NUMBER">1</span><span class="Token Variable Number SPACE"> </span><span class="Punctuator Token Number SHL">&lt;&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">33</span><span class="Expression Token Variable brace-depth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xffffffff</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">band</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Expression Token Variable brace-depth-2 LPAREN">(</span><span class="Token Variable Number NUMBER">1</span><span class="Token Variable Number SPACE"> </span><span class="Punctuator Token Number SHL">&lt;&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">33</span><span class="Expression Token Variable brace-depth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">band</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Variable brace-depth-2 LPAREN">(</span><span class="Token Variable Number NUMBER">1</span><span class="Token Variable Number SPACE"> </span><span class="Punctuator Token Number SHL">&lt;&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">33</span><span class="Expression Token Variable brace-depth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">band</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Variable brace-depth-2 LPAREN">(</span><span class="Token Variable Number NUMBER">1</span><span class="Token Variable Number SPACE"> </span><span class="Punctuator Token Number SHL">&lt;&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">40</span><span class="Expression Token Variable brace-depth-2 RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">band</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number SHL">&lt;&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">40</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">band</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Variable brace-depth-2 LPAREN">(</span><span class="Token Variable Number NUMBER">1</span><span class="Token Variable Number SPACE"> </span><span class="Punctuator Token Number SHL">&lt;&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">40</span><span class="Expression Token Variable brace-depth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xfffffffe</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">band</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Expression Token Variable brace-depth-2 LPAREN">(</span><span class="Token Variable Number NUMBER">1</span><span class="Token Variable Number SPACE"> </span><span class="Punctuator Token Number SHL">&lt;&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">40</span><span class="Expression Token Variable brace-depth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">4</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xfffffffc</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">lrotate</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">lrotate</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">7</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">lrotate</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0x12345678</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">lrotate</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">32</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0x12345678</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">lrotate</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0x23456781</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">rrotate</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">4</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0x23456781</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">lrotate</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">8</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0x78123456</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">rrotate</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">8</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0x78123456</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">lrotate</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0xaaaaaaaa</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xaaaaaaaa</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">lrotate</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0xaaaaaaaa</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">2</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xaaaaaaaa</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">50</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">50</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">lrotate</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0x89abcdef</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">lrotate</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0x89abcdef</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Punctuator Expression Token MOD">%</span><span class="Expression Token Number NUMBER">32</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">lshift</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0x23456780</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">lshift</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">8</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0x34567800</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">lshift</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">4</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0x01234567</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">lshift</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">8</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0x00123456</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">lshift</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">32</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">lshift</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">32</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">rshift</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0x01234567</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">rshift</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">8</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0x00123456</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">rshift</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">32</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">rshift</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">32</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">arshift</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0x12345678</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">arshift</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0x12345678</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number DOUBLE_DIV">//</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">2</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">arshift</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0x12345678</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number MUL">*</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">2</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">arshift</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xffffffff</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">arshift</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">24</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xffffffff</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">arshift</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">32</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xffffffff</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">arshift</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">band</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number MUL">*</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0xffffffff</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number SHL">&lt;&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number EQ">==</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">0x123456780</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number SHL">&lt;&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">8</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number EQ">==</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">0x1234567800</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number SHL">&lt;&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">4</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number EQ">==</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">0x01234567</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number SHL">&lt;&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">8</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number EQ">==</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">0x00123456</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number SHL">&lt;&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">32</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number EQ">==</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">0x1234567800000000</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number SHL">&lt;&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">32</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number EQ">==</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number SHR">&gt;&gt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number EQ">==</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">0x01234567</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number SHR">&gt;&gt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">8</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number EQ">==</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">0x00123456</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number SHR">&gt;&gt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">32</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number EQ">==</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number SHR">&gt;&gt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">32</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number EQ">==</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">0x1234567800000000</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;+&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- some special cases</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">c</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Token Number Field NUMBER">0</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">1</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">10</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">0x80000000</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">0xaaaaaaaa</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">0x55555555</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">           </span><span class="Token Number Field NUMBER">0xffffffff</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">0x7fffffff</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token ID">_</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">b</span><span class="Identifier Token SPACE"> </span><span class="Statement Keyword Token IN">in</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pairs</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">band</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">band</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">band</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">btest</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">band</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">band</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token TILDE">~</span><span class="Identifier Token Variable ID">b</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">btest</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">band</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">bnot</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">bor</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">bnot</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">bnot</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">bor</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">bor</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">bor</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">bor</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token TILDE">~</span><span class="Identifier Token Variable ID">b</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xffffffff</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">bxor</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">bxor</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">bxor</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">bxor</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">bxor</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">bnot</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">bnot</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">bnot</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">bnot</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">1</span><span class="Token Variable Number SPACE"> </span><span class="Punctuator Token Number SHL">&lt;&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">32</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number MINUS">-</span><span class="Punctuator Token Number SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">lrotate</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">32</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">rrotate</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">32</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">lshift</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">lshift</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">4</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">band</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">bnot</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0xf</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">rshift</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">rshift</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">4</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">band</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">bnot</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0xf</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- for this test, use at most 24 bits (mantissa of a single float)</span><span class="Statement Keyword Token LF">
</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Token Number Field NUMBER">0</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">1</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">10</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">0x800000</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">0xaaaaaa</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">0x555555</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">0xffffff</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">0x7fffff</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token ID">_</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">b</span><span class="Identifier Token SPACE"> </span><span class="Statement Keyword Token IN">in</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pairs</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">40</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">40</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">lshift</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">y</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">floor</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">fmod</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MUL">*</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2.0</span><span class="Punctuator Token Number CARET">^</span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2.0</span><span class="Punctuator Token Number CARET">^</span><span class="Token Number NUMBER">32</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">fmod</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2.0</span><span class="Punctuator Token Number CARET">^</span><span class="Token Number NUMBER">32</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">band</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token TableConstructor brace-depth-2 LCURLY_BRACE">{</span><span class="Expression Token TableConstructor brace-depth-2 RCURLY_BRACE">}</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">bnot</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;a&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">lshift</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">45</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">lshift</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">45</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">rshift</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">45</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;+&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- testing extract/replace</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">extract</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">8</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">extract</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">7</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">extract</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0xa0001111</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">28</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xa</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">extract</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0xa0001111</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">31</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">extract</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0x50000111</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">31</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">extract</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0xf2345679</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">32</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xf2345679</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">extract</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">extract</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">32</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">extract</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">33</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">extract</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">31</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">replace</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">28</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0x52345678</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">replace</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0x87654321</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">32</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0x87654321</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">replace</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="Punctuator Token Number CARET">^</span><span class="Token Number NUMBER">2</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">replace</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="Punctuator Token Number CARET">^</span><span class="Token Number NUMBER">4</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">replace</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">31</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">1</span><span class="Token Variable Number SPACE"> </span><span class="Punctuator Token Number SHL">&lt;&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">31</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">replace</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">1</span><span class="Token Variable Number SPACE"> </span><span class="Punctuator Token Number SHL">&lt;&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">32</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">7</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- testing conversion of floats</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">bor</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">3.0</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">bor</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">4.0</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xfffffffc</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- large floats and large-enough integers?</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Token Number NUMBER">2.0</span><span class="Punctuator Token Number CARET">^</span><span class="Token Number NUMBER">50</span><span class="Token Number SPACE"> </span><span class="Punctuator brace-depth-0 Token Number LANGLE_BRACE">&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">2.0</span><span class="Punctuator Token Number CARET">^</span><span class="Token Number NUMBER">50</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number PLUS">+</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">1.0</span><span class="Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Token Number NUMBER">2.0</span><span class="Punctuator Token Number CARET">^</span><span class="Token Number NUMBER">50</span><span class="Token Number SPACE"> </span><span class="Punctuator Token brace-depth-1 Number LANGLE_BRACE">&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Expression Token Variable brace-depth-2 LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number SHR">&gt;&gt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Expression Token Variable brace-depth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">bor</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">2.0</span><span class="Punctuator Token Number CARET">^</span><span class="Token Number NUMBER">32</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number MINUS">-</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">5.0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xfffffffb</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">bor</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">2.0</span><span class="Punctuator Token Number CARET">^</span><span class="Token Number NUMBER">32</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number MINUS">-</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">6.0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xfffffffa</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">bor</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">2.0</span><span class="Punctuator Token Number CARET">^</span><span class="Token Number NUMBER">48</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number MINUS">-</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">5.0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xfffffffb</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">bor</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">2.0</span><span class="Punctuator Token Number CARET">^</span><span class="Token Number NUMBER">48</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number MINUS">-</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">6.0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0xfffffffa</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Token String STR">&#x27;OK&#x27;</span></code></pre><h2 id="h2-10"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/10.lua" target="_blank">10.lua</a></h2><pre class="language-lua"><code><span class="Token COMMENT">-- BUG: built in function 无法识别</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">tonumber</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">tointeger</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">tonumber</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">tointeger</span><span class="Identifier TableKey Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">type</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">getmetatable</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">rawget</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">error</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">type</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">getmetatable</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">rawget</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">error</span><span class="Identifier Token Variable LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">strsub</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">sub</span><span class="Identifier TableKey Token VarSuffix LF">
</span><span class="Identifier TableKey Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">print</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable ID">_ENV</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token LF">
</span><span class="Keyword Token COMMENT">-- Try to convert a value to an integer, without assuming any coercion.</span><span class="Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">toint</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">tonumber</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">   </span><span class="Argument Token VarSuffix COMMENT">-- handle numerical strings</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Keyword Token FALSE">false</span><span class="Keyword Token SPACE">    </span><span class="Keyword Token COMMENT">-- not coercible to a number</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">tointeger</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody COMMENT">-- If operation fails, maybe second operand has a metamethod that should</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody COMMENT">-- have been called if not for this string metamethod, so try to</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody COMMENT">-- call it.</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">trymt</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">mtname</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">y</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;string&quot;</span><span class="Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token COMMENT">-- avoid recalling original metamethod</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">mt</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">getmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">y</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">mm</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">mt</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">rawget</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">mt</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">mtname</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">mm</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">mm</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- if any test fails, there is no other metamethod to be called</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">error</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;attempt to &#x27;&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token CONCAT">..</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">strsub</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">mtname</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token CONCAT">..</span><span class="Punctuator Expression Token LF">
</span><span class="Punctuator Expression Token SPACE">        </span><span class="Token String STR">&quot;&#x27; a &quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token CONCAT">..</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token CONCAT">..</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot; with a &quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token CONCAT">..</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">y</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">checkargs</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">mtname</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">xi</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">toint</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">yi</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">toint</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">y</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">xi</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">yi</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">xi</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">yi</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">trymt</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">mtname</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">smt</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">getmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">smt</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionName Token TableKey VarSuffix ID">__band</span><span class="Identifier FunctionName Token TableKey VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">y</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">checkargs</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;__band&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token OR">or</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier Token Variable ID">smt</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionName Token TableKey VarSuffix ID">__bor</span><span class="Identifier FunctionName Token TableKey VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">y</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">checkargs</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;__bor&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PIPE">|</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token OR">or</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier Token Variable ID">smt</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionName Token TableKey VarSuffix ID">__bxor</span><span class="Identifier FunctionName Token TableKey VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">y</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">checkargs</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;__bxor&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token TILDE">~</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token OR">or</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier Token Variable ID">smt</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionName Token TableKey VarSuffix ID">__shl</span><span class="Identifier FunctionName Token TableKey VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">y</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">checkargs</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;__shl&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token SHL">&lt;&lt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token OR">or</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier Token Variable ID">smt</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionName Token TableKey VarSuffix ID">__shr</span><span class="Identifier FunctionName Token TableKey VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">y</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">checkargs</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;__shr&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token SHR">&gt;&gt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token OR">or</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier Token Variable ID">smt</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionName Token TableKey VarSuffix ID">__bnot</span><span class="Identifier FunctionName Token TableKey VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">y</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">checkargs</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;__bnot&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Punctuator Expression Token TILDE">~</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token OR">or</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable LF">
</span><span class="Keyword Token FunctionBody END">end</span></code></pre><h2 id="h2-11"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/11.lua" target="_blank">11.lua</a></h2><pre class="language-lua"><code><span class="Token COMMENT">-- $Id: testes/calls.lua $</span><span class="Token LF">
</span><span class="Token COMMENT">-- See Copyright Notice in file all.lua</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;testing functions and calls&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">debug</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Token String STR">&quot;debug&quot;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token COMMENT">-- get the opportunity to test &#x27;type&#x27; too ;)</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="Punctuator Token Number brace-depth-2 LANGLE_BRACE">&lt;</span><span class="Token Number NUMBER">2</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;boolean&#x27;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token TRUE">true</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;boolean&#x27;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FALSE">false</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;boolean&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;nil&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">   </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">3</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;number&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">   </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="Token String STR">&#x27;x&#x27;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;string&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">   </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="brace-depth-0 Argument Token TableConstructor LCURLY_BRACE">{</span><span class="brace-depth-0 Argument Token TableConstructor RCURLY_BRACE">}</span><span class="Argument Token TableConstructor SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;table&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">   </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">type</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;function&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">f</span><span class="Identifier Statement Token SPACE"> </span><span class="brace-depth-2 Statement Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-2 Statement Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix COLON">:</span><span class="Identifier FunctionCall Token VarSuffix ID">x</span><span class="Identifier FunctionCall Token VarSuffix SPACE"> </span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;function&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">type</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- testing local-function recursion</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">fact</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FALSE">false</span><span class="Keyword Token LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">fact</span><span class="Identifier Statement Token SPACE"> </span><span class="brace-depth-2 Statement Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">n</span><span class="brace-depth-2 Statement Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Punctuator Expression Token MUL">*</span><span class="Identifier FunctionCall Token Variable ID">fact</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">fact</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">5</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">120</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">fact</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token FALSE">false</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">fact</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token LF">
</span><span class="Keyword Token COMMENT">-- testing declarations</span><span class="Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Token TableConstructor brace-depth-2 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">i</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Token Number Field NUMBER">10</span><span class="Expression Token TableConstructor brace-depth-2 RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">self</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Number LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FunctionName FuncName ID">a</span><span class="Statement Token FuncName COLON">:</span><span class="Identifier Token FuncName ID">x</span><span class="Identifier Token FuncName SPACE"> </span><span class="brace-depth-2 Statement Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-2 Statement Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Punctuator Expression Token PLUS">+</span><span class="Identifier Token Variable ID">self</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">i</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FuncName ID">a</span><span class="Statement Token FuncName DOT">.</span><span class="Identifier Token FunctionName FuncName ID">y</span><span class="Identifier Token FunctionName FuncName SPACE"> </span><span class="brace-depth-2 Statement Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-2 Statement Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Punctuator Expression Token PLUS">+</span><span class="Identifier Token Variable ID">self</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix COLON">:</span><span class="Identifier FunctionCall Token VarSuffix ID">x</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Punctuator Expression Token PLUS">+</span><span class="Expression Token Number NUMBER">10</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number EQ">==</span><span class="Punctuator Token Number SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">y</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">t</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Token TableConstructor brace-depth-2 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">i</span><span class="Token Field FieldList ASSIGN">=</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">100</span><span class="Expression Token TableConstructor brace-depth-2 RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token String STR">&quot;t&quot;</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionName Token TableKey VarSuffix ID">x</span><span class="Identifier FunctionName Token TableKey VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">self</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">self</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">i</span><span class="Punctuator Expression Token PLUS">+</span><span class="Identifier Token Variable ID">a</span><span class="Punctuator Expression Token PLUS">+</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">t</span><span class="Token VarSuffix COLON">:</span><span class="Identifier FunctionCall Token VarSuffix ID">x</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">3</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">95</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">x</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Number Field NUMBER">0</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FunctionName FuncName ID">a</span><span class="Statement Token FuncName COLON">:</span><span class="Identifier Token FuncName ID">add</span><span class="Identifier Token FuncName SPACE"> </span><span class="brace-depth-2 Statement Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-2 Statement Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Identifier Token Variable ID">self</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix ID">y</span><span class="Identifier Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">self</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">x</span><span class="Punctuator Expression Token PLUS">+</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">self</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix COLON">:</span><span class="Identifier FunctionCall Token VarSuffix ID">add</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Token VarSuffix COLON">:</span><span class="Identifier FunctionCall Token VarSuffix ID">add</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">20</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Token VarSuffix COLON">:</span><span class="Identifier FunctionCall Token VarSuffix ID">add</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">30</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">x</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">60</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">y</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">20</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Token TableConstructor brace-depth-2 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">b</span><span class="Token Field FieldList ASSIGN">=</span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">c</span><span class="Token Field FieldList ASSIGN">=</span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor brace-depth-2 RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FuncName ID">a</span><span class="Statement Token FuncName DOT">.</span><span class="Identifier Token FuncName ID">b</span><span class="Statement Token FuncName DOT">.</span><span class="Identifier Token FuncName ID">c</span><span class="Statement Token FuncName DOT">.</span><span class="Identifier Token FunctionName FuncName ID">f1</span><span class="Identifier Token FunctionName FuncName SPACE"> </span><span class="brace-depth-2 Statement Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-2 Statement Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Punctuator Expression Token PLUS">+</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FuncName ID">a</span><span class="Statement Token FuncName DOT">.</span><span class="Identifier Token FuncName ID">b</span><span class="Statement Token FuncName DOT">.</span><span class="Identifier Token FunctionName FuncName ID">c</span><span class="Statement Token FuncName COLON">:</span><span class="Identifier Token FuncName ID">f2</span><span class="Identifier Token FuncName SPACE"> </span><span class="brace-depth-2 Statement Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Identifier Token ID">y</span><span class="brace-depth-2 Statement Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Identifier Token Variable ID">self</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">x</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">b</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">c</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">f1</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">4</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">5</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">b</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">c</span><span class="Token VarSuffix COLON">:</span><span class="Identifier FunctionCall Token VarSuffix ID">f2</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;k&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">12</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">b</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">c</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">k</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">12</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;+&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token SPACE">   </span><span class="Keyword Token COMMENT">-- &#x27;declare&#x27; t</span><span class="Keyword Token LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FunctionName FuncName ID">f</span><span class="brace-depth-2 Statement Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token ID">c</span><span class="brace-depth-2 Statement Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">d</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&#x27;a&#x27;</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Statement Token ASSIGN">=</span><span class="Expression Token TableConstructor brace-depth-2 LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">a</span><span class="Punctuator Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Punctuator Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Punctuator Token COMMA">,</span><span class="Identifier Token Variable ID">d</span><span class="Expression Token TableConstructor brace-depth-2 RCURLY_BRACE">}</span><span class="Expression Token TableConstructor SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Argument Token VarSuffix SPACE">      </span><span class="Argument Token VarSuffix COMMENT">-- this line change must be valid</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">2</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">3</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="Expression Keyword Token SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">4</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;a&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE">   </span><span class="Token COMMENT">-- this one too</span><span class="Token LF">
</span><span class="Token SPACE">      </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">4</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">3</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">4</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;a&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token SPACE">   </span><span class="Keyword Token COMMENT">-- delete &#x27;t&#x27;</span><span class="Keyword Token LF">
</span><span class="Keyword Token LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FunctionName FuncName ID">fat</span><span class="brace-depth-2 Statement Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-2 Statement Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token LE">&lt;=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Punctuator Expression Token MUL">*</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;return fat(&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token CONCAT">..</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number CONCAT">..</span><span class="Punctuator Token Number SPACE"> </span><span class="Token String STR">&quot;)&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Token String STR">&quot;load &#x27;assert(fat(6)==720)&#x27; () &quot;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;return fat(5), 3&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">120</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">fat</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;+&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">err_on_n</span><span class="Identifier Statement Token SPACE"> </span><span class="brace-depth-2 Statement Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">n</span><span class="brace-depth-2 Statement Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">error</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">exit</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">err_on_n</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">exit</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">dummy</span><span class="Identifier Statement Token SPACE"> </span><span class="brace-depth-2 Statement Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">n</span><span class="brace-depth-2 Statement Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token brace-depth-2 RANGLE_BRACE">&gt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">err_on_n</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">      </span><span class="Identifier FunctionCall Token Variable ID">dummy</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">dummy</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">deep</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token SPACE">   </span><span class="Keyword Token COMMENT">-- &quot;declaration&quot;  (used by &#x27;all.lua&#x27;)</span><span class="Keyword Token LF">
</span><span class="Keyword Token LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FunctionName FuncName ID">deep</span><span class="Identifier Token FunctionName FuncName SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">n</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Punctuator Expression Token brace-depth-0 RANGLE_BRACE">&gt;</span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">deep</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">deep</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">deep</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">180</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Token String STR">&quot;testing tail calls&quot;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FunctionName FuncName ID">deep</span><span class="Identifier Token FunctionName FuncName SPACE"> </span><span class="Statement Token FunctionBody brace-depth-1 LPAREN">(</span><span class="Identifier Token ID">n</span><span class="Statement Token FunctionBody brace-depth-1 RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Punctuator Expression Token brace-depth-1 RANGLE_BRACE">&gt;</span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">deep</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">101</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">deep</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">30000</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">101</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Token TableConstructor brace-depth-2 LCURLY_BRACE">{</span><span class="Expression Token TableConstructor brace-depth-2 RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FunctionName FuncName ID">a</span><span class="Statement Token FuncName COLON">:</span><span class="Identifier Token FuncName ID">deep</span><span class="Identifier Token FuncName SPACE"> </span><span class="brace-depth-2 Statement Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">n</span><span class="brace-depth-2 Statement Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Punctuator Expression Token brace-depth-2 RANGLE_BRACE">&gt;</span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">self</span><span class="Token VarSuffix COLON">:</span><span class="Identifier FunctionCall Token VarSuffix ID">deep</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">101</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix COLON">:</span><span class="Identifier FunctionCall Token VarSuffix ID">deep</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">30000</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">101</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- tail calls x varargs</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">foo</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token FunctionBody ParameterList COMMA">,</span><span class="Token FunctionBody ParameterList SPACE"> </span><span class="Punctuator Token ParameterList VARARGS">...</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Punctuator Expression Token VARARGS">...</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">foo1</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">c</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo1</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">2</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- tail calls x metamethods</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__call</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Identifier Token Variable ID">foo</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">foo2</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">t</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo2</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">100</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">100</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token Variable LPAREN">(</span><span class="Keyword Token FunctionCall FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionCall FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token FunctionCall ReturnStatment RETURN">return</span><span class="Keyword Token FunctionCall ReturnStatment SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="FunctionCall Keyword Token FunctionBody END">end</span><span class="Expression brace-depth-0 Token Variable RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="Expression Keyword Token SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">X</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">Y</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">A</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">foo</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="Token FunctionBody ParameterList COMMA">,</span><span class="Token FunctionBody ParameterList SPACE"> </span><span class="Punctuator Token ParameterList VARARGS">...</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Identifier Token Variable ID">X</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">Y</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Punctuator Expression Token VARARGS">...</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">foo1</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Punctuator Token FunctionBody VARARGS">...</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token VARARGS">...</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">c</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo1</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">X</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="Expression Keyword Token SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">Y</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="Expression Keyword Token SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo1</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">X</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">Y</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="Expression Keyword Token SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo1</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">X</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">Y</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">20</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo1</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">30</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">X</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">Y</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">20</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">A</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">30</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- C-stack overflow while handling C-stack overflow</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">loop</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">loop</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">err</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">msg</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">xpcall</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">loop</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">loop</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">err</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">find</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;error&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- tail calls x chain of __call</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">n</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">10000</span><span class="Token Number SPACE">   </span><span class="Token Number COMMENT">-- depth</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">foo</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">1023</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Keyword Token FunctionBody COMMENT">-- build a chain of __call metamethods ending in function &#x27;foo&#x27;</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">100</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">foo</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__call</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Identifier Token Variable ID">foo</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- call the first one as a tail call in a new coroutine</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- (to ensure stack is not preallocated)</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">coroutine</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">wrap</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1023</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;+&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- testing chains of &#x27;__call&#x27;</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">N</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">u</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">table</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">pack</span><span class="Identifier TableKey Token VarSuffix LF">
</span><span class="Identifier TableKey Token VarSuffix SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">N</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">u</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">i</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__call</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Identifier Token Variable ID">u</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">Res</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">u</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;a&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;b&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;c&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">Res</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">n</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">N</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">N</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">Res</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">Res</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">N</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;a&quot;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">Res</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">N</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;b&quot;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">Res</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">N</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;c&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="brace-depth-0 Token Variable LPAREN">(</span><span class="Keyword Token FunctionCall FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionCall FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token FunctionCall ID">x</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="Statement Token ASSIGN">=</span><span class="Identifier FunctionCall Token Variable ID">x</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="FunctionCall Keyword Token FunctionBody END">end</span><span class="brace-depth-0 Token Variable RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">23</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">23</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Keyword Token FunctionCall FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionCall FunctionDefinition SPACE"> </span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token FunctionCall ID">x</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token FunctionCall ReturnStatment RETURN">return</span><span class="Keyword Token FunctionCall ReturnStatment SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">x</span><span class="Punctuator Expression Token FunctionCall MUL">*</span><span class="Expression Token FunctionCall Number NUMBER">2</span><span class="Expression Token FunctionCall Number SPACE"> </span><span class="FunctionCall Keyword Token FunctionBody END">end</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">20</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">40</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- testing closures</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- fixed-point operator</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName FunctionName ID">Z</span><span class="Identifier Token AttributeName FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">le</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">      </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">a</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">f</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">        </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">le</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">      </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">      </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody COMMENT">-- non-recursive factorial</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName FunctionName ID">F</span><span class="Identifier Token AttributeName FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">f</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">      </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">n</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">               </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number LF">
</span><span class="Token Number SPACE">               </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Punctuator Expression Token MUL">*</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">             </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">fat</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">Z</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">F</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">fat</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">fat</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">4</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">24</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">Z</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">F</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">5</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">5</span><span class="Punctuator Token Number MUL">*</span><span class="Identifier FunctionCall Token Variable ID">Z</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">F</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">4</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">g</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">z</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">f</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token ID">c</span><span class="Token COMMA">,</span><span class="Identifier Token ID">d</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Identifier Token ID">y</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Punctuator Expression Token PLUS">+</span><span class="Identifier Token Variable ID">b</span><span class="Punctuator Expression Token PLUS">+</span><span class="Identifier Token Variable ID">c</span><span class="Punctuator Expression Token PLUS">+</span><span class="Identifier Token Variable ID">d</span><span class="Punctuator Expression Token PLUS">+</span><span class="Identifier Token Variable ID">a</span><span class="Punctuator Expression Token PLUS">+</span><span class="Identifier Token Variable ID">x</span><span class="Punctuator Expression Token PLUS">+</span><span class="Identifier Token Variable ID">y</span><span class="Punctuator Expression Token PLUS">+</span><span class="Identifier Token Variable ID">z</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">z</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">z</span><span class="Punctuator Expression Token PLUS">+</span><span class="Expression Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">z</span><span class="Punctuator Expression Token PLUS">+</span><span class="Expression Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">z</span><span class="Punctuator Expression Token PLUS">+</span><span class="Expression Token Number NUMBER">3</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">g</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">9</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">16</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="Punctuator Token Number PLUS">+</span><span class="Token Number NUMBER">11</span><span class="Punctuator Token Number PLUS">+</span><span class="Token Number NUMBER">12</span><span class="Punctuator Token Number PLUS">+</span><span class="Token Number NUMBER">13</span><span class="Punctuator Token Number PLUS">+</span><span class="Token Number NUMBER">10</span><span class="Punctuator Token Number PLUS">+</span><span class="Token Number NUMBER">9</span><span class="Punctuator Token Number PLUS">+</span><span class="Token Number NUMBER">16</span><span class="Punctuator Token Number PLUS">+</span><span class="Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;+&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- testing multiple returns</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">unlpack</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">i</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token OR">or</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number LF">
</span><span class="Expression Token Number SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Expression brace-depth-0 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token LE">&lt;=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">t</span><span class="Expression brace-depth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">unlpack</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Punctuator Expression Token PLUS">+</span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">equaltab</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">t1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">t2</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">t1</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">t2</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">t1</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t1</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">t2</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName FunctionName ID">pack</span><span class="Identifier Token AttributeName FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Punctuator Token FunctionBody VARARGS">...</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Expression brace-depth-0 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">table</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">pack</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Punctuator Expression Token VARARGS">...</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Expression brace-depth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">f</span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">30</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">4</span><span class="Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">ret2</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">b</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">c</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">d</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">unlpack</span><span class="brace-depth-0 Argument Token TableConstructor LCURLY_BRACE">{</span><span class="Token Number Field NUMBER">1</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">3</span><span class="brace-depth-0 Argument Token TableConstructor RCURLY_BRACE">}</span><span class="Argument Token TableConstructor LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">3</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Token Number Field NUMBER">1</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">4</span><span class="Punctuator Token COMMA">,</span><span class="Keyword Token Field FALSE">false</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">10</span><span class="Punctuator Token COMMA">,</span><span class="Token String STR">&#x27;alo&#x27;</span><span class="Punctuator Token COMMA">,</span><span class="Keyword Token Field FALSE">false</span><span class="Punctuator Token COMMA">,</span><span class="Identifier Token Variable ID">assert</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Identifier FunctionCall Token Variable ID">equaltab</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">unlpack</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">equaltab</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">unlpack</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Token Number Field NUMBER">1</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">ret2</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">ret2</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">unlpack</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">ret2</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">ret2</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">unlpack</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">ret2</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token Variable brace-depth-2 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">ret2</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Expression Token Variable brace-depth-2 RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Keyword Token NIL">nil</span><span class="Expression Keyword Token SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">ret2</span><span class="brace-depth-0 Argument Token TableConstructor LCURLY_BRACE">{</span><span class="Argument Token TableConstructor SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">unlpack</span><span class="Argument Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Token Number Field NUMBER">1</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">3</span><span class="Argument Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">unlpack</span><span class="Argument Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Token Number Field NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">1</span><span class="Argument Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">unlpack</span><span class="Argument Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Token String STR">&quot;a&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token String STR">&quot;b&quot;</span><span class="Argument Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token TableConstructor RCURLY_BRACE">}</span><span class="Argument Token TableConstructor LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">3</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;a&quot;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">4</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;b&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- testing calls with &#x27;incorrect&#x27; arguments</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">rawget</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;x&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">rawset</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;x&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">sin</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">2</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">sin</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">table</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">sort</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Token Number Field NUMBER">10</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">9</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">8</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">4</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">19</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">23</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">0</span><span class="Punctuator Token COMMA">,</span><span class="Token Number Field NUMBER">0</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Punctuator Expression Token brace-depth-1 LANGLE_BRACE">&lt;</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;extra arg&quot;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- test for generic load</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;-- a comment\0\0\0</span><span class="Control Token String STR">\n</span><span class="Token String STR">  x = 10 + </span><span class="Control Token String STR">\n</span><span class="Token String STR">23; \
     local a = function () x = &#x27;hi&#x27; end; \
     return &#x27;\0&#x27;&quot;</span><span class="Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">read1</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">i</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Identifier Token Variable ID">i</span><span class="Punctuator Expression Token PLUS">+</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number LF">
</span><span class="Expression Token Number SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">sub</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">cannotload</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">find</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">msg</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">read1</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;modname&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;t&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;\0&quot;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">x</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">33</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">getinfo</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">source</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;modname&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- cannot read text in binary mode</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">cannotload</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;attempt to load a text chunk&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">read1</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;modname&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;b&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token TableConstructor brace-depth-2 LCURLY_BRACE">{</span><span class="Expression Token TableConstructor brace-depth-2 RCURLY_BRACE">}</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">cannotload</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;attempt to load a text chunk&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;modname&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;b&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- empty chunk</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- small bug</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Keyword Token Field NIL">nil</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token String STR">&quot;return &quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token String STR">&quot;3&quot;</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">msg</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">table</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">remove</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">   </span><span class="Argument Token VarSuffix COMMENT">-- should read the empty chunk</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- another small bug (in 5.2.1)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">dump</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;b&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;function&quot;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- another bug (in 5.4.0)</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- loading a binary long string interrupted by GC cycles</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">dump</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token String STR">&#x27;01234567890123456789012345678901234567890123456789&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">read1</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;01234567890123456789012345678901234567890123456789&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- another bug (since 5.2)</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- corrupted binary dump: list of upvalue names is larger than number</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- of upvalues, overflowing the array of upvalues.</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">code</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">   </span><span class="Token String STR">&quot;\x1b\x4c\x75\x61\x54\x00\x19\x93\x0d\x0a\x1a\x0a\x04\x08\x08\x78\x56\z
    \x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x28\x77\x40\x00\x86\x40\z
    \x74\x65\x6d\x70\x81\x81\x01\x00\x02\x82\x48\x00\x02\x00\xc7\x00\x01\z
    \x00\x80\x80\x80\x82\x00\x00\x80\x81\x82\x78\x80\x82\x81\x86\x40\x74\z
    \x65\x6d\x70&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">code</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">   </span><span class="Argument Token VarSuffix COMMENT">-- segfaults in previous versions</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">dump</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;x = 1; return x&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">read1</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;b&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">x</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">cannotload</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;attempt to load a binary chunk&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">read1</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;t&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">cannotload</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;attempt to load a binary chunk&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;t&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">x</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">dump</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- no dump of C functions</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">cannotload</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;unexpected symbol&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">read1</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;*a = 123&quot;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">cannotload</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;unexpected symbol&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;*a = 123&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">cannotload</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;hhi&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">error</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;hhi&quot;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- any value is valid for _ENV</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;return _ENV&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">123</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">123</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- load when _ENV is not first upvalue</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">XX</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">123</span><span class="Token Number LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">h</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">y</span><span class="Statement Token ASSIGN">=</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE">   </span><span class="Identifier Token Variable COMMENT">-- use &#x27;x&#x27;, so that it becomes 1st upvalue</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">XX</span><span class="Identifier Token Variable SPACE">   </span><span class="Identifier Token Variable COMMENT">-- global name</span><span class="Identifier Token Variable LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">d</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">dump</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">h</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">d</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;b&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">getupvalue</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;_ENV&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">setupvalue</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">x</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">123</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;return XX + ...&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">XX</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Token Number Field NUMBER">13</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">4</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">17</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">XX</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token LF">
</span><span class="Keyword Token COMMENT">-- test generic load with nested functions</span><span class="Keyword Token LF">
</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">[[
  return function (x)
    return function (y)
     return function (z)
       return x+y+z
     end
   end
  end
]]</span><span class="Token LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">read1</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;read&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;t&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">2</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">3</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">15</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- repeat the test loading a binary chunk</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">dump</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">read1</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;read&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;b&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">2</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">3</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">15</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- test for dump/undump with upvalues</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">30</span><span class="Token Number LF">
</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">dump</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;set&quot;</span><span class="Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Punctuator Token Number PLUS">+</span><span class="Identifier Token Variable ID">b</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Punctuator Expression Token PLUS">+</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">  </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;b&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">x</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">setupvalue</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;hi&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;a&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">x</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;hi&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">setupvalue</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">13</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;b&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">setupvalue</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">   </span><span class="Argument Token VarSuffix COMMENT">-- only 2 upvalues</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">x</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;set&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">x</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">23</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">x</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;set&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">x</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">24</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- test for dump/undump with many upvalues</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">nup</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">200</span><span class="Token Number SPACE">    </span><span class="Token Number COMMENT">-- maximum number of local variables</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">prog</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Token String STR">&quot;local a1&quot;</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">nup</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;, a&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token CONCAT">..</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot; = 1&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">nup</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;, &quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token CONCAT">..</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">sum</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;; return function () return a1&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">nup</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot; + a&quot;</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token CONCAT">..</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">sum</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">sum</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot; end&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">table</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">concat</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">sum</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">dump</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">   </span><span class="Argument Token VarSuffix COMMENT">-- main chunk now has many upvalues</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName FunctionName ID">h</span><span class="Identifier Token AttributeName FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">nup</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvaluejoin</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">h</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number MUL">*</span><span class="Punctuator Token Number SPACE"> </span><span class="Identifier Token Variable ID">nup</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- test for long method names</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Token TableConstructor brace-depth-2 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">x</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Token Number Field NUMBER">1</span><span class="Expression Token TableConstructor brace-depth-2 RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FunctionName FuncName ID">t</span><span class="Statement Token FuncName COLON">:</span><span class="Identifier Token FuncName ID">_012345678901234567890123456789012345678901234567890123456789</span><span class="Identifier Token FuncName SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">self</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">x</span><span class="Identifier TableKey Token VarSuffix LF">
</span><span class="Identifier TableKey Token VarSuffix SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix COLON">:</span><span class="Identifier FunctionCall Token VarSuffix ID">_012345678901234567890123456789012345678901234567890123456789</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- test for bug in parameter adjustment</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Keyword Token FunctionCall FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionCall FunctionDefinition SPACE"> </span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token FunctionCall ReturnStatment RETURN">return</span><span class="Keyword Token FunctionCall ReturnStatment SPACE"> </span><span class="Keyword Token FunctionCall NIL">nil</span><span class="Keyword Token FunctionCall SPACE"> </span><span class="FunctionCall Keyword Token FunctionBody END">end</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">4</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Keyword Token FunctionCall FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionCall FunctionDefinition SPACE"> </span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Statement Keyword Token FunctionCall LOCAL">local</span><span class="Statement Keyword Token FunctionCall SPACE"> </span><span class="Identifier Token FunctionCall AttributeName ID">a</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionCall ReturnStatment RETURN">return</span><span class="Keyword Token FunctionCall ReturnStatment SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="FunctionCall Keyword Token FunctionBody END">end</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">4</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Keyword Token FunctionCall FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionCall FunctionDefinition SPACE"> </span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token FunctionCall ID">a</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token FunctionCall ReturnStatment RETURN">return</span><span class="Keyword Token FunctionCall ReturnStatment SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="FunctionCall Keyword Token FunctionBody END">end</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;testing binary chunks&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">header</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">pack</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;c4BBc6BBB&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&quot;\27Lua&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE">                                  </span><span class="Token COMMENT">-- signature</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token Number NUMBER">0x54</span><span class="Token COMMA">,</span><span class="Token SPACE">                                      </span><span class="Token COMMENT">-- version 5.4 (0x54)</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE">                                         </span><span class="Token COMMENT">-- format</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&quot;\x19\x93\r</span><span class="Control Token String STR">\n</span><span class="Token String STR">\x1a</span><span class="Control Token String STR">\n</span><span class="Token String STR">&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE">                      </span><span class="Token COMMENT">-- data</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE">                                         </span><span class="Token COMMENT">-- size of instruction</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">packsize</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;j&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE">                      </span><span class="Token COMMENT">-- sizeof(lua integer)</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">packsize</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;n&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE">                       </span><span class="Argument Token VarSuffix COMMENT">-- sizeof(lua number)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">c</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">dump</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName FunctionName ID">f</span><span class="Identifier Token AttributeName FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">_ENV</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">c</span><span class="ReturnStatment Token Block SEMI">;</span><span class="ReturnStatment Token Block SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Keyword Token FunctionBody COMMENT">-- upvalues</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">s1</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;a constant&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">s2</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;another constant&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MUL">*</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3</span><span class="Expression Token Number LF">
</span><span class="Expression Token Number SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- check header</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">sub</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">header</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">header</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- check LUAC_INT and LUAC_NUM</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">ci</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">cn</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">unpack</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;jn&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">header</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">ci</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0x5678</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">cn</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">370.5</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- corrupted header</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">header</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">s</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">sub</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token CONCAT">..</span><span class="Punctuator Expression Token LF">
</span><span class="Punctuator Expression Token SPACE">              </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">char</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">byte</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">sub</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token CONCAT">..</span><span class="Punctuator Expression Token LF">
</span><span class="Punctuator Expression Token SPACE">              </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">sub</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">s</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">c</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">s</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- loading truncated binary chunks</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">st</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">msg</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">sub</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">st</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">find</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;truncated&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;OK&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">deep</span></code></pre><h2 id="h2-12"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/12.lua" target="_blank">12.lua</a></h2><pre class="language-lua"><code><span class="Token COMMENT">-- $Id: testes/closure.lua $</span><span class="Token LF">
</span><span class="Token COMMENT">-- See Copyright Notice in file all.lua</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Token String STR">&quot;testing closures&quot;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">A</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">B</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">g</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Number Field NUMBER">10</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">f</span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Token Number NUMBER">1000</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">y</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Identifier Token Variable ID">B</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">g</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">B</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">g</span><span class="Punctuator Expression Token PLUS">+</span><span class="Expression Token Number NUMBER">1</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Punctuator Expression Token PLUS">+</span><span class="Identifier Token Variable ID">x</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Punctuator Expression Token PLUS">+</span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName FunctionName ID">dummy</span><span class="Identifier Token AttributeName FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">A</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">dummy</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">3</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">B</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">g</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">12</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- force a GC in this level</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Token brace-depth-1 Field FieldList LSQUAR_PAREN">[</span><span class="Token Number Field NUMBER">1</span><span class="Token brace-depth-1 Field FieldList RSQUAR_PAREN">]</span><span class="Token Field FieldList SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor SPACE">   </span><span class="Expression Token TableConstructor COMMENT">-- to detect a GC</span><span class="Expression Token TableConstructor LF">
</span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__mode</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Token String STR">&#x27;kv&#x27;</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token WHILE">while</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- repeat until GC</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">A</span><span class="Punctuator Expression Token CONCAT">..</span><span class="Identifier Token Variable ID">A</span><span class="Punctuator Expression Token CONCAT">..</span><span class="Identifier Token Variable ID">A</span><span class="Punctuator Expression Token CONCAT">..</span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable COMMENT">-- create garbage</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">A</span><span class="Punctuator Expression Token PLUS">+</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">20</span><span class="Punctuator Token Number PLUS">+</span><span class="Identifier Token Variable ID">A</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">30</span><span class="Punctuator Token Number PLUS">+</span><span class="Identifier Token Variable ID">A</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="Punctuator Token Number PLUS">+</span><span class="Identifier Token Variable ID">A</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">20</span><span class="Punctuator Token Number PLUS">+</span><span class="Identifier Token Variable ID">A</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">30</span><span class="Punctuator Token Number PLUS">+</span><span class="Identifier Token Variable ID">A</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">3</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">20</span><span class="Punctuator Token Number PLUS">+</span><span class="Identifier Token Variable ID">A</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">8</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="Punctuator Token Number PLUS">+</span><span class="Identifier Token Variable ID">A</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">getmetatable</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">__mode</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;kv&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">B</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">g</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">19</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- testing equality</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">_ENV</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">3</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">4</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">4</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">5</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName FunctionName ID">a</span><span class="Identifier Token AttributeName FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE">  </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">sin</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">_ENV</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">x</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">f</span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- testing closures with &#x27;for&#x27; control variable</span><span class="Statement Keyword Token LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Token Number NUMBER">10</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">set</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Identifier Token Field ID">get</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token BREAK">break</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">4</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">undef</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">set</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">get</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">set</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;a&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">3</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">get</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">get</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;a&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Token String STR">&quot;a&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token String STR">&quot;b&quot;</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">k</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix LF">
</span><span class="Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Field ID">set</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Identifier Token Variable ID">x</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">k</span><span class="Statement Token ASSIGN">=</span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">          </span><span class="Identifier Token Field ID">get</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">k</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token BREAK">break</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">set</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">r</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">s</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">get</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">r</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">s</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;b&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">r</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">s</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">get</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">r</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">s</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">20</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">set</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;a&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;b&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">r</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">s</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">get</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">r</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;a&quot;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">s</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;b&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- testing closures with &#x27;for&#x27; control variable x break</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Token Number NUMBER">3</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable FunctionName ID">f</span><span class="Identifier Token Variable FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token BREAK">break</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">k</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">v</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">k</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix LF">
</span><span class="Token VarSuffix SPACE">  </span><span class="Identifier Token Variable FunctionName ID">f</span><span class="Identifier Token Variable FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">k</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">v</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token BREAK">break</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Expression Token TableConstructor brace-depth-2 LCURLY_BRACE">{</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Expression Token TableConstructor brace-depth-2 RCURLY_BRACE">}</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Expression Token TableConstructor brace-depth-2 LCURLY_BRACE">{</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Expression Token TableConstructor brace-depth-2 RCURLY_BRACE">}</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;a&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- testing closure x break x return x errors</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FunctionName FuncName ID">f</span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">first</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Statement Keyword Token WHILE">while</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Token Number NUMBER">1</span><span class="Statement Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">first</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&#x27;xuxu&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Identifier Token Variable FunctionName ID">b</span><span class="Identifier Token Variable FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">op</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">          </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">op</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;set&#x27;</span><span class="Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">            </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Punctuator Expression Token PLUS">+</span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">          </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">            </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">          </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">        </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token BREAK">break</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Keyword Token ElseIfStatement ELSEIF">elseif</span><span class="Keyword Token ElseIfStatement SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token ElseIfStatement THEN">then</span><span class="Keyword Token ElseIfStatement SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment LF">
</span><span class="Keyword Token ReturnStatment SPACE">    </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">error</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">first</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Token Number NUMBER">3</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">b</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&#x27;get&#x27;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;xuxu&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;set&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">b</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&#x27;get&#x27;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="Punctuator Token Number PLUS">+</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">b</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&#x27;get&#x27;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&#x27;xuxu&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;set&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">b</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&#x27;get&#x27;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">14</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">y</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">w</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName COMMENT">-- testing multi-level closure</span><span class="Identifier Token AttributeName LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token FunctionName FuncName ID">f</span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">y</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">z</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">w</span><span class="Punctuator Expression Token PLUS">+</span><span class="Identifier Token Variable ID">x</span><span class="Punctuator Expression Token PLUS">+</span><span class="Identifier Token Variable ID">y</span><span class="Punctuator Expression Token PLUS">+</span><span class="Identifier Token Variable ID">z</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">w</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1.345</span><span class="Token Number LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">y</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">20</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token Number NUMBER">30</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">60</span><span class="Punctuator Token Number PLUS">+</span><span class="Identifier Token Variable ID">w</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- testing closures x break</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">X</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">Y</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">sin</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token WHILE">while</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token Variable FunctionName ID">X</span><span class="Identifier Token Variable FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody SPACE">   </span><span class="Keyword Token FunctionBody COMMENT">-- closure with upvalue</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token BREAK">break</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token Variable FunctionName ID">Y</span><span class="Identifier Token Variable FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody SPACE">   </span><span class="Keyword Token FunctionBody COMMENT">-- closure with upvalue</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- upvalues must be different</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">X</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">Y</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">20</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- testing closures x repeat-until</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">i</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number LF">
</span><span class="Statement Keyword Token REPEAT">repeat</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Punctuator Expression Token PLUS">+</span><span class="Expression Token Number NUMBER">1</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token UNTIL">until</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token brace-depth-0 RANGLE_BRACE">&gt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number OR">or</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">11</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">3</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">4</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- testing closures created in &#x27;then&#x27; and &#x27;else&#x27; parts of &#x27;if&#x27;s</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MOD">%</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number EQ">==</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">y</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Keyword Token ElseIfStatement ELSEIF">elseif</span><span class="Keyword Token ElseIfStatement SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MOD">%</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number EQ">==</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE"> </span><span class="Keyword Token ElseIfStatement THEN">then</span><span class="Keyword Token ElseIfStatement LF">
</span><span class="Keyword Token ElseIfStatement SPACE">    </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">L1</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">error</span><span class="Token String STR">&#x27;not here&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">L1</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token LF">
</span><span class="Statement Label Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">y</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Keyword Token ElseIfStatement ELSEIF">elseif</span><span class="Keyword Token ElseIfStatement SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MOD">%</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number EQ">==</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Keyword Token ElseIfStatement THEN">then</span><span class="Keyword Token ElseIfStatement LF">
</span><span class="Keyword Token ElseIfStatement SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">    </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l4</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">    </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l4a</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l4b</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">error</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;should never be here!&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l4</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token LF">
</span><span class="Statement Label Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">y</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token Variable FunctionName ID">t</span><span class="Identifier Token Variable FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l4a</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">error</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;should never be here!&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l4b</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token LF">
</span><span class="Statement Label Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MUL">*</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MOD">%</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MUL">*</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Token String STR">&#x27;+&#x27;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token COMMENT">-- test for correctly closing upvalues in tail calls of vararg functions</span><span class="Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">t</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-1 LPAREN">(</span><span class="Statement Token FunctionBody brace-depth-1 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">c</span><span class="Statement Token FunctionBody brace-depth-1 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="Statement Token FunctionBody brace-depth-1 RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Punctuator Expression Token EQ">==</span><span class="Token String STR">&quot;test&quot;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Punctuator Expression Token EQ">==</span><span class="Token String STR">&quot;OK&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">v</span><span class="Statement Token FunctionBody brace-depth-1 LPAREN">(</span><span class="Identifier Token ID">f</span><span class="Token FunctionBody ParameterList COMMA">,</span><span class="Token FunctionBody ParameterList SPACE"> </span><span class="Punctuator Token ParameterList VARARGS">...</span><span class="Statement Token FunctionBody brace-depth-1 RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">c</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;test&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Token String STR">&quot;FAILED&quot;</span><span class="Token SPACE"> </span><span class="Expression Keyword Token OR">or</span><span class="Expression Keyword Token SPACE"> </span><span class="Token String STR">&quot;OK&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">v</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">t</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- test for debug manipulation of upvalues</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">debug</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&#x27;debug&#x27;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">foo1</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">foo2</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">foo3</span><span class="Identifier Token AttributeName LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">c</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">7</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Identifier Token Variable FunctionName ID">foo1</span><span class="Identifier Token Variable FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Punctuator Expression Token PLUS">+</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Identifier Token Variable FunctionName ID">foo2</span><span class="Identifier Token Variable FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Punctuator Expression Token PLUS">+</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token Variable FunctionName ID">foo3</span><span class="Identifier Token Variable FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Punctuator Expression Token PLUS">+</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalueid</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalueid</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalueid</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalueid</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalueid</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">foo2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalueid</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalueid</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">foo2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalueid</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">foo3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalueid</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalueid</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">foo3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalueid</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalueid</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">foo3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalueid</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">gmatch</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;x&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;x&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">foo1</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number PLUS">+</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo2</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">5</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number PLUS">+</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvaluejoin</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">foo1</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number PLUS">+</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo2</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">5</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number PLUS">+</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">foo3</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number PLUS">+</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvaluejoin</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">foo3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">foo3</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number PLUS">+</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvaluejoin</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">foo3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">foo3</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number PLUS">+</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">upvaluejoin</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">upvaluejoin</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">upvaluejoin</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">upvaluejoin</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">upvaluejoin</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">upvaluejoin</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Token String STR">&#x27;OK&#x27;</span></code></pre><h2 id="h2-13"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/13.lua" target="_blank">13.lua</a></h2><pre class="language-lua"><code><span class="Token COMMENT">-- $Id: testes/code.lua $</span><span class="Token LF">
</span><span class="Token COMMENT">-- See Copyright Notice in file all.lua</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Punctuator Expression Token EQ">==</span><span class="Expression Keyword Token NIL">nil</span><span class="Expression Keyword Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="brace-depth-0 Token Variable LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">Message</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Expression Keyword Token FunctionCall OR">or</span><span class="Expression Keyword Token FunctionCall SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="brace-depth-0 Token Variable RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&#x27;</span><span class="Control Token String STR">\n</span><span class="Token String STR"> &gt;&gt;&gt; testC not active: skipping opcode tests &lt;&lt;&lt;</span><span class="Control Token String STR">\n</span><span class="Token String STR">&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment LF">
</span><span class="Keyword Token ReturnStatment SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Token String STR">&quot;testing code generation and optimizations&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token COMMENT">-- to test constant propagation</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">k0aux</span><span class="Identifier Token AttributeName SPACE"> </span><span class="brace-depth-0 Token Attribute AttributeName LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="brace-depth-0 Token Attribute AttributeName RANGLE_BRACE">&gt;</span><span class="Token Attribute AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">k0</span><span class="Identifier Token AttributeName SPACE"> </span><span class="brace-depth-0 Token Attribute AttributeName LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="brace-depth-0 Token Attribute AttributeName RANGLE_BRACE">&gt;</span><span class="Token Attribute AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">k0aux</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">k1</span><span class="Identifier Token AttributeName SPACE"> </span><span class="brace-depth-0 Token Attribute AttributeName LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="brace-depth-0 Token Attribute AttributeName RANGLE_BRACE">&gt;</span><span class="Token Attribute AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">k3</span><span class="Identifier Token AttributeName SPACE"> </span><span class="brace-depth-0 Token Attribute AttributeName LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="brace-depth-0 Token Attribute AttributeName RANGLE_BRACE">&gt;</span><span class="Token Attribute AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">k6</span><span class="Identifier Token AttributeName SPACE"> </span><span class="brace-depth-0 Token Attribute AttributeName LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="brace-depth-0 Token Attribute AttributeName RANGLE_BRACE">&gt;</span><span class="Token Attribute AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">k3</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression brace-depth-0 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">k3</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token SHL">&lt;&lt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">k0</span><span class="Expression brace-depth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">kFF0</span><span class="Identifier Token AttributeName SPACE"> </span><span class="brace-depth-0 Token Attribute AttributeName LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="brace-depth-0 Token Attribute AttributeName RANGLE_BRACE">&gt;</span><span class="Token Attribute AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0xFF0</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">k3_78</span><span class="Identifier Token AttributeName SPACE"> </span><span class="brace-depth-0 Token Attribute AttributeName LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="brace-depth-0 Token Attribute AttributeName RANGLE_BRACE">&gt;</span><span class="Token Attribute AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">3.78</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">k3_78_4</span><span class="Identifier Token AttributeName SPACE"> </span><span class="brace-depth-0 Token Attribute AttributeName LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="brace-depth-0 Token Attribute AttributeName RANGLE_BRACE">&gt;</span><span class="Token Attribute AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">k3_78</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token DIV">/</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">4</span><span class="Expression Token Number LF">
</span><span class="Expression Token Number SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">kx</span><span class="Identifier Token AttributeName SPACE"> </span><span class="brace-depth-0 Token Attribute AttributeName LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="brace-depth-0 Token Attribute AttributeName RANGLE_BRACE">&gt;</span><span class="Token Attribute AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;x&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">kTrue</span><span class="Identifier Token AttributeName SPACE"> </span><span class="brace-depth-0 Token Attribute AttributeName LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="brace-depth-0 Token Attribute AttributeName RANGLE_BRACE">&gt;</span><span class="Token Attribute AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">kFalse</span><span class="Identifier Token AttributeName SPACE"> </span><span class="brace-depth-0 Token Attribute AttributeName LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="brace-depth-0 Token Attribute AttributeName RANGLE_BRACE">&gt;</span><span class="Token Attribute AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FALSE">false</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">kNil</span><span class="Identifier Token AttributeName SPACE"> </span><span class="brace-depth-0 Token Attribute AttributeName LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="brace-depth-0 Token Attribute AttributeName RANGLE_BRACE">&gt;</span><span class="Token Attribute AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Keyword Token COMMENT">-- this code gave an error for the code checker</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">f</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token ID">k</span><span class="Token COMMA">,</span><span class="Identifier Token ID">v</span><span class="Token COMMA">,</span><span class="Identifier Token ID">w</span><span class="Identifier Token SPACE"> </span><span class="Statement Keyword Token IN">in</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- testing reuse in constant table</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">checkKlist</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">func</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">list</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">k</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">listk</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">func</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">k</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">list</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">k</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">k</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">list</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">type</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">k</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">type</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">list</span><span class="brace-depth-2 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-2 Token VarSuffix RSQUAR_PAREN">]</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">foo</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">k3</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0.0</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">7</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number PLUS">+</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">7</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">k3_78</span><span class="Punctuator Expression Token DIV">/</span><span class="Expression Token Number NUMBER">4</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">k3_78_4</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Identifier Token Variable ID">k3_78</span><span class="Punctuator Expression Token DIV">/</span><span class="Expression Token Number NUMBER">4</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">k3_78</span><span class="Punctuator Expression Token DIV">/</span><span class="Expression Token Number NUMBER">4</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">3.78</span><span class="Punctuator Token Number DIV">/</span><span class="Token Number NUMBER">4</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">3.79</span><span class="Punctuator Token Number DIV">/</span><span class="Token Number NUMBER">4</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0.0</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">0</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">k3</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">3.0</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">3.0</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkKlist</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">foo</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Token Number Field NUMBER">3.78</span><span class="Punctuator Token Number DIV">/</span><span class="Token Number NUMBER">4</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">3.78</span><span class="Punctuator Token Number DIV">/</span><span class="Token Number NUMBER">4</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">3.79</span><span class="Punctuator Token Number DIV">/</span><span class="Token Number NUMBER">4</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable FunctionName ID">foo</span><span class="Identifier Token Variable FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">a</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">          </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">100</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number MUL">*</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">1000</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">          </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">100.0</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number MUL">*</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">1000</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">          </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">100</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number MUL">*</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">1000</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">          </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">100</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number MUL">*</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">1000.0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">          </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">100000</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">          </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">100000.0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">          </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">100000</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">          </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">100000.0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">        </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkKlist</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">foo</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Token Number Field NUMBER">100000</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">100000.0</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">100000</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">100000.0</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- floats x integers</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable FunctionName ID">foo</span><span class="Identifier Token Variable FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">a</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1.0</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1.0</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">2.0</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0.0</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1.0</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">2.0</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0.0</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkKlist</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">foo</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Token Number Field NUMBER">1</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">1.0</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">2.0</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">0</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token Number Field NUMBER">0.0</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- testing opcodes</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- check that &#x27;f&#x27; opcodes match &#x27;...&#x27;</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">check</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">f</span><span class="Token FunctionBody ParameterList COMMA">,</span><span class="Token FunctionBody ParameterList SPACE"> </span><span class="Punctuator Token ParameterList VARARGS">...</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">arg</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Punctuator Expression Token VARARGS">...</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">c</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">listcode</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">arg</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">opcode</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">match</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;</span><span class="Token String Format STR">%u</span><span class="Token String STR">%w+&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">      </span><span class="Argument Token VarSuffix COMMENT">-- print(arg[i], opcode)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">      </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">arg</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">opcode</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">arg</span><span class="Punctuator Expression Token PLUS">+</span><span class="Expression Token Number NUMBER">2</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">undef</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Keyword Token FunctionBody COMMENT">-- check that &#x27;f&#x27; opcodes match &#x27;...&#x27; and that &#x27;f(p) == r&#x27;.</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">checkR</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">p</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">r</span><span class="Token FunctionBody ParameterList COMMA">,</span><span class="Token FunctionBody ParameterList SPACE"> </span><span class="Punctuator Token ParameterList VARARGS">...</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">r1</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">p</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">r</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">r1</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">type</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">r</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">type</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">r1</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token VARARGS">...</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Keyword Token FunctionBody COMMENT">-- check that &#x27;a&#x27; and &#x27;b&#x27; has the same opcodes</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">checkequal</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">b</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">listcode</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">listcode</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">gsub</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;%b()&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">   </span><span class="Argument Token VarSuffix COMMENT">-- remove line number</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">      </span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">gsub</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;%b()&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">   </span><span class="Argument Token VarSuffix COMMENT">-- remove line number</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">      </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Keyword Token FunctionBody COMMENT">-- some basic instructions</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE">   </span><span class="Token FunctionBody FunctionDefinition COMMENT">-- function does not create upvalues</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Token Variable brace-depth-1 LPAREN">(</span><span class="Keyword Token FunctionCall FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionCall FunctionDefinition SPACE"> </span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="FunctionCall Keyword Token FunctionBody END">end</span><span class="Token Variable brace-depth-1 RPAREN">)</span><span class="Argument Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Argument Token TableConstructor LF">
</span><span class="Argument Token TableConstructor SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;CLOSURE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;NEWTABLE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;EXTRAARG&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;GETTABUP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;CALL&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">       </span><span class="Token String STR">&#x27;SETLIST&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;CALL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN0&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE">   </span><span class="Token FunctionBody FunctionDefinition COMMENT">-- function creates upvalues</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Token Variable brace-depth-1 LPAREN">(</span><span class="Keyword Token FunctionCall FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionCall FunctionDefinition SPACE"> </span><span class="brace-depth-2 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-2 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token FunctionCall ReturnStatment RETURN">return</span><span class="Keyword Token FunctionCall ReturnStatment SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">x</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="FunctionCall Keyword Token FunctionBody END">end</span><span class="Token Variable brace-depth-1 RPAREN">)</span><span class="Argument Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="Argument Token TableConstructor LF">
</span><span class="Argument Token TableConstructor SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;CLOSURE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;NEWTABLE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;EXTRAARG&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;GETTABUP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;CALL&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">       </span><span class="Token String STR">&#x27;SETLIST&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;CALL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- sequence of LOADNILs</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">kNil</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Attribute AttributeName brace-depth-1 LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="Token Attribute AttributeName brace-depth-1 RANGLE_BRACE">&gt;</span><span class="Token Attribute AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">b</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">c</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">d</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">e</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">g</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">h</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">    </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Statement Token ASSIGN">=</span><span class="Keyword Token NIL">nil</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Statement Token ASSIGN">=</span><span class="Keyword Token NIL">nil</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Statement Token ASSIGN">=</span><span class="Identifier Token Variable ID">kNil</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Statement Token ASSIGN">=</span><span class="Keyword Token NIL">nil</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADNIL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN0&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">b</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">c</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">d</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">1</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token Variable ID">d</span><span class="Statement Token ASSIGN">=</span><span class="Keyword Token NIL">nil</span><span class="Statement Token SEMI">;</span><span class="Identifier Token Variable ID">c</span><span class="Statement Token ASSIGN">=</span><span class="Keyword Token NIL">nil</span><span class="Statement Token SEMI">;</span><span class="Identifier Token Variable ID">b</span><span class="Statement Token ASSIGN">=</span><span class="Keyword Token NIL">nil</span><span class="Statement Token SEMI">;</span><span class="Identifier Token Variable ID">a</span><span class="Statement Token ASSIGN">=</span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADNIL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN0&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">b</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">c</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">d</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">1</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token Variable ID">d</span><span class="Statement Token ASSIGN">=</span><span class="Keyword Token NIL">nil</span><span class="Statement Token SEMI">;</span><span class="Identifier Token Variable ID">c</span><span class="Statement Token ASSIGN">=</span><span class="Keyword Token NIL">nil</span><span class="Statement Token SEMI">;</span><span class="Identifier Token Variable ID">b</span><span class="Statement Token ASSIGN">=</span><span class="Keyword Token NIL">nil</span><span class="Statement Token SEMI">;</span><span class="Identifier Token Variable ID">a</span><span class="Statement Token ASSIGN">=</span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="Expression Keyword Token SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="Expression Keyword Token SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="Expression Keyword Token SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- single return</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token ID">c</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- infinite loops</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Statement Keyword Token WHILE">while</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">kTrue</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN0&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Statement Keyword Token WHILE">while</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Token Number NUMBER">1</span><span class="Statement Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN0&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Statement Keyword Token REPEAT">repeat</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token UNTIL">until</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token TRUE">true</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN0&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- concat optimization</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token ID">c</span><span class="Token COMMA">,</span><span class="Identifier Token ID">d</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Punctuator Expression Token CONCAT">..</span><span class="Identifier Token Variable ID">b</span><span class="Punctuator Expression Token CONCAT">..</span><span class="Identifier Token Variable ID">c</span><span class="Punctuator Expression Token CONCAT">..</span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;CONCAT&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- not</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="Expression Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADFALSE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">kFalse</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADFALSE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Keyword Token TRUE">true</span><span class="Expression Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADTRUE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">k3</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADTRUE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- direct access to locals</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">b</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">c</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">d</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Punctuator Expression Token MUL">*</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable ID">c</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Expression Token Variable brace-depth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Punctuator Expression Token DIV">/</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">b</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Expression Token Variable brace-depth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token CARET">^</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">x</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;LOADNIL&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;MUL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBIN&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;DIV&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBIN&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;ADD&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBIN&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;GETTABLE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SUB&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBIN&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;GETFIELD&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;POW&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBIN&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;UNM&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SETTABLE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SETFIELD&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN0&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- direct access to constants</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">c</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">kNil</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">kx</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">3.2</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">x</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&#x27;x&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;LOADNIL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SETFIELD&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SETFIELD&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SETTABLE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN0&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- &quot;get/set table&quot; with numeric indices</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">a</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">k255</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Attribute AttributeName brace-depth-1 LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="Token Attribute AttributeName brace-depth-1 RANGLE_BRACE">&gt;</span><span class="Token Attribute AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">255</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">100</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix LF">
</span><span class="Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">k255</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">256</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix LF">
</span><span class="Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">256</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;GETI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SETI&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;GETTABLE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SETI&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SETTABLE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE">  </span><span class="Token String STR">&#x27;RETURN0&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Punctuator Expression Token DIV">/</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Punctuator Token Number MINUS">-</span><span class="Token Number NUMBER">4</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;LOADNIL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SUB&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBIN&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;DIV&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBIN&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN0&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">kTrue</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FALSE">false</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;LOADNIL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADTRUE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SETTABLE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN0&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- equalities</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">a</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;EQI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">a</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">4.0</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number EQ">==</span><span class="Punctuator Token Number SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;EQI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">a</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;hi&quot;</span><span class="Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;EQK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">a</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10000</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;EQK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">   </span><span class="Argument Token VarSuffix COMMENT">-- number too large</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">a</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">10000</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number EQ">==</span><span class="Punctuator Token Number SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">10000</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;EQK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE">   </span><span class="Argument Token VarSuffix COMMENT">-- number too large</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- comparisons</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">a</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">10</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number LE">&lt;=</span><span class="Punctuator Token Number SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;GEI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">a</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Token Number NUMBER">128.0</span><span class="Statement Token Number SPACE"> </span><span class="Punctuator Token brace-depth-1 Number RANGLE_BRACE">&gt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">129</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;LTI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">a</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">127.0</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token brace-depth-1 Number LANGLE_BRACE">&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">127</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;GTI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">a</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Token Number NUMBER">10</span><span class="Statement Token Number SPACE"> </span><span class="Punctuator Token brace-depth-1 Number LANGLE_BRACE">&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">11</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;GTI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">a</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Token Number NUMBER">129</span><span class="Statement Token Number SPACE"> </span><span class="Punctuator Token brace-depth-1 Number LANGLE_BRACE">&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">130</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LT&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">a</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token GE">&gt;=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">23.0</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">25</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;GEI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">a</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token GE">&gt;=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">23.1</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;LOADK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">a</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token brace-depth-1 RANGLE_BRACE">&gt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2300.0</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;LOADF&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LT&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- constant folding</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">checkK</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">func</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">val</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">func</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">checkKlist</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">func</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">val</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">func</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">val</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">checkI</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">func</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">val</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">func</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">checkKlist</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">func</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">func</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">val</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">checkF</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">func</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">val</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">func</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADF&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">checkKlist</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">func</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token brace-depth-1 TableConstructor LCURLY_BRACE">{</span><span class="Expression Token brace-depth-1 TableConstructor RCURLY_BRACE">}</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">func</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">val</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkF</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">0.0</span><span class="Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0.0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkI</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">k0</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkI</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Identifier Token Variable ID">k0</span><span class="Punctuator Expression Token DOUBLE_DIV">//</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkK</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Punctuator Token Number CARET">^</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Punctuator Token Number DIV">/</span><span class="Token Number NUMBER">3</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkK</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">1</span><span class="Token Variable Number SPACE"> </span><span class="Punctuator Token Number PLUS">+</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Punctuator Expression Token CARET">^</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">50</span><span class="Token Variable Number SPACE"> </span><span class="Punctuator Token Number PLUS">+</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">50</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Punctuator Token Number CARET">^</span><span class="Token Number NUMBER">100</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkK</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Punctuator Expression Token CARET">^</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">31</span><span class="Token Variable Number SPACE"> </span><span class="Punctuator Token Number MINUS">-</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">0x20000000</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number PLUS">+</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">0.0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkF</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Identifier Token Variable ID">k3</span><span class="Punctuator Expression Token CARET">^</span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number PLUS">+</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token DOUBLE_DIV">//</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3.0</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1.0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkI</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Identifier Token Variable ID">k3</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MOD">%</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">5</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkF</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Expression Token Variable brace-depth-2 LPAREN">(</span><span class="Token Variable Number NUMBER">2.0</span><span class="Punctuator Token Number CARET">^</span><span class="Token Number NUMBER">8</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number PLUS">+</span><span class="Punctuator Token Number SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression brace-depth-0 Token Variable LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Expression brace-depth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable brace-depth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token MOD">%</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">8</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Punctuator Expression Token DIV">/</span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number MUL">*</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number MINUS">-</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">5.0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkF</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Expression Token Variable brace-depth-2 LPAREN">(</span><span class="Token Variable Number NUMBER">2</span><span class="Punctuator Token Number CARET">^</span><span class="Token Number NUMBER">8</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number PLUS">+</span><span class="Punctuator Token Number SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression brace-depth-0 Token Variable LPAREN">(</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Expression brace-depth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable brace-depth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token MOD">%</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">8</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Punctuator Expression Token DOUBLE_DIV">//</span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number MUL">*</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number MINUS">-</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">7.0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkI</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">0xF0.0</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number PIPE">|</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">0xCC.0</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number TILDE">~</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">0xAA</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number AMPERSAND">&amp;</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">0xFD</span><span class="Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0xF4</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkI</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Punctuator Expression Token TILDE">~</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Punctuator Expression Token TILDE">~</span><span class="Identifier Token Variable ID">kFF0</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PIPE">|</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">kFF0</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkI</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Punctuator Expression Token TILDE">~</span><span class="Punctuator Expression Token TILDE">~</span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1024.0</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1024</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkI</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Expression Token Variable brace-depth-2 LPAREN">(</span><span class="Token Variable Number NUMBER">100</span><span class="Token Variable Number SPACE"> </span><span class="Punctuator Token Number SHL">&lt;&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Identifier Token Variable ID">k6</span><span class="Expression Token Variable brace-depth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token SHL">&lt;&lt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">4</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token SHR">&gt;&gt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">100</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- borders around MAXARG_sBx ((((1 &lt;&lt; 17) - 1) &gt;&gt; 1) == 65535)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">17</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">sbx</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token Variable LPAREN">(</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">1</span><span class="Token Variable Number SPACE"> </span><span class="Punctuator Token Number SHL">&lt;&lt;</span><span class="Punctuator Token Number SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression brace-depth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Punctuator Expression Token SHR">&gt;&gt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE">   </span><span class="Expression Token Number COMMENT">-- avoid folding</span><span class="Expression Token Number LF">
</span><span class="Expression Token Number SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">border</span><span class="Identifier Token AttributeName SPACE"> </span><span class="brace-depth-0 Token Attribute AttributeName LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="brace-depth-0 Token Attribute AttributeName RANGLE_BRACE">&gt;</span><span class="Token Attribute AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">65535</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkI</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">border</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">sbx</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkI</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Identifier Token Variable ID">border</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Identifier Token Variable ID">sbx</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkI</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">border</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">sbx</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkK</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">border</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">sbx</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkK</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">border</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">sbx</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">border</span><span class="Identifier Token AttributeName SPACE"> </span><span class="brace-depth-0 Token Attribute AttributeName LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="brace-depth-0 Token Attribute AttributeName RANGLE_BRACE">&gt;</span><span class="Token Attribute AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">65535.0</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkF</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">border</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">sbx</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0.0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkF</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Identifier Token Variable ID">border</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Identifier Token Variable ID">sbx</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0.0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkF</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">border</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">sbx</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1.0</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkK</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">border</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">sbx</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2.0</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkK</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">border</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">sbx</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1.0</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- immediate operands</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">k1</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">11</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;ADDI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">127</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">117</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;ADDI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">128</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number PLUS">+</span><span class="Punctuator Token Number SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0.0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">128.0</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">           </span><span class="Token String STR">&#x27;ADDI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MUL">*</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">127</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1.0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">127.0</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">           </span><span class="Token String STR">&#x27;MULK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number MUL">*</span><span class="Punctuator Token Number SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">40</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MULK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token CARET">^</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0.25</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;POWK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token DIV">/</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">40</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">40</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1.0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;DIVK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token DOUBLE_DIV">//</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10.0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10.0</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">           </span><span class="Token String STR">&#x27;IDIVK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MOD">%</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">100</span><span class="Token Variable Number SPACE"> </span><span class="Punctuator Token Number MINUS">-</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">91</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">           </span><span class="Token String STR">&#x27;MODK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">k1</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token SHL">&lt;&lt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">8</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SHLI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token SHL">&lt;&lt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">127</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SHRI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token SHL">&lt;&lt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">127</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SHRI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token SHR">&gt;&gt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">128</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">8</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SHRI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token SHR">&gt;&gt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">127</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">8</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SHRI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">9</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;BANDK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number PIPE">|</span><span class="Punctuator Token Number SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">11</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;BORK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">10</span><span class="Expression Token Number SPACE"> </span><span class="Punctuator Token Number TILDE">~</span><span class="Punctuator Token Number SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">9</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;BXORK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- K operands in arithmetic operations</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0.0</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1.0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;ADDK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">--  check(function (x) return 128 + x end, &#x27;ADDK&#x27;, &#x27;MMBINK&#x27;, &#x27;RETURN1&#x27;)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MUL">*</span><span class="Punctuator Expression Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">10000</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">20000</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">           </span><span class="Token String STR">&#x27;MULK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">--  check(function (x) return 20 * x end, &#x27;MULK&#x27;, &#x27;MMBINK&#x27;, &#x27;RETURN1&#x27;)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token CARET">^</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0.5</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2.0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;POWK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token DIV">/</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2.0</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2.0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;DIVK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token DOUBLE_DIV">//</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10000</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10000</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">           </span><span class="Token String STR">&#x27;IDIVK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MOD">%</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">100.0</span><span class="Token Variable Number SPACE"> </span><span class="Punctuator Token Number MINUS">-</span><span class="Punctuator Token Number SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">91</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1.0</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">           </span><span class="Token String STR">&#x27;MODK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- no foldings (and immediate operands)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">0.0</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADF&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;UNM&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">k3</span><span class="Punctuator Expression Token DIV">/</span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;DIVK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Punctuator Token Number MOD">%</span><span class="Token Number NUMBER">0</span><span class="Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MODK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">4</span><span class="Punctuator Token Number DOUBLE_DIV">//</span><span class="Token Number NUMBER">0</span><span class="Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;IDIVK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token SHR">&gt;&gt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2.0</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADF&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SHR&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBIN&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token SHL">&lt;&lt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">128</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SHL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBIN&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">x</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token AMPERSAND">&amp;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2.0</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADF&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;BAND&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBIN&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- basic &#x27;for&#x27; loops</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Token Number NUMBER">10</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">10.5</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;FORPREP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;FORLOOP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN0&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">0xfffffff</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">10.0</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token String STR">&#x27;LOADK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADF&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;FORPREP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;FORLOOP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN0&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- bug in constant folding for 5.1</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Expression Keyword Token NIL">nil</span><span class="Expression Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADNIL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;UNM&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">b</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">c</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">    </span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">c</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;LOADNIL&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SETTABLE&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SETTABLE&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token COMMENT">-- no code for a = a</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;RETURN0&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- x == nil , x ~= nil</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- checkequal(function (b) if (a==nil) then a=1 end; if a~=nil then a=1 end end,</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">--            function () if (a==9) then a=1 end; if a~=9 then a=1 end end)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- check(function () if a==nil then a=&#x27;a&#x27; end end,</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- &#x27;GETTABUP&#x27;, &#x27;EQ&#x27;, &#x27;JMP&#x27;, &#x27;SETTABUP&#x27;, &#x27;RETURN&#x27;)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- tests for table access in upvalues</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">kx</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix DOT">.</span><span class="Identifier TableKey Token VarSuffix ID">y</span><span class="Identifier TableKey Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;GETTABUP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SETTABUP&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">a</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;CALL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;GETUPVAL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;CALL&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;GETUPVAL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;GETTABLE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SETTABLE&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- de morgan</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkequal</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token OR">or</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Statement Token ASSIGN">=</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">             </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Statement Token ASSIGN">=</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkequal</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">l</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Number SPACE"> </span><span class="Punctuator Token Number LE">&lt;=</span><span class="Punctuator Token Number SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token LE">&lt;=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">l</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">             </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">l</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Token Variable brace-depth-1 LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Token Variable brace-depth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token GE">&gt;=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">0</span><span class="Expression Token Variable brace-depth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Keyword Token OR">or</span><span class="Expression Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Token Variable brace-depth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token LE">&lt;=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">l</span><span class="Expression Token Variable brace-depth-2 RPAREN">)</span><span class="Expression Token Variable brace-depth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- if-break optimizations</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">b</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">          </span><span class="Statement Keyword Token WHILE">while</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">            </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token BREAK">break</span><span class="Statement Keyword Token SPACE"> </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">          </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">        </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token String STR">&#x27;TEST&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;TEST&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;ADDI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN0&#x27;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkequal</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">6</span><span class="Token Number SPACE"> </span><span class="Keyword Token Number OR">or</span><span class="Keyword Token Number SPACE"> </span><span class="Keyword Token Number TRUE">true</span><span class="Keyword Token Number SPACE"> </span><span class="Keyword Token OR">or</span><span class="Keyword Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">             </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">k6</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token OR">or</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">kTrue</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token OR">or</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">kNil</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkequal</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token Number NUMBER">6</span><span class="Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Keyword Token Number TRUE">true</span><span class="Keyword Token Number SPACE"> </span><span class="Keyword Token OR">or</span><span class="Keyword Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">             </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">k6</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">kTrue</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token OR">or</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">kNil</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- string constants</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">k0</span><span class="Identifier Token AttributeName SPACE"> </span><span class="brace-depth-0 Token Attribute AttributeName LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="brace-depth-0 Token Attribute AttributeName RANGLE_BRACE">&gt;</span><span class="Token Attribute AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;00000000000000000000000000000000000000000000000000&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">f1</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">      </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">k</span><span class="Identifier Token AttributeName SPACE"> </span><span class="brace-depth-0 Token Attribute AttributeName LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="brace-depth-0 Token Attribute AttributeName RANGLE_BRACE">&gt;</span><span class="Token Attribute AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">k0</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">      </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition LF">
</span><span class="Token FunctionBody FunctionDefinition SPACE">               </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">k</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">             </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">f2</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f1</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">f3</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f2</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f3</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">k0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">checkK</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">k0</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Argument Token VarSuffix COMMENT">-- string is not needed by other functions</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">listk</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">f1</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">listk</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">f2</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Token String STR">&#x27;OK&#x27;</span></code></pre><h2 id="h2-14"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/14.lua" target="_blank">14.lua</a></h2><pre class="language-lua"><code><span class="Token COMMENT">-- $Id: testes/goto.lua $</span><span class="Token LF">
</span><span class="Token COMMENT">-- See Copyright Notice in file all.lua</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">errmsg</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Identifier Token ID">code</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">m</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">st</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">msg</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">code</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">st</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Keyword Token AND">and</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">find</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody COMMENT">-- cannot see label inside block</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">errmsg</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">[[ goto l1; do ::l1:: end ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;label &#x27;l1&#x27;&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">errmsg</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">[[ do ::l1:: end goto l1; ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;label &#x27;l1&#x27;&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- repeated label</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">errmsg</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">[[ ::l1:: ::l1:: ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;label &#x27;l1&#x27;&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">errmsg</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">[[ ::l1:: do ::l1:: end]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;label &#x27;l1&#x27;&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- undefined label</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">errmsg</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">[[ goto l1; local aa ::l1:: ::l2:: print(3) ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;local &#x27;aa&#x27;&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- jumping over variable definition</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">errmsg</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">[[
do local bb, cc; goto l1; end
local aa
::l1:: print(3)
]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;local &#x27;aa&#x27;&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- jumping into a block</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">errmsg</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">[[ do ::l1:: end goto l1 ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;label &#x27;l1&#x27;&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">errmsg</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">[[ goto l1 do ::l1:: end ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;label &#x27;l1&#x27;&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- cannot continue a repeat-until with variables</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">errmsg</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">[[
  repeat
    if x then goto cont end
    local xuxu = 10
    ::cont::
  until xuxu &lt; x
]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;local &#x27;xuxu&#x27;&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- simple gotos</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">y</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">12</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l1</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l2</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l3</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l1</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l2</span><span class="Identifier Statement Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l3</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l3_1</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">13</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- long labels</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">prog</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">[[
  do
    local a = 1
    goto l</span><span class="Token String Format STR">%sa</span><span class="Token String STR">; a = a + 1
   ::l</span><span class="Token String Format STR">%sa</span><span class="Token String STR">:: a = a + 10
    goto l</span><span class="Token String Format STR">%s</span><span class="Token String STR">b; a = a + 2
   ::l</span><span class="Token String Format STR">%s</span><span class="Token String STR">b:: a = a + 20
    return a
  end
  ]]</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">label</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">rep</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;0123456789&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">40</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">format</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">label</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">label</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">label</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">label</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">31</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- ok to jump over local dec. to end of block</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l1</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">23</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l1</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token WHILE">while</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token TRUE">true</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l4</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">  </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l1</span><span class="Identifier Statement Token SPACE">  </span><span class="Identifier Statement Token COMMENT">-- ok to jump over local dec. to end of block</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">  </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l1</span><span class="Identifier Statement Token SPACE">  </span><span class="Identifier Statement Token COMMENT">-- multiple uses of same label</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">45</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l1</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Statement Token SEMI">;</span><span class="Statement Token SEMI">;</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l4</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">13</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l1</span><span class="Identifier Statement Token SPACE">   </span><span class="Identifier Statement Token COMMENT">-- ok to jump over local dec. to end of block</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">error</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Token String STR">&quot;should not be here&quot;</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l2</span><span class="Identifier Statement Token SPACE">   </span><span class="Identifier Statement Token COMMENT">-- ok to jump over local dec. to end of block</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l1</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l2</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Statement Token SEMI">;</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- to repeat a label in a different function is OK</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">foo</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l3</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l1</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l2</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l2</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l5</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l3</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token LF">
</span><span class="Statement Label Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l3a</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l1</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l4</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l6</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l5</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l4</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l6</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">3</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number LF">
</span><span class="Keyword Token Number SPACE">              </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">4</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">5</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">5</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">4</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Expression Keyword Token NOT">not</span><span class="Expression Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">6</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">6</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l3a</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- do it twice</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l6</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- bug in 5.2 -&gt; 5.3.2</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">L1</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token LF">
</span><span class="Statement Label Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">y</span><span class="Identifier Token AttributeName SPACE">             </span><span class="Identifier Token AttributeName COMMENT">-- cannot join this SETNIL with previous one</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="Expression Keyword Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">L1</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">  </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number LF">
</span><span class="Expression Token Number SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token Number AND">and</span><span class="Keyword Token Number SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token TRUE">true</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- bug in 5.3</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">first</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FALSE">false</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token TRUE">true</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">LBL</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">    </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">loop</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token LF">
</span><span class="Statement Label Token SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">    </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">LBL</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token LF">
</span><span class="Statement Label Token SPACE">    </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">first</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Identifier Token Variable ID">first</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FALSE">false</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">      </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">loop</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- compiling infinite loops</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">escape</span><span class="Identifier Statement Token SPACE">   </span><span class="Identifier Statement Token COMMENT">-- do not run the infinite loops</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">a</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">a</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">b</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">c</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">c</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">b</span><span class="Identifier Statement Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">escape</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token LF">
</span><span class="Statement Label Token COMMENT">--------------------------------------------------------------------------------</span><span class="Statement Label Token LF">
</span><span class="Statement Label Token COMMENT">-- testing closing of upvalues</span><span class="Statement Label Token LF">
</span><span class="Statement Label Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">debug</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Token String STR">&#x27;debug&#x27;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">foo</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-0 LPAREN">(</span><span class="Statement Token FunctionBody brace-depth-0 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression brace-depth-0 Token TableConstructor LCURLY_BRACE">{</span><span class="Expression brace-depth-0 Token TableConstructor RCURLY_BRACE">}</span><span class="Expression Token TableConstructor LF">
</span><span class="Expression Token TableConstructor SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">i</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">c</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">d</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l1</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token LF">
</span><span class="Statement Label Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">c</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Keyword Token FunctionBody COMMENT">-- t[2], t[4], t[6]</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token brace-depth-0 RANGLE_BRACE">&gt;</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l2</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">d</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">      </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-1 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-1 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody SPACE">   </span><span class="Keyword Token FunctionBody COMMENT">-- t[3], t[5]</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">      </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number LF">
</span><span class="Expression Token Number SPACE">      </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">      </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l1</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l2</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Punctuator Expression Token HASH">#</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">6</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix COMMENT">-- all functions share same &#x27;a&#x27;</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">6</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalueid</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalueid</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- &#x27;b&#x27; and &#x27;c&#x27; are shared among some of them</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">6</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- only a[1] uses external &#x27;b&#x27;/&#x27;b&#x27;</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalueid</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalueid</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalueid</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalueid</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- inner functions share &#x27;b&#x27;/&#x27;c&#x27; with previous ones</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalueid</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalueid</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalueid</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalueid</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MINUS">-</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Argument Token VarSuffix COMMENT">-- but not with next ones</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalueid</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalueid</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalueid</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token NORE">~=</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalueid</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- only external &#x27;d&#x27; is shared</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">6</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalueid</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalueid</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="brace-depth-0 Token VarSuffix LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="brace-depth-0 Token VarSuffix RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- internal &#x27;d&#x27;s are all different</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">j</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Token Number NUMBER">6</span><span class="Token Number SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Expression Token Variable brace-depth-2 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalueid</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier FunctionCall Token VarSuffix ID">upvalueid</span><span class="brace-depth-0 Argument Token VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix brace-depth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">j</span><span class="Token VarSuffix brace-depth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="brace-depth-0 Argument Token VarSuffix RPAREN">)</span><span class="Expression Token Variable brace-depth-2 RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">      </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Variable brace-depth-2 LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Identifier Token Variable ID">j</span><span class="Expression Token Variable brace-depth-2 RPAREN">)</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">--------------------------------------------------------------------------------</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- testing if x goto optimizations</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">testG</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token FunctionBody brace-depth-1 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Statement Token FunctionBody brace-depth-1 RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l1</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">error</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;should never be here!&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">  </span><span class="Keyword Token ElseIfStatement ELSEIF">elseif</span><span class="Keyword Token ElseIfStatement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token ElseIfStatement THEN">then</span><span class="Keyword Token ElseIfStatement SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l2</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">  </span><span class="Keyword Token ElseIfStatement ELSEIF">elseif</span><span class="Keyword Token ElseIfStatement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">3</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token ElseIfStatement THEN">then</span><span class="Keyword Token ElseIfStatement SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l3</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">  </span><span class="Keyword Token ElseIfStatement ELSEIF">elseif</span><span class="Keyword Token ElseIfStatement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">4</span><span class="Expression Token Number SPACE"> </span><span class="Keyword Token ElseIfStatement THEN">then</span><span class="Keyword Token ElseIfStatement LF">
</span><span class="Keyword Token ElseIfStatement SPACE">    </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l1</span><span class="Identifier Statement Token SPACE">  </span><span class="Identifier Statement Token COMMENT">-- go to inside the block</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">error</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;should never be here!&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l1</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token PLUS">+</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">1</span><span class="Expression Token Number SPACE">   </span><span class="Expression Token Number COMMENT">-- must go to &#x27;if&#x27; end</span><span class="Expression Token Number LF">
</span><span class="Expression Token Number SPACE">  </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">    </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l4</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">    </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l4a</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token MUL">*</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">2</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l4b</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">error</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;should never be here!&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l4</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l4a</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">error</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Token String STR">&quot;should never be here!&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l4b</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token LF">
</span><span class="Statement Label Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l2</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token String STR">&quot;2&quot;</span><span class="Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l3</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token String STR">&quot;3&quot;</span><span class="Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l1</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Keyword Token ReturnStatment RETURN">return</span><span class="Keyword Token ReturnStatment SPACE"> </span><span class="Token String STR">&quot;1&quot;</span><span class="Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">testG</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;1&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">testG</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">2</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;2&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">testG</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">3</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Token String STR">&quot;3&quot;</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">testG</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">4</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">5</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">testG</span><span class="brace-depth-2 Argument Token VarSuffix LPAREN">(</span><span class="Token Number NUMBER">5</span><span class="brace-depth-2 Argument Token VarSuffix RPAREN">)</span><span class="Argument Token VarSuffix SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Token Number NUMBER">10</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- if x back goto out of scope of upvalue</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">X</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">  </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">L1</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">L2</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">L3</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">L1</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Attribute AttributeName brace-depth-1 LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">close</span><span class="Token Attribute AttributeName brace-depth-1 RANGLE_BRACE">&gt;</span><span class="Token Attribute AttributeName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Expression Token TableConstructor brace-depth-2 LCURLY_BRACE">{</span><span class="Expression Token TableConstructor brace-depth-2 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token TableConstructor brace-depth-2 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__close</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Keyword Token FunctionDefinition FUNCTION">function</span><span class="Keyword Token FunctionDefinition SPACE"> </span><span class="brace-depth-0 Token FunctionBody FunctionDefinition LPAREN">(</span><span class="brace-depth-0 Token FunctionBody FunctionDefinition RPAREN">)</span><span class="Token FunctionBody FunctionDefinition SPACE"> </span><span class="Identifier Token Variable ID">X</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Expression Token TableConstructor brace-depth-2 RCURLY_BRACE">}</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">X</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token NIL">nil</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix LF">
</span><span class="Argument Token VarSuffix SPACE">    </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">L2</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- jumping back out of scope of &#x27;a&#x27;</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">L3</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Argument Token VarSuffix brace-depth-1 LPAREN">(</span><span class="Identifier Token Variable ID">X</span><span class="Identifier Token Variable SPACE"> </span><span class="Punctuator Expression Token EQ">==</span><span class="Punctuator Expression Token SPACE"> </span><span class="Expression Keyword Token TRUE">true</span><span class="Argument Token VarSuffix brace-depth-1 RPAREN">)</span><span class="Argument Token VarSuffix SPACE">   </span><span class="Argument Token VarSuffix COMMENT">-- checks that &#x27;a&#x27; was correctly closed</span><span class="Argument Token VarSuffix LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">--------------------------------------------------------------------------------</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Token String STR">&#x27;OK&#x27;</span></code></pre></div>
    <div class="dir-tree"><ul><li><a href="../../md-docs/README" >README</a></li></ul><ul><li><a href="../../用户手册/API" >用户手册</a><ul><li><a href="../../用户手册/API" >API</a></li></ul><ul><li><a href="../../用户手册/全部文法支持" >全部文法支持</a></li></ul><ul><li><a href="../../用户手册/自定义颜色" >自定义颜色</a></li></ul><ul><li><a href="../../用户手册/自定义文法解析" >自定义文法解析</a></li></ul></li></ul><ul><li><a href="../../开发文档/BNF" >开发文档</a><ul><li><a href="../../开发文档/BNF" >BNF</a></li></ul><ul><li><a href="../../开发文档/参考文档" >参考文档</a></li></ul></li></ul><ul><li><a href="../../全部文法高亮/C" >全部文法高亮</a><ul><li><a href="../../全部文法高亮/C" >C</a></li></ul><ul><li><a href="../../全部文法高亮/Lua" >Lua</a></li></ul><ul><li><a href="../../全部文法高亮/asm" >asm</a></li></ul><ul><li><a href="../../全部文法高亮/BNF" >BNF</a></li></ul><ul><li><a href="../../全部文法高亮/json" >json</a></li></ul><ul><li><a href="../../全部文法高亮/shell" >shell</a></li></ul><ul><li><a href="../../全部文法高亮/toml" >toml</a></li></ul><ul><li><a href="../../全部文法高亮/xml" >xml</a></li></ul></li></ul></div>
    <div class="zood"><a class="" href="https://github.com/luzhixing12345/zood" target="_blank">zood</a></div>
    <script type="text/javascript" src="../../../js/next_front.js"></script><script>addLink("../../全部文法高亮/C","../../全部文法高亮/asm","ab")</script><script type="text/javascript" src="../../../js/change_mode.js"></script><script>addChangeModeButton("../../../img/sun.png","../../../img/moon.png")</script><script type="text/javascript" src="../../../js/copy_code.js"></script><script>addCodeCopy("../../../img/before_copy.png","../../../img/after_copy.png")</script><script type="text/javascript" src="../../../js/navigator.js"></script><script type="text/javascript" src="../../../js/picture_preview.js"></script><script type="text/javascript" src="../../../js/global_js_configuration.js"></script>
</body>

</html>