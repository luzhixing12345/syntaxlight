<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        Document
    </title>
    <link rel='stylesheet' href=../../../css/index.css />
    <link rel='stylesheet' href=../../../css/c.css /><link rel='stylesheet' href=../../../css/toml.css /><link rel='stylesheet' href=../../../css/riscvasm.css /><link rel='stylesheet' href=../../../css/css.css /><link rel='stylesheet' href=../../../css/bnf.css /><link rel='stylesheet' href=../../../css/json.css /><link rel='stylesheet' href=../../../css/lua.css /><link rel='stylesheet' href=../../../css/xml.css /><link rel='stylesheet' href=../../../css/shell.css /><link rel='stylesheet' href=../../../css/x86asm.css />
    <link rel="icon" href="https://raw.githubusercontent.com/learner-lu/picbed/master/logo.png">
</head>

<body class="light">
    <a href="https://github.com/luzhixing12345/syntaxlight.git" target="_blank" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    <div class="header-navigator"><ul><li><a href="#h1-0">lua</a><ul><li><a href="#h2-1">1.lua</a></li></ul><ul><li><a href="#h2-2">2.lua</a></li></ul><ul><li><a href="#h2-3">3.lua</a></li></ul><ul><li><a href="#h2-4">4.lua</a></li></ul><ul><li><a href="#h2-5">5.lua</a></li></ul><ul><li><a href="#h2-6">6.lua</a></li></ul><ul><li><a href="#h2-7">7.lua</a></li></ul><ul><li><a href="#h2-8">8.lua</a></li></ul><ul><li><a href="#h2-9">9.lua</a></li></ul><ul><li><a href="#h2-10">10.lua</a></li></ul><ul><li><a href="#h2-11">11.lua</a></li></ul><ul><li><a href="#h2-12">12.lua</a></li></ul><ul><li><a href="#h2-13">13.lua</a></li></ul><ul><li><a href="#h2-14">14.lua</a></li></ul></li></ul></div><div class='markdown-body'><h1 id="h1-0">lua</h1><h2 id="h2-1"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/1.lua" target="_blank">1.lua</a></h2><pre class="language-lua"><code><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">k0aux</span><span class="Identifier Token AttributeName SPACE"> </span><span class="AttributeName Token Attribute BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="AttributeName Token Attribute BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Token Attribute SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Number LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">k0</span><span class="Identifier Token AttributeName SPACE"> </span><span class="AttributeName Token Attribute BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="AttributeName Token Attribute BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Token Attribute SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">k0aux</span><span class="Identifier Token Variable LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">k1</span><span class="Identifier Token AttributeName SPACE"> </span><span class="AttributeName Token Attribute BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="AttributeName Token Attribute BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Token Attribute SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">k3</span><span class="Identifier Token AttributeName SPACE"> </span><span class="AttributeName Token Attribute BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="AttributeName Token Attribute BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Token Attribute SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Number LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">k6</span><span class="Identifier Token AttributeName SPACE"> </span><span class="AttributeName Token Attribute BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="AttributeName Token Attribute BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Token Attribute SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">k3</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Expression Token BraceDepth-0 Variable LPAREN">(</span><span class="Identifier Token Variable ID">k3</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator SHL">&lt;&lt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">k0</span><span class="Expression Token BraceDepth-0 Variable RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">kFF0</span><span class="Identifier Token AttributeName SPACE"> </span><span class="AttributeName Token Attribute BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="AttributeName Token Attribute BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Token Attribute SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0xFF0</span><span class="Token Number LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">k3_78</span><span class="Identifier Token AttributeName SPACE"> </span><span class="AttributeName Token Attribute BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="AttributeName Token Attribute BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Token Attribute SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">3.78</span></code></pre><h2 id="h2-2"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/2.lua" target="_blank">2.lua</a></h2><pre class="language-lua"><code><span class="Token COMMENT">-- 1. 变量和数据类型</span><span class="Token LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">numberVar</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">42</span><span class="Token Number LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">stringVar</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;Hello, Lua!&quot;</span><span class="Token LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">booleanVar</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword TRUE">true</span><span class="Token Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">tableVar</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Token Field Number NUMBER">1</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">2</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">3</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName FunctionName ID">functionVar</span><span class="Identifier Token AttributeName FunctionName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MUL">*</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword COMMENT">-- 2. 条件语句</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">numberVar</span><span class="Identifier Token Variable SPACE"> </span><span class="Token BraceDepth-0 Expression Punctuator RANGLE_BRACE">&gt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">50</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;Number is greater than 50&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="ElseIfStatement Token Keyword ELSEIF">elseif</span><span class="ElseIfStatement Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">numberVar</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">50</span><span class="Token Expression Number SPACE"> </span><span class="ElseIfStatement Token Keyword THEN">then</span><span class="ElseIfStatement Token Keyword LF">
</span><span class="ElseIfStatement Token Keyword SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;Number is equal to 50&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="ElseStatement Token Keyword ELSE">else</span><span class="ElseStatement Token Keyword LF">
</span><span class="ElseStatement Token Keyword SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;Number is less than 50&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword COMMENT">-- 3. 循环语句</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;Iteration&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">counter</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Number LF">
</span><span class="Token Statement Keyword WHILE">while</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">counter</span><span class="Identifier Token Variable SPACE"> </span><span class="Token BraceDepth-1 Expression Punctuator LANGLE_BRACE">&lt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">5</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Identifier Token Variable ID">counter</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">counter</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number LF">
</span><span class="Token Expression Number SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&quot;Counter:&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">counter</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword COMMENT">-- 4. 函数定义</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token FunctionName ID">sayHello</span><span class="FunctionBody Token BraceDepth-2 Statement LPAREN">(</span><span class="Identifier Token ID">name</span><span class="FunctionBody Token BraceDepth-2 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&quot;Hello,&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">name</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword COMMENT">-- 5. 函数调用</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">sayHello</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&quot;Alice&quot;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- 6. 表(Table)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">person</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-2 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="Identifier Token Field ID">name</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="String Token STR">&quot;Bob&quot;</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator LF">
</span><span class="Token Punctuator SPACE">    </span><span class="Identifier Token Field ID">age</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Token Field Number NUMBER">30</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator LF">
</span><span class="Token Punctuator SPACE">    </span><span class="Identifier Token Field ID">isMale</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Token Field Keyword TRUE">true</span><span class="Token Field Keyword LF">
</span><span class="Token TableConstructor Expression BraceDepth-2 RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">person</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">name</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Argument VarSuffix COMMENT">-- Output: Bob</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- 7. 匿名函数</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName FunctionName ID">add</span><span class="Identifier Token AttributeName FunctionName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">b</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">add</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Argument VarSuffix COMMENT">-- Output: 7</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- 8. 迭代器(Pairs和ipairs)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">fruits</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-2 LCURLY_BRACE">{</span><span class="String Token STR">&quot;apple&quot;</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="String Token STR">&quot;banana&quot;</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="String Token STR">&quot;orange&quot;</span><span class="Token TableConstructor Expression BraceDepth-2 RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression LF">
</span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token ID">index</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">fruit</span><span class="Identifier Token SPACE"> </span><span class="Token Statement Keyword IN">in</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">ipairs</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">fruits</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&quot;Fruit&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">index</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;is&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">fruit</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword COMMENT">-- 9. 模块(Module)</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">myModule</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-2 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-2 RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression LF">
</span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token ID">myModule</span><span class="FuncName Token Statement DOT">.</span><span class="FuncName Identifier Token FunctionName ID">sayGoodbye</span><span class="FunctionBody Token BraceDepth-2 Statement LPAREN">(</span><span class="Identifier Token ID">name</span><span class="FunctionBody Token BraceDepth-2 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&quot;Goodbye,&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">name</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">myModule</span><span class="Identifier Token Variable LF">
</span></code></pre><h2 id="h2-3"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/3.lua" target="_blank">3.lua</a></h2><pre class="language-lua"><code><span class="Token COMMENT">-- 定义斐波那契数列函数</span><span class="Token LF">
</span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token FunctionName ID">fibonacci</span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">n</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">fib</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Token Field Number NUMBER">0</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">1</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">        </span><span class="Identifier Token Variable ID">fib</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">fib</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">fib</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix LF">
</span><span class="Token VarSuffix SPACE">    </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">fib</span><span class="Identifier Token Variable LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword COMMENT">-- 打印前n个斐波那契数</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token FunctionName ID">print_fibonacci</span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">n</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">fib</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">fibonacci</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;前&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator CONCAT">..</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator CONCAT">..</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;个斐波那契数列:&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">        </span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">write</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">fib</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator CONCAT">..</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot; &quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- 换行</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword COMMENT">-- 调用函数打印前10个斐波那契数</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">print_fibonacci</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span></code></pre><h2 id="h2-4"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/4.lua" target="_blank">4.lua</a></h2><pre class="language-lua"><code><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token FunctionName ID">factorial</span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">n</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator LE">&lt;=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">        </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="ElseStatement Token Keyword ELSE">else</span><span class="ElseStatement Token Keyword LF">
</span><span class="ElseStatement Token Keyword SPACE">        </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MUL">*</span><span class="Token Expression Punctuator SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">factorial</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">result</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">factorial</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">5</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;Factorial of 5:&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">result</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number LF">
</span><span class="Token Number LF">
</span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token FunctionName ID">modifyGlobal</span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Number LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token FunctionName ID">accessGlobal</span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;Global a:&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">modifyGlobal</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">accessGlobal</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">largeNumber</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number Punctuator CARET">^</span><span class="Token Number NUMBER">100</span><span class="Token Number LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;Large number:&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">largeNumber</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">largeTable</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number Punctuator CARET">^</span><span class="Token Number NUMBER">6</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Identifier Token Variable ID">largeTable</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;Large table length:&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">largeTable</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">longString</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;&quot;</span><span class="Token LF">
</span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number Punctuator CARET">^</span><span class="Token Number NUMBER">5</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Identifier Token Variable ID">longString</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">longString</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator CONCAT">..</span><span class="Token Expression Punctuator SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">tostring</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;Length of longString:&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">longString</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">nestedTable</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="Identifier Token Field ID">a</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Token Field Number NUMBER">1</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator LF">
</span><span class="Token Punctuator SPACE">    </span><span class="Identifier Token Field ID">b</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">        </span><span class="Identifier Token Field ID">c</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Token Field Number NUMBER">2</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator LF">
</span><span class="Token Punctuator SPACE">        </span><span class="Identifier Token Field ID">d</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-2 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">            </span><span class="Identifier Token Field ID">e</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Token Field Number NUMBER">3</span><span class="Token Field Number LF">
</span><span class="Token Field Number SPACE">        </span><span class="Token TableConstructor Expression BraceDepth-2 RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;Value of nestedTable.b.d.e:&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">nestedTable</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">b</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">d</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">e</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token FunctionName ID">multipleReturns</span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Number LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">c</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">multipleReturns</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;Values:&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">mixedTable</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="String Token STR">&quot;first&quot;</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator LF">
</span><span class="Token Punctuator SPACE">    </span><span class="String Token STR">&quot;second&quot;</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator LF">
</span><span class="Token Punctuator SPACE">    </span><span class="Identifier Token Field ID">key1</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="String Token STR">&quot;value1&quot;</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator LF">
</span><span class="Token Punctuator SPACE">    </span><span class="Identifier Token Field ID">key2</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="String Token STR">&quot;value2&quot;</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator LF">
</span><span class="Token Punctuator SPACE">    </span><span class="Identifier Token Field ID">key3</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">        </span><span class="Identifier Token Field ID">key1</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">        </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator LF">
</span><span class="Token Punctuator SPACE">        </span><span class="Identifier Token Field ID">key2</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Token Field Number NUMBER">1</span><span class="Token Field Number LF">
</span><span class="Token Field Number SPACE">    </span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;Value at index 2:&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">mixedTable</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;Value of key &#x27;key1&#x27;:&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">mixedTable</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">key1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">mixedTable</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">key3</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">key1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">mixedTable</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">key3</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">key2</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">mixedTable</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">key3</span><span class="Token VarSuffix COLON">:</span><span class="Identifier Token VarSuffix FunctionCall ID">asd</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">value</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">42</span><span class="Token Number LF">
</span><span class="Token Number LF">
</span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">value</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;Value is truthy&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="ElseStatement Token Keyword ELSE">else</span><span class="ElseStatement Token Keyword LF">
</span><span class="ElseStatement Token Keyword SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;Value is falsy&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span></code></pre><h2 id="h2-5"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/5.lua" target="_blank">5.lua</a></h2><pre class="language-lua"><code><span class="Token LF">
</span><span class="Token COMMENT">-- $Id: testes/all.lua $</span><span class="Token LF">
</span><span class="Token COMMENT">-- See Copyright Notice at the end of this file</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">version</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;Lua 5.4&quot;</span><span class="Token LF">
</span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">_VERSION</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">version</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">stderr</span><span class="Token VarSuffix COLON">:</span><span class="Identifier Token VarSuffix FunctionCall ID">write</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;This test suite is for &quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">version</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">                  </span><span class="String Token STR">&quot;, not for &quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">_VERSION</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;</span><span class="String Control Token STR">\n</span><span class="String Token STR">Exiting tests&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">ARG</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">arg</span><span class="Identifier Token Variable SPACE">   </span><span class="Identifier Token Variable COMMENT">-- save arg for other tests</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable COMMENT">-- next variables control the execution of some tests</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable COMMENT">-- true means no test (so an undefined variable does not skip a test)</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable COMMENT">-- defaults are for Linux; test everything.</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable COMMENT">-- Make true to avoid long or memory consuming tests</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable ID">_soft</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">rawget</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">_G</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;_soft&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Keyword OR">or</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Keyword FALSE">false</span><span class="Token Expression Keyword LF">
</span><span class="Token Expression Keyword COMMENT">-- Make true to avoid non-portable tests</span><span class="Token Expression Keyword LF">
</span><span class="Identifier Token Variable ID">_port</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">rawget</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">_G</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;_port&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Keyword OR">or</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Keyword FALSE">false</span><span class="Token Expression Keyword LF">
</span><span class="Token Expression Keyword COMMENT">-- Make true to avoid messages about tests not performed</span><span class="Token Expression Keyword LF">
</span><span class="Identifier Token Variable ID">_nomsg</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">rawget</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">_G</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;_nomsg&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Keyword OR">or</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Keyword FALSE">false</span><span class="Token Expression Keyword LF">
</span><span class="Token Expression Keyword LF">
</span><span class="Token Expression Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">usertests</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">rawget</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">_G</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;_U&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">usertests</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- tests for sissies ;)  Avoid problems</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Identifier Token Variable ID">_soft</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword TRUE">true</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Identifier Token Variable ID">_port</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword TRUE">true</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Identifier Token Variable ID">_nomsg</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword TRUE">true</span><span class="Token Keyword LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword COMMENT">-- tests should require debug when needed</span><span class="Token Statement Keyword LF">
</span><span class="Identifier Token Variable ID">debug</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword LF">
</span><span class="Token Keyword LF">
</span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">usertests</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword SPACE">    </span><span class="Token Keyword COMMENT">-- no &quot;internal&quot; tests for user tests</span><span class="Token Keyword LF">
</span><span class="ElseStatement Token Keyword ELSE">else</span><span class="ElseStatement Token Keyword LF">
</span><span class="ElseStatement Token Keyword SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">rawget</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">_G</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;T&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- avoid problems with &#x27;strict&#x27; module</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword COMMENT">--[=[
  example of a long [comment],
  [[spanning several [lines]]]
]=]</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;</span><span class="String Control Token STR">\n</span><span class="String Control Token STR">\t</span><span class="String Token STR">Starting Tests&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- set random seed</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">random_x</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">random_y</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">randomseed</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">format</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;random seeds: </span><span class="String Token Format STR">%d</span><span class="String Token STR">, </span><span class="String Token Format STR">%d</span><span class="String Token STR">&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">random_x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">random_y</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;current path:</span><span class="String Control Token STR">\n</span><span class="String Token STR">****&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator CONCAT">..</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">path</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator CONCAT">..</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;****</span><span class="String Control Token STR">\n</span><span class="String Token STR">&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">initclock</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">os</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">clock</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">lastclock</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">initclock</span><span class="Identifier Token Variable LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">walltime</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">os</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">time</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">collectgarbage</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">collectgarbage</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">   </span><span class="Token Statement Keyword COMMENT">-- (</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword COMMENT">-- track messages for tests not performed</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">msgs</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token FunctionName ID">Message</span><span class="FuncName Identifier Token FunctionName SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">m</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">_nomsg</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">m</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">msgs</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">msgs</span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">sub</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">m</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">3</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">os</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">setlocale</span><span class="String Token STR">&quot;C&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">T</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">print</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">format</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">write</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">assert</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">type</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">unpack</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">floor</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">      </span><span class="Identifier Token Variable ID">T</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">print</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">format</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">write</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">assert</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">type</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">table</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">unpack</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">floor</span><span class="Identifier Token VarSuffix TableKey LF">
</span><span class="Identifier Token VarSuffix TableKey COMMENT">-- use K for 1000 and M for 1000000 (not 2^10 -- 2^20)</span><span class="Identifier Token VarSuffix TableKey LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">F</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">m</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">round</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">m</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="Identifier Token Variable ID">m</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0.04999</span><span class="Token Expression Number LF">
</span><span class="Token Expression Number SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">format</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;%.1f&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">      </span><span class="Token Argument VarSuffix COMMENT">-- keep one decimal digit</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Identifier Token Variable SPACE"> </span><span class="Token BraceDepth-0 Expression Punctuator LANGLE_BRACE">&lt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1000</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="ElseStatement Token Keyword ELSE">else</span><span class="ElseStatement Token Keyword LF">
</span><span class="ElseStatement Token Keyword SPACE">    </span><span class="Identifier Token Variable ID">m</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator DIV">/</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1000</span><span class="Token Expression Number LF">
</span><span class="Token Expression Number SPACE">    </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Identifier Token Variable SPACE"> </span><span class="Token BraceDepth-1 Expression Punctuator LANGLE_BRACE">&lt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1000</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">round</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">m</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Expression Punctuator CONCAT">..</span><span class="String Token STR">&quot;K&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="ElseStatement Token Keyword ELSE">else</span><span class="ElseStatement Token Keyword LF">
</span><span class="ElseStatement Token Keyword SPACE">      </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">round</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">m</span><span class="Token Expression Punctuator DIV">/</span><span class="Token Expression Number NUMBER">1000</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Expression Punctuator CONCAT">..</span><span class="String Token STR">&quot;M&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">Cstacklevel</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">showmem</span><span class="Identifier Token AttributeName LF">
</span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">max</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Identifier Token FunctionName Variable ID">showmem</span><span class="Identifier Token FunctionName Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">m</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&quot;count&quot;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator MUL">*</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1024</span><span class="Token Expression Number LF">
</span><span class="Token Expression Number SPACE">    </span><span class="Identifier Token Variable ID">max</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">m</span><span class="Identifier Token Variable SPACE"> </span><span class="Token BraceDepth-0 Expression Punctuator RANGLE_BRACE">&gt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">max</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword OR">or</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">max</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">format</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;    ---- total memory: </span><span class="String Token Format STR">%s</span><span class="String Token STR">, max memory: </span><span class="String Token Format STR">%s</span><span class="String Token STR"> ----</span><span class="String Control Token STR">\n</span><span class="String Token STR">&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">          </span><span class="FunctionCall Identifier Token Variable ID">F</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">m</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">F</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">max</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Identifier Token FunctionName Variable ID">Cstacklevel</span><span class="Identifier Token FunctionName Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword SPACE">   </span><span class="FunctionBody Token Keyword COMMENT">-- no info about stack level</span><span class="FunctionBody Token Keyword LF">
</span><span class="ElseStatement Token Keyword ELSE">else</span><span class="ElseStatement Token Keyword LF">
</span><span class="ElseStatement Token Keyword SPACE">  </span><span class="Identifier Token FunctionName Variable ID">showmem</span><span class="Identifier Token FunctionName Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">checkmemory</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">total</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">numblocks</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">maxmem</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">totalmem</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">count</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&quot;count&quot;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">format</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">      </span><span class="String Token STR">&quot;</span><span class="String Control Token STR">\n</span><span class="String Token STR">    ---- total memory: </span><span class="String Token Format STR">%s</span><span class="String Token STR"> (%.0fK), max use: </span><span class="String Token Format STR">%s</span><span class="String Token STR">,  blocks: </span><span class="String Token Format STR">%d</span><span class="String Control Token STR">\n</span><span class="String Token STR">&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">      </span><span class="FunctionCall Identifier Token Variable ID">F</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">total</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">count</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">F</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">maxmem</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">numblocks</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">format</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;</span><span class="String Control Token STR">\t</span><span class="String Token STR">(strings:  </span><span class="String Token Format STR">%d</span><span class="String Token STR">, tables: </span><span class="String Token Format STR">%d</span><span class="String Token STR">, functions: </span><span class="String Token Format STR">%d</span><span class="String Token STR">, &quot;</span><span class="Token Expression Punctuator CONCAT">..</span><span class="Token Expression Punctuator LF">
</span><span class="Token Expression Punctuator SPACE">                 </span><span class="String Token STR">&quot;</span><span class="String Control Token STR">\n</span><span class="String Control Token STR">\t</span><span class="String Token STR">udata: </span><span class="String Token Format STR">%d</span><span class="String Token STR">, threads: </span><span class="String Token Format STR">%d</span><span class="String Token STR">)&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">                 </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">totalmem</span><span class="String Token STR">&quot;string&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">totalmem</span><span class="String Token STR">&quot;table&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">totalmem</span><span class="String Token STR">&quot;function&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">                 </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">totalmem</span><span class="String Token STR">&quot;userdata&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">totalmem</span><span class="String Token STR">&quot;thread&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Identifier Token FunctionName Variable ID">Cstacklevel</span><span class="Identifier Token FunctionName Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">_</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">_</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">ncalls</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">stacklevel</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">ncalls</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable COMMENT">-- number of C calls</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">Cstack</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">Cstacklevel</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">--</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- redefine dofile to run files through dump/undump</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">--</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">report</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-2 Statement LPAREN">(</span><span class="Identifier Token ID">n</span><span class="FunctionBody Token BraceDepth-2 Statement RPAREN">)</span><span class="FunctionBody Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&quot;</span><span class="String Control Token STR">\n</span><span class="String Token STR">***** FILE &#x27;&quot;</span><span class="Token Expression Punctuator CONCAT">..</span><span class="Identifier Token Variable ID">n</span><span class="Token Expression Punctuator CONCAT">..</span><span class="String Token STR">&quot;&#x27;*****&quot;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">olddofile</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">dofile</span><span class="Identifier Token Variable LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName FunctionName ID">dofile</span><span class="Identifier Token AttributeName FunctionName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="Identifier Token ID">n</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">strip</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">showmem</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">c</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">os</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">clock</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">format</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;time: </span><span class="String Token Format STR">%g</span><span class="String Token STR"> (+</span><span class="String Token Format STR">%g</span><span class="String Token STR">)&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">initclock</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">lastclock</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">lastclock</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">report</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">loadfile</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">dump</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">strip</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">dofile</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;main.lua&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- trace GC cycles</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">require</span><span class="String Token STR">&quot;tracegc&quot;</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">start</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">report</span><span class="String Token STR">&quot;gc.lua&quot;</span><span class="Token LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">loadfile</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;gc.lua&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">dofile</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;db.lua&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">dofile</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;calls.lua&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">deep</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">deep</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">deep</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">olddofile</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;strings.lua&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">olddofile</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;literals.lua&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">dofile</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;tpack.lua&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">dofile</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;attrib.lua&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">27</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">dofile</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;gengc.lua&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">dofile</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;locals.lua&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">5</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">dofile</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;constructs.lua&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">dofile</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;code.lua&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword TRUE">true</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">_soft</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">report</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;big.lua&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">coroutine</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">wrap</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">loadfile</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&#x27;big.lua&#x27;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;b&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;a&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">dofile</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;cstack.lua&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">dofile</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;nextvar.lua&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">dofile</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;pm.lua&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">dofile</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;utf8.lua&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">dofile</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;api.lua&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">dofile</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;events.lua&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">12</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">dofile</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;vararg.lua&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">dofile</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;closure.lua&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">dofile</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;coroutine.lua&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">dofile</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;goto.lua&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword TRUE">true</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">dofile</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;errors.lua&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">dofile</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;math.lua&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">dofile</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;sort.lua&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword TRUE">true</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">dofile</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;bitwise.lua&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">dofile</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;verybig.lua&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword TRUE">true</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">dofile</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;files.lua&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">msgs</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression BraceDepth-2 Punctuator RANGLE_BRACE">&gt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">m</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">table</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">concat</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">msgs</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;</span><span class="String Control Token STR">\n</span><span class="String Token STR">  &quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">warn</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;#tests not performed:</span><span class="String Control Token STR">\n</span><span class="String Token STR">  &quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;</span><span class="String Control Token STR">\n</span><span class="String Token STR">&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;(there should be two warnings now)&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">warn</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;@on&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">warn</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;#This is &quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;an expected&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot; warning&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">warn</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;@off&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">warn</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;******** THIS WARNING SHOULD NOT APPEAR **********&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">warn</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;******** THIS WARNING ALSO SHOULD NOT APPEAR **********&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">warn</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;@on&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">warn</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;#This is&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot; another one&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- no test module should define &#x27;debug&#x27;</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">debug</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">require</span><span class="FunctionCall Identifier Token Variable SPACE"> </span><span class="String Token STR">&quot;debug&quot;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">format</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;</span><span class="String Token Format STR">%d</span><span class="String Token STR">-bit integers, </span><span class="String Token Format STR">%d</span><span class="String Token STR">-bit floats&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">        </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">packsize</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&quot;j&quot;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator MUL">*</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">8</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">packsize</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&quot;n&quot;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator MUL">*</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">8</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">sethook</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;string&#x27;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;cr&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- to survive outside block</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">showmem</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">showmem</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">Cstack</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">Cstacklevel</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="String Token STR">&quot;should be at the same C-stack level it was when started the tests&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword SPACE">   </span><span class="Token Statement Keyword COMMENT">--)</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">_G</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">showmem</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">print</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">format</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">clock</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">time</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">difftime</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName LF">
</span><span class="Token AttributeName SPACE">      </span><span class="Identifier Token AttributeName ID">assert</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">open</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">warn</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">      </span><span class="Identifier Token Variable ID">_G</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">showmem</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">format</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">os</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">clock</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">os</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">time</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">os</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">difftime</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">      </span><span class="Identifier Token Variable ID">assert</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">open</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">warn</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable COMMENT">-- file with time of last performed test</span><span class="Identifier Token Variable LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">fname</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="String Token STR">&quot;time-debug.txt&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword OR">or</span><span class="Token Expression Keyword SPACE"> </span><span class="String Token STR">&quot;time.txt&quot;</span><span class="Token LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">lasttime</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName LF">
</span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">usertests</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- open file with time of last performed test</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">open</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">fname</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Identifier Token Variable ID">lasttime</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">tonumber</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token VarSuffix COLON">:</span><span class="Identifier Token VarSuffix FunctionCall ID">read</span><span class="String Token STR">&#x27;a&#x27;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">f</span><span class="Token VarSuffix COLON">:</span><span class="Identifier Token VarSuffix FunctionCall ID">close</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">  </span><span class="ElseStatement Token Keyword ELSE">else</span><span class="ElseStatement Token Keyword SPACE">   </span><span class="ElseStatement Token Keyword COMMENT">-- no such file; assume it is recording time for first time</span><span class="ElseStatement Token Keyword LF">
</span><span class="ElseStatement Token Keyword SPACE">    </span><span class="Identifier Token Variable ID">lasttime</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword COMMENT">-- erase (almost) all globals</span><span class="Token Statement Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;cleaning all!!!!&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token ID">n</span><span class="Identifier Token SPACE"> </span><span class="Token Statement Keyword IN">in</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pairs</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">_G</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Expression Token BraceDepth-0 Variable LPAREN">(</span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">___Glob</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Token Field Number NUMBER">1</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Identifier Token Field ID">tostring</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Token Field Number NUMBER">1</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Expression Token BraceDepth-0 Variable RPAREN">)</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">n</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">n</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">undef</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="FunctionCall Identifier Token Variable ID">showmem</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">clocktime</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">clock</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">initclock</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable ID">walltime</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">difftime</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">time</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">walltime</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">format</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;</span><span class="String Control Token STR">\n</span><span class="String Control Token STR">\n</span><span class="String Token STR">total time: %.2fs (wall time: </span><span class="String Token Format STR">%gs</span><span class="String Token STR">)</span><span class="String Control Token STR">\n</span><span class="String Token STR">&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">clocktime</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">walltime</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">usertests</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Identifier Token Variable ID">lasttime</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">lasttime</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword OR">or</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">clocktime</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable COMMENT">-- if no last time, ignore difference</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable COMMENT">-- check whether current test time differs more than 5% from last time</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">diff</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Expression Token BraceDepth-0 Variable LPAREN">(</span><span class="Identifier Token Variable ID">clocktime</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">lasttime</span><span class="Expression Token BraceDepth-0 Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator DIV">/</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">lasttime</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">tolerance</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0.05</span><span class="Token Number SPACE">    </span><span class="Token Number COMMENT">-- 5%</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Expression Token BraceDepth-0 Variable LPAREN">(</span><span class="Identifier Token Variable ID">diff</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator GE">&gt;=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">tolerance</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword OR">or</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">diff</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator LE">&lt;=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Identifier Token Variable ID">tolerance</span><span class="Expression Token BraceDepth-0 Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">warn</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">format</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;#time difference from previous test: %+.1f%%&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">                  </span><span class="Identifier Token Variable ID">diff</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MUL">*</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">100</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">open</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">fname</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;w&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token VarSuffix COLON">:</span><span class="Identifier Token VarSuffix FunctionCall ID">write</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">clocktime</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token VarSuffix COLON">:</span><span class="Identifier Token VarSuffix FunctionCall ID">close</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;final OK !!!&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">--[[
*****************************************************************************
* Copyright (C) 1994-2016 Lua.org, PUC-Rio.
*
* Permission is hereby granted, free of charge, to any person obtaining
* a copy of this software and associated documentation files (the
* &quot;Software&quot;), to deal in the Software without restriction, including
* without limitation the rights to use, copy, modify, merge, publish,
* distribute, sublicense, and/or sell copies of the Software, and to
* permit persons to whom the Software is furnished to do so, subject to
* the following conditions:
*
* The above copyright notice and this permission notice shall be
* included in all copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
* MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
* IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY
* CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
* TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
* SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
*****************************************************************************
]]</span></code></pre><h2 id="h2-6"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/6.lua" target="_blank">6.lua</a></h2><pre class="language-lua"><code><span class="Token COMMENT">-- $Id: testes/api.lua $</span><span class="Token LF">
</span><span class="Token COMMENT">-- See Copyright Notice in file all.lua</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Keyword NIL">nil</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token BraceDepth-0 Variable LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">Message</span><span class="FunctionCall Identifier Token Variable SPACE"> </span><span class="FunctionCall Token Expression Keyword OR">or</span><span class="FunctionCall Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token BraceDepth-0 Variable RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;</span><span class="String Control Token STR">\n</span><span class="String Token STR"> &gt;&gt;&gt; testC not active: skipping API tests &lt;&lt;&lt;</span><span class="String Control Token STR">\n</span><span class="String Token STR">&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword LF">
</span><span class="ReturnStatment Token Keyword SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">debug</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">require</span><span class="FunctionCall Identifier Token Variable SPACE"> </span><span class="String Token STR">&quot;debug&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">pack</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">table</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">pack</span><span class="Identifier Token VarSuffix TableKey LF">
</span><span class="Identifier Token VarSuffix TableKey SPACE">  </span><span class="Identifier Token VarSuffix TableKey COMMENT">-- standard error message for memory errors</span><span class="Identifier Token VarSuffix TableKey LF">
</span><span class="Identifier Token VarSuffix TableKey SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">MEMERRMSG</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;not enough memory&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">tcheck</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">t1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">t2</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t1</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">n</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">t2</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">n</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Keyword OR">or</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">t2</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">t1</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">n</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t1</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">t2</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">checkerr</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">f</span><span class="FunctionBody Token ParameterList COMMA">,</span><span class="FunctionBody Token ParameterList SPACE"> </span><span class="Token ParameterList Punctuator VARARGS">...</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">stat</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">err</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator VARARGS">...</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">stat</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">find</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">err</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">msg</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;testing C API&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;pushvalue R; return 1&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">getregistry</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- absindex</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;settop 10; absindex -1; return 1&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;settop 5; absindex -5; return 1&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;settop 10; absindex 1; return 1&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;settop 10; absindex R; return 1&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token BraceDepth-1 Expression Punctuator LANGLE_BRACE">&lt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">10</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- testing alignment</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">d2s</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">12458954321123.0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">pack</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;d&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">12458954321123.0</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">s2d</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">12458954321123.0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">b</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">c</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;pushnum 1; pushnum 2; pushnum 3; return 2&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">makeCfunc</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;pushnum 1; pushnum 2; pushnum 3; return 2&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- test that all trues are equal</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;pushbool 1; pushbool 2; pushbool 0; return 3&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword TRUE">true</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Keyword AND">and</span><span class="Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword FALSE">false</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="String Token STR">&quot;pushbool 0; pushbool 10; pushnil;\
                        tobool -3; tobool -3; tobool -3; return 3&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Keyword FALSE">false</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Keyword AND">and</span><span class="Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Keyword TRUE">true</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Keyword AND">and</span><span class="Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Keyword FALSE">false</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;gettop; return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">30</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">40</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">40</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">5</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pack</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;settop 5; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">tcheck</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">n</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field Number NUMBER">4</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">2</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">3</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pack</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;settop 0; settop 15; return 10&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">23</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">n</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Keyword AND">and</span><span class="Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">10</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pack</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;remove -2; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">tcheck</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">n</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field Number NUMBER">2</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">2</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">4</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pack</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;insert -1; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">tcheck</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">n</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field Number NUMBER">2</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">2</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">3</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pack</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;insert 3; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">tcheck</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">n</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field Number NUMBER">4</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">2</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">5</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">3</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">4</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pack</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;replace 2; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">tcheck</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">n</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field Number NUMBER">3</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">5</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">3</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">4</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pack</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;replace -2; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">tcheck</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">n</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field Number NUMBER">3</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">2</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">3</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">5</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pack</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;remove 3; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">tcheck</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">n</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field Number NUMBER">3</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">2</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">4</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">5</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pack</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;copy 3 4; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">tcheck</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">n</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field Number NUMBER">4</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">2</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">3</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">3</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">5</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pack</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;copy -3 -1; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">tcheck</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">n</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field Number NUMBER">4</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">2</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">3</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">4</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">3</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">   </span><span class="Token Statement Keyword COMMENT">-- testing &#x27;rotate&#x27;</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Token Field Number NUMBER">10</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">20</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">30</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">40</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">50</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">60</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">6</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">6</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">      </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">s</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">format</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;rotate 2 </span><span class="String Token Format STR">%d</span><span class="String Token STR">; return 7&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">      </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">t1</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pack</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">s</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">30</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">40</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">50</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">60</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">      </span><span class="FunctionCall Identifier Token Variable ID">tcheck</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">      </span><span class="Identifier Token Variable ID">table</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">insert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">table</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">remove</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pack</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;rotate -2 1; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">30</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">40</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">tcheck</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token Field Number NUMBER">10</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">20</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">40</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">30</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pack</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;rotate -2 -1; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">30</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">40</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">tcheck</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token Field Number NUMBER">10</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">20</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">40</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">30</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Argument VarSuffix COMMENT">-- some corner cases</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pack</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;rotate -1 0; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">30</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">40</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">tcheck</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token Field Number NUMBER">10</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">20</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">30</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">40</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pack</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;rotate -1 1; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">30</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">40</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">tcheck</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token Field Number NUMBER">10</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">20</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">30</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">40</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pack</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;rotate 5 -1; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">30</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">40</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">tcheck</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token Field Number NUMBER">10</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">20</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">30</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">40</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- testing warnings</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">[[
    warningC &quot;#This shold be a&quot;
    warningC &quot; single &quot;
    warning &quot;warning&quot;
    warningC &quot;#This should be &quot;
    warning &quot;another one&quot;
  ]]</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- testing message handlers</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">makeCfunc</span><span class="String Token STR">[[
      getglobal error
      pushstring bola
      pcall 1 1 1   # call &#x27;error&#x27; with given handler
      pushstatus
      return 2     # return error message and status
    ]]</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">msg</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">st</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">upper</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">   </span><span class="Token Argument VarSuffix COMMENT">-- function handler</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">st</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;ERRRUN&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">msg</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;BOLA&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">msg</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">st</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">len</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">     </span><span class="Token Argument VarSuffix COMMENT">-- function handler</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">st</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;ERRRUN&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">msg</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">4</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pack</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;insert 3; pushvalue 3; remove 3; pushvalue 2; remove 2; \
                    insert 2; pushvalue 1; remove 1; insert 1; \
        insert -2; pushvalue -2; remove -3; return *&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">        </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">40</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">90</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">tcheck</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">n</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field Number NUMBER">7</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">2</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">3</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">4</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">5</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">10</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">40</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">90</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pack</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;concat 5; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;alo&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;joao&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">12</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">tcheck</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">n</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field Number NUMBER">1</span><span class="Token Punctuator COMMA">,</span><span class="String Token STR">&quot;alo23joao12&quot;</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- testing MULTRET</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pack</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;call 2,-1; return *&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">       </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;alo&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;joao&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">tcheck</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">n</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field Number NUMBER">6</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">1</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">2</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">3</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">4</span><span class="Token Punctuator COMMA">,</span><span class="String Token STR">&quot;alo&quot;</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="String Token STR">&quot;joao&quot;</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- test returning more results than fit in the caller stack</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Number NUMBER">1000</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword TRUE">true</span><span class="Token Keyword SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">999</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">[[pcall 1 -1 0; pop 1; tostring -1; return 1]]</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">                      </span><span class="Identifier Token Variable ID">table</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">unpack</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;10&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- testing globals</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">AA</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">14</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">BB</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;a31&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-2 LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="String Token STR">[[
    getglobal AA;
    getglobal BB;
    getglobal BB;
    setglobal AA;
    return *
  ]]</span><span class="Token TableConstructor Expression BraceDepth-2 RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">14</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">3</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;a31&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">4</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Keyword AND">and</span><span class="Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">AA</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;a31&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix ID">AA</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix ID">BB</span><span class="Identifier Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Token Keyword COMMENT">-- testing arith</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;pushnum 10; pushnum 20; arith /; return 1&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0.5</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;pushnum 10; pushnum 20; arith -; return 1&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;pushnum 10; pushnum -20; arith *; return 1&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">200</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;pushnum 10; pushnum 3; arith ^; return 1&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1000</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;pushnum 10; pushstring 20; arith /; return 1&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0.5</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;pushstring 10; pushnum 20; arith -; return 1&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;pushstring 10; pushstring -20; arith *; return 1&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">200</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;pushstring 10; pushstring 3; arith ^; return 1&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1000</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;arith /; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10.0</span><span class="Token Number Punctuator DIV">/</span><span class="Token Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;pushnum 10; pushint 3; arith </span><span class="String Control Token STR">\\</span><span class="String Token STR">; return 1&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3.0</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">type</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;float&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;pushint 10; pushint 3; arith </span><span class="String Control Token STR">\\</span><span class="String Token STR">; return 1&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">type</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;integer&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;pushint 10; pushint 3; arith +; return 1&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">13</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">type</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;integer&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;pushnum 10; pushint 3; arith +; return 1&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">13</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">type</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;float&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">[[pushnum 1;
                    pushstring 10; arith _;
                    pushstring 5; return 3]]</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">10</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;5&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">mt</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">        </span><span class="Identifier Token Field ID">__add</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">setmetatable</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token TableConstructor Expression BraceDepth-2 LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token TableConstructor Expression BraceDepth-2 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">mt</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator LF">
</span><span class="Token Punctuator SPACE">        </span><span class="Identifier Token Field ID">__mod</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">setmetatable</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token TableConstructor Expression BraceDepth-2 LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator MOD">%</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token TableConstructor Expression BraceDepth-2 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">mt</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator LF">
</span><span class="Token Punctuator SPACE">        </span><span class="Identifier Token Field ID">__unm</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">setmetatable</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token TableConstructor Expression BraceDepth-2 LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token Expression Punctuator MUL">*</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token TableConstructor Expression BraceDepth-2 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">mt</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">setmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token Field Number NUMBER">4</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">mt</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">          </span><span class="FunctionCall Identifier Token Variable ID">setmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token Field Number NUMBER">8</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">mt</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">          </span><span class="FunctionCall Identifier Token Variable ID">setmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">3</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">mt</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">y</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">z</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;arith +; return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">12</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">z</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;arith %; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">4</span><span class="Token Number Punctuator MOD">%</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">3</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;arith _; arith +; arith %; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator LF">
</span><span class="Token Expression Punctuator SPACE">                 </span><span class="Token Expression Number NUMBER">8</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator MOD">%</span><span class="Token Number Punctuator SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">4</span><span class="Token Variable Number SPACE"> </span><span class="Token Number Punctuator PLUS">+</span><span class="Token Number Punctuator SPACE"> </span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">3</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Token Expression Punctuator MUL">*</span><span class="Token Expression Number NUMBER">2</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- errors in arithmetic</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkerr</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;divide by zero&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">testC</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;arith </span><span class="String Control Token STR">\\</span><span class="String Token STR">&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkerr</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;%</span><span class="String Token Format STR">%0</span><span class="String Token STR">&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">testC</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;arith %&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- testing lessthan and lessequal</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;compare LT 2 5, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;compare LE 2 5, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;compare LT 3 4, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;compare LE 3 4, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;compare LT 5 2, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;compare LT 2 -3, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;4&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;3&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;2&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;compare LT -3 2, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;3&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;4&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;2&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- non-valid indices produce false</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;compare LT 1 4, return 1&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;compare LE 9 1, return 1&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;compare EQ 9 9, return 1&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__lt</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token BraceDepth-1 Expression Punctuator LANGLE_BRACE">&lt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token TableConstructor Expression BraceDepth-2 RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a1</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">a3</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">a4</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">setmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token Field Number NUMBER">1</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">                   </span><span class="FunctionCall Identifier Token Variable ID">setmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token Field Number NUMBER">3</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">                   </span><span class="FunctionCall Identifier Token Variable ID">setmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token Field Number NUMBER">4</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;compare LT 2 5, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;compare LE 2 5, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;compare LT 5 -6, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;compare LT 5 -6, return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">20</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword FALSE">false</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;compare LE 5 -6, return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">20</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword FALSE">false</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;compare LE 5 -6, return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">20</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword TRUE">true</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- testing lessthan and lessequal with metamethods</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">mt</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__lt</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token BraceDepth-1 Expression Punctuator LANGLE_BRACE">&lt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator LF">
</span><span class="Token Punctuator SPACE">                </span><span class="Identifier Token Field ID">__le</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator LE">&lt;=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator LF">
</span><span class="Token Punctuator SPACE">                </span><span class="Identifier Token Field ID">__eq</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token TableConstructor Expression BraceDepth-2 RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">O</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">      </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">setmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">x</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">mt</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;compare LT 2 3; pushint 10; return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">O</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">O</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">2</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword TRUE">true</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Keyword AND">and</span><span class="Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;compare LE 2 3; pushint 10; return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">O</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">3</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">O</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">2</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword FALSE">false</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Keyword AND">and</span><span class="Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;compare EQ 2 3; pushint 10; return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">O</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">3</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">O</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">3</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword TRUE">true</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Keyword AND">and</span><span class="Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- testing length</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">setmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">x</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Token Field Number NUMBER">20</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__len</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="Identifier Token ID">t</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">x</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">[[
     len 2;
     Llen 2;
     objsize 2;
     return 3
  ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">20</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">20</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">x</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;234&quot;</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">[[
     len 2;
     Llen 2;
     objsize 2;
     return 3
  ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;234&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">234</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">x</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">[[
     len 2;
     objsize 2;
     return 2
  ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- testing __concat</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">setmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">x</span><span class="Token Field FieldList ASSIGN">=</span><span class="String Token STR">&quot;u&quot;</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__concat</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">x</span><span class="Token Expression Punctuator CONCAT">..</span><span class="String Token STR">&#x27;.&#x27;</span><span class="Token Expression Punctuator CONCAT">..</span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">x</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">[[
    pushnum 5
    pushvalue 2;
    pushvalue 2;
    concat 2;
    pushvalue -2;
    return 2;
  ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token Expression Punctuator CONCAT">..</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">5</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- concat with 0 elements</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;concat 0; return 1&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- concat with 1 element</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;concat 1; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;xuxu&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;xuxu&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- testing lua_is</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">B</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword OR">or</span><span class="Token Number Keyword SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">count</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">n</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword OR">or</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Expression Number LF">
</span><span class="Token Expression Number SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">prog</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">[[
      isnumber </span><span class="String Token Format STR">%d</span><span class="String Token STR">;
      isstring </span><span class="String Token Format STR">%d</span><span class="String Token STR">;
      isfunction </span><span class="String Token Format STR">%d</span><span class="String Token STR">;
      iscfunction </span><span class="String Token Format STR">%d</span><span class="String Token STR">;
      istable </span><span class="String Token Format STR">%d</span><span class="String Token STR">;
      isuserdata </span><span class="String Token Format STR">%d</span><span class="String Token STR">;
      isnil </span><span class="String Token Format STR">%d</span><span class="String Token STR">;
      isnull </span><span class="String Token Format STR">%d</span><span class="String Token STR">;
      return 8
    ]]</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">format</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">b</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">c</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">d</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">e</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">f</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">g</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">h</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">B</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Expression Punctuator PLUS">+</span><span class="FunctionCall Identifier Token Variable ID">B</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Expression Punctuator PLUS">+</span><span class="FunctionCall Identifier Token Variable ID">B</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Expression Punctuator PLUS">+</span><span class="FunctionCall Identifier Token Variable ID">B</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">d</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Expression Punctuator PLUS">+</span><span class="FunctionCall Identifier Token Variable ID">B</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">e</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Expression Punctuator PLUS">+</span><span class="FunctionCall Identifier Token Variable ID">B</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Expression Punctuator PLUS">+</span><span class="FunctionCall Identifier Token Variable ID">B</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">g</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Expression Punctuator PLUS">+</span><span class="Expression Token BraceDepth-0 Variable LPAREN">(</span><span class="Token Variable Number NUMBER">100</span><span class="Token Number Punctuator MUL">*</span><span class="FunctionCall Identifier Token Variable ID">B</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">h</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Expression Token BraceDepth-0 Variable RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">count</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">3</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">count</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&#x27;alo&#x27;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">count</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&#x27;32&#x27;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">count</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token TableConstructor Expression BraceDepth-2 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-2 RCURLY_BRACE">}</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">count</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">print</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">count</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">count</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Keyword NIL">nil</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">count</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">stdin</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">count</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Keyword NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">15</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">100</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- testing lua_to...</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">to</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">s</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">n</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword OR">or</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Expression Number LF">
</span><span class="Token Expression Number SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">format</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;</span><span class="String Token Format STR">%s</span><span class="String Token STR"> </span><span class="String Token Format STR">%d</span><span class="String Token STR">; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">s</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">null</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">pushuserdata</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">hfunc</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">gmatch</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Argument VarSuffix COMMENT">-- a &quot;heavy C function&quot; (with upvalues)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">getupvalue</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">hfunc</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">to</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;tostring&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-2 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-2 RCURLY_BRACE">}</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">to</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;tostring&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;alo&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;alo&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">to</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;tostring&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">12</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;12&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">to</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;tostring&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">12</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">to</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;objsize&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-2 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-2 RCURLY_BRACE">}</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">to</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;objsize&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-2 LCURLY_BRACE">{</span><span class="Token Field Number NUMBER">1</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">2</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">3</span><span class="Token TableConstructor Expression BraceDepth-2 RCURLY_BRACE">}</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">to</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;objsize&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;alo\0\0a&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">6</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">to</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;objsize&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">newuserdata</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">to</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;objsize&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">newuserdata</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Token Number NUMBER">101</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">101</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">to</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;objsize&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">124</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">to</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;objsize&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword TRUE">true</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">to</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;tonumber&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-2 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-2 RCURLY_BRACE">}</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">to</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;tonumber&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;12&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">12</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">to</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;tonumber&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;s2&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">to</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;tonumber&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">to</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">null</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">to</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword TRUE">true</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">null</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">to</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">null</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">to</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;abc&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">null</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">to</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">rep</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&quot;x&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator LF">
</span><span class="Token Expression Punctuator SPACE">         </span><span class="FunctionCall Identifier Token Variable ID">to</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">rep</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&quot;x&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Argument VarSuffix COMMENT">-- short strings</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword COMMENT">-- long strings</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">s1</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">rep</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;x&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">300</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">s2</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">rep</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;x&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">300</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">to</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">s1</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">to</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">s2</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">to</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">pushuserdata</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Token Number NUMBER">20</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">null</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">to</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">read</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">null</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">           </span><span class="Token Argument VarSuffix COMMENT">-- light C function</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">to</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">hfunc</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">null</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">        </span><span class="Token Argument VarSuffix COMMENT">-- &quot;heavy&quot; C function</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">to</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">null</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">   </span><span class="Token Argument VarSuffix COMMENT">-- Lua function</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">to</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">stdin</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">null</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">   </span><span class="Token Argument VarSuffix COMMENT">-- full userdata</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">to</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;func2num&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">to</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;func2num&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">pushuserdata</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">to</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;func2num&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">read</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">     </span><span class="Token Argument VarSuffix COMMENT">-- light C function</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">to</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;func2num&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">hfunc</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- &quot;heavy&quot; C function (with upvalue)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">to</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;tocfunction&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">deg</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">a</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">3</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">deg</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">3</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">deg</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;testing panic function&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword COMMENT">-- trivial error</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">checkpanic</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;pushstring hi; error&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;hi&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Argument VarSuffix COMMENT">-- using the stack inside panic</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">checkpanic</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;pushstring hi; error;&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">      </span><span class="String Token STR">[[checkstack 5 XX
        pushstring &#x27; alo&#x27;
        pushstring &#x27; mundo&#x27;
        concat 3]]</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;hi alo mundo&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Argument VarSuffix COMMENT">-- &quot;argerror&quot; without frames</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">checkpanic</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;loadstring 4&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator LF">
</span><span class="Token Expression Punctuator SPACE">        </span><span class="String Token STR">&quot;bad argument #4 (string expected, got no value)&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Argument VarSuffix COMMENT">-- memory error</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">totalmem</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">totalmem</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Number NUMBER">10000</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">   </span><span class="Token Argument VarSuffix COMMENT">-- set low memory limit (+10k)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">checkpanic</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;newuserdata 20000&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">MEMERRMSG</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">totalmem</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">          </span><span class="Token Argument VarSuffix COMMENT">-- restore high limit</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Argument VarSuffix COMMENT">-- stack error</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">_soft</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">      </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">msg</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">checkpanic</span><span class="String Token STR">[[
        pushstring &quot;function f() f() end&quot;
        loadstring -1; call 0 0
        getglobal f; call 0 0
      ]]</span><span class="Token LF">
</span><span class="Token SPACE">      </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">find</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;stack overflow&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword COMMENT">-- exit in panic still close to-be-closed variables</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">checkpanic</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">[[
      pushstring &quot;return {__close = function () Y = &#x27;ho&#x27;; end}&quot;
      newtable
      loadstring -2
      call 0 1
      setmetatable -2
      toclose -1
      pushstring &quot;hi&quot;
      error
    ]]</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="String Token STR">[[
      getglobal Y
      concat 2         # concat original error with global Y
    ]]</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;hiho&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- testing deep C stack</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">_soft</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;testing stack overflow&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;stop&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">checkerr</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;XXXX&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">testC</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;checkstack 1000023 XXXX&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">   </span><span class="Token Argument VarSuffix COMMENT">-- too deep</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Argument VarSuffix COMMENT">-- too deep (with no message)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">checkerr</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;^stack overflow$&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">testC</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;checkstack 1000023 &#x27;&#x27;&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">s</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">rep</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;pushnil;checkstack 1 XX;&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1000000</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">checkerr</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;overflow&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">testC</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">s</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;restart&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="String Token STR">&#x27;+&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">lim</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">_soft</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Number NUMBER">500</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword OR">or</span><span class="Token Number Keyword SPACE"> </span><span class="Token Number NUMBER">12000</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">prog</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="String Token STR">&quot;checkstack &quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator CONCAT">..</span><span class="Token Expression Punctuator SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MUL">*</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator PLUS">+</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">100</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator CONCAT">..</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;msg&quot;</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="String Token STR">&quot;newtable&quot;</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Identifier Token Variable ID">prog</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;pushnum &quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator CONCAT">..</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable ID">prog</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;pushnum &quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator CONCAT">..</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MUL">*</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Expression Number LF">
</span><span class="Token Expression Number SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;rawgeti R 2&quot;</span><span class="Token SPACE">   </span><span class="Token COMMENT">-- get global table in registry</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;insert &quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator CONCAT">..</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Expression Token BraceDepth-0 Variable LPAREN">(</span><span class="Token Variable Number NUMBER">2</span><span class="Token Number Punctuator MUL">*</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Expression Token BraceDepth-0 Variable RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">  </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Identifier Token Variable ID">prog</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;settable &quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator CONCAT">..</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Expression Token BraceDepth-0 Variable LPAREN">(</span><span class="Token Variable Number NUMBER">2</span><span class="Token Number Punctuator MUL">*</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Expression Token BraceDepth-0 Variable RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;return 2&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">table</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">concat</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;;&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">g</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">g</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token Expression Punctuator MUL">*</span><span class="Token Expression Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">undef</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">next</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">g</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Token Keyword COMMENT">-- testing errors</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">[[
    loadstring 2; pcall 0 1 0;
    pushvalue 3; insert -2; pcall 1 1 0;
    pcall 0 0 0;
    return 1
  ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;XX=150&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;string&#x27;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">XX</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">150</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">XX</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">check3</span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">p</span><span class="FunctionBody Token ParameterList COMMA">,</span><span class="FunctionBody Token ParameterList SPACE"> </span><span class="Token ParameterList Punctuator VARARGS">...</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">arg</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Token Expression Punctuator VARARGS">...</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">arg</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">find</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">arg</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">3</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">check3</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;:1:&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;loadstring 2; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;x=&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">check3</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;%.&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;loadfile 2; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;.&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">check3</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;xxxx&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;loadfile 2; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;xxxx&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- test errors in non protected threads</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">checkerrnopro</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">code</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">msg</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">th</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">coroutine</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">create</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- create new thread</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">stt</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">err</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">testC</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">th</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">code</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">   </span><span class="Token Argument VarSuffix COMMENT">-- run code there</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">stt</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">find</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">err</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">msg</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">_soft</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;stop&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">   </span><span class="Token Argument VarSuffix COMMENT">-- avoid __gc with full stack</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">checkerrnopro</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;pushnum 3; call 0 0&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;attempt to call&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="String Token STR">&quot;testing stack overflow in unprotected thread&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token FunctionName ID">F</span><span class="FuncName Identifier Token FunctionName SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">F</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">checkerrnopro</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;getglobal &#x27;F&#x27;; call 0 0;&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;stack overflow&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">F</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;restart&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="String Token STR">&quot;+&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token COMMENT">-- testing table access</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">   </span><span class="Token Statement Keyword COMMENT">-- getp/setp</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a1</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;rawsetp 2 1; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">pushuserdata</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">20</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a1</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;rawgetp -1 1; return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a1</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">20</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- using the table itself as index</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">prog</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;gettable -1; return *&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">prog</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;settable -2; return *&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">20</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Argument VarSuffix COMMENT">-- raw</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">prog</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;rawget -1; return *&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">prog</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;rawset -2; return *&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">20</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Argument VarSuffix COMMENT">-- using the table as the value to set</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">prog</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;rawset -1; return *&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">30</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">30</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">prog</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;settable -1; return *&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">40</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">40</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">prog</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;rawseti -1 100; return *&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">100</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">prog</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;seti -1 200; return *&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">200</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Identifier Token Field ID">x</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field Number NUMBER">0</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Identifier Token Field ID">y</span><span class="Token Field ASSIGN">=</span><span class="Token Field Number NUMBER">12</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;gettable 2; pushvalue 4; gettable 2; return 2&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">                  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;y&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;x&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">12</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;settable -5&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;x&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">15</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">x</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">15</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;gettable 2; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- table and key are the same object!</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;settable 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;x&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Argument VarSuffix COMMENT">-- table and key are the same object!</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;x&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">setmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">p</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">getmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token VarSuffix DOT">.</span><span class="Token VarSuffix TableKey FunctionName Identifier ID">__index</span><span class="Token VarSuffix TableKey FunctionName Identifier SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="Identifier Token ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">i</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">p</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">k</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;gettable 3, return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">35</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;x&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">15</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">k</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">35</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">k</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;getfield 2 y, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">k</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">12</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">getmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token VarSuffix DOT">.</span><span class="Token VarSuffix TableKey FunctionName Identifier ID">__index</span><span class="Token VarSuffix TableKey FunctionName Identifier SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="Identifier Token ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">i</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Identifier Token Variable ID">getmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token VarSuffix DOT">.</span><span class="Token VarSuffix TableKey FunctionName Identifier ID">__newindex</span><span class="Token VarSuffix TableKey FunctionName Identifier SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="Identifier Token ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">i</span><span class="Token COMMA">,</span><span class="Identifier Token ID">v</span><span class="Identifier Token SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">v</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;insert 2; gettable -5; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;y&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">12</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">k</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;settable -5, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;x&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">16</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">x</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">16</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">k</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">4</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&#x27;xuxu&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;gettable 2, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;xuxu&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;settable 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">19</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">19</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">--</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">   </span><span class="Token Statement Keyword COMMENT">-- testing getfield/setfield with long keys</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Identifier Token Field ID">_012345678901234567890123456789012345678901234567890123456789</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Token Field Number NUMBER">32</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">[[
      getfield 2 _012345678901234567890123456789012345678901234567890123456789
      return 1
    ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">32</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">[[
      pushnum 33
      setglobal _012345678901234567890123456789012345678901234567890123456789
    ]]</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">_012345678901234567890123456789012345678901234567890123456789</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">33</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">_012345678901234567890123456789012345678901234567890123456789</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- testing next</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pack</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;next; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">tcheck</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">n</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field Number NUMBER">1</span><span class="Token Punctuator COMMA">,</span><span class="Identifier Token Variable ID">a</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Identifier Token Field ID">a</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field Number NUMBER">3</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pack</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;next; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">tcheck</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">n</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field Number NUMBER">3</span><span class="Token Punctuator COMMA">,</span><span class="Identifier Token Variable ID">a</span><span class="Token Punctuator COMMA">,</span><span class="String Token STR">&#x27;a&#x27;</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">3</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pack</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;next; pop 1; next; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">tcheck</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">n</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field Number NUMBER">1</span><span class="Token Punctuator COMMA">,</span><span class="Identifier Token Variable ID">a</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- testing upvalues</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">A</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="String Token STR">[[ pushnum 10; pushnum 20; pushcclosure 2; return 1]]</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">A</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">[[pushvalue U0; pushvalue U1; pushvalue U2; return 3]]</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">20</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;table&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">A</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">[[tostring U3; tonumber U4; return 2]]</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Keyword AND">and</span><span class="Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">A</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">[[pushnum 100; pushnum 200; replace U2; replace U1]]</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">A</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">[[pushvalue U1; pushvalue U2; return 2]]</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">100</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">200</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">A</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">[[replace U2; replace U1]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">x</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field Number NUMBER">1</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">x</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field Number NUMBER">2</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">A</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">[[pushvalue U1; pushvalue U2; return 2]]</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">x</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">x</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">checkmemory</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- testing absent upvalues from C-function pointers</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="String Token STR">[[isnull U1; return 1]]</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword TRUE">true</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="String Token STR">[[isnull U100; return 1]]</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword TRUE">true</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="String Token STR">[[pushvalue U1; return 1]]</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="String Token STR">[[ pushnum 10; pushnum 20; pushcclosure 2; return 1]]</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalue</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword LF">
</span><span class="Token Number Keyword SPACE">         </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalue</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">20</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword LF">
</span><span class="Token Number Keyword SPACE">         </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalue</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalue</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;xuxu&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalue</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;xuxu&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- large closures</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">A</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;checkstack 300 msg;&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator CONCAT">..</span><span class="Token Expression Punctuator LF">
</span><span class="Token Expression Punctuator SPACE">              </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">rep</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;pushnum 10;&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">255</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator CONCAT">..</span><span class="Token Expression Punctuator LF">
</span><span class="Token Expression Punctuator SPACE">              </span><span class="String Token STR">&quot;pushcclosure 255; return 1&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">A</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Number NUMBER">255</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">      </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">A</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="String Token STR">&quot;pushvalue U</span><span class="String Token Format STR">%d</span><span class="String Token STR">; return 1&quot;</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Token VarSuffix COLON">:</span><span class="Identifier Token VarSuffix FunctionCall ID">format</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">A</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;isnull U256; return 1&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">A</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;isnil U256; return 1&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- testing get/setuservalue</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- bug in 5.1.2</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkerr</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;got number&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">setuservalue</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkerr</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;got nil&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">setuservalue</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkerr</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;got light userdata&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">setuservalue</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">pushuserdata</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- testing multiple user values</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">newuserdata</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">v</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">p</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">getuservalue</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">v</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Keyword AND">and</span><span class="Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">   </span><span class="Token Statement Keyword COMMENT">-- indices out of range</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">v</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">p</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">getuservalue</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">2</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">v</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Keyword AND">and</span><span class="Token Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">v</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">p</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">getuservalue</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">11</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">v</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Keyword AND">and</span><span class="Token Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Token Field Keyword TRUE">true</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Keyword FALSE">false</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">4.56</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="String Token STR">&quot;XYZ&quot;</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token ID">k</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">v</span><span class="Identifier Token SPACE"> </span><span class="Token Statement Keyword IN">in</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">ipairs</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">setuservalue</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">v</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">k</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token ID">k</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">v</span><span class="Identifier Token SPACE"> </span><span class="Token Statement Keyword IN">in</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">ipairs</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">v1</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">p</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">getuservalue</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">k</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">v1</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">v</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">getuservalue</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">4</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">setuservalue</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">   </span><span class="Token Argument VarSuffix COMMENT">-- function should not be collected</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">getuservalue</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">setuservalue</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">134</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">   </span><span class="Token Argument VarSuffix COMMENT">-- number should not be a problem for collector</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">getuservalue</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">134</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- test barrier for uservalues</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">oldmode</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;incremental&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">gcstate</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;atomic&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">gccolor</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;black&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">setuservalue</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">x</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Token Field Number NUMBER">100</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">gcstate</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;pause&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- complete collection</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">getuservalue</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">x</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">100</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- uvalue should be there</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">oldmode</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- long chain of userdata</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1000</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">bb</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">newuserdata</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">setuservalue</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bb</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">bb</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">     </span><span class="Token Argument VarSuffix COMMENT">-- nothing should not be collected</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1000</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">getuservalue</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">getuservalue</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">x</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">100</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Token Keyword COMMENT">-- testing locks (refs)</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Token Keyword COMMENT">-- reuse of references</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">i</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">ref</span><span class="BraceDepth-0 Token TableConstructor Argument LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Argument RCURLY_BRACE">}</span><span class="Token TableConstructor Argument LF">
</span><span class="Token TableConstructor Argument SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">unref</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">ref</span><span class="Token TableConstructor Argument BraceDepth-1 LCURLY_BRACE">{</span><span class="Token TableConstructor Argument BraceDepth-1 RCURLY_BRACE">}</span><span class="Token TableConstructor Argument SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">Arr</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">Lim</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">100</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Identifier Token Variable ID">Lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">   </span><span class="Token Statement Keyword COMMENT">-- lock many objects</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Identifier Token Variable ID">Arr</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">ref</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">ref</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Keyword NIL">nil</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">getref</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">unref</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">unref</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Identifier Token Variable ID">Lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">   </span><span class="Token Statement Keyword COMMENT">-- unlock all them</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">unref</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">Arr</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">printlocks</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">makeCfunc</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;gettable R; return 1&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">n</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;n&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;n&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">0</span><span class="Token Statement COMMA">,</span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">      </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Identifier Token Variable ID">Lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">   </span><span class="Token Statement Keyword COMMENT">-- lock many objects</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Identifier Token Variable ID">Arr</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">ref</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Identifier Token Variable ID">Lim</span><span class="Token Statement COMMA">,</span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">   </span><span class="Token Statement Keyword COMMENT">-- unlock half of them</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">unref</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">Arr</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">getref</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">Arr</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;table&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">getref</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">ref</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">getref</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;table&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- colect in cl the `val&#x27; of all collected userdata</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">tt</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">cl</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Identifier Token Field ID">n</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field Number NUMBER">0</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">B</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">F</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">  </span><span class="Identifier Token FunctionName Variable ID">F</span><span class="Identifier Token FunctionName Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">udval</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">udataval</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">table</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">insert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">cl</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">udval</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">d</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">newuserdata</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">100</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">   </span><span class="Token Argument VarSuffix COMMENT">-- create garbage</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">getmetatable</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">__gc</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">F</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;table.insert({}, {})&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">   </span><span class="Token Argument VarSuffix COMMENT">-- create more garbage</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Argument VarSuffix COMMENT">-- GC during GC (no op)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">dummy</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression SPACE">    </span><span class="Token TableConstructor Expression COMMENT">-- create more garbage during GC</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">      </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">A</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;userdata&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">      </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">udataval</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">A</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">B</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">      </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">getmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">A</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Argument VarSuffix COMMENT">-- just access it</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE">   </span><span class="Identifier Token Variable COMMENT">-- ressurect userdata</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable ID">B</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">udval</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">3</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Identifier Token Variable ID">tt</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">__gc</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">F</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable COMMENT">-- test whether udate collection frees memory in the right time</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;count&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">newuserdata</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">5001</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;objsize 2; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">5001</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;count&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator GE">&gt;=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Number NUMBER">4</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;count&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator LE">&lt;=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Argument VarSuffix COMMENT">-- udata without finalizer</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;count&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;stop&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Number NUMBER">1000</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">newuserdata</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;count&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token BraceDepth-1 Expression Punctuator RANGLE_BRACE">&gt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Number NUMBER">10</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;count&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator LE">&lt;=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Argument VarSuffix COMMENT">-- udata with finalizer</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;count&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;stop&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__gc</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Number NUMBER">1000</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">setmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">newuserdata</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;count&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator GE">&gt;=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- this collection only calls TM, without freeing memory</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;count&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator GE">&gt;=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- now frees memory</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;count&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator LE">&lt;=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;restart&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;stop&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- create 3 userdatas with tag `tt&#x27;</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">newuserdata</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">setmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">tt</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">na</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">udataval</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">newuserdata</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">setmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">tt</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">nb</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">udataval</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">newuserdata</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">setmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">tt</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">nc</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">udataval</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- create userdata without meta table</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">newuserdata</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">4</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">newuserdata</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkerr</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;FILE%* expected, got userdata&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">input</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkerr</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;FILE%* expected, got userdata&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">input</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">getmetatable</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Keyword AND">and</span><span class="Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">getmetatable</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">y</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">d</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">ref</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">e</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">ref</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">ref</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">getref</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">d</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">getref</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">e</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">getref</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">3</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Token Statement ASSIGN">=</span><span class="Token Keyword NIL">nil</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token Statement ASSIGN">=</span><span class="Token Keyword NIL">nil</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token Statement ASSIGN">=</span><span class="Token Keyword NIL">nil</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">unref</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">e</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">unref</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- check that unref objects have been collected</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">cl</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">cl</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">nc</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">getref</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">d</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;userdata&#x27;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">getmetatable</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">tt</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Identifier Token Variable ID">tt</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">b</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable COMMENT">-- create cycle</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable ID">tt</span><span class="Token Statement ASSIGN">=</span><span class="Token Keyword NIL">nil</span><span class="Token Keyword SPACE">    </span><span class="Token Keyword COMMENT">-- frees tt for GC</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">unref</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">d</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">n5</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">newuserdata</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">setmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">n5</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__gc</span><span class="Token Field FieldList ASSIGN">=</span><span class="Identifier Token Variable ID">F</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">n5</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">udataval</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">n5</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">cl</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">4</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- check order of collection</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">cl</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">n5</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">cl</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">3</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">nb</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">cl</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">4</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">na</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="String Token STR">&quot;restart&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">na</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">30</span><span class="Token Statement COMMA">,</span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">newuserdata</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">setmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__gc</span><span class="Token Field FieldList ASSIGN">=</span><span class="Identifier Token Variable ID">F</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">na</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">udataval</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Identifier Token Variable ID">cl</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-2 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-2 RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">cl</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">30</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Number NUMBER">30</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">cl</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">na</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Identifier Token Variable ID">na</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">2</span><span class="Token Statement COMMA">,</span><span class="Identifier Token Variable ID">Lim</span><span class="Token Statement COMMA">,</span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">   </span><span class="Token Statement Keyword COMMENT">-- unlock the other half</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">unref</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">Arr</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">newuserdata</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">41</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">setmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__gc</span><span class="Token Field FieldList ASSIGN">=</span><span class="Identifier Token Variable ID">F</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;objsize 2; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">41</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">cl</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Token BraceDepth-1 Field FieldList LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">x</span><span class="Token BraceDepth-1 Field FieldList RSQUAR_PAREN">]</span><span class="Token Field FieldList SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Token Field Number NUMBER">1</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">udataval</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- old `x&#x27; cannot be collected (`a&#x27; still uses it)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">cl</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token ID">n</span><span class="Identifier Token SPACE"> </span><span class="Token Statement Keyword IN">in</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pairs</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">n</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">undef</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">cl</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">cl</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">   </span><span class="Token Argument VarSuffix COMMENT">-- old `x&#x27; must be collected</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- testing lua_equal</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;compare EQ 2 4; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;compare EQ 3 2; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;alo&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;alo&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;compare EQ 2 3; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;compare EQ 2 3; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-2 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-2 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-2 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-2 RCURLY_BRACE">}</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;compare EQ 2 3; return 1&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;compare EQ 2 3; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- testing lua_equal with fallbacks</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">map</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__eq</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">map</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">map</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">f</span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">      </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">u</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">newuserdata</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">      </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">setmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">u</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">      </span><span class="Identifier Token Variable ID">map</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">u</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">      </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">u</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">11</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;compare EQ 2 3; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;compare EQ 2 3; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Token Number NUMBER">20</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">__eq</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="String Token STR">&#x27;+&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token COMMENT">-- testing changing hooks during hooks</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">TT</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">sethook</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">[[
    # set a line hook after 3 count hooks
    sethook 4 0 &#x27;
      getglobal TT;
      pushvalue -3; append -2
      pushvalue -2; append -2
    &#x27;]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;c&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE">   </span><span class="Token Number COMMENT">-- counting</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE">   </span><span class="Token Number COMMENT">-- counting</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE">   </span><span class="Token Number COMMENT">-- count hook (set line hook)</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE">   </span><span class="Token Number COMMENT">-- line hook</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE">   </span><span class="Token Number COMMENT">-- line hook</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">sethook</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">TT</span><span class="Identifier Token VarSuffix TableKey LF">
</span><span class="Identifier Token VarSuffix TableKey SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;line&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">line</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix LF">
</span><span class="Token VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">3</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;line&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">4</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">line</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">5</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;line&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">6</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">line</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">7</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">TT</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Token Keyword COMMENT">-------------------------------------------------------------------------</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">   </span><span class="Token Statement Keyword COMMENT">-- testing errors during GC</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">warn</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;@off&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;stop&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Number NUMBER">20</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">      </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">newuserdata</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">   </span><span class="Token Argument VarSuffix COMMENT">-- creates several udata</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Number NUMBER">20</span><span class="Token Statement COMMA">,</span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">   </span><span class="Token Statement Keyword COMMENT">-- mark half of them to raise errors during GC</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">      </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">setmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">        </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__gc</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">error</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&quot;@expected error in gc&quot;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">2</span><span class="Token Statement COMMA">,</span><span class="Token Number NUMBER">20</span><span class="Token Statement COMMA">,</span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">   </span><span class="Token Statement Keyword COMMENT">-- mark the other half to count and to create more garbage</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">      </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">setmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__gc</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&quot;A=A+1&quot;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">    </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">A</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- number of normal collections</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;restart&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">warn</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;@on&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">A</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Token Keyword COMMENT">-------------------------------------------------------------------------</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Token Keyword COMMENT">-- test for userdata vals</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">lim</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">30</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">0</span><span class="Token Statement COMMA">,</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">pushuserdata</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">0</span><span class="Token Statement COMMA">,</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">udataval</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">0</span><span class="Token Statement COMMA">,</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">pushuserdata</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">0</span><span class="Token Statement COMMA">,</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">0</span><span class="Token Statement COMMA">,</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">pushuserdata</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">tostring</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;string&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-------------------------------------------------------------------------</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- testing multiple states</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">closestate</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">newstate</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">  </span><span class="Identifier Token Variable ID">L1</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">newstate</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">doremote</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;X=&#x27;a&#x27;; return &#x27;a&#x27;&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;a&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator HASH">#</span><span class="FunctionCall Identifier Token Variable ID">pack</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">doremote</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;function f () return &#x27;alo&#x27;, 3 end; f()&quot;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">doremote</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;return f()&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;alo&#x27;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;3&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">doremote</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;_ERRORMESSAGE = nil&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- error: `sin&#x27; is not defined</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">doremote</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;return sin(1)&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Keyword AND">and</span><span class="Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">   </span><span class="Token Argument VarSuffix COMMENT">-- 2 == run-time error</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- error: syntax error</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">doremote</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;return a+&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Keyword AND">and</span><span class="Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;string&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">   </span><span class="Token Argument VarSuffix COMMENT">-- 3 == syntax error</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">loadlib</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">doremote</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">[[
    string = require&#x27;string&#x27;
    a = require&#x27;_G&#x27;; assert(a == _G and require(&quot;_G&quot;) == a)
    io = require&#x27;io&#x27;; assert(type(io.read) == &quot;function&quot;)
    assert(require(&quot;io&quot;) == io)
    a = require&#x27;table&#x27;; assert(type(a.insert) == &quot;function&quot;)
    a = require&#x27;debug&#x27;; assert(type(a.getlocal) == &quot;function&quot;)
    a = require&#x27;math&#x27;; assert(type(a.sin) == &quot;function&quot;)
    return string.sub(&#x27;okinama&#x27;, 1, 2)
  ]]</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;ok&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">closestate</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">  </span><span class="Identifier Token Variable ID">L1</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">newstate</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">loadlib</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">doremote</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;a = {}&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">[[getglobal &quot;a&quot;; pushstring &quot;x&quot;; pushint 1;
               settable -3]]</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">doremote</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;return a.x&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;1&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">closestate</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">L1</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;+&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-------------------------------------------------------------------------</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- testing to-be-closed variables</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-------------------------------------------------------------------------</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="String Token STR">&quot;testing to-be-closed variables&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">openresource</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">newresource</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">      </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">setmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token Field Number NUMBER">10</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__close</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="Identifier Token ID">y</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">        </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">openresource</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">openresource</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">        </span><span class="Identifier Token Variable ID">openresource</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">openresource</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">        </span><span class="Identifier Token Variable ID">y</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number LF">
</span><span class="Token Expression Number SPACE">      </span><span class="FunctionBody Token Keyword END">end</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">      </span><span class="Identifier Token Variable ID">openresource</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">openresource</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">      </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">[[
      call 0 1   # create resource
      pushnil
      toclose -2  # mark call result to be closed
      toclose -1  # mark nil to be closed (will be ignored)
      return 2
    ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">newresource</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">11</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">openresource</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Argument VarSuffix COMMENT">-- was closed</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Argument VarSuffix COMMENT">-- repeat the test, but calling function in a &#x27;multret&#x27; context</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">[[
      call 0 1   # create resource
      toclose 2 # mark it to be closed
      return 2
    ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">newresource</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;string&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">11</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">openresource</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Argument VarSuffix COMMENT">-- was closed</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Argument VarSuffix COMMENT">-- closing by error</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">makeCfunc</span><span class="String Token STR">[[
      call 0 1   # create resource
      toclose -1 # mark it to be closed
      error       # resource is the error object
    ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">newresource</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword FALSE">false</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Keyword AND">and</span><span class="Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">11</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">openresource</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Argument VarSuffix COMMENT">-- was closed</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Argument VarSuffix COMMENT">-- non-closable value</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">makeCfunc</span><span class="String Token STR">[[
      newtable   # create non-closable object
      toclose -1 # mark it to be closed (should raise an error)
      abort  # will not be executed
    ]]</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword FALSE">false</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Keyword AND">and</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">      </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">find</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;non%-closable value&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">check</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">n</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">      </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">openresource</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">    </span><span class="FunctionBody Token Keyword COMMENT">-- closing resources with &#x27;closeslot&#x27;</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">    </span><span class="Identifier Token Variable ID">_ENV</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">xxx</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword TRUE">true</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">[[
      pushvalue 2  # stack: S, NR, CH, NR
      call 0 1   # create resource; stack: S, NR, CH, R
      toclose -1 # mark it to be closed
      pushvalue 2  #  stack: S, NR, CH, R, NR
      call 0 1   # create another resource; stack: S, NR, CH, R, R
      toclose -1 # mark it to be closed
      pushvalue 3  # stack: S, NR, CH, R, R, CH
      pushint 2   # there should be two open resources
      call 1 0  #  stack: S, NR, CH, R, R
      closeslot -1   # close second resource
      pushvalue 3  # stack: S, NR, CH, R, R, CH
      pushint 1   # there should be one open resource
      call 1 0  # stack: S, NR, CH, R, R
      closeslot 4
      setglobal &quot;xxx&quot;  # previous op. erased the slot
      pop 1       # pop other resource from the stack
      pushint *
      return 1    # return stack size
    ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">newresource</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">_ENV</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">xxx</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">   </span><span class="Token Argument VarSuffix COMMENT">-- no extra items left in the stack</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Argument VarSuffix COMMENT">-- closing resources with &#x27;pop&#x27;</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">[[
      pushvalue 2  # stack: S, NR, CH, NR
      call 0 1   # create resource; stack: S, NR, CH, R
      toclose -1 # mark it to be closed
      pushvalue 2  #  stack: S, NR, CH, R, NR
      call 0 1   # create another resource; stack: S, NR, CH, R, R
      toclose -1 # mark it to be closed
      pushvalue 3  # stack: S, NR, CH, R, R, CH
      pushint 2   # there should be two open resources
      call 1 0  #  stack: S, NR, CH, R, R
      pop 1   # pop second resource
      pushvalue 3  # stack: S, NR, CH, R, CH
      pushint 1   # there should be one open resource
      call 1 0  # stack: S, NR, CH, R
      pop 1       # pop other resource from the stack
      pushvalue 3  # stack: S, NR, CH, CH
      pushint 0   # there should be no open resources
      call 1 0  # stack: S, NR, CH
      pushint *
      return 1    # return stack size
    ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">newresource</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">   </span><span class="Token Argument VarSuffix COMMENT">-- no extra items left in the stack</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Argument VarSuffix COMMENT">-- non-closable value</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">makeCfunc</span><span class="String Token STR">[[
      pushint 32
      toclose -1
    ]]</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">find</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;(C temporary)&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">--[[
  ** {==================================================================
  ** Testing memory limits
  ** ===================================================================
  --]]</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;memory-allocation errors&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkerr</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;block too big&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">newuserdata</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">maxinteger</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="String Token STR">&quot;local a={}; for i=1,100000 do a[i]=i end&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">alloccount</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkerr</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">MEMERRMSG</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">alloccount</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">          </span><span class="Token Argument VarSuffix COMMENT">-- remove limit</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- test memory errors; increase limit for maximum memory by steps,</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- o that we get memory errors in all allocations of a given</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- task, until there is enough memory to complete the task without</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- errors.</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">testbytes</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">s</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">f</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">M</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">totalmem</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">oldM</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">M</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">    </span><span class="Token Statement Keyword WHILE">while</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword TRUE">true</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">      </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">      </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">totalmem</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">M</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">      </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;pcall 0 1 0; pushstatus; return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">      </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">totalmem</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- remove limit</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">      </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;OK&quot;</span><span class="Token SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword BREAK">break</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword SPACE">       </span><span class="Token Statement Keyword COMMENT">-- stop when no more errors</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">      </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;OK&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">MEMERRMSG</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword COMMENT">-- not a memory error?</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">        </span><span class="FunctionCall Identifier Token Variable ID">error</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">   </span><span class="Token Argument VarSuffix COMMENT">-- propagate it</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">      </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">      </span><span class="Identifier Token Variable ID">M</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">M</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">7</span><span class="Token Expression Number SPACE">   </span><span class="Token Expression Number COMMENT">-- increase memory limit</span><span class="Token Expression Number LF">
</span><span class="Token Expression Number SPACE">    </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">format</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;minimum memory for </span><span class="String Token Format STR">%s</span><span class="String Token STR">: </span><span class="String Token Format STR">%d</span><span class="String Token STR"> bytes&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">s</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">M</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">oldM</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="FunctionBody Token Keyword COMMENT">-- test memory errors; increase limit for number of allocations one</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="FunctionBody Token Keyword COMMENT">-- by one, so that we get memory errors in all allocations of a given</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="FunctionBody Token Keyword COMMENT">-- task, until there is enough allocations to complete the task without</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="FunctionBody Token Keyword COMMENT">-- errors.</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">testalloc</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">s</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">f</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">M</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">    </span><span class="Token Statement Keyword WHILE">while</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword TRUE">true</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">      </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">      </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">alloccount</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">M</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">      </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;pcall 0 1 0; pushstatus; return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">      </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">alloccount</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- remove limit</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">      </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;OK&quot;</span><span class="Token SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword BREAK">break</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword SPACE">       </span><span class="Token Statement Keyword COMMENT">-- stop when no more errors</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">      </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;OK&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">MEMERRMSG</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword COMMENT">-- not a memory error?</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">        </span><span class="FunctionCall Identifier Token Variable ID">error</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">   </span><span class="Token Argument VarSuffix COMMENT">-- propagate it</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">      </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">      </span><span class="Identifier Token Variable ID">M</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">M</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE">   </span><span class="Token Expression Number COMMENT">-- increase allocation limit</span><span class="Token Expression Number LF">
</span><span class="Token Expression Number SPACE">    </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">format</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;minimum allocations for </span><span class="String Token Format STR">%s</span><span class="String Token STR">: </span><span class="String Token Format STR">%d</span><span class="String Token STR"> allocations&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">s</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">M</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">testamem</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">s</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">f</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">testalloc</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">s</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">testbytes</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">s</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="FunctionBody Token Keyword COMMENT">-- doing nothing</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">testamem</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;doing nothing&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- testing memory errors when creating a new state</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">testamem</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;state creation&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">st</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">newstate</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">st</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">closestate</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">st</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword SPACE">   </span><span class="Token Statement Keyword COMMENT">-- close new state</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">st</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">testamem</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;empty-table creation&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">testamem</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;string creation&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="String Token STR">&quot;XXX&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator CONCAT">..</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;YYY&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">testamem</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;coroutine creation&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">             </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">coroutine</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">create</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">print</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- testing to-be-closed variables</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">testamem</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;to-be-closed variables&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">flag</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">    </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">      </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName SPACE"> </span><span class="AttributeName Token Attribute BraceDepth-1 LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">close</span><span class="AttributeName Token Attribute BraceDepth-1 RANGLE_BRACE">&gt;</span><span class="AttributeName Token Attribute SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">                </span><span class="FunctionCall Identifier Token Variable ID">setmetatable</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token TableConstructor Expression BraceDepth-2 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-2 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-2 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__close</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Identifier Token Variable ID">flag</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword TRUE">true</span><span class="Token Keyword SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token TableConstructor Expression BraceDepth-2 RCURLY_BRACE">}</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">      </span><span class="Identifier Token Variable ID">flag</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword FALSE">false</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">      </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">flag</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- testing threads</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- get main thread from registry (at index LUA_RIDX_MAINTHREAD == 1)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">mt</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;rawgeti R 1; return 1&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">mt</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;thread&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">coroutine</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">running</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">mt</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">expand</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">n</span><span class="Token COMMA">,</span><span class="Identifier Token ID">s</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">0</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="String Token STR">&quot;&quot;</span><span class="Token SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">e</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">rep</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;=&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">format</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;T.doonnewstack([</span><span class="String Token Format STR">%s</span><span class="String Token STR">[ </span><span class="String Token Format STR">%s</span><span class="String Token STR">;</span><span class="String Control Token STR">\n</span><span class="String Token STR"> collectgarbage(); </span><span class="String Token Format STR">%s</span><span class="String Token STR">]</span><span class="String Token Format STR">%s</span><span class="String Token STR">])</span><span class="String Control Token STR">\n</span><span class="String Token STR">&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">                                </span><span class="Identifier Token Variable ID">e</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">s</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">expand</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">s</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">e</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Identifier Token Variable ID">G</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">0</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;count&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">expand</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">20</span><span class="Token COMMA">,</span><span class="String Token STR">&quot;G=G+1&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">G</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">20</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE">  </span><span class="Token Statement COMMENT">-- assert(gcinfo() &lt;= a+1)</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">  </span><span class="Identifier Token Variable ID">G</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">testamem</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;running code on new thread&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">doonnewstack</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;local x=1&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Expression Number SPACE">  </span><span class="Token Expression Number COMMENT">-- try to create thread</span><span class="Token Expression Number LF">
</span><span class="Token Expression Number SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- testing memory x compiler</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">testamem</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;loadstring&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;x=1&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- try to do load a string</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">testprog</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">[[
  local function foo () return end
  local t = {&quot;x&quot;}
  AA = &quot;aaa&quot;
  for i = 1, #t do AA = AA .. t[i] end
  return true
  ]]</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token COMMENT">-- testing memory x dofile</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">AA</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Identifier Token Variable ID">os</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">tmpname</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">open</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;w&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">f</span><span class="Token VarSuffix COLON">:</span><span class="Identifier Token VarSuffix FunctionCall ID">write</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">testprog</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">f</span><span class="Token VarSuffix COLON">:</span><span class="Identifier Token VarSuffix FunctionCall ID">close</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">testamem</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;dofile&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">loadfile</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">a</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">os</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">remove</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">AA</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;aaax&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- other generic tests</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">testamem</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;gsub&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">gsub</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;alo alo&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;(a)&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token Expression Punctuator CONCAT">..</span><span class="String Token STR">&#x27;b&#x27;</span><span class="Token SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;ablo ablo&#x27;</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">testamem</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;dump/undump&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">testprog</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">dump</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">a</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">AA</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">os</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">tmpname</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">testamem</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;file creation&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">open</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;w&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="FunctionCall Identifier Token Variable SPACE"> </span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">open</span><span class="String Token STR">&quot;nomenaoexistente&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">close</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">loadfile</span><span class="String Token STR">&#x27;nomenaoexistente&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">os</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">remove</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">testamem</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;table creation&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">lim</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token Expression Punctuator CONCAT">..</span><span class="String Token STR">&#x27;a&#x27;</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token TableConstructor Expression SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">lim</span><span class="Token Expression Punctuator CONCAT">..</span><span class="String Token STR">&#x27;a&#x27;</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;table&#x27;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">lim</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">lim</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">testamem</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;constructors&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token Field Number NUMBER">10</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">20</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">30</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">40</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">50</span><span class="Token Punctuator SEMI">;</span><span class="Token Punctuator SPACE"> </span><span class="Identifier Token Field ID">a</span><span class="Token Field ASSIGN">=</span><span class="Token Field Number NUMBER">1</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Identifier Token Field ID">b</span><span class="Token Field ASSIGN">=</span><span class="Token Field Number NUMBER">2</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Identifier Token Field ID">c</span><span class="Token Field ASSIGN">=</span><span class="Token Field Number NUMBER">3</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Identifier Token Field ID">d</span><span class="Token Field ASSIGN">=</span><span class="Token Field Number NUMBER">4</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Identifier Token Field ID">e</span><span class="Token Field ASSIGN">=</span><span class="Token Field Number NUMBER">5</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;table&#x27;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">e</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">5</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">close</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">testamem</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;closure creation&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token FunctionName ID">close</span><span class="FuncName Identifier Token FunctionName SPACE"> </span><span class="FunctionBody Token BraceDepth-1 Statement LPAREN">(</span><span class="Identifier Token ID">b</span><span class="FunctionBody Token BraceDepth-1 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">     </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">    </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">close</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Token Number NUMBER">2</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Token Number NUMBER">4</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">6</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">testamem</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;using coroutines&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">coroutine</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">wrap</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">                </span><span class="Identifier Token Variable ID">coroutine</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">yield</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">rep</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;a&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">                </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-2 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-2 RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">              </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">len</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">a</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">a</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">   </span><span class="Token Statement Keyword COMMENT">-- auxiliary buffer</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">lim</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">100</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;01234567890123456789&quot;</span><span class="Token SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">testamem</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;auxiliary buffer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">      </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">table</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">concat</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;,&quot;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">20</span><span class="Token Number Punctuator MUL">*</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">    </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">testamem</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;growing stack&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">foo</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-1 Statement LPAREN">(</span><span class="Identifier Token ID">n</span><span class="FunctionBody Token BraceDepth-1 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">      </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE"> </span><span class="ElseStatement Token Keyword ELSE">else</span><span class="ElseStatement Token Keyword SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator PLUS">+</span><span class="Token Number Punctuator SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">foo</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">foo</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">100</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- }==================================================================</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">   </span><span class="Token Statement Keyword COMMENT">-- testing failing in &#x27;lua_checkstack&#x27;</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">[[rawcheckstack 500000; return 1]]</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword FALSE">false</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">L</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">newstate</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">alloccount</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">   </span><span class="Token Argument VarSuffix COMMENT">-- will be unable to reallocate the stack</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">[[rawcheckstack 5000; return 1]]</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">alloccount</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">closestate</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword FALSE">false</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">   </span><span class="Token Statement Keyword COMMENT">-- closing state with no extra memory</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">L</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">newstate</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">alloccount</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">closestate</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">alloccount</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">   </span><span class="Token Statement Keyword COMMENT">-- garbage collection with no extra memory</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">L</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">newstate</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">loadlib</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Expression Token BraceDepth-0 Variable LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">doremote</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">L</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">[[
      _ENV = require&quot;_G&quot;
      local T = require&quot;T&quot;
      local a = {}
      for i = 1, 1000 do a[i] = &#x27;i&#x27; .. i end    -- grow string table
      local stsize, stuse = T.querystr()
      assert(stuse &gt; 1000)
      local function foo (n)
        if n &gt; 0 then foo(n - 1) end
      end
      foo(180)    -- grow stack
      local _, stksize = T.stacklevel()
      assert(stksize &gt; 180)
      a = nil
      T.alloccount(0)
      collectgarbage()
      T.alloccount()
      -- stack and string table could not be reallocated,
      -- so they kept their sizes (without errors)
      assert(select(2, T.stacklevel()) == stksize)
      assert(T.querystr() == stsize)
      return &#x27;ok&#x27;
    ]]</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Expression Token BraceDepth-0 Variable RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;ok&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">closestate</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">L</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="String Token STR">&#x27;+&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token COMMENT">-- testing some auxlib functions</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">gsub</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">c</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;gsub 2 3 4; gettop; return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">5</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">gsub</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;alo.alo.uhuh.&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;.&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;//&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;alo//alo//uhuh//&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">gsub</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;alo.alo.uhuh.&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;alo&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;//&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;//.//.uhuh.&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">gsub</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;alo&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;//&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">gsub</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;...&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;.&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;/.&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;/././.&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">gsub</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;...&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;...&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- testing luaL_newmetatable</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">mt_xuxu</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">top</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;newmetatable xuxu; gettop; return 3&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">mt_xuxu</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;table&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">top</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">d</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">top</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;newmetatable xuxu; gettop; return 3&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">mt_xuxu</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">top</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">d</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">top</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;newmetatable xuxu1; gettop; return 3&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">mt_xuxu</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">top</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">newuserdata</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">  </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">newuserdata</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;pushstring xuxu; gettable R; setmetatable 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">getmetatable</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">mt_xuxu</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- testing luaL_testudata</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- correct metatable</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">res1</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">res2</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">top</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">[[testudata -1 xuxu
                        testudata 2 xuxu
                    gettop
                    return 3]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">res1</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">res2</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">top</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">4</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- wrong metatable</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">res1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">res2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">top</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">[[testudata -1 xuxu1
                  testudata 2 xuxu1
                  gettop
                  return 3]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">res1</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">res2</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">top</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">4</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- non-existent type</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">res1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">res2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">top</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">[[testudata -1 xuxu2
                  testudata 2 xuxu2
                  gettop
                  return 3]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">res1</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">res2</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">top</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">4</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- userdata has no metatable</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">res1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">res2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">top</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">testC</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">[[testudata -1 xuxu
                  testudata 2 xuxu
                  gettop
                  return 3]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">res1</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">res2</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">top</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">4</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- erase metatables</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">r</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">getregistry</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">r</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">xuxu</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">mt_xuxu</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">r</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">xuxu1</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">r</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">xuxu</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">r</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">xuxu1</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="String Token STR">&#x27;OK&#x27;</span></code></pre><h2 id="h2-7"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/7.lua" target="_blank">7.lua</a></h2><pre class="language-lua"><code><span class="Token COMMENT">-- $Id: testes/attrib.lua $</span><span class="Token LF">
</span><span class="Token COMMENT">-- See Copyright Notice in file all.lua</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="FunctionCall Identifier Token Variable SPACE"> </span><span class="String Token STR">&quot;testing require&quot;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">require</span><span class="String Token STR">&quot;string&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">require</span><span class="String Token STR">&quot;math&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">require</span><span class="String Token STR">&quot;table&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">table</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">require</span><span class="String Token STR">&quot;io&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">io</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">require</span><span class="String Token STR">&quot;os&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">os</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">require</span><span class="String Token STR">&quot;coroutine&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">coroutine</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">path</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;string&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">cpath</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;string&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">loaded</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;table&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">preload</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;table&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">config</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;string&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;package config: &quot;</span><span class="Token Expression Punctuator CONCAT">..</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">gsub</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">config</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;</span><span class="String Control Token STR">\n</span><span class="String Token STR">&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;|&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- create a path with &#x27;max&#x27; templates,</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- each with 1-10 repetitions of &#x27;?&#x27;</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">max</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">_soft</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Number NUMBER">100</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword OR">or</span><span class="Token Number Keyword SPACE"> </span><span class="Token Number NUMBER">2000</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Identifier Token Variable ID">max</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">rep</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;?&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token Expression Punctuator MOD">%</span><span class="Token Expression Number NUMBER">10</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator PLUS">+</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;;&quot;</span><span class="Token SPACE">    </span><span class="Token COMMENT">-- empty template</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">path</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">table</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">concat</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;;&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- use that path in a search</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">s</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">err</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">searchpath</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;xuxu&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">path</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- search fails; check that message has an occurrence of</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- &#x27;??????????&#x27; with ? replaced by xuxu and at least &#x27;max&#x27; lines</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">s</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword LF">
</span><span class="Token Expression Keyword SPACE">         </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">find</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">err</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">rep</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&quot;xuxu&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword LF">
</span><span class="Token Expression Keyword SPACE">         </span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">gsub</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">err</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;[^</span><span class="String Control Token STR">\n</span><span class="String Token STR">]&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator GE">&gt;=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">max</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- path with one very long template</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">path</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">rep</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;?&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">max</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">s</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">err</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">searchpath</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;xuxu&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">path</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">s</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">find</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">err</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">rep</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;xuxu&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">max</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">oldpath</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">path</span><span class="Identifier Token VarSuffix TableKey LF">
</span><span class="Identifier Token VarSuffix TableKey SPACE">  </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">path</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">s</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">err</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">require</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;no-such-file&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">s</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">find</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">err</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;package.path&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">path</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">oldpath</span><span class="Identifier Token Variable LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="String Token STR">&quot;testing &#x27;require&#x27; message&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">oldpath</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">path</span><span class="Identifier Token VarSuffix TableKey LF">
</span><span class="Identifier Token VarSuffix TableKey SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">oldcpath</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">cpath</span><span class="Identifier Token VarSuffix TableKey LF">
</span><span class="Identifier Token VarSuffix TableKey SPACE">  </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">path</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;?.lua;?/?&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">cpath</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;?.so;?/init&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">st</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">msg</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">require</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;XXX&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">expected</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">[[module &#x27;XXX&#x27; not found:
    no field package.preload[&#x27;XXX&#x27;]
    no file &#x27;XXX.lua&#x27;
    no file &#x27;XXX/XXX&#x27;
    no file &#x27;XXX.so&#x27;
    no file &#x27;XXX/init&#x27;]]</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">msg</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">expected</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">path</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">oldpath</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">cpath</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">oldcpath</span><span class="Identifier Token Variable LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;+&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- The next tests for &#x27;require&#x27; assume some specific directories and</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- libraries.</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">_port</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword COMMENT">--[</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">dirsep</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">match</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">config</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;^([^</span><span class="String Control Token STR">\n</span><span class="String Token STR">]+)</span><span class="String Control Token STR">\n</span><span class="String Token STR">&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- auxiliary directory with C modules and temporary files</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">DIR</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;libs&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator CONCAT">..</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">dirsep</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable COMMENT">-- prepend DIR to a name and correct directory separators</span><span class="Identifier Token Variable LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">D</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">gsub</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;/&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">dirsep</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">DIR</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator CONCAT">..</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword COMMENT">-- prepend DIR and pospend proper C lib. extension to a name</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">DC</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">ext</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Expression Token BraceDepth-0 Variable LPAREN">(</span><span class="Identifier Token Variable ID">dirsep</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;</span><span class="String Control Token STR">\\</span><span class="String Token STR">&#x27;</span><span class="Expression Token BraceDepth-0 Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="String Token STR">&quot;.dll&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword OR">or</span><span class="Token Expression Keyword SPACE"> </span><span class="String Token STR">&quot;.so&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">D</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator CONCAT">..</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">ext</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">createfiles</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">files</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">preextras</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">posextras</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token ID">n</span><span class="Token COMMA">,</span><span class="Identifier Token ID">c</span><span class="Identifier Token SPACE"> </span><span class="Token Statement Keyword IN">in</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pairs</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">files</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">output</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">D</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">write</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">format</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">preextras</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">write</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">write</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">format</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">posextras</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">close</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">io</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">output</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">removefiles</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">files</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token ID">n</span><span class="Identifier Token SPACE"> </span><span class="Token Statement Keyword IN">in</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pairs</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">files</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Identifier Token Variable ID">os</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">remove</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">D</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">files</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="Token BraceDepth-1 Field FieldList LSQUAR_PAREN">[</span><span class="String Token STR">&quot;names.lua&quot;</span><span class="Token BraceDepth-1 Field FieldList RSQUAR_PAREN">]</span><span class="Token Field FieldList SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="String Token STR">&quot;do return {...} end</span><span class="String Control Token STR">\n</span><span class="String Token STR">&quot;</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator LF">
</span><span class="Token Punctuator SPACE">  </span><span class="Token Field BraceDepth-1 LSQUAR_PAREN">[</span><span class="String Token STR">&quot;err.lua&quot;</span><span class="Token Field BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="String Token STR">&quot;B = 15; a = a + 1;&quot;</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator LF">
</span><span class="Token Punctuator SPACE">  </span><span class="Token Field BraceDepth-1 LSQUAR_PAREN">[</span><span class="String Token STR">&quot;synerr.lua&quot;</span><span class="Token Field BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="String Token STR">&quot;B =&quot;</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator LF">
</span><span class="Token Punctuator SPACE">  </span><span class="Token Field BraceDepth-1 LSQUAR_PAREN">[</span><span class="String Token STR">&quot;A.lua&quot;</span><span class="Token Field BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="String Token STR">&quot;&quot;</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator LF">
</span><span class="Token Punctuator SPACE">  </span><span class="Token Field BraceDepth-1 LSQUAR_PAREN">[</span><span class="String Token STR">&quot;B.lua&quot;</span><span class="Token Field BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="String Token STR">&quot;assert(...==&#x27;B&#x27;);require &#x27;A&#x27;&quot;</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator LF">
</span><span class="Token Punctuator SPACE">  </span><span class="Token Field BraceDepth-1 LSQUAR_PAREN">[</span><span class="String Token STR">&quot;A.lc&quot;</span><span class="Token Field BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="String Token STR">&quot;&quot;</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator LF">
</span><span class="Token Punctuator SPACE">  </span><span class="Token Field BraceDepth-1 LSQUAR_PAREN">[</span><span class="String Token STR">&quot;A&quot;</span><span class="Token Field BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="String Token STR">&quot;&quot;</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator LF">
</span><span class="Token Punctuator SPACE">  </span><span class="Token Field BraceDepth-1 LSQUAR_PAREN">[</span><span class="String Token STR">&quot;L&quot;</span><span class="Token Field BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="String Token STR">&quot;&quot;</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator LF">
</span><span class="Token Punctuator SPACE">  </span><span class="Token Field BraceDepth-1 LSQUAR_PAREN">[</span><span class="String Token STR">&quot;XXxX&quot;</span><span class="Token Field BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="String Token STR">&quot;&quot;</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator LF">
</span><span class="Token Punctuator SPACE">  </span><span class="Token Field BraceDepth-1 LSQUAR_PAREN">[</span><span class="String Token STR">&quot;C.lua&quot;</span><span class="Token Field BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="String Token STR">&quot;package.loaded[...] = 25; require&#x27;C&#x27;&quot;</span><span class="FieldList Token Punctuator COMMA">,</span><span class="FieldList Token Punctuator LF">
</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression LF">
</span><span class="Identifier Token Variable ID">AA</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">extras</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">[[
NAME = &#x27;</span><span class="String Token Format STR">%s</span><span class="String Token STR">&#x27;
REQUIRED = ...
return AA]]</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="FunctionCall Identifier Token Variable ID">createfiles</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">files</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">extras</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- testing explicit &quot;dir&quot; separator in &#x27;searchpath&#x27;</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">searchpath</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;C.lua&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">D</span><span class="String Token STR">&quot;?&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">D</span><span class="String Token STR">&quot;C.lua&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">searchpath</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;C.lua&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">D</span><span class="String Token STR">&quot;?&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;.&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;.&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">D</span><span class="String Token STR">&quot;C.lua&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">searchpath</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;--x-&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">D</span><span class="String Token STR">&quot;?&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;-&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;X&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">D</span><span class="String Token STR">&quot;XXxX&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">searchpath</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;---xX&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">D</span><span class="String Token STR">&quot;?&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;---&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;XX&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">D</span><span class="String Token STR">&quot;XXxX&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">searchpath</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">D</span><span class="String Token STR">&quot;C.lua&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;?&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">dirsep</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">D</span><span class="String Token STR">&quot;C.lua&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">searchpath</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;.</span><span class="String Control Token STR">\\</span><span class="String Token STR">C.lua&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">D</span><span class="String Token STR">&quot;?&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;</span><span class="String Control Token STR">\\</span><span class="String Token STR">&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">D</span><span class="String Token STR">&quot;./C.lua&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">oldpath</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">path</span><span class="Identifier Token VarSuffix TableKey LF">
</span><span class="Identifier Token VarSuffix TableKey LF">
</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">path</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">gsub</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;D/?.lua;D/?.lc;D/?;D/??x?;D/L&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;D/&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">DIR</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName FunctionName ID">try</span><span class="Identifier Token AttributeName FunctionName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="Identifier Token ID">p</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">n</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">r</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">ext</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">  </span><span class="Identifier Token Variable ID">NAME</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">rr</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">require</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">p</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">NAME</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">REQUIRED</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">rr</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">r</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">ext</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">require</span><span class="String Token STR">&quot;names&quot;</span><span class="Token LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;names&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">D</span><span class="String Token STR">&quot;names.lua&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">st</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">msg</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">require</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;err&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">st</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">find</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;arithmetic&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">B</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">15</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">st</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">msg</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">require</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;synerr&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">st</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">find</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;error loading module&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">searchpath</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;C&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">path</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">D</span><span class="String Token STR">&quot;C.lua&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">require</span><span class="String Token STR">&quot;C&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">25</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">require</span><span class="String Token STR">&quot;C&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">25</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">AA</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">try</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;B&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;B.lua&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword TRUE">true</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;libs/B.lua&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">loaded</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">B</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">require</span><span class="String Token STR">&quot;B&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword TRUE">true</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">loaded</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">A</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">require</span><span class="String Token STR">&quot;C&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">25</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">loaded</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">A</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">try</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;B&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword TRUE">true</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">   </span><span class="Token Argument VarSuffix COMMENT">-- should not reload package</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">try</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;A&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;A.lua&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword TRUE">true</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;libs/A.lua&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">loaded</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">A</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Identifier Token Variable ID">os</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">remove</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">D</span><span class="String Token STR">&#x27;A.lua&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">AA</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="FunctionCall Identifier Token Variable ID">try</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;A&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;A.lc&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">AA</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;libs/A.lc&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- now must find second option</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">searchpath</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;A&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">path</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">D</span><span class="String Token STR">&quot;A.lc&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">require</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;A&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">AA</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">AA</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword FALSE">false</span><span class="Token Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">try</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;K&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;L&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword FALSE">false</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;libs/L&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">     </span><span class="Token Argument VarSuffix COMMENT">-- default option</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">try</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;K&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;L&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword FALSE">false</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;libs/L&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">     </span><span class="Token Argument VarSuffix COMMENT">-- default option (should reload it)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">rawget</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">_G</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;_REQUIREDNAME&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">AA</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;x&quot;</span><span class="Token LF">
</span><span class="FunctionCall Identifier Token Variable ID">try</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;X&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;XXxX&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">AA</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;libs/XXxX&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">removefiles</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">files</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">NAME</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">REQUIRED</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">AA</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">B</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword LF">
</span><span class="Token Keyword LF">
</span><span class="Token Keyword COMMENT">-- testing require of sub-packages</span><span class="Token Keyword LF">
</span><span class="Token Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">_G</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">path</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">gsub</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;D/?.lua;D/?/init.lua&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;D/&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">DIR</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">files</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="Token BraceDepth-1 Field FieldList LSQUAR_PAREN">[</span><span class="String Token STR">&quot;P1/init.lua&quot;</span><span class="Token BraceDepth-1 Field FieldList RSQUAR_PAREN">]</span><span class="Token Field FieldList SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="String Token STR">&quot;AA = 10&quot;</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator LF">
</span><span class="Token Punctuator SPACE">  </span><span class="Token Field BraceDepth-1 LSQUAR_PAREN">[</span><span class="String Token STR">&quot;P1/xuxu.lua&quot;</span><span class="Token Field BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="String Token STR">&quot;AA = 20&quot;</span><span class="FieldList Token Punctuator COMMA">,</span><span class="FieldList Token Punctuator LF">
</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression LF">
</span><span class="FunctionCall Identifier Token Variable ID">createfiles</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">files</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;_ENV = {}</span><span class="String Control Token STR">\n</span><span class="String Token STR">&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;</span><span class="String Control Token STR">\n</span><span class="String Token STR">return _ENV</span><span class="String Control Token STR">\n</span><span class="String Token STR">&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">AA</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Number LF">
</span><span class="Token Number LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">m</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">ext</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">require</span><span class="String Token STR">&quot;P1&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">ext</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;libs/P1/init.lua&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">AA</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">AA</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">require</span><span class="String Token STR">&quot;P1&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">require</span><span class="String Token STR">&quot;P1&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">searchpath</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;P1.xuxu&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">path</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">D</span><span class="String Token STR">&quot;P1/xuxu.lua&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">m</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix ID">xuxu</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">ext</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">require</span><span class="String Token STR">&quot;P1.xuxu&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">AA</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">xuxu</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">AA</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">20</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">ext</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;libs/P1/xuxu.lua&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">require</span><span class="String Token STR">&quot;P1.xuxu&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">xuxu</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">require</span><span class="String Token STR">&quot;P1.xuxu&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">xuxu</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">require</span><span class="String Token STR">&quot;P1&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">AA</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">removefiles</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">files</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">AA</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword LF">
</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">path</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;&quot;</span><span class="Token LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">require</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;file_does_not_exist&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">path</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;??\0?&quot;</span><span class="Token LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">require</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;file_does_not_exist1&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">path</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">oldpath</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable COMMENT">-- check &#x27;require&#x27; error message</span><span class="Identifier Token Variable LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">fname</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;file_does_not_exist2&quot;</span><span class="Token LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">m</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">err</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">require</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">fname</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token ID">t</span><span class="Identifier Token SPACE"> </span><span class="Token Statement Keyword IN">in</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">gmatch</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">path</span><span class="Token Expression Punctuator CONCAT">..</span><span class="String Token STR">&quot;;&quot;</span><span class="Token Expression Punctuator CONCAT">..</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">cpath</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;[^;]+&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">gsub</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;?&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">fname</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">find</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">err</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword TRUE">true</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- testing &#x27;package.searchers&#x27; not being a table</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">searchers</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">searchers</span><span class="Identifier Token VarSuffix TableKey LF">
</span><span class="Identifier Token VarSuffix TableKey SPACE">  </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">searchers</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">st</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">msg</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">require</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;a&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">st</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">find</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;must be a table&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">searchers</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">searchers</span><span class="Identifier Token Variable LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">import</span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="FunctionBody Token Punctuator VARARGS">...</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Token Expression Punctuator VARARGS">...</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="Identifier Token ID">m</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">f</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">f</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword COMMENT">-- cannot change environment of a C function</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">module</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;XUXU&#x27;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- testing require of C libraries</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">p</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;&quot;</span><span class="Token SPACE">   </span><span class="Token COMMENT">-- On Mac OS X, redefine this to &quot;_&quot;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token COMMENT">-- check whether loadlib works in this system</span><span class="Token LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">st</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">err</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">when</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">loadlib</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">DC</span><span class="String Token STR">&quot;lib1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;*&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">st</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">err</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">when</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">loadlib</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;donotexist&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="Token Expression Punctuator CONCAT">..</span><span class="String Token STR">&quot;xuxu&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">err</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;string&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">when</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;absent&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement SEMI">;</span><span class="Token BraceDepth-0 Variable LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">Message</span><span class="FunctionCall Identifier Token Variable SPACE"> </span><span class="FunctionCall Token Expression Keyword OR">or</span><span class="FunctionCall Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token BraceDepth-0 Variable RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;</span><span class="String Control Token STR">\n</span><span class="String Token STR"> &gt;&gt;&gt; cannot load dynamic library &lt;&lt;&lt;</span><span class="String Control Token STR">\n</span><span class="String Token STR">&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">err</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">when</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="ElseStatement Token Keyword ELSE">else</span><span class="ElseStatement Token Keyword LF">
</span><span class="ElseStatement Token Keyword SPACE">  </span><span class="ElseStatement Token Keyword COMMENT">-- tests for loadlib</span><span class="ElseStatement Token Keyword LF">
</span><span class="ElseStatement Token Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">loadlib</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">DC</span><span class="String Token STR">&quot;lib1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="Token Expression Punctuator CONCAT">..</span><span class="String Token STR">&quot;onefunction&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">15</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">25</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">25</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">15</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">loadlib</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">DC</span><span class="String Token STR">&quot;lib1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="Token Expression Punctuator CONCAT">..</span><span class="String Token STR">&quot;anotherfunc&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;10</span><span class="String Token Format STR">%20</span><span class="String Control Token STR">\n</span><span class="String Token STR">&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- check error messages</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">err</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">when</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">loadlib</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">DC</span><span class="String Token STR">&quot;lib1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="Token Expression Punctuator CONCAT">..</span><span class="String Token STR">&quot;xuxu&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">err</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;string&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">when</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;init&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">err</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">when</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">loadlib</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;donotexist&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="Token Expression Punctuator CONCAT">..</span><span class="String Token STR">&quot;xuxu&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">err</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;string&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">when</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;open&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- symbols from &#x27;lib1&#x27; must be visible to other libraries</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">loadlib</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">DC</span><span class="String Token STR">&quot;lib11&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="Token Expression Punctuator CONCAT">..</span><span class="String Token STR">&quot;luaopen_lib11&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;exported&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- test C modules with prefixes in names</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">cpath</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">DC</span><span class="String Token STR">&quot;?&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">lib2</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">ext</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">require</span><span class="String Token STR">&quot;lib2-v2&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">find</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">ext</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;libs/lib2-v2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword TRUE">true</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- check correct access to global environment and correct</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- parameters</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">_ENV</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">x</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;lib2-v2&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">_ENV</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">y</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">DC</span><span class="String Token STR">&quot;lib2-v2&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">lib2</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">id</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;x&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword TRUE">true</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">   </span><span class="Token Argument VarSuffix COMMENT">-- a different &quot;id&quot; implementation</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- test C submodules</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">fs</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">ext</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">require</span><span class="String Token STR">&quot;lib1.sub&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">_ENV</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">x</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;lib1.sub&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">_ENV</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">y</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">DC</span><span class="String Token STR">&quot;lib1&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">find</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">ext</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;libs/lib1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword TRUE">true</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">fs</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">id</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">45</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">45</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">_ENV</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">_ENV</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix ID">y</span><span class="Identifier Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Identifier Token Variable ID">_ENV</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable COMMENT">-- testing preload</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">p</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable ID">package</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="Identifier Token Variable ID">p</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">preload</span><span class="Token VarSuffix DOT">.</span><span class="Token VarSuffix TableKey FunctionName Identifier ID">pl</span><span class="Token VarSuffix TableKey FunctionName Identifier SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="FunctionBody Token Punctuator VARARGS">...</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">_ENV</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Token Expression Punctuator VARARGS">...</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token FunctionName ID">xuxu</span><span class="FuncName Identifier Token FunctionName SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Number NUMBER">20</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">_ENV</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">pl</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">ext</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">require</span><span class="String Token STR">&quot;pl&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">require</span><span class="String Token STR">&quot;pl&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">pl</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">pl</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">xuxu</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">30</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">pl</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;pl&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">pl</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;:preload:&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">ext</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;:preload:&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">package</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">path</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;string&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;+&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">--]</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;testing assignments, logical operators, and constructors&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">res2</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">27</span><span class="Token Number LF">
</span><span class="Token Number LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number Punctuator PLUS">+</span><span class="Token Number NUMBER">3</span><span class="Token Number LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">5</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token Statement ASSIGN">=</span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">f</span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">11</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">12</span><span class="Token Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">x</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">2</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Number NUMBER">3</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;x&#x27;</span><span class="Token LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">10</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">13</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;x&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName FunctionName ID">f</span><span class="Identifier Token AttributeName FunctionName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="Identifier Token ID">n</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token Statement ASSIGN">=</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">                         </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">table</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">unpack</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">b</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">c</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">5</span><span class="Token COMMA">,</span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">4</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">0</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">5</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">5</span><span class="Token COMMA">,</span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">0</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">5</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">c</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">d</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Token Number Keyword NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE"> </span><span class="Token Number Keyword OR">or</span><span class="Token Number Keyword SPACE"> </span><span class="Token Number Keyword NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token BraceDepth-0 Variable LPAREN">(</span><span class="Token Variable Number NUMBER">1</span><span class="Token Variable Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Variable Keyword NIL">nil</span><span class="Token Variable Keyword SPACE"> </span><span class="Token Keyword OR">or</span><span class="Token Keyword SPACE"> </span><span class="Token Keyword Number NUMBER">1</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token BraceDepth-0 Variable RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">6</span><span class="Token Number LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">6</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Number LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">10</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">11</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">12</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">10</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token BraceDepth-1 Expression Punctuator LANGLE_BRACE">&lt;</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword FALSE">false</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Keyword AND">and</span><span class="Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token BraceDepth-1 Expression Punctuator RANGLE_BRACE">&gt;</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword TRUE">true</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">10</span><span class="Token Variable Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">10</span><span class="Token Variable Number SPACE"> </span><span class="Token Number Keyword OR">or</span><span class="Token Number Keyword SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">10</span><span class="Token Variable Number SPACE"> </span><span class="Token Number Keyword OR">or</span><span class="Token Number Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Token Keyword NIL">nil</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Variable Keyword NIL">nil</span><span class="Token Variable Keyword SPACE"> </span><span class="Token Keyword AND">and</span><span class="Token Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Token Keyword NIL">nil</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Variable Keyword NIL">nil</span><span class="Token Variable Keyword SPACE"> </span><span class="Token Keyword OR">or</span><span class="Token Keyword SPACE"> </span><span class="String Token STR">&quot;alo&quot;</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;alo&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Variable Keyword NIL">nil</span><span class="Token Variable Keyword SPACE"> </span><span class="Token Keyword AND">and</span><span class="Token Keyword SPACE"> </span><span class="Token Keyword Number NUMBER">10</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Variable Keyword FALSE">false</span><span class="Token Variable Keyword SPACE"> </span><span class="Token Keyword AND">and</span><span class="Token Keyword SPACE"> </span><span class="Token Keyword Number NUMBER">10</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword FALSE">false</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Variable Keyword TRUE">true</span><span class="Token Variable Keyword SPACE"> </span><span class="Token Keyword OR">or</span><span class="Token Keyword SPACE"> </span><span class="Token Keyword Number NUMBER">10</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword TRUE">true</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Variable Keyword FALSE">false</span><span class="Token Variable Keyword SPACE"> </span><span class="Token Keyword OR">or</span><span class="Token Keyword SPACE"> </span><span class="Token Keyword Number NUMBER">10</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Keyword FALSE">false</span><span class="Token Keyword SPACE"> </span><span class="Token Keyword Punctuator NORE">~=</span><span class="Token Keyword Punctuator SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Keyword NIL">nil</span><span class="Token Keyword SPACE"> </span><span class="Token Keyword Punctuator NORE">~=</span><span class="Token Keyword Punctuator SPACE"> </span><span class="Token Keyword FALSE">false</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Keyword Punctuator EQ">==</span><span class="Token Keyword Punctuator SPACE"> </span><span class="Token Keyword TRUE">true</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Keyword Punctuator EQ">==</span><span class="Token Keyword Punctuator SPACE"> </span><span class="Token Keyword FALSE">false</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator EQ">==</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number Keyword TRUE">true</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword TRUE">true</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">6</span><span class="Token Variable Number SPACE"> </span><span class="Token Number Keyword OR">or</span><span class="Token Number Keyword SPACE"> </span><span class="Token Number Keyword NIL">nil</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword TRUE">true</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Variable Keyword NIL">nil</span><span class="Token Variable Keyword SPACE"> </span><span class="Token Keyword AND">and</span><span class="Token Keyword SPACE"> </span><span class="Token Keyword Number NUMBER">56</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword FALSE">false</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Variable Keyword NIL">nil</span><span class="Token Variable Keyword SPACE"> </span><span class="Token Keyword AND">and</span><span class="Token Keyword SPACE"> </span><span class="Token Keyword TRUE">true</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword FALSE">false</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator EQ">==</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number Keyword FALSE">false</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token TableConstructor Expression SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword FALSE">false</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Number NUMBER">0.5</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator EQ">==</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number Keyword FALSE">false</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="String Token STR">&quot;x&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword FALSE">false</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token TableConstructor Expression SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;+&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Keyword TRUE">true</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Number LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Keyword FALSE">false</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token Number BraceDepth-2 Punctuator LANGLE_BRACE">&lt;</span><span class="Token Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">20</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token Number BraceDepth-2 Punctuator RANGLE_BRACE">&gt;</span><span class="Token Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token FunctionName ID">f</span><span class="FunctionBody Token BraceDepth-2 Statement LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionBody Token BraceDepth-2 Statement RPAREN">)</span><span class="FunctionBody Token Statement SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-2 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-2 RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">3000</span><span class="Token Statement COMMA">,</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">3000</span><span class="Token Statement COMMA">,</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0.0</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">10e30</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;alo&quot;</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Token VarSuffix Keyword TRUE">true</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Token VarSuffix Keyword FALSE">false</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Number LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">10e30</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;alo&#x27;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">20</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">10</span><span class="Token Number BraceDepth-1 Punctuator LANGLE_BRACE">&lt;</span><span class="Token Number NUMBER">20</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">3000</span><span class="Token Statement COMMA">,</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">3000</span><span class="Token Statement COMMA">,</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">print</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">assert</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">f</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">print</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">print</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">f</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">print</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Keyword NIL">nil</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Token BraceDepth-1 Field FieldList LSQUAR_PAREN">[</span><span class="Token Field Keyword NIL">nil</span><span class="Token BraceDepth-1 Field FieldList RSQUAR_PAREN">]</span><span class="Token Field FieldList SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Token Field Number NUMBER">10</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Token VarSuffix Keyword NIL">nil</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">undef</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">c</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Token Field Number NUMBER">10</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">9</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">8</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">7</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">6</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">5</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">4</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">3</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">2</span><span class="Token Punctuator SEMI">;</span><span class="Token Punctuator SPACE"> </span><span class="Token BraceDepth-0 Field LSQUAR_PAREN">[</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">3</span><span class="Token BraceDepth-0 Field RSQUAR_PAREN">]</span><span class="Token Field ASSIGN">=</span><span class="String Token STR">&#x27;a&#x27;</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token BraceDepth-0 Field LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">f</span><span class="Token BraceDepth-0 Field RSQUAR_PAREN">]</span><span class="Token Field ASSIGN">=</span><span class="Identifier Token Variable ID">print</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Identifier Token Field ID">a</span><span class="Token Field ASSIGN">=</span><span class="String Token STR">&#x27;a&#x27;</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Identifier Token Field ID">b</span><span class="Token Field ASSIGN">=</span><span class="String Token STR">&#x27;ab&#x27;</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix ID">y</span><span class="Identifier Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">3</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">10</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">3</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token Expression Punctuator EQ">==</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">a</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">f</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token Expression Punctuator EQ">==</span><span class="Identifier Token Variable ID">print</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">x</span><span class="Token Expression Punctuator EQ">==</span><span class="String Token STR">&#x27;a&#x27;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">y</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token Field BraceDepth-2 FieldList LSQUAR_PAREN">[</span><span class="String Token STR">&#x27;alo&#x27;</span><span class="Token Field BraceDepth-2 FieldList RSQUAR_PAREN">]</span><span class="Token Field FieldList ASSIGN">=</span><span class="Identifier Token Variable ID">assert</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">f</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">6</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">23</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">alo</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">10</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">10</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token Expression Punctuator EQ">==</span><span class="Identifier Token Variable ID">print</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">aVeryLongName012345678901234567890123456789012345678901234567890123456789</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">foo</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-1 Statement LPAREN">(</span><span class="FunctionBody Token BraceDepth-1 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">aVeryLongName012345678901234567890123456789012345678901234567890123456789</span><span class="Identifier Token VarSuffix TableKey LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">foo</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">aVeryLongName012345678901234567890123456789012345678901234567890123456789</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator LF">
</span><span class="Token Expression Number NUMBER">10</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- _ENV constant</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">foo</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-1 Statement LPAREN">(</span><span class="FunctionBody Token BraceDepth-1 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">_ENV</span><span class="Identifier Token AttributeName SPACE"> </span><span class="AttributeName Token Attribute BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="AttributeName Token Attribute BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Token Attribute SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">11</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token Variable ID">X</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;hi&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">st</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">msg</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">foo</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">st</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">find</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;number&quot;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword COMMENT">-- test of large float/integer indices</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword COMMENT">-- compute maximum integer where all bits fit in a float</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">maxint</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">maxinteger</span><span class="Identifier Token VarSuffix TableKey LF">
</span><span class="Identifier Token VarSuffix TableKey LF">
</span><span class="Identifier Token VarSuffix TableKey COMMENT">-- trim (if needed) to fit in a float</span><span class="Identifier Token VarSuffix TableKey LF">
</span><span class="Token Statement Keyword WHILE">while</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">maxint</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">maxint</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0.0</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Keyword OR">or</span><span class="Token Expression Keyword SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">maxint</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">maxint</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1.0</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Identifier Token Variable ID">maxint</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">maxint</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator DOUBLE_DIV">//</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Expression Number LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">maxintF</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">maxint</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0.0</span><span class="Token Expression Number SPACE">   </span><span class="Token Expression Number COMMENT">-- float version</span><span class="Token Expression Number LF">
</span><span class="Token Expression Number LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">maxintF</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">maxint</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">type</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">maxintF</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;float&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword LF">
</span><span class="Token Expression Keyword SPACE">       </span><span class="Identifier Token Variable ID">maxintF</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator GE">&gt;=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2.0</span><span class="Token Number Punctuator CARET">^</span><span class="Token Number NUMBER">14</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- floats and integers must index the same places</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">maxintF</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">maxintF</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1.0</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">11</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator MINUS">-</span><span class="Identifier Token Variable ID">maxintF</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">12</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator MINUS">-</span><span class="Identifier Token Variable ID">maxintF</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1.0</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">13</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">maxint</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">maxint</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">11</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword LF">
</span><span class="Token Number Keyword SPACE">       </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator MINUS">-</span><span class="Identifier Token Variable ID">maxint</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">12</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator MINUS">-</span><span class="Identifier Token Variable ID">maxint</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">13</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">maxint</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Number LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator MINUS">-</span><span class="Identifier Token Variable ID">maxint</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">22</span><span class="Token Number LF">
</span><span class="Token Number LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">maxintF</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">20</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">maxintF</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1.0</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">11</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword LF">
</span><span class="Token Number Keyword SPACE">       </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator MINUS">-</span><span class="Identifier Token Variable ID">maxintF</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">22</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator MINUS">-</span><span class="Identifier Token Variable ID">maxintF</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1.0</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">13</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword LF">
</span><span class="Token Keyword LF">
</span><span class="Token Keyword COMMENT">-- test conflicts in multiple assignment</span><span class="Token Keyword LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">i</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">j</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="String Token STR">&#x27;a&#x27;</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="String Token STR">&#x27;b&#x27;</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">j</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">2</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Statement ASSIGN">=</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">j</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">j</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token Expression Punctuator PLUS">+</span><span class="Identifier Token Variable ID">j</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">j</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">j</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">j</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword LF">
</span><span class="Token Number Keyword SPACE">         </span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">3</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">foo</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-1 Statement LPAREN">(</span><span class="FunctionBody Token BraceDepth-1 Statement RPAREN">)</span><span class="FunctionBody Token Statement SPACE">    </span><span class="FunctionBody Token Statement COMMENT">-- assigining to upvalues</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">foo</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">20</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">x</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword COMMENT">-- repeat test with upvalues</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">i</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">j</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="String Token STR">&#x27;a&#x27;</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="String Token STR">&#x27;b&#x27;</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">j</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">2</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Statement ASSIGN">=</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">foo</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-1 Statement LPAREN">(</span><span class="FunctionBody Token BraceDepth-1 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">j</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">j</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token Expression Punctuator PLUS">+</span><span class="Identifier Token Variable ID">j</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">j</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">j</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">foo</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">j</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword LF">
</span><span class="Token Number Keyword SPACE">         </span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">3</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="Token Variable BraceDepth-1 LPAREN">(</span><span class="FunctionDefinition Token FunctionCall Keyword FUNCTION">function</span><span class="FunctionDefinition Token FunctionCall Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="Identifier Token FunctionCall ID">a</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="FunctionCall Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">a</span><span class="FunctionCall Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token FunctionCall Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token FunctionCall Number NUMBER">20</span><span class="Token FunctionCall Number SPACE">  </span><span class="FunctionBody Token FunctionCall Keyword END">end</span><span class="Token Variable BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword COMMENT">-- bug in 5.2 beta</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">foo</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-1 Statement LPAREN">(</span><span class="FunctionBody Token BraceDepth-1 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">  </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">14</span><span class="Token Number SPACE">    </span><span class="Token Number COMMENT">-- local and upvalue have same index</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">foo</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">14</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&#x27;OK&#x27;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">res</span></code></pre><h2 id="h2-8"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/8.lua" target="_blank">8.lua</a></h2><pre class="language-lua"><code><span class="Token COMMENT">-- $Id: testes/big.lua $</span><span class="Token LF">
</span><span class="Token COMMENT">-- See Copyright Notice in file all.lua</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">_soft</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="String Token STR">&#x27;a&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="FunctionCall Identifier Token Variable SPACE"> </span><span class="String Token STR">&quot;testing large tables&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">debug</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">require</span><span class="String Token STR">&quot;debug&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">lim</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number Punctuator CARET">^</span><span class="Token Number NUMBER">18</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator PLUS">+</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">1000</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">prog</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Token TableConstructor Expression SPACE"> </span><span class="String Token STR">&quot;local y = {0&quot;</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;}</span><span class="String Control Token STR">\n</span><span class="String Token STR">&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;X = y</span><span class="String Control Token STR">\n</span><span class="String Token STR">&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Expression Token BraceDepth-0 Variable LPAREN">(</span><span class="String Token STR">&quot;assert(X[</span><span class="String Token Format STR">%d</span><span class="String Token STR">] == </span><span class="String Token Format STR">%d</span><span class="String Token STR">)&quot;</span><span class="Expression Token BraceDepth-0 Variable RPAREN">)</span><span class="Token VarSuffix COLON">:</span><span class="Identifier Token VarSuffix FunctionCall ID">format</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;return 0&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">table</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">concat</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;;&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">env</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Identifier Token Field ID">string</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Identifier Token Field ID">assert</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="Identifier Token Variable ID">assert</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">env</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">env</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">X</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">lim</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">env</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">X</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">lim</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token ID">k</span><span class="Identifier Token SPACE"> </span><span class="Token Statement Keyword IN">in</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pairs</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">env</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">env</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">k</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">undef</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- yields during accesses larger than K (in RK)</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">setmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">env</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="Identifier Token Field ID">__index</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="Identifier Token ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">n</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Identifier Token Variable ID">coroutine</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">yield</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;g&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">n</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator LF">
</span><span class="Token Punctuator SPACE">    </span><span class="Identifier Token Field ID">__newindex</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="Identifier Token ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">n</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">v</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Identifier Token Variable ID">coroutine</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">yield</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;s&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">n</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">v</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FieldList Token Punctuator COMMA">,</span><span class="FieldList Token Punctuator LF">
</span><span class="FieldList Token Punctuator SPACE">  </span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">X</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">co</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">coroutine</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">wrap</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">co</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;s&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">co</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;g&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">co</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;g&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">co</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">X</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">lim</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">X</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">lim</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- errors in accesses larger than K (in RK)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">getmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">env</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token VarSuffix DOT">.</span><span class="Token VarSuffix TableKey FunctionName Identifier ID">__index</span><span class="Token VarSuffix TableKey FunctionName Identifier SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Identifier Token Variable ID">getmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">env</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token VarSuffix DOT">.</span><span class="Token VarSuffix TableKey FunctionName Identifier ID">__newindex</span><span class="Token VarSuffix TableKey FunctionName Identifier SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">e</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">m</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">e</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Token VarSuffix COLON">:</span><span class="Identifier Token VarSuffix FunctionCall ID">find</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;global &#x27;X&#x27;&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- errors in metamethods</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">getmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">env</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token VarSuffix DOT">.</span><span class="Token VarSuffix TableKey FunctionName Identifier ID">__newindex</span><span class="Token VarSuffix TableKey FunctionName Identifier SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">error</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;hi&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">e</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">m</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">xpcall</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">traceback</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">e</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Token VarSuffix COLON">:</span><span class="Identifier Token VarSuffix FunctionCall ID">find</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;&#x27;newindex&#x27;&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">X</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Identifier Token Variable ID">coroutine</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">yield</span><span class="String Token STR">&#x27;b&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Number NUMBER">2</span><span class="Token Number Punctuator CARET">^</span><span class="Token Number NUMBER">32</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator EQ">==</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE">   </span><span class="Token Statement Keyword COMMENT">-- (small integers) {</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="FunctionCall Identifier Token Variable SPACE"> </span><span class="String Token STR">&quot;testing string length overflow&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">repstrings</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">192</span><span class="Token Number SPACE">          </span><span class="Token Number COMMENT">-- number of strings to be concatenated</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">ssize</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">ceil</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">2.0</span><span class="Token Number Punctuator CARET">^</span><span class="Token Number NUMBER">32</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator DIV">/</span><span class="Token Number Punctuator SPACE"> </span><span class="Identifier Token Variable ID">repstrings</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE">   </span><span class="Token Expression Number COMMENT">-- size of each string</span><span class="Token Expression Number LF">
</span><span class="Token Expression Number SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">repstrings</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MUL">*</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">ssize</span><span class="Identifier Token Variable SPACE"> </span><span class="Token BraceDepth-1 Expression Punctuator RANGLE_BRACE">&gt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2.0</span><span class="Token Number Punctuator CARET">^</span><span class="Token Number NUMBER">32</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- it should be larger than maximum size</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">longs</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">rep</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;\0&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">ssize</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">   </span><span class="Token Argument VarSuffix COMMENT">-- create one long string</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- create function to concatenate &#x27;repstrings&#x27; copies of its argument</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">rep</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="String Token STR">&quot;local a = ...; return &quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator CONCAT">..</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">rep</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&quot;a&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">repstrings</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;..&quot;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">rep</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">longs</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">   </span><span class="Token Argument VarSuffix COMMENT">-- call that function</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- it should fail without creating string (result would be too large)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">find</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;overflow&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword SPACE">   </span><span class="Token Statement Keyword COMMENT">-- }</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="String Token STR">&#x27;OK&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="String Token STR">&#x27;a&#x27;</span></code></pre><h2 id="h2-9"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/9.lua" target="_blank">9.lua</a></h2><pre class="language-lua"><code><span class="Token COMMENT">-- $Id: testes/bitwise.lua $</span><span class="Token LF">
</span><span class="Token COMMENT">-- See Copyright Notice in file all.lua</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;testing bitwise operations&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">require</span><span class="FunctionCall Identifier Token Variable SPACE"> </span><span class="String Token STR">&quot;bwcoercion&quot;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">numbits</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">packsize</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;j&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator MUL">*</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">8</span><span class="Token Expression Number LF">
</span><span class="Token Expression Number LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator TILDE">~</span><span class="Token Expression Number NUMBER">0</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator EQ">==</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">1</span><span class="Token Variable Number SPACE"> </span><span class="Token Number Punctuator SHL">&lt;&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">numbits</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">mininteger</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- basic tests for bitwise operators;</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- use variables to avoid constant folding</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">c</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">d</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0xFFFFFFFFFFFFFFFF</span><span class="Token Number LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator EQ">==</span><span class="Token Number Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">35</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator EQ">==</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">35</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0xF0F0F0F0F0F0F0F0</span><span class="Token Number LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PIPE">|</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator EQ">==</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator TILDE">~</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator TILDE">~</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator EQ">==</span><span class="Token Number Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator TILDE">~</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator TILDE">~</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator SHR">&gt;&gt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">4</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator EQ">==</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Expression Punctuator TILDE">~</span><span class="Identifier Token Variable ID">a</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0xF0</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0xCC</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0xAA</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0xFD</span><span class="Token Number LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PIPE">|</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator TILDE">~</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xF4</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0xF0.0</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0xCC.0</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;0xAA.0&quot;</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;0xFD.0&quot;</span><span class="Token LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PIPE">|</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator TILDE">~</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xF4</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0xF0000000</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0xCC000000</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0xAA000000</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0xFD000000</span><span class="Token Number LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PIPE">|</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator TILDE">~</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xF4000000</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator TILDE">~</span><span class="Token Expression Punctuator TILDE">~</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Punctuator TILDE">~</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator TILDE">~</span><span class="Token Number Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator TILDE">~</span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator SHL">&lt;&lt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">32</span><span class="Token Expression Number LF">
</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator SHL">&lt;&lt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">32</span><span class="Token Expression Number LF">
</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator SHL">&lt;&lt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">32</span><span class="Token Expression Number LF">
</span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator SHL">&lt;&lt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">32</span><span class="Token Expression Number LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PIPE">|</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator TILDE">~</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xF4000000</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator SHL">&lt;&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">32</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator TILDE">~</span><span class="Token Expression Punctuator TILDE">~</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Punctuator TILDE">~</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator TILDE">~</span><span class="Token Number Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator TILDE">~</span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">   </span><span class="Token Statement Keyword COMMENT">-- constant folding</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">code</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">format</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;return -1 &gt;&gt; </span><span class="String Token Format STR">%d</span><span class="String Token STR">&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">maxinteger</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">code</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">code</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">format</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;return -1 &gt;&gt; </span><span class="String Token Format STR">%d</span><span class="String Token STR">&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">mininteger</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">code</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">code</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">format</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;return -1 &lt;&lt; </span><span class="String Token Format STR">%d</span><span class="String Token STR">&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">maxinteger</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">code</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">code</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">format</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;return -1 &lt;&lt; </span><span class="String Token Format STR">%d</span><span class="String Token STR">&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">mininteger</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">code</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator SHR">&gt;&gt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator EQ">==</span><span class="Token Number Punctuator SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">1</span><span class="Token Variable Number SPACE"> </span><span class="Token Number Punctuator SHL">&lt;&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">numbits</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator SHL">&lt;&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">31</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator EQ">==</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">0x80000000</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator SHR">&gt;&gt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">numbits</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator SHR">&gt;&gt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Identifier Token Variable ID">numbits</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword LF">
</span><span class="Token Number Keyword SPACE">       </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator SHR">&gt;&gt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Identifier Token Variable ID">numbits</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword LF">
</span><span class="Token Number Keyword SPACE">       </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator SHL">&lt;&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Identifier Token Variable ID">numbits</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword LF">
</span><span class="Token Number Keyword SPACE">       </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator SHL">&lt;&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Identifier Token Variable ID">numbits</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator SHR">&gt;&gt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">mininteger</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator SHR">&gt;&gt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">maxinteger</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator SHL">&lt;&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">mininteger</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator SHL">&lt;&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">maxinteger</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">2</span><span class="Token Number Punctuator CARET">^</span><span class="Token Number NUMBER">30</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator MINUS">-</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator SHL">&lt;&lt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Number Punctuator CARET">^</span><span class="Token Number NUMBER">30</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator EQ">==</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">2</span><span class="Token Number Punctuator CARET">^</span><span class="Token Number NUMBER">30</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator MINUS">-</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator SHR">&gt;&gt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Number Punctuator CARET">^</span><span class="Token Number NUMBER">30</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator EQ">==</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator SHR">&gt;&gt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">3</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator EQ">==</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator SHL">&lt;&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Token Number NUMBER">1000</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator SHR">&gt;&gt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator EQ">==</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">1000</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator SHL">&lt;&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">5</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- coercion from strings to integers</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;0xffffffffffffffff&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator PIPE">|</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator EQ">==</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;0xfffffffffffffffe&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;-1&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">2</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot; </span><span class="String Control Token STR">\t</span><span class="String Token STR">-0xfffffffffffffffe</span><span class="String Control Token STR">\n</span><span class="String Control Token STR">\t</span><span class="String Token STR">&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;-1&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;   </span><span class="String Control Token STR">\n</span><span class="String Token STR">  -45  </span><span class="String Control Token STR">\t</span><span class="String Token STR"> &quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator SHR">&gt;&gt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;  -2  &quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">45</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator MUL">*</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;1234.0&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator SHL">&lt;&lt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;5.0&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1234</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator MUL">*</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">32</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;0xffff.0&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator TILDE">~</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;0xAAAA&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0x5555</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator TILDE">~</span><span class="String Token STR">&quot;0x0.000p4&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;7&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator CONCAT">..</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator SHL">&lt;&lt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator EQ">==</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">146</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0xffffffff</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator SHR">&gt;&gt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">1</span><span class="Token Variable Number SPACE"> </span><span class="Token Number Punctuator CONCAT">..</span><span class="Token Number Punctuator SPACE"> </span><span class="String Token STR">&quot;9&quot;</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0x1fff</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator PIPE">|</span><span class="Token Number Punctuator SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">1</span><span class="Token Variable Number SPACE"> </span><span class="Token Number Punctuator CONCAT">..</span><span class="Token Number Punctuator SPACE"> </span><span class="String Token STR">&quot;9&quot;</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">27</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">st</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">msg</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator AMPERSAND">&amp;</span><span class="Token Number Punctuator SPACE"> </span><span class="String Token STR">&quot;a&quot;</span><span class="Token SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">find</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;&#x27;band&#x27;&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">st</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">msg</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Expression Punctuator TILDE">~</span><span class="String Token STR">&quot;a&quot;</span><span class="Token SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">find</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;&#x27;bnot&#x27;&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword COMMENT">-- out of range number</span><span class="Token Statement Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="String Token STR">&quot;0xffffffffffffffff.0&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator PIPE">|</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- embedded zeros</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="String Token STR">&quot;0xffffffffffffffff\0&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator PIPE">|</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="String Token STR">&#x27;+&#x27;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Identifier Token Variable ID">package</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">preload</span><span class="Token VarSuffix DOT">.</span><span class="Token VarSuffix TableKey FunctionName Identifier ID">bit32</span><span class="Token VarSuffix TableKey FunctionName Identifier SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE">     </span><span class="FunctionBody FunctionDefinition Token COMMENT">--{</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token COMMENT">-- no built-in &#x27;bit32&#x27; library: implement it using bitwise operators</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">bit</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression LF">
</span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token ID">bit</span><span class="FuncName Token Statement DOT">.</span><span class="FuncName Identifier Token FunctionName ID">bnot</span><span class="FuncName Identifier Token FunctionName SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Expression Punctuator TILDE">~</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xFFFFFFFF</span><span class="Token Expression Number LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword COMMENT">--</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword COMMENT">-- in all vararg functions, avoid creating &#x27;arg&#x27; table when there are</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword COMMENT">-- only 2 (or less) parameters, as 2 parameters is the common case</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword COMMENT">--</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token ID">bit</span><span class="FuncName Token Statement DOT">.</span><span class="FuncName Identifier Token FunctionName ID">band</span><span class="FuncName Identifier Token FunctionName SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">z</span><span class="FunctionBody Token ParameterList COMMA">,</span><span class="FunctionBody Token ParameterList SPACE"> </span><span class="Token ParameterList Punctuator VARARGS">...</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">z</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Expression Token BraceDepth-0 Variable LPAREN">(</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword OR">or</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword OR">or</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token BraceDepth-0 Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xFFFFFFFF</span><span class="Token Expression Number LF">
</span><span class="Token Expression Number SPACE">  </span><span class="ElseStatement Token Keyword ELSE">else</span><span class="ElseStatement Token Keyword LF">
</span><span class="ElseStatement Token Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">arg</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Token Expression Punctuator VARARGS">...</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">z</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">arg</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">arg</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xFFFFFFFF</span><span class="Token Expression Number LF">
</span><span class="Token Expression Number SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token ID">bit</span><span class="FuncName Token Statement DOT">.</span><span class="FuncName Identifier Token FunctionName ID">bor</span><span class="FuncName Identifier Token FunctionName SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">z</span><span class="FunctionBody Token ParameterList COMMA">,</span><span class="FunctionBody Token ParameterList SPACE"> </span><span class="Token ParameterList Punctuator VARARGS">...</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">z</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Expression Token BraceDepth-0 Variable LPAREN">(</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword OR">or</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator PIPE">|</span><span class="Token Expression Punctuator SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword OR">or</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token BraceDepth-0 Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xFFFFFFFF</span><span class="Token Expression Number LF">
</span><span class="Token Expression Number SPACE">  </span><span class="ElseStatement Token Keyword ELSE">else</span><span class="ElseStatement Token Keyword LF">
</span><span class="ElseStatement Token Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">arg</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Token Expression Punctuator VARARGS">...</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PIPE">|</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PIPE">|</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">z</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">arg</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PIPE">|</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">arg</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xFFFFFFFF</span><span class="Token Expression Number LF">
</span><span class="Token Expression Number SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token ID">bit</span><span class="FuncName Token Statement DOT">.</span><span class="FuncName Identifier Token FunctionName ID">bxor</span><span class="FuncName Identifier Token FunctionName SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">z</span><span class="FunctionBody Token ParameterList COMMA">,</span><span class="FunctionBody Token ParameterList SPACE"> </span><span class="Token ParameterList Punctuator VARARGS">...</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">z</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Expression Token BraceDepth-0 Variable LPAREN">(</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword OR">or</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator TILDE">~</span><span class="Token Expression Punctuator SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword OR">or</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token BraceDepth-0 Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xFFFFFFFF</span><span class="Token Expression Number LF">
</span><span class="Token Expression Number SPACE">  </span><span class="ElseStatement Token Keyword ELSE">else</span><span class="ElseStatement Token Keyword LF">
</span><span class="ElseStatement Token Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">arg</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Token Expression Punctuator VARARGS">...</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator TILDE">~</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator TILDE">~</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">z</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">arg</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator TILDE">~</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">arg</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xFFFFFFFF</span><span class="Token Expression Number LF">
</span><span class="Token Expression Number SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token ID">bit</span><span class="FuncName Token Statement DOT">.</span><span class="FuncName Identifier Token FunctionName ID">btest</span><span class="FuncName Identifier Token FunctionName SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="FunctionBody Token Punctuator VARARGS">...</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">bit</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">band</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator VARARGS">...</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Expression Number LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token ID">bit</span><span class="FuncName Token Statement DOT">.</span><span class="FuncName Identifier Token FunctionName ID">lshift</span><span class="FuncName Identifier Token FunctionName SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">b</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Expression Token BraceDepth-0 Variable LPAREN">(</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xFFFFFFFF</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator SHL">&lt;&lt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression Token BraceDepth-0 Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xFFFFFFFF</span><span class="Token Expression Number LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token ID">bit</span><span class="FuncName Token Statement DOT">.</span><span class="FuncName Identifier Token FunctionName ID">rshift</span><span class="FuncName Identifier Token FunctionName SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">b</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Expression Token BraceDepth-0 Variable LPAREN">(</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xFFFFFFFF</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator SHR">&gt;&gt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression Token BraceDepth-0 Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xFFFFFFFF</span><span class="Token Expression Number LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token ID">bit</span><span class="FuncName Token Statement DOT">.</span><span class="FuncName Identifier Token FunctionName ID">arshift</span><span class="FuncName Identifier Token FunctionName SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">b</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xFFFFFFFF</span><span class="Token Expression Number LF">
</span><span class="Token Expression Number SPACE">  </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator LE">&lt;=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword OR">or</span><span class="Token Number Keyword SPACE"> </span><span class="Expression Token BraceDepth-0 Variable LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0x80000000</span><span class="Expression Token BraceDepth-0 Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Expression Token BraceDepth-0 Variable LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator SHR">&gt;&gt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression Token BraceDepth-0 Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xFFFFFFFF</span><span class="Token Expression Number LF">
</span><span class="Token Expression Number SPACE">  </span><span class="ElseStatement Token Keyword ELSE">else</span><span class="ElseStatement Token Keyword LF">
</span><span class="ElseStatement Token Keyword SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Expression Token BraceDepth-0 Variable LPAREN">(</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator SHR">&gt;&gt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator PIPE">|</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator TILDE">~</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">0xFFFFFFFF</span><span class="Token Variable Number SPACE"> </span><span class="Token Number Punctuator SHR">&gt;&gt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token BraceDepth-0 Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xFFFFFFFF</span><span class="Token Expression Number LF">
</span><span class="Token Expression Number SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token ID">bit</span><span class="FuncName Token Statement DOT">.</span><span class="FuncName Identifier Token FunctionName ID">lrotate</span><span class="FuncName Identifier Token FunctionName SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Identifier Token SPACE"> </span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">31</span><span class="Token Expression Number LF">
</span><span class="Token Expression Number SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xFFFFFFFF</span><span class="Token Expression Number LF">
</span><span class="Token Expression Number SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Expression Token BraceDepth-0 Variable LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator SHL">&lt;&lt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression Token BraceDepth-0 Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator PIPE">|</span><span class="Token Expression Punctuator SPACE"> </span><span class="Expression Token BraceDepth-0 Variable LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator SHR">&gt;&gt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">32</span><span class="Token Variable Number SPACE"> </span><span class="Token Number Punctuator MINUS">-</span><span class="Token Number Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token BraceDepth-0 Variable RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">  </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xFFFFFFFF</span><span class="Token Expression Number LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token ID">bit</span><span class="FuncName Token Statement DOT">.</span><span class="FuncName Identifier Token FunctionName ID">rrotate</span><span class="FuncName Identifier Token FunctionName SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">b</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">bit</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">lrotate</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">checkfield</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">w</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="Identifier Token Variable ID">w</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">w</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword OR">or</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number LF">
</span><span class="Token Expression Number SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator GE">&gt;=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;field cannot be negative&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">w</span><span class="Identifier Token Variable SPACE"> </span><span class="Token BraceDepth-1 Expression Punctuator RANGLE_BRACE">&gt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;width must be positive&quot;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">w</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator LE">&lt;=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">32</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;trying to access non-existent bits&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator TILDE">~</span><span class="Expression Token BraceDepth-0 Variable LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator SHL">&lt;&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Identifier Token Variable ID">w</span><span class="Expression Token BraceDepth-0 Variable RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token ID">bit</span><span class="FuncName Token Statement DOT">.</span><span class="FuncName Identifier Token FunctionName ID">extract</span><span class="FuncName Identifier Token FunctionName SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">w</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">mask</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">checkfield</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">w</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Expression Token BraceDepth-0 Variable LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator SHR">&gt;&gt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="Expression Token BraceDepth-0 Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">mask</span><span class="Identifier Token Variable LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token ID">bit</span><span class="FuncName Token Statement DOT">.</span><span class="FuncName Identifier Token FunctionName ID">replace</span><span class="FuncName Identifier Token FunctionName SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">v</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">w</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">mask</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">checkfield</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">w</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">v</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">v</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">mask</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Expression Token BraceDepth-0 Variable LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator TILDE">~</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">mask</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator SHL">&lt;&lt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token BraceDepth-0 Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator PIPE">|</span><span class="Token Expression Punctuator SPACE"> </span><span class="Expression Token BraceDepth-0 Variable LPAREN">(</span><span class="Identifier Token Variable ID">v</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator SHL">&lt;&lt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="Expression Token BraceDepth-0 Variable RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">  </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xFFFFFFFF</span><span class="Token Expression Number LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">bit</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="FunctionBody Token Keyword COMMENT">--}</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;testing bitwise library&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">bit32</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">require</span><span class="String Token STR">&#x27;bit32&#x27;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">band</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">bnot</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">btest</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword TRUE">true</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">bor</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">bxor</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">band</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">band</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0xffffffff</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">band</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">2</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- out-of-range numbers</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">band</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xffffffff</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">band</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Token Variable Number NUMBER">1</span><span class="Token Variable Number SPACE"> </span><span class="Token Number Punctuator SHL">&lt;&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">33</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xffffffff</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">band</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Token Variable Number NUMBER">1</span><span class="Token Variable Number SPACE"> </span><span class="Token Number Punctuator SHL">&lt;&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">33</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xffffffff</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">band</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Token Variable Number NUMBER">1</span><span class="Token Variable Number SPACE"> </span><span class="Token Number Punctuator SHL">&lt;&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">33</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">band</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Token Variable Number NUMBER">1</span><span class="Token Variable Number SPACE"> </span><span class="Token Number Punctuator SHL">&lt;&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">33</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">band</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Token Variable Number NUMBER">1</span><span class="Token Variable Number SPACE"> </span><span class="Token Number Punctuator SHL">&lt;&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">40</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">band</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator SHL">&lt;&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">40</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">band</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Token Variable Number NUMBER">1</span><span class="Token Variable Number SPACE"> </span><span class="Token Number Punctuator SHL">&lt;&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">40</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xfffffffe</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">band</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Token Variable Number NUMBER">1</span><span class="Token Variable Number SPACE"> </span><span class="Token Number Punctuator SHL">&lt;&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">40</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">4</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xfffffffc</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">lrotate</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">lrotate</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">7</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">lrotate</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0x12345678</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">lrotate</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">32</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0x12345678</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">lrotate</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0x23456781</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">rrotate</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">4</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0x23456781</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">lrotate</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">8</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0x78123456</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">rrotate</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">8</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0x78123456</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">lrotate</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0xaaaaaaaa</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xaaaaaaaa</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">lrotate</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0xaaaaaaaa</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">2</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xaaaaaaaa</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">50</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">50</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">lrotate</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0x89abcdef</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">lrotate</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0x89abcdef</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token Expression Punctuator MOD">%</span><span class="Token Expression Number NUMBER">32</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">lshift</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0x23456780</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">lshift</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">8</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0x34567800</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">lshift</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">4</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0x01234567</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">lshift</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">8</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0x00123456</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">lshift</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">32</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">lshift</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">32</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">rshift</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0x01234567</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">rshift</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">8</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0x00123456</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">rshift</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">32</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">rshift</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">32</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">arshift</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0x12345678</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">arshift</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0x12345678</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator DOUBLE_DIV">//</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">arshift</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0x12345678</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator MUL">*</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">arshift</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xffffffff</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">arshift</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">24</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xffffffff</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">arshift</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">32</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xffffffff</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">arshift</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">band</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator MUL">*</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0xffffffff</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator SHL">&lt;&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator EQ">==</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">0x123456780</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator SHL">&lt;&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">8</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator EQ">==</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">0x1234567800</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator SHL">&lt;&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">4</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator EQ">==</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">0x01234567</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator SHL">&lt;&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">8</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator EQ">==</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">0x00123456</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator SHL">&lt;&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">32</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator EQ">==</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">0x1234567800000000</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator SHL">&lt;&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">32</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator EQ">==</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator SHR">&gt;&gt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator EQ">==</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">0x01234567</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator SHR">&gt;&gt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">8</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator EQ">==</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">0x00123456</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator SHR">&gt;&gt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">32</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator EQ">==</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator SHR">&gt;&gt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">32</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator EQ">==</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">0x1234567800000000</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;+&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- some special cases</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">c</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Token Field Number NUMBER">0</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">1</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">2</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">3</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">10</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">0x80000000</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">0xaaaaaaaa</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">0x55555555</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator LF">
</span><span class="Token Punctuator SPACE">           </span><span class="Token Field Number NUMBER">0xffffffff</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">0x7fffffff</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token ID">_</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">b</span><span class="Identifier Token SPACE"> </span><span class="Token Statement Keyword IN">in</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pairs</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">band</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">band</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">band</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">btest</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">band</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">band</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator TILDE">~</span><span class="Identifier Token Variable ID">b</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">btest</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">band</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">bnot</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">bor</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">bnot</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">bnot</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">bor</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">bor</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">bor</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">bor</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator TILDE">~</span><span class="Identifier Token Variable ID">b</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xffffffff</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">bxor</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">bxor</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">bxor</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">bxor</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">bxor</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">bnot</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">bnot</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">bnot</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">bnot</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">1</span><span class="Token Variable Number SPACE"> </span><span class="Token Number Punctuator SHL">&lt;&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">32</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator MINUS">-</span><span class="Token Number Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">lrotate</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">32</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">rrotate</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">32</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">lshift</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">lshift</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">4</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">band</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">bnot</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0xf</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">rshift</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">rshift</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">4</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">band</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">bnot</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0xf</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword COMMENT">-- for this test, use at most 24 bits (mantissa of a single float)</span><span class="Token Statement Keyword LF">
</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Token Field Number NUMBER">0</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">1</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">2</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">3</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">10</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">0x800000</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">0xaaaaaa</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">0x555555</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">0xffffff</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">0x7fffff</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token ID">_</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">b</span><span class="Identifier Token SPACE"> </span><span class="Token Statement Keyword IN">in</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pairs</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">40</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">40</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">lshift</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">y</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">floor</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">fmod</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MUL">*</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2.0</span><span class="Token Number Punctuator CARET">^</span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2.0</span><span class="Token Number Punctuator CARET">^</span><span class="Token Number NUMBER">32</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">fmod</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2.0</span><span class="Token Number Punctuator CARET">^</span><span class="Token Number NUMBER">32</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">band</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-2 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-2 RCURLY_BRACE">}</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">bnot</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;a&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">lshift</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">45</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">lshift</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">45</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">rshift</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">45</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;+&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- testing extract/replace</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">extract</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">8</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">extract</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">7</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">extract</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0xa0001111</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">28</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xa</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">extract</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0xa0001111</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">31</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">extract</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0x50000111</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">31</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">extract</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0xf2345679</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">32</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xf2345679</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">extract</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">extract</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">32</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">extract</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">33</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">extract</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">31</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">replace</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">28</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0x52345678</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">replace</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0x87654321</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">32</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0x87654321</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">replace</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Number Punctuator CARET">^</span><span class="Token Number NUMBER">2</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">replace</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Number Punctuator CARET">^</span><span class="Token Number NUMBER">4</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">replace</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">31</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">1</span><span class="Token Variable Number SPACE"> </span><span class="Token Number Punctuator SHL">&lt;&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">31</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">replace</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">1</span><span class="Token Variable Number SPACE"> </span><span class="Token Number Punctuator SHL">&lt;&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">32</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">7</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- testing conversion of floats</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">bor</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">3.0</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">bor</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">4.0</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xfffffffc</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- large floats and large-enough integers?</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Number NUMBER">2.0</span><span class="Token Number Punctuator CARET">^</span><span class="Token Number NUMBER">50</span><span class="Token Number SPACE"> </span><span class="Token Number BraceDepth-0 Punctuator LANGLE_BRACE">&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">2.0</span><span class="Token Number Punctuator CARET">^</span><span class="Token Number NUMBER">50</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator PLUS">+</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">1.0</span><span class="Token Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Token Number NUMBER">2.0</span><span class="Token Number Punctuator CARET">^</span><span class="Token Number NUMBER">50</span><span class="Token Number SPACE"> </span><span class="Token Number BraceDepth-1 Punctuator LANGLE_BRACE">&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator SHR">&gt;&gt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">bor</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">2.0</span><span class="Token Number Punctuator CARET">^</span><span class="Token Number NUMBER">32</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator MINUS">-</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">5.0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xfffffffb</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">bor</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">2.0</span><span class="Token Number Punctuator CARET">^</span><span class="Token Number NUMBER">32</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator MINUS">-</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">6.0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xfffffffa</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">bor</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">2.0</span><span class="Token Number Punctuator CARET">^</span><span class="Token Number NUMBER">48</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator MINUS">-</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">5.0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xfffffffb</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">bor</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">2.0</span><span class="Token Number Punctuator CARET">^</span><span class="Token Number NUMBER">48</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator MINUS">-</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">6.0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0xfffffffa</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="String Token STR">&#x27;OK&#x27;</span></code></pre><h2 id="h2-10"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/10.lua" target="_blank">10.lua</a></h2><pre class="language-lua"><code><span class="Token COMMENT">-- BUG: built in function 无法识别</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">tonumber</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">tointeger</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">tonumber</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">tointeger</span><span class="Identifier Token VarSuffix TableKey LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">type</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">getmetatable</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">rawget</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">error</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">type</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">getmetatable</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">rawget</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">error</span><span class="Identifier Token Variable LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">strsub</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">sub</span><span class="Identifier Token VarSuffix TableKey LF">
</span><span class="Identifier Token VarSuffix TableKey LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">print</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable ID">_ENV</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword LF">
</span><span class="Token Keyword COMMENT">-- Try to convert a value to an integer, without assuming any coercion.</span><span class="Token Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">toint</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">tonumber</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">   </span><span class="Token Argument VarSuffix COMMENT">-- handle numerical strings</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Keyword FALSE">false</span><span class="Token Keyword SPACE">    </span><span class="Token Keyword COMMENT">-- not coercible to a number</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">tointeger</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword COMMENT">-- If operation fails, maybe second operand has a metamethod that should</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword COMMENT">-- have been called if not for this string metamethod, so try to</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword COMMENT">-- call it.</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">trymt</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">mtname</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">y</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;string&quot;</span><span class="Token SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword COMMENT">-- avoid recalling original metamethod</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">mt</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">getmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">y</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">mm</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">mt</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">rawget</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">mt</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">mtname</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">mm</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">      </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">mm</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- if any test fails, there is no other metamethod to be called</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">error</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;attempt to &#x27;&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator CONCAT">..</span><span class="Token Expression Punctuator SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">strsub</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">mtname</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator CONCAT">..</span><span class="Token Expression Punctuator LF">
</span><span class="Token Expression Punctuator SPACE">        </span><span class="String Token STR">&quot;&#x27; a &quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator CONCAT">..</span><span class="Token Expression Punctuator SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator CONCAT">..</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot; with a &quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator CONCAT">..</span><span class="Token Expression Punctuator SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">y</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">checkargs</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">mtname</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">xi</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">toint</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">yi</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">toint</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">y</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">xi</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">yi</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">xi</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">yi</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="ElseStatement Token Keyword ELSE">else</span><span class="ElseStatement Token Keyword LF">
</span><span class="ElseStatement Token Keyword SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">trymt</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">mtname</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">smt</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">getmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">smt</span><span class="Token VarSuffix DOT">.</span><span class="Token VarSuffix TableKey FunctionName Identifier ID">__band</span><span class="Token VarSuffix TableKey FunctionName Identifier SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">y</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">checkargs</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;__band&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword OR">or</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Identifier Token Variable ID">smt</span><span class="Token VarSuffix DOT">.</span><span class="Token VarSuffix TableKey FunctionName Identifier ID">__bor</span><span class="Token VarSuffix TableKey FunctionName Identifier SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">y</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">checkargs</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;__bor&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PIPE">|</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword OR">or</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Identifier Token Variable ID">smt</span><span class="Token VarSuffix DOT">.</span><span class="Token VarSuffix TableKey FunctionName Identifier ID">__bxor</span><span class="Token VarSuffix TableKey FunctionName Identifier SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">y</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">checkargs</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;__bxor&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator TILDE">~</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword OR">or</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Identifier Token Variable ID">smt</span><span class="Token VarSuffix DOT">.</span><span class="Token VarSuffix TableKey FunctionName Identifier ID">__shl</span><span class="Token VarSuffix TableKey FunctionName Identifier SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">y</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">checkargs</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;__shl&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator SHL">&lt;&lt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword OR">or</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Identifier Token Variable ID">smt</span><span class="Token VarSuffix DOT">.</span><span class="Token VarSuffix TableKey FunctionName Identifier ID">__shr</span><span class="Token VarSuffix TableKey FunctionName Identifier SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">y</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">checkargs</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;__shr&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator SHR">&gt;&gt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword OR">or</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Identifier Token Variable ID">smt</span><span class="Token VarSuffix DOT">.</span><span class="Token VarSuffix TableKey FunctionName Identifier ID">__bnot</span><span class="Token VarSuffix TableKey FunctionName Identifier SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">y</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">checkargs</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;__bnot&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Punctuator TILDE">~</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword OR">or</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable LF">
</span><span class="FunctionBody Token Keyword END">end</span></code></pre><h2 id="h2-11"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/11.lua" target="_blank">11.lua</a></h2><pre class="language-lua"><code><span class="Token COMMENT">-- $Id: testes/calls.lua $</span><span class="Token LF">
</span><span class="Token COMMENT">-- See Copyright Notice in file all.lua</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;testing functions and calls&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">debug</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">require</span><span class="FunctionCall Identifier Token Variable SPACE"> </span><span class="String Token STR">&quot;debug&quot;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token COMMENT">-- get the opportunity to test &#x27;type&#x27; too ;)</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="Token Number BraceDepth-2 Punctuator LANGLE_BRACE">&lt;</span><span class="Token Number NUMBER">2</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;boolean&#x27;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Keyword TRUE">true</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;boolean&#x27;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Keyword FALSE">false</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;boolean&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;nil&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">   </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">3</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;number&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">   </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="String Token STR">&#x27;x&#x27;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;string&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">   </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="BraceDepth-0 Token TableConstructor Argument LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Argument RCURLY_BRACE">}</span><span class="Token TableConstructor Argument SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;table&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">   </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">type</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;function&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">f</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-2 Statement LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody Token BraceDepth-2 Statement RPAREN">)</span><span class="FunctionBody Token Statement SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix COLON">:</span><span class="Identifier Token VarSuffix FunctionCall ID">x</span><span class="Identifier Token VarSuffix FunctionCall SPACE"> </span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;function&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">type</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- testing local-function recursion</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">fact</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword FALSE">false</span><span class="Token Keyword LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">res</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">fact</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-2 Statement LPAREN">(</span><span class="Identifier Token ID">n</span><span class="FunctionBody Token BraceDepth-2 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">0</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="ElseStatement Token Keyword ELSE">else</span><span class="ElseStatement Token Keyword SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token Expression Punctuator MUL">*</span><span class="FunctionCall Identifier Token Variable ID">fact</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">fact</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">5</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">120</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">fact</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword FALSE">false</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">fact</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword LF">
</span><span class="Token Keyword COMMENT">-- testing declarations</span><span class="Token Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-2 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">i</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Token Field Number NUMBER">10</span><span class="Token TableConstructor Expression BraceDepth-2 RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">self</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Number LF">
</span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token FunctionName ID">a</span><span class="FuncName Token Statement COLON">:</span><span class="FuncName Identifier Token ID">x</span><span class="FuncName Identifier Token SPACE"> </span><span class="FunctionBody Token BraceDepth-2 Statement LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody Token BraceDepth-2 Statement RPAREN">)</span><span class="FunctionBody Token Statement SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token Expression Punctuator PLUS">+</span><span class="Identifier Token Variable ID">self</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">i</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token ID">a</span><span class="FuncName Token Statement DOT">.</span><span class="FuncName Identifier Token FunctionName ID">y</span><span class="FuncName Identifier Token FunctionName SPACE"> </span><span class="FunctionBody Token BraceDepth-2 Statement LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody Token BraceDepth-2 Statement RPAREN">)</span><span class="FunctionBody Token Statement SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token Expression Punctuator PLUS">+</span><span class="Identifier Token Variable ID">self</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix COLON">:</span><span class="Identifier Token VarSuffix FunctionCall ID">x</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Number NUMBER">10</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator EQ">==</span><span class="Token Number Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">y</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">t</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-2 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">i</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">100</span><span class="Token TableConstructor Expression BraceDepth-2 RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="String Token STR">&quot;t&quot;</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix DOT">.</span><span class="Token VarSuffix TableKey FunctionName Identifier ID">x</span><span class="Token VarSuffix TableKey FunctionName Identifier SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="Identifier Token ID">self</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">self</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">i</span><span class="Token Expression Punctuator PLUS">+</span><span class="Identifier Token Variable ID">a</span><span class="Token Expression Punctuator PLUS">+</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">t</span><span class="Token VarSuffix COLON">:</span><span class="Identifier Token VarSuffix FunctionCall ID">x</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">3</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">95</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">x</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field Number NUMBER">0</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token FunctionName ID">a</span><span class="FuncName Token Statement COLON">:</span><span class="FuncName Identifier Token ID">add</span><span class="FuncName Identifier Token SPACE"> </span><span class="FunctionBody Token BraceDepth-2 Statement LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody Token BraceDepth-2 Statement RPAREN">)</span><span class="FunctionBody Token Statement SPACE"> </span><span class="Identifier Token Variable ID">self</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix ID">y</span><span class="Identifier Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">self</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">x</span><span class="Token Expression Punctuator PLUS">+</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">self</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix COLON">:</span><span class="Identifier Token VarSuffix FunctionCall ID">add</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token VarSuffix COLON">:</span><span class="Identifier Token VarSuffix FunctionCall ID">add</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">20</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token VarSuffix COLON">:</span><span class="Identifier Token VarSuffix FunctionCall ID">add</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">30</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">x</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">60</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">y</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">20</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-2 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">b</span><span class="Token Field FieldList ASSIGN">=</span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Identifier Token Field ID">c</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression BraceDepth-2 RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression LF">
</span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token ID">a</span><span class="FuncName Token Statement DOT">.</span><span class="FuncName Identifier Token ID">b</span><span class="FuncName Token Statement DOT">.</span><span class="FuncName Identifier Token ID">c</span><span class="FuncName Token Statement DOT">.</span><span class="FuncName Identifier Token FunctionName ID">f1</span><span class="FuncName Identifier Token FunctionName SPACE"> </span><span class="FunctionBody Token BraceDepth-2 Statement LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody Token BraceDepth-2 Statement RPAREN">)</span><span class="FunctionBody Token Statement SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token ID">a</span><span class="FuncName Token Statement DOT">.</span><span class="FuncName Identifier Token ID">b</span><span class="FuncName Token Statement DOT">.</span><span class="FuncName Identifier Token FunctionName ID">c</span><span class="FuncName Token Statement COLON">:</span><span class="FuncName Identifier Token ID">f2</span><span class="FuncName Identifier Token SPACE"> </span><span class="FunctionBody Token BraceDepth-2 Statement LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Identifier Token ID">y</span><span class="FunctionBody Token BraceDepth-2 Statement RPAREN">)</span><span class="FunctionBody Token Statement SPACE"> </span><span class="Identifier Token Variable ID">self</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">x</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">b</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">c</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">f1</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">4</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">5</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">b</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">c</span><span class="Token VarSuffix COLON">:</span><span class="Identifier Token VarSuffix FunctionCall ID">f2</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;k&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">12</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">b</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">c</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">k</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">12</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;+&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword SPACE">   </span><span class="Token Keyword COMMENT">-- &#x27;declare&#x27; t</span><span class="Token Keyword LF">
</span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token FunctionName ID">f</span><span class="FunctionBody Token BraceDepth-2 Statement LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token ID">c</span><span class="FunctionBody Token BraceDepth-2 Statement RPAREN">)</span><span class="FunctionBody Token Statement SPACE"> </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">d</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&#x27;a&#x27;</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token Statement ASSIGN">=</span><span class="Token TableConstructor Expression BraceDepth-2 LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">a</span><span class="Token Punctuator COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token Punctuator COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Token Punctuator COMMA">,</span><span class="Identifier Token Variable ID">d</span><span class="Token TableConstructor Expression BraceDepth-2 RCURLY_BRACE">}</span><span class="Token TableConstructor Expression SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Token Argument VarSuffix SPACE">      </span><span class="Token Argument VarSuffix COMMENT">-- this line change must be valid</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">2</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">3</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Keyword AND">and</span><span class="Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">4</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;a&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE">   </span><span class="Token COMMENT">-- this one too</span><span class="Token LF">
</span><span class="Token SPACE">      </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">4</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">3</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">4</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;a&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword SPACE">   </span><span class="Token Keyword COMMENT">-- delete &#x27;t&#x27;</span><span class="Token Keyword LF">
</span><span class="Token Keyword LF">
</span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token FunctionName ID">fat</span><span class="FunctionBody Token BraceDepth-2 Statement LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody Token BraceDepth-2 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator LE">&lt;=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="ElseStatement Token Keyword ELSE">else</span><span class="ElseStatement Token Keyword SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token Expression Punctuator MUL">*</span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&quot;return fat(&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator CONCAT">..</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator CONCAT">..</span><span class="Token Number Punctuator SPACE"> </span><span class="String Token STR">&quot;)&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;&quot;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="FunctionCall Identifier Token Variable SPACE"> </span><span class="String Token STR">&quot;load &#x27;assert(fat(6)==720)&#x27; () &quot;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;return fat(5), 3&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">a</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">120</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">fat</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;+&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">err_on_n</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-2 Statement LPAREN">(</span><span class="Identifier Token ID">n</span><span class="FunctionBody Token BraceDepth-2 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">0</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">error</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">exit</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">  </span><span class="ElseStatement Token Keyword ELSE">else</span><span class="ElseStatement Token Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">err_on_n</span><span class="FunctionCall Identifier Token Variable SPACE"> </span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">exit</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">dummy</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-2 Statement LPAREN">(</span><span class="Identifier Token ID">n</span><span class="FunctionBody Token BraceDepth-2 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression BraceDepth-2 Punctuator RANGLE_BRACE">&gt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">      </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">err_on_n</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">      </span><span class="FunctionCall Identifier Token Variable ID">dummy</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">dummy</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">deep</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword SPACE">   </span><span class="Token Keyword COMMENT">-- &quot;declaration&quot;  (used by &#x27;all.lua&#x27;)</span><span class="Token Keyword LF">
</span><span class="Token Keyword LF">
</span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token FunctionName ID">deep</span><span class="FuncName Identifier Token FunctionName SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">n</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token BraceDepth-0 Expression Punctuator RANGLE_BRACE">&gt;</span><span class="Token Expression Number NUMBER">0</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">deep</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">deep</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">deep</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">180</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="String Token STR">&quot;testing tail calls&quot;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token FunctionName ID">deep</span><span class="FuncName Identifier Token FunctionName SPACE"> </span><span class="FunctionBody Token BraceDepth-1 Statement LPAREN">(</span><span class="Identifier Token ID">n</span><span class="FunctionBody Token BraceDepth-1 Statement RPAREN">)</span><span class="FunctionBody Token Statement SPACE"> </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token BraceDepth-1 Expression Punctuator RANGLE_BRACE">&gt;</span><span class="Token Expression Number NUMBER">0</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">deep</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="ElseStatement Token Keyword ELSE">else</span><span class="ElseStatement Token Keyword SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">101</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">deep</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">30000</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">101</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-2 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-2 RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token FunctionName ID">a</span><span class="FuncName Token Statement COLON">:</span><span class="FuncName Identifier Token ID">deep</span><span class="FuncName Identifier Token SPACE"> </span><span class="FunctionBody Token BraceDepth-2 Statement LPAREN">(</span><span class="Identifier Token ID">n</span><span class="FunctionBody Token BraceDepth-2 Statement RPAREN">)</span><span class="FunctionBody Token Statement SPACE"> </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token Expression BraceDepth-2 Punctuator RANGLE_BRACE">&gt;</span><span class="Token Expression Number NUMBER">0</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">self</span><span class="Token VarSuffix COLON">:</span><span class="Identifier Token VarSuffix FunctionCall ID">deep</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="ElseStatement Token Keyword ELSE">else</span><span class="ElseStatement Token Keyword SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">101</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix COLON">:</span><span class="Identifier Token VarSuffix FunctionCall ID">deep</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">30000</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">101</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">   </span><span class="Token Statement Keyword COMMENT">-- tail calls x varargs</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">foo</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody Token ParameterList COMMA">,</span><span class="FunctionBody Token ParameterList SPACE"> </span><span class="Token ParameterList Punctuator VARARGS">...</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement SPACE"> </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Token Expression Punctuator VARARGS">...</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">foo1</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">foo</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">c</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">foo1</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">2</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">2</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- tail calls x metamethods</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">setmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__call</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Identifier Token Variable ID">foo</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">foo2</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">t</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">foo2</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">100</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">100</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Expression Token BraceDepth-0 Variable LPAREN">(</span><span class="FunctionDefinition Token FunctionCall Keyword FUNCTION">function</span><span class="FunctionDefinition Token FunctionCall Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token FunctionCall Keyword RETURN">return</span><span class="ReturnStatment Token FunctionCall Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">foo</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="FunctionBody Token FunctionCall Keyword END">end</span><span class="Expression Token BraceDepth-0 Variable RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Keyword AND">and</span><span class="Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">X</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">Y</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">A</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">foo</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="FunctionBody Token ParameterList COMMA">,</span><span class="FunctionBody Token ParameterList SPACE"> </span><span class="Token ParameterList Punctuator VARARGS">...</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement SPACE"> </span><span class="Identifier Token Variable ID">X</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">Y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Token Expression Punctuator VARARGS">...</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">foo1</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="FunctionBody Token Punctuator VARARGS">...</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">foo</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator VARARGS">...</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">c</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">foo1</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">X</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Keyword AND">and</span><span class="Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">Y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Keyword AND">and</span><span class="Token Keyword SPACE"> </span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">foo1</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">X</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">Y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Keyword AND">and</span><span class="Token Keyword SPACE"> </span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">foo1</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">X</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">Y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">20</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">foo1</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">30</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">X</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">Y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">20</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">A</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">30</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">   </span><span class="Token Statement Keyword COMMENT">-- C-stack overflow while handling C-stack overflow</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">loop</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">loop</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">err</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">msg</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">xpcall</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">loop</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">loop</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">err</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">find</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;error&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">   </span><span class="Token Statement Keyword COMMENT">-- tail calls x chain of __call</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">n</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">10000</span><span class="Token Number SPACE">   </span><span class="Token Number COMMENT">-- depth</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">foo</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">1023</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="ElseStatement Token Keyword ELSE">else</span><span class="ElseStatement Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">foo</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="FunctionBody Token Keyword COMMENT">-- build a chain of __call metamethods ending in function &#x27;foo&#x27;</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">100</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Identifier Token Variable ID">foo</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">setmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__call</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Identifier Token Variable ID">foo</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- call the first one as a tail call in a new coroutine</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- (to ensure stack is not preallocated)</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">coroutine</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">wrap</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">foo</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1023</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;+&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- testing chains of &#x27;__call&#x27;</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">N</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">u</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">table</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">pack</span><span class="Identifier Token VarSuffix TableKey LF">
</span><span class="Identifier Token VarSuffix TableKey SPACE">  </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">N</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Identifier Token Variable ID">u</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">setmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">i</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__call</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Identifier Token Variable ID">u</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">Res</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">u</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;a&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;b&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;c&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">Res</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">n</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">N</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">N</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">Res</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">Res</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">N</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;a&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">Res</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">N</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;b&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">Res</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">N</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;c&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token BraceDepth-0 Variable LPAREN">(</span><span class="FunctionDefinition Token FunctionCall Keyword FUNCTION">function</span><span class="FunctionDefinition Token FunctionCall Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token FunctionCall ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">a</span><span class="Token Statement ASSIGN">=</span><span class="FunctionCall Identifier Token Variable ID">x</span><span class="FunctionCall Identifier Token Variable SPACE"> </span><span class="FunctionBody Token FunctionCall Keyword END">end</span><span class="Token BraceDepth-0 Variable RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">23</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">23</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="FunctionDefinition Token FunctionCall Keyword FUNCTION">function</span><span class="FunctionDefinition Token FunctionCall Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="Identifier Token FunctionCall ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token FunctionCall Keyword RETURN">return</span><span class="ReturnStatment Token FunctionCall Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">x</span><span class="FunctionCall Token Expression Punctuator MUL">*</span><span class="FunctionCall Token Expression Number NUMBER">2</span><span class="FunctionCall Token Expression Number SPACE"> </span><span class="FunctionBody Token FunctionCall Keyword END">end</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">20</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">40</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- testing closures</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- fixed-point operator</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName FunctionName ID">Z</span><span class="Identifier Token AttributeName FunctionName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="Identifier Token ID">le</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">      </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">a</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">f</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">        </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">le</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">      </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">      </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">a</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword COMMENT">-- non-recursive factorial</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName FunctionName ID">F</span><span class="Identifier Token AttributeName FunctionName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="Identifier Token ID">f</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">      </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="Identifier Token ID">n</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">               </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number LF">
</span><span class="Token Number SPACE">               </span><span class="ElseStatement Token Keyword ELSE">else</span><span class="ElseStatement Token Keyword SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token Expression Punctuator MUL">*</span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">             </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">    </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">fat</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">Z</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">F</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">fat</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">fat</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">4</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">24</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">Z</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">F</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">5</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">5</span><span class="Token Number Punctuator MUL">*</span><span class="FunctionCall Identifier Token Variable ID">Z</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">F</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">4</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">g</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">z</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">f</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token ID">c</span><span class="Token COMMA">,</span><span class="Identifier Token ID">d</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Identifier Token ID">y</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token Expression Punctuator PLUS">+</span><span class="Identifier Token Variable ID">b</span><span class="Token Expression Punctuator PLUS">+</span><span class="Identifier Token Variable ID">c</span><span class="Token Expression Punctuator PLUS">+</span><span class="Identifier Token Variable ID">d</span><span class="Token Expression Punctuator PLUS">+</span><span class="Identifier Token Variable ID">a</span><span class="Token Expression Punctuator PLUS">+</span><span class="Identifier Token Variable ID">x</span><span class="Token Expression Punctuator PLUS">+</span><span class="Identifier Token Variable ID">y</span><span class="Token Expression Punctuator PLUS">+</span><span class="Identifier Token Variable ID">z</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">z</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">z</span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">z</span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">z</span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Number NUMBER">3</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">g</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">9</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">16</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Number Punctuator PLUS">+</span><span class="Token Number NUMBER">11</span><span class="Token Number Punctuator PLUS">+</span><span class="Token Number NUMBER">12</span><span class="Token Number Punctuator PLUS">+</span><span class="Token Number NUMBER">13</span><span class="Token Number Punctuator PLUS">+</span><span class="Token Number NUMBER">10</span><span class="Token Number Punctuator PLUS">+</span><span class="Token Number NUMBER">9</span><span class="Token Number Punctuator PLUS">+</span><span class="Token Number NUMBER">16</span><span class="Token Number Punctuator PLUS">+</span><span class="Token Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;+&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- testing multiple returns</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">unlpack</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">i</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword OR">or</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number LF">
</span><span class="Token Expression Number SPACE">  </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Expression Token BraceDepth-0 Variable LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator LE">&lt;=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">t</span><span class="Expression Token BraceDepth-0 Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">unlpack</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">equaltab</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">t1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">t2</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">t1</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">t2</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">t1</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t1</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">t2</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName FunctionName ID">pack</span><span class="Identifier Token AttributeName FunctionName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="FunctionBody Token Punctuator VARARGS">...</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Expression Token BraceDepth-0 Variable LPAREN">(</span><span class="Identifier Token Variable ID">table</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">pack</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Expression Punctuator VARARGS">...</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Expression Token BraceDepth-0 Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">f</span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">30</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">4</span><span class="Token Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">ret2</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">b</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">c</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">d</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">unlpack</span><span class="BraceDepth-0 Token TableConstructor Argument LCURLY_BRACE">{</span><span class="Token Field Number NUMBER">1</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">2</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">3</span><span class="BraceDepth-0 Token TableConstructor Argument RCURLY_BRACE">}</span><span class="Token TableConstructor Argument LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">2</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">3</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Token Field Number NUMBER">1</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">2</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">3</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">4</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Keyword FALSE">false</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">10</span><span class="Token Punctuator COMMA">,</span><span class="String Token STR">&#x27;alo&#x27;</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Keyword FALSE">false</span><span class="Token Punctuator COMMA">,</span><span class="Identifier Token Variable ID">assert</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="FunctionCall Identifier Token Variable ID">equaltab</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">pack</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">unlpack</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">equaltab</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">pack</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">unlpack</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token Field Number NUMBER">1</span><span class="Token Punctuator COMMA">,</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">ret2</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">ret2</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">2</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">unlpack</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">pack</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">ret2</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">ret2</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">2</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">unlpack</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">pack</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">ret2</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">ret2</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Keyword NIL">nil</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Keyword AND">and</span><span class="Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">ret2</span><span class="BraceDepth-0 Token TableConstructor Argument LCURLY_BRACE">{</span><span class="Token TableConstructor Argument SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">unlpack</span><span class="Token TableConstructor Argument BraceDepth-1 LCURLY_BRACE">{</span><span class="Token Field Number NUMBER">1</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">2</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">3</span><span class="Token TableConstructor Argument BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">unlpack</span><span class="Token TableConstructor Argument BraceDepth-1 LCURLY_BRACE">{</span><span class="Token Field Number NUMBER">3</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">2</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">1</span><span class="Token TableConstructor Argument BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">unlpack</span><span class="Token TableConstructor Argument BraceDepth-1 LCURLY_BRACE">{</span><span class="String Token STR">&quot;a&quot;</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="String Token STR">&quot;b&quot;</span><span class="Token TableConstructor Argument BraceDepth-1 RCURLY_BRACE">}</span><span class="BraceDepth-0 Token TableConstructor Argument RCURLY_BRACE">}</span><span class="Token TableConstructor Argument LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">3</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;a&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">4</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;b&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- testing calls with &#x27;incorrect&#x27; arguments</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">rawget</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;x&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">rawset</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;x&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">sin</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">2</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">sin</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">table</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">sort</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token Field Number NUMBER">10</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">9</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">8</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">4</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">19</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">23</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">0</span><span class="Token Punctuator COMMA">,</span><span class="Token Field Number NUMBER">0</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token BraceDepth-1 Expression Punctuator LANGLE_BRACE">&lt;</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;extra arg&quot;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- test for generic load</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;-- a comment\0\0\0</span><span class="String Control Token STR">\n</span><span class="String Token STR">  x = 10 + </span><span class="String Control Token STR">\n</span><span class="String Token STR">23; \
     local a = function () x = &#x27;hi&#x27; end; \
     return &#x27;\0&#x27;&quot;</span><span class="Token LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">read1</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">i</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Identifier Token Variable ID">i</span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number LF">
</span><span class="Token Expression Number SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">sub</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">cannotload</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">find</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">msg</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">read1</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;modname&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;t&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">a</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;\0&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">x</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">33</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">getinfo</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">source</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;modname&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- cannot read text in binary mode</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">cannotload</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;attempt to load a text chunk&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">read1</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;modname&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;b&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-2 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-2 RCURLY_BRACE">}</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">cannotload</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;attempt to load a text chunk&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;modname&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;b&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">a</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- empty chunk</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Keyword TRUE">true</span><span class="Token Keyword SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- small bug</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Token Field Keyword NIL">nil</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="String Token STR">&quot;return &quot;</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="String Token STR">&quot;3&quot;</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">msg</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">table</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">remove</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">   </span><span class="Token Argument VarSuffix COMMENT">-- should read the empty chunk</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- another small bug (in 5.2.1)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">dump</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;b&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">type</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;function&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">   </span><span class="Token Statement Keyword COMMENT">-- another bug (in 5.4.0)</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- loading a binary long string interrupted by GC cycles</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">dump</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="String Token STR">&#x27;01234567890123456789012345678901234567890123456789&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">read1</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;01234567890123456789012345678901234567890123456789&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">   </span><span class="Token Statement Keyword COMMENT">-- another bug (since 5.2)</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- corrupted binary dump: list of upvalue names is larger than number</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- of upvalues, overflowing the array of upvalues.</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">code</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">   </span><span class="String Token STR">&quot;\x1b\x4c\x75\x61\x54\x00\x19\x93\x0d\x0a\x1a\x0a\x04\x08\x08\x78\x56\z
    \x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x28\x77\x40\x00\x86\x40\z
    \x74\x65\x6d\x70\x81\x81\x01\x00\x02\x82\x48\x00\x02\x00\xc7\x00\x01\z
    \x00\x80\x80\x80\x82\x00\x00\x80\x81\x82\x78\x80\x82\x81\x86\x40\x74\z
    \x65\x6d\x70&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">code</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">   </span><span class="Token Argument VarSuffix COMMENT">-- segfaults in previous versions</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">dump</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;x = 1; return x&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">read1</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;b&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">a</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">x</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">cannotload</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;attempt to load a binary chunk&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">read1</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;t&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">cannotload</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;attempt to load a binary chunk&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;t&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">_G</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">x</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">dump</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- no dump of C functions</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">cannotload</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;unexpected symbol&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">read1</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&quot;*a = 123&quot;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">cannotload</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;unexpected symbol&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;*a = 123&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">cannotload</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;hhi&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">error</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&quot;hhi&quot;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- any value is valid for _ENV</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;return _ENV&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">123</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">123</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- load when _ENV is not first upvalue</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">XX</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">123</span><span class="Token Number LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">h</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">y</span><span class="Token Statement ASSIGN">=</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE">   </span><span class="Identifier Token Variable COMMENT">-- use &#x27;x&#x27;, so that it becomes 1st upvalue</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">XX</span><span class="Identifier Token Variable SPACE">   </span><span class="Identifier Token Variable COMMENT">-- global name</span><span class="Identifier Token Variable LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">d</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">dump</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">h</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">d</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;b&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">getupvalue</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;_ENV&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">setupvalue</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">x</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">123</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="String Token STR">&quot;return XX + ...&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Identifier Token Field ID">XX</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Token Field Number NUMBER">13</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">4</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">17</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">XX</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword LF">
</span><span class="Token Keyword COMMENT">-- test generic load with nested functions</span><span class="Token Keyword LF">
</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">[[
  return function (x)
    return function (y)
     return function (z)
       return x+y+z
     end
   end
  end
]]</span><span class="Token LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">read1</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;read&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;t&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">a</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">2</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">3</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">15</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- repeat the test loading a binary chunk</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">dump</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">read1</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;read&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;b&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">a</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">2</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">3</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">15</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- test for dump/undump with upvalues</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">30</span><span class="Token Number LF">
</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">dump</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">  </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;set&quot;</span><span class="Token SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number Punctuator PLUS">+</span><span class="Identifier Token Variable ID">b</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="ElseStatement Token Keyword ELSE">else</span><span class="ElseStatement Token Keyword LF">
</span><span class="ElseStatement Token Keyword SPACE">  </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;b&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">x</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">setupvalue</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;hi&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;a&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">x</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;hi&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">setupvalue</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">13</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;b&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">setupvalue</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">   </span><span class="Token Argument VarSuffix COMMENT">-- only 2 upvalues</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">x</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;set&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">x</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">23</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">x</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;set&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">x</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">24</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- test for dump/undump with many upvalues</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">nup</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">200</span><span class="Token Number SPACE">    </span><span class="Token Number COMMENT">-- maximum number of local variables</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">prog</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="String Token STR">&quot;local a1&quot;</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">nup</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;, a&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator CONCAT">..</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot; = 1&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">nup</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;, &quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator CONCAT">..</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">sum</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;; return function () return a1&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">nup</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot; + a&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator CONCAT">..</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">sum</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">sum</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot; end&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">table</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">concat</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">sum</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">dump</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">   </span><span class="Token Argument VarSuffix COMMENT">-- main chunk now has many upvalues</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName FunctionName ID">h</span><span class="Identifier Token AttributeName FunctionName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">nup</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvaluejoin</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">h</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator MUL">*</span><span class="Token Number Punctuator SPACE"> </span><span class="Identifier Token Variable ID">nup</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword COMMENT">-- test for long method names</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-2 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">x</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Token Field Number NUMBER">1</span><span class="Token TableConstructor Expression BraceDepth-2 RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token FunctionName ID">t</span><span class="FuncName Token Statement COLON">:</span><span class="FuncName Identifier Token ID">_012345678901234567890123456789012345678901234567890123456789</span><span class="FuncName Identifier Token SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">self</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">x</span><span class="Identifier Token VarSuffix TableKey LF">
</span><span class="Identifier Token VarSuffix TableKey SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix COLON">:</span><span class="Identifier Token VarSuffix FunctionCall ID">_012345678901234567890123456789012345678901234567890123456789</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword COMMENT">-- test for bug in parameter adjustment</span><span class="Token Statement Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="FunctionDefinition Token FunctionCall Keyword FUNCTION">function</span><span class="FunctionDefinition Token FunctionCall Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token FunctionCall Keyword RETURN">return</span><span class="ReturnStatment Token FunctionCall Keyword SPACE"> </span><span class="Token FunctionCall Keyword NIL">nil</span><span class="Token FunctionCall Keyword SPACE"> </span><span class="FunctionBody Token FunctionCall Keyword END">end</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">4</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="FunctionDefinition Token FunctionCall Keyword FUNCTION">function</span><span class="FunctionDefinition Token FunctionCall Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Token FunctionCall Statement Keyword LOCAL">local</span><span class="Token FunctionCall Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName FunctionCall ID">a</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="ReturnStatment Token FunctionCall Keyword RETURN">return</span><span class="ReturnStatment Token FunctionCall Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">a</span><span class="FunctionCall Identifier Token Variable SPACE"> </span><span class="FunctionBody Token FunctionCall Keyword END">end</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">4</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="FunctionDefinition Token FunctionCall Keyword FUNCTION">function</span><span class="FunctionDefinition Token FunctionCall Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="Identifier Token FunctionCall ID">a</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token FunctionCall Keyword RETURN">return</span><span class="ReturnStatment Token FunctionCall Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">a</span><span class="FunctionCall Identifier Token Variable SPACE"> </span><span class="FunctionBody Token FunctionCall Keyword END">end</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;testing binary chunks&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">header</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">pack</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;c4BBc6BBB&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="String Token STR">&quot;\27Lua&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE">                                  </span><span class="Token COMMENT">-- signature</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token Number NUMBER">0x54</span><span class="Token COMMA">,</span><span class="Token SPACE">                                      </span><span class="Token COMMENT">-- version 5.4 (0x54)</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE">                                         </span><span class="Token COMMENT">-- format</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="String Token STR">&quot;\x19\x93\r</span><span class="String Control Token STR">\n</span><span class="String Token STR">\x1a</span><span class="String Control Token STR">\n</span><span class="String Token STR">&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE">                      </span><span class="Token COMMENT">-- data</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE">                                         </span><span class="Token COMMENT">-- size of instruction</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">packsize</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;j&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE">                      </span><span class="Token COMMENT">-- sizeof(lua integer)</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">packsize</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;n&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE">                       </span><span class="Token Argument VarSuffix COMMENT">-- sizeof(lua number)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">c</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">dump</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName FunctionName ID">f</span><span class="Identifier Token AttributeName FunctionName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">_ENV</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">c</span><span class="ReturnStatment Token Block SEMI">;</span><span class="ReturnStatment Token Block SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword SPACE">    </span><span class="FunctionBody Token Keyword COMMENT">-- upvalues</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">s1</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;a constant&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">s2</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;another constant&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MUL">*</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3</span><span class="Token Expression Number LF">
</span><span class="Token Expression Number SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- check header</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">sub</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">header</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">header</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- check LUAC_INT and LUAC_NUM</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">ci</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">cn</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">unpack</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;jn&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">header</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">ci</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0x5678</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">cn</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">370.5</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- corrupted header</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">header</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">s</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">sub</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator CONCAT">..</span><span class="Token Expression Punctuator LF">
</span><span class="Token Expression Punctuator SPACE">              </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">char</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">byte</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">sub</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator CONCAT">..</span><span class="Token Expression Punctuator LF">
</span><span class="Token Expression Punctuator SPACE">              </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">sub</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">s</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">c</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">s</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- loading truncated binary chunks</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">st</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">msg</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">sub</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">st</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">find</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;truncated&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;OK&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">deep</span></code></pre><h2 id="h2-12"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/12.lua" target="_blank">12.lua</a></h2><pre class="language-lua"><code><span class="Token COMMENT">-- $Id: testes/closure.lua $</span><span class="Token LF">
</span><span class="Token COMMENT">-- See Copyright Notice in file all.lua</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="FunctionCall Identifier Token Variable SPACE"> </span><span class="String Token STR">&quot;testing closures&quot;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">A</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">B</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Identifier Token Field ID">g</span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field Number NUMBER">10</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">f</span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Number NUMBER">1000</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">y</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">      </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Identifier Token Variable ID">B</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">g</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">B</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">g</span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Number NUMBER">1</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Token Expression Punctuator PLUS">+</span><span class="Identifier Token Variable ID">x</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Token Expression Punctuator PLUS">+</span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">    </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName FunctionName ID">dummy</span><span class="Identifier Token AttributeName FunctionName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">A</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">dummy</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">3</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">B</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">g</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">12</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- force a GC in this level</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Token BraceDepth-1 Field FieldList LSQUAR_PAREN">[</span><span class="Token Field Number NUMBER">1</span><span class="Token BraceDepth-1 Field FieldList RSQUAR_PAREN">]</span><span class="Token Field FieldList SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression SPACE">   </span><span class="Token TableConstructor Expression COMMENT">-- to detect a GC</span><span class="Token TableConstructor Expression LF">
</span><span class="FunctionCall Identifier Token Variable ID">setmetatable</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__mode</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="String Token STR">&#x27;kv&#x27;</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword WHILE">while</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">   </span><span class="Token Statement Keyword COMMENT">-- repeat until GC</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">A</span><span class="Token Expression Punctuator CONCAT">..</span><span class="Identifier Token Variable ID">A</span><span class="Token Expression Punctuator CONCAT">..</span><span class="Identifier Token Variable ID">A</span><span class="Token Expression Punctuator CONCAT">..</span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable COMMENT">-- create garbage</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">A</span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">20</span><span class="Token Number Punctuator PLUS">+</span><span class="Identifier Token Variable ID">A</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">30</span><span class="Token Number Punctuator PLUS">+</span><span class="Identifier Token Variable ID">A</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Number Punctuator PLUS">+</span><span class="Identifier Token Variable ID">A</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">20</span><span class="Token Number Punctuator PLUS">+</span><span class="Identifier Token Variable ID">A</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">30</span><span class="Token Number Punctuator PLUS">+</span><span class="Identifier Token Variable ID">A</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">3</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">20</span><span class="Token Number Punctuator PLUS">+</span><span class="Identifier Token Variable ID">A</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">8</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Number Punctuator PLUS">+</span><span class="Identifier Token Variable ID">A</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">getmetatable</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">__mode</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;kv&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">B</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">g</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">19</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- testing equality</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression LF">
</span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">_ENV</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">3</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">4</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">4</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">5</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName FunctionName ID">a</span><span class="Identifier Token AttributeName FunctionName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE">  </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">sin</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">_ENV</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">x</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">f</span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword COMMENT">-- testing closures with &#x27;for&#x27; control variable</span><span class="Token Statement Keyword LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Number NUMBER">10</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Identifier Token Field ID">set</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Identifier Token Field ID">get</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword BREAK">break</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">4</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">undef</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">set</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">get</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">set</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;a&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">3</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">get</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">get</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;a&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="String Token STR">&quot;a&quot;</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="String Token STR">&quot;b&quot;</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">k</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix LF">
</span><span class="Token VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Identifier Token Field ID">set</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Identifier Token Variable ID">x</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">k</span><span class="Token Statement ASSIGN">=</span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator LF">
</span><span class="Token Punctuator SPACE">          </span><span class="Identifier Token Field ID">get</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field ASSIGN">=</span><span class="Token Field SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">k</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword BREAK">break</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">set</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">r</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">s</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">get</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">r</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">s</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;b&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">r</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">s</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">get</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">r</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">s</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">20</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">set</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;a&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;b&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">r</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">s</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">get</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">r</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;a&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">s</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;b&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- testing closures with &#x27;for&#x27; control variable x break</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Identifier Token AttributeName LF">
</span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Number NUMBER">3</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Identifier Token FunctionName Variable ID">f</span><span class="Identifier Token FunctionName Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Token Statement Keyword BREAK">break</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">k</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">v</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">k</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix LF">
</span><span class="Token VarSuffix SPACE">  </span><span class="Identifier Token FunctionName Variable ID">f</span><span class="Identifier Token FunctionName Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">k</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">v</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Token Statement Keyword BREAK">break</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token TableConstructor Expression BraceDepth-2 LCURLY_BRACE">{</span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token TableConstructor Expression BraceDepth-2 RCURLY_BRACE">}</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token TableConstructor Expression BraceDepth-2 LCURLY_BRACE">{</span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token TableConstructor Expression BraceDepth-2 RCURLY_BRACE">}</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;a&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- testing closure x break x return x errors</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName LF">
</span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token FunctionName ID">f</span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">first</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Token Statement Keyword WHILE">while</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Number NUMBER">1</span><span class="Token Statement Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">first</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&#x27;xuxu&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Identifier Token FunctionName Variable ID">b</span><span class="Identifier Token FunctionName Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="Identifier Token ID">op</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">          </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">op</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;set&#x27;</span><span class="Token SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">            </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token Expression Punctuator PLUS">+</span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">          </span><span class="ElseStatement Token Keyword ELSE">else</span><span class="ElseStatement Token Keyword LF">
</span><span class="ElseStatement Token Keyword SPACE">            </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">          </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">        </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">    </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword BREAK">break</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="ElseIfStatement Token Keyword ELSEIF">elseif</span><span class="ElseIfStatement Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Expression Number SPACE"> </span><span class="ElseIfStatement Token Keyword THEN">then</span><span class="ElseIfStatement Token Keyword SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword LF">
</span><span class="ReturnStatment Token Keyword SPACE">    </span><span class="ElseStatement Token Keyword ELSE">else</span><span class="ElseStatement Token Keyword SPACE"> </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">error</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Identifier Token Variable ID">first</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Number NUMBER">3</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">b</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&#x27;get&#x27;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;xuxu&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;set&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">b</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&#x27;get&#x27;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Number Punctuator PLUS">+</span><span class="Identifier Token Variable ID">i</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">b</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&#x27;get&#x27;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&#x27;xuxu&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;set&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">b</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&#x27;get&#x27;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">14</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">y</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">w</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName COMMENT">-- testing multi-level closure</span><span class="Identifier Token AttributeName LF">
</span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="FuncName Identifier Token FunctionName ID">f</span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="Identifier Token ID">y</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="Identifier Token ID">z</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">w</span><span class="Token Expression Punctuator PLUS">+</span><span class="Identifier Token Variable ID">x</span><span class="Token Expression Punctuator PLUS">+</span><span class="Identifier Token Variable ID">y</span><span class="Token Expression Punctuator PLUS">+</span><span class="Identifier Token Variable ID">z</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">w</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1.345</span><span class="Token Number LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">y</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">20</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Number NUMBER">30</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">60</span><span class="Token Number Punctuator PLUS">+</span><span class="Identifier Token Variable ID">w</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- testing closures x break</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">X</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">Y</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">sin</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword WHILE">while</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token FunctionName Variable ID">X</span><span class="Identifier Token FunctionName Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword SPACE">   </span><span class="FunctionBody Token Keyword COMMENT">-- closure with upvalue</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">    </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword BREAK">break</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token FunctionName Variable ID">Y</span><span class="Identifier Token FunctionName Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword SPACE">   </span><span class="FunctionBody Token Keyword COMMENT">-- closure with upvalue</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- upvalues must be different</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">X</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">Y</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">20</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword COMMENT">-- testing closures x repeat-until</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">i</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number LF">
</span><span class="Token Statement Keyword REPEAT">repeat</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Number NUMBER">1</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword UNTIL">until</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token BraceDepth-0 Expression Punctuator RANGLE_BRACE">&gt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword OR">or</span><span class="Token Number Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">11</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">3</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">4</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- testing closures created in &#x27;then&#x27; and &#x27;else&#x27; parts of &#x27;if&#x27;s</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MOD">%</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator EQ">==</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">y</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="ElseIfStatement Token Keyword ELSEIF">elseif</span><span class="ElseIfStatement Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MOD">%</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator EQ">==</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE"> </span><span class="ElseIfStatement Token Keyword THEN">then</span><span class="ElseIfStatement Token Keyword LF">
</span><span class="ElseIfStatement Token Keyword SPACE">    </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">L1</span><span class="Identifier Token Statement LF">
</span><span class="Identifier Token Statement SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">error</span><span class="String Token STR">&#x27;not here&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">L1</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement LF">
</span><span class="Label Token Statement SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">y</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="ElseIfStatement Token Keyword ELSEIF">elseif</span><span class="ElseIfStatement Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MOD">%</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator EQ">==</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="ElseIfStatement Token Keyword THEN">then</span><span class="ElseIfStatement Token Keyword LF">
</span><span class="ElseIfStatement Token Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">    </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">l4</span><span class="Identifier Token Statement LF">
</span><span class="Identifier Token Statement SPACE">    </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">l4a</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">l4b</span><span class="Identifier Token Statement LF">
</span><span class="Identifier Token Statement SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">error</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;should never be here!&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">l4</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement LF">
</span><span class="Label Token Statement SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">y</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token FunctionName Variable ID">t</span><span class="Identifier Token FunctionName Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">    </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">l4a</span><span class="Identifier Token Statement LF">
</span><span class="Identifier Token Statement SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">error</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;should never be here!&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">l4b</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement LF">
</span><span class="Label Token Statement SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MUL">*</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MOD">%</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MUL">*</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="String Token STR">&#x27;+&#x27;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token COMMENT">-- test for correctly closing upvalues in tail calls of vararg functions</span><span class="Token LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">t</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-1 Statement LPAREN">(</span><span class="FunctionBody Token BraceDepth-1 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">c</span><span class="FunctionBody Token BraceDepth-1 Statement LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="FunctionBody Token BraceDepth-1 Statement RPAREN">)</span><span class="FunctionBody Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token Expression Punctuator EQ">==</span><span class="String Token STR">&quot;test&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Expression Punctuator EQ">==</span><span class="String Token STR">&quot;OK&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">v</span><span class="FunctionBody Token BraceDepth-1 Statement LPAREN">(</span><span class="Identifier Token ID">f</span><span class="FunctionBody Token ParameterList COMMA">,</span><span class="FunctionBody Token ParameterList SPACE"> </span><span class="Token ParameterList Punctuator VARARGS">...</span><span class="FunctionBody Token BraceDepth-1 Statement RPAREN">)</span><span class="FunctionBody Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">c</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;test&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="String Token STR">&quot;FAILED&quot;</span><span class="Token SPACE"> </span><span class="Token Expression Keyword OR">or</span><span class="Token Expression Keyword SPACE"> </span><span class="String Token STR">&quot;OK&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">v</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">t</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- test for debug manipulation of upvalues</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">debug</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">require</span><span class="String Token STR">&#x27;debug&#x27;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">foo1</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">foo2</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">foo3</span><span class="Identifier Token AttributeName LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">c</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">7</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Identifier Token FunctionName Variable ID">foo1</span><span class="Identifier Token FunctionName Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token Expression Punctuator PLUS">+</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">  </span><span class="Identifier Token FunctionName Variable ID">foo2</span><span class="Identifier Token FunctionName Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Expression Punctuator PLUS">+</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">  </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token FunctionName Variable ID">foo3</span><span class="Identifier Token FunctionName Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token Expression Punctuator PLUS">+</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalueid</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalueid</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalueid</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalueid</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalueid</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">foo2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalueid</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalueid</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">foo2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalueid</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">foo3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalueid</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalueid</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">foo3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalueid</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalueid</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">foo3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalueid</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">gmatch</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;x&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;x&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">foo1</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator PLUS">+</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Token Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">foo2</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">5</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator PLUS">+</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvaluejoin</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">foo1</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator PLUS">+</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">foo2</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">5</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator PLUS">+</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">foo3</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator PLUS">+</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvaluejoin</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">foo3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">foo3</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator PLUS">+</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvaluejoin</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">foo3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">foo3</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator PLUS">+</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">upvaluejoin</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">upvaluejoin</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">upvaluejoin</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">upvaluejoin</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">upvaluejoin</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">pcall</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">upvaluejoin</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="String Token STR">&#x27;OK&#x27;</span></code></pre><h2 id="h2-13"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/13.lua" target="_blank">13.lua</a></h2><pre class="language-lua"><code><span class="Token COMMENT">-- $Id: testes/code.lua $</span><span class="Token LF">
</span><span class="Token COMMENT">-- See Copyright Notice in file all.lua</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Keyword NIL">nil</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token BraceDepth-0 Variable LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">Message</span><span class="FunctionCall Identifier Token Variable SPACE"> </span><span class="FunctionCall Token Expression Keyword OR">or</span><span class="FunctionCall Token Expression Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="Token BraceDepth-0 Variable RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&#x27;</span><span class="String Control Token STR">\n</span><span class="String Token STR"> &gt;&gt;&gt; testC not active: skipping opcode tests &lt;&lt;&lt;</span><span class="String Control Token STR">\n</span><span class="String Token STR">&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword LF">
</span><span class="ReturnStatment Token Keyword SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="FunctionCall Identifier Token Variable SPACE"> </span><span class="String Token STR">&quot;testing code generation and optimizations&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token COMMENT">-- to test constant propagation</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">k0aux</span><span class="Identifier Token AttributeName SPACE"> </span><span class="AttributeName Token Attribute BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="AttributeName Token Attribute BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Token Attribute SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">k0</span><span class="Identifier Token AttributeName SPACE"> </span><span class="AttributeName Token Attribute BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="AttributeName Token Attribute BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Token Attribute SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">k0aux</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">k1</span><span class="Identifier Token AttributeName SPACE"> </span><span class="AttributeName Token Attribute BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="AttributeName Token Attribute BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Token Attribute SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">k3</span><span class="Identifier Token AttributeName SPACE"> </span><span class="AttributeName Token Attribute BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="AttributeName Token Attribute BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Token Attribute SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">k6</span><span class="Identifier Token AttributeName SPACE"> </span><span class="AttributeName Token Attribute BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="AttributeName Token Attribute BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Token Attribute SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">k3</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Expression Token BraceDepth-0 Variable LPAREN">(</span><span class="Identifier Token Variable ID">k3</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator SHL">&lt;&lt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">k0</span><span class="Expression Token BraceDepth-0 Variable RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">kFF0</span><span class="Identifier Token AttributeName SPACE"> </span><span class="AttributeName Token Attribute BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="AttributeName Token Attribute BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Token Attribute SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0xFF0</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">k3_78</span><span class="Identifier Token AttributeName SPACE"> </span><span class="AttributeName Token Attribute BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="AttributeName Token Attribute BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Token Attribute SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">3.78</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">k3_78_4</span><span class="Identifier Token AttributeName SPACE"> </span><span class="AttributeName Token Attribute BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="AttributeName Token Attribute BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Token Attribute SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">k3_78</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator DIV">/</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">4</span><span class="Token Expression Number LF">
</span><span class="Token Expression Number SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">kx</span><span class="Identifier Token AttributeName SPACE"> </span><span class="AttributeName Token Attribute BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="AttributeName Token Attribute BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Token Attribute SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;x&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">kTrue</span><span class="Identifier Token AttributeName SPACE"> </span><span class="AttributeName Token Attribute BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="AttributeName Token Attribute BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Token Attribute SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword TRUE">true</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">kFalse</span><span class="Identifier Token AttributeName SPACE"> </span><span class="AttributeName Token Attribute BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="AttributeName Token Attribute BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Token Attribute SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword FALSE">false</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">kNil</span><span class="Identifier Token AttributeName SPACE"> </span><span class="AttributeName Token Attribute BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="AttributeName Token Attribute BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Token Attribute SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Token Keyword COMMENT">-- this code gave an error for the code checker</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">f</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token ID">k</span><span class="Token COMMA">,</span><span class="Identifier Token ID">v</span><span class="Token COMMA">,</span><span class="Identifier Token ID">w</span><span class="Identifier Token SPACE"> </span><span class="Token Statement Keyword IN">in</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- testing reuse in constant table</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">checkKlist</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">func</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">list</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">k</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">listk</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">func</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">k</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">list</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">k</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">      </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">k</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">list</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">type</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">k</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">type</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">list</span><span class="Token VarSuffix BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">foo</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">k3</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0.0</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">7</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator PLUS">+</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">7</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">k3_78</span><span class="Token Expression Punctuator DIV">/</span><span class="Token Expression Number NUMBER">4</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">k3_78_4</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Identifier Token Variable ID">k3_78</span><span class="Token Expression Punctuator DIV">/</span><span class="Token Expression Number NUMBER">4</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">k3_78</span><span class="Token Expression Punctuator DIV">/</span><span class="Token Expression Number NUMBER">4</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">3.78</span><span class="Token Number Punctuator DIV">/</span><span class="Token Number NUMBER">4</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">3.79</span><span class="Token Number Punctuator DIV">/</span><span class="Token Number NUMBER">4</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0.0</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">0</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">k3</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">3.0</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">3.0</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkKlist</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">foo</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token Field Number NUMBER">3.78</span><span class="Token Number Punctuator DIV">/</span><span class="Token Number NUMBER">4</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">3.78</span><span class="Token Number Punctuator DIV">/</span><span class="Token Number NUMBER">4</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">3.79</span><span class="Token Number Punctuator DIV">/</span><span class="Token Number NUMBER">4</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token FunctionName Variable ID">foo</span><span class="Identifier Token FunctionName Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="Identifier Token ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">a</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">          </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">100</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator MUL">*</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">1000</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">          </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">100.0</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator MUL">*</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">1000</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">          </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">100</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator MUL">*</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">1000</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">          </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">100</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator MUL">*</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">1000.0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">          </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">100000</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">          </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Number NUMBER">100000.0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">          </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">100000</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">          </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">100000.0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">        </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkKlist</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">foo</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token Field Number NUMBER">100000</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">100000.0</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">100000</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">100000.0</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- floats x integers</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token FunctionName Variable ID">foo</span><span class="Identifier Token FunctionName Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="Identifier Token ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">a</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1.0</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1.0</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">2.0</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0.0</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1.0</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">2.0</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0.0</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkKlist</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">foo</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token Field Number NUMBER">1</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">1.0</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">2</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">2.0</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">0</span><span class="Token Punctuator COMMA">,</span><span class="Token Punctuator SPACE"> </span><span class="Token Field Number NUMBER">0.0</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- testing opcodes</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- check that &#x27;f&#x27; opcodes match &#x27;...&#x27;</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">check</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">f</span><span class="FunctionBody Token ParameterList COMMA">,</span><span class="FunctionBody Token ParameterList SPACE"> </span><span class="Token ParameterList Punctuator VARARGS">...</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">arg</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="Token Expression Punctuator VARARGS">...</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">c</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">listcode</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Token Statement ASSIGN">=</span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">arg</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">      </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">opcode</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">match</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;</span><span class="String Token Format STR">%u</span><span class="String Token STR">%w+&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">      </span><span class="Token Argument VarSuffix COMMENT">-- print(arg[i], opcode)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">      </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">arg</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">opcode</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">arg</span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">undef</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="FunctionBody Token Keyword COMMENT">-- check that &#x27;f&#x27; opcodes match &#x27;...&#x27; and that &#x27;f(p) == r&#x27;.</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">checkR</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">p</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">r</span><span class="FunctionBody Token ParameterList COMMA">,</span><span class="FunctionBody Token ParameterList SPACE"> </span><span class="Token ParameterList Punctuator VARARGS">...</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">r1</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">p</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">r</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">r1</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">type</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">r</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">type</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">r1</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator VARARGS">...</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="FunctionBody Token Keyword COMMENT">-- check that &#x27;a&#x27; and &#x27;b&#x27; has the same opcodes</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">checkequal</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">b</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">listcode</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">listcode</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">b</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">      </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">gsub</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;%b()&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">   </span><span class="Token Argument VarSuffix COMMENT">-- remove line number</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">      </span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">gsub</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;%b()&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">   </span><span class="Token Argument VarSuffix COMMENT">-- remove line number</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">      </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="FunctionBody Token Keyword COMMENT">-- some basic instructions</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE">   </span><span class="FunctionBody FunctionDefinition Token COMMENT">-- function does not create upvalues</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="Token Variable BraceDepth-1 LPAREN">(</span><span class="FunctionDefinition Token FunctionCall Keyword FUNCTION">function</span><span class="FunctionDefinition Token FunctionCall Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="FunctionBody Token FunctionCall Keyword END">end</span><span class="Token Variable BraceDepth-1 RPAREN">)</span><span class="Token TableConstructor Argument BraceDepth-1 LCURLY_BRACE">{</span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token TableConstructor Argument BraceDepth-1 RCURLY_BRACE">}</span><span class="Token TableConstructor Argument LF">
</span><span class="Token TableConstructor Argument SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;CLOSURE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;NEWTABLE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;EXTRAARG&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;GETTABUP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;CALL&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">       </span><span class="String Token STR">&#x27;SETLIST&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;CALL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN0&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE">   </span><span class="FunctionBody FunctionDefinition Token COMMENT">-- function creates upvalues</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="Token Variable BraceDepth-1 LPAREN">(</span><span class="FunctionDefinition Token FunctionCall Keyword FUNCTION">function</span><span class="FunctionDefinition Token FunctionCall Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-2 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token FunctionCall Keyword RETURN">return</span><span class="ReturnStatment Token FunctionCall Keyword SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">x</span><span class="FunctionCall Identifier Token Variable SPACE"> </span><span class="FunctionBody Token FunctionCall Keyword END">end</span><span class="Token Variable BraceDepth-1 RPAREN">)</span><span class="Token TableConstructor Argument BraceDepth-1 LCURLY_BRACE">{</span><span class="FunctionCall Identifier Token Variable ID">f</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token TableConstructor Argument BraceDepth-1 RCURLY_BRACE">}</span><span class="Token TableConstructor Argument LF">
</span><span class="Token TableConstructor Argument SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;CLOSURE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;NEWTABLE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;EXTRAARG&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;GETTABUP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;CALL&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">       </span><span class="String Token STR">&#x27;SETLIST&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;CALL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- sequence of LOADNILs</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">kNil</span><span class="Identifier Token AttributeName SPACE"> </span><span class="AttributeName Token Attribute BraceDepth-1 LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="AttributeName Token Attribute BraceDepth-1 RANGLE_BRACE">&gt;</span><span class="AttributeName Token Attribute SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">b</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">c</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">d</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">e</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">f</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">g</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">h</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">    </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Token Statement ASSIGN">=</span><span class="Token Keyword NIL">nil</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Statement ASSIGN">=</span><span class="Token Keyword NIL">nil</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token Statement ASSIGN">=</span><span class="Identifier Token Variable ID">kNil</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token Statement ASSIGN">=</span><span class="Token Keyword NIL">nil</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADNIL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN0&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">b</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">c</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">d</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">1</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token Variable ID">d</span><span class="Token Statement ASSIGN">=</span><span class="Token Keyword NIL">nil</span><span class="Token Statement SEMI">;</span><span class="Identifier Token Variable ID">c</span><span class="Token Statement ASSIGN">=</span><span class="Token Keyword NIL">nil</span><span class="Token Statement SEMI">;</span><span class="Identifier Token Variable ID">b</span><span class="Token Statement ASSIGN">=</span><span class="Token Keyword NIL">nil</span><span class="Token Statement SEMI">;</span><span class="Identifier Token Variable ID">a</span><span class="Token Statement ASSIGN">=</span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADNIL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN0&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">b</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">c</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">d</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token Number NUMBER">1</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token Variable ID">d</span><span class="Token Statement ASSIGN">=</span><span class="Token Keyword NIL">nil</span><span class="Token Statement SEMI">;</span><span class="Identifier Token Variable ID">c</span><span class="Token Statement ASSIGN">=</span><span class="Token Keyword NIL">nil</span><span class="Token Statement SEMI">;</span><span class="Identifier Token Variable ID">b</span><span class="Token Statement ASSIGN">=</span><span class="Token Keyword NIL">nil</span><span class="Token Statement SEMI">;</span><span class="Identifier Token Variable ID">a</span><span class="Token Statement ASSIGN">=</span><span class="Token Keyword NIL">nil</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Keyword AND">and</span><span class="Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Keyword AND">and</span><span class="Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Keyword AND">and</span><span class="Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- single return</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="FunctionCall Identifier Token Variable SPACE"> </span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token ID">c</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- infinite loops</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Token Statement Keyword WHILE">while</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">kTrue</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="String Token STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN0&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Token Statement Keyword WHILE">while</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Number NUMBER">1</span><span class="Token Statement Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="String Token STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN0&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Token Statement Keyword REPEAT">repeat</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword UNTIL">until</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword TRUE">true</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="String Token STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN0&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- concat optimization</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token ID">c</span><span class="Token COMMA">,</span><span class="Identifier Token ID">d</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token Expression Punctuator CONCAT">..</span><span class="Identifier Token Variable ID">b</span><span class="Token Expression Punctuator CONCAT">..</span><span class="Identifier Token Variable ID">c</span><span class="Token Expression Punctuator CONCAT">..</span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="String Token STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;CONCAT&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- not</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADFALSE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">kFalse</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADFALSE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Keyword TRUE">true</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADTRUE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">k3</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADTRUE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- direct access to locals</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">b</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">c</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">d</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Expression Punctuator MUL">*</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable ID">c</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Token Expression Punctuator DIV">/</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator CARET">^</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">x</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="String Token STR">&#x27;LOADNIL&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="String Token STR">&#x27;MUL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBIN&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="String Token STR">&#x27;DIV&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBIN&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;ADD&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBIN&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;GETTABLE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;SUB&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBIN&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="String Token STR">&#x27;GETFIELD&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;POW&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBIN&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;UNM&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;SETTABLE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;SETFIELD&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN0&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- direct access to constants</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">c</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">kNil</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">kx</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">3.2</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">x</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&#x27;x&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="String Token STR">&#x27;LOADNIL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;SETFIELD&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;SETFIELD&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;SETTABLE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN0&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- &quot;get/set table&quot; with numeric indices</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">k255</span><span class="Identifier Token AttributeName SPACE"> </span><span class="AttributeName Token Attribute BraceDepth-1 LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="AttributeName Token Attribute BraceDepth-1 RANGLE_BRACE">&gt;</span><span class="AttributeName Token Attribute SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">255</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">100</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix LF">
</span><span class="Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">k255</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">256</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix LF">
</span><span class="Token VarSuffix SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">256</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="String Token STR">&#x27;GETI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;SETI&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="String Token STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;GETTABLE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;SETI&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="String Token STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;SETTABLE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE">  </span><span class="String Token STR">&#x27;RETURN0&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token Expression Punctuator DIV">/</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Token Number Punctuator MINUS">-</span><span class="Token Number NUMBER">4</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="String Token STR">&#x27;LOADNIL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;SUB&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBIN&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;DIV&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBIN&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN0&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">kTrue</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword FALSE">false</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="String Token STR">&#x27;LOADNIL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADTRUE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;SETTABLE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN0&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- equalities</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="String Token STR">&#x27;EQI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">4.0</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator EQ">==</span><span class="Token Number Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="String Token STR">&#x27;EQI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;hi&quot;</span><span class="Token SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="String Token STR">&#x27;EQK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10000</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="String Token STR">&#x27;EQK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">   </span><span class="Token Argument VarSuffix COMMENT">-- number too large</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">10000</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator EQ">==</span><span class="Token Number Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">10000</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="String Token STR">&#x27;EQK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE">   </span><span class="Token Argument VarSuffix COMMENT">-- number too large</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- comparisons</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">10</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator LE">&lt;=</span><span class="Token Number Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="String Token STR">&#x27;GEI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Number NUMBER">128.0</span><span class="Token Statement Number SPACE"> </span><span class="Token Number BraceDepth-1 Punctuator RANGLE_BRACE">&gt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">129</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="String Token STR">&#x27;LTI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">127.0</span><span class="Token Expression Number SPACE"> </span><span class="Token Number BraceDepth-1 Punctuator LANGLE_BRACE">&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">127</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="String Token STR">&#x27;GTI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Number NUMBER">10</span><span class="Token Statement Number SPACE"> </span><span class="Token Number BraceDepth-1 Punctuator LANGLE_BRACE">&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">11</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="String Token STR">&#x27;GTI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Number NUMBER">129</span><span class="Token Statement Number SPACE"> </span><span class="Token Number BraceDepth-1 Punctuator LANGLE_BRACE">&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">130</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="String Token STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LT&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator GE">&gt;=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">23.0</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">25</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="String Token STR">&#x27;GEI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator GE">&gt;=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">23.1</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="String Token STR">&#x27;LOADK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token BraceDepth-1 Expression Punctuator RANGLE_BRACE">&gt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2300.0</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="String Token STR">&#x27;LOADF&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LT&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- constant folding</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">checkK</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">func</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">val</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">func</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">checkKlist</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">func</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">val</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">func</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">val</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">checkI</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">func</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">val</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">func</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">checkKlist</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">func</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">func</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">val</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">checkF</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">func</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">val</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">func</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADF&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">checkKlist</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">func</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-1 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-1 RCURLY_BRACE">}</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">func</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">val</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkF</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">0.0</span><span class="Token Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0.0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkI</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">k0</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkI</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Identifier Token Variable ID">k0</span><span class="Token Expression Punctuator DOUBLE_DIV">//</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkK</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Number Punctuator CARET">^</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number Punctuator DIV">/</span><span class="Token Number NUMBER">3</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkK</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">1</span><span class="Token Variable Number SPACE"> </span><span class="Token Number Punctuator PLUS">+</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Token Expression Punctuator CARET">^</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">50</span><span class="Token Variable Number SPACE"> </span><span class="Token Number Punctuator PLUS">+</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">50</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number Punctuator CARET">^</span><span class="Token Number NUMBER">100</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkK</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">2</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Token Expression Punctuator CARET">^</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">31</span><span class="Token Variable Number SPACE"> </span><span class="Token Number Punctuator MINUS">-</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">0x20000000</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator PLUS">+</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">0.0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkF</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Identifier Token Variable ID">k3</span><span class="Token Expression Punctuator CARET">^</span><span class="Token Expression Number NUMBER">0</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator PLUS">+</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator DOUBLE_DIV">//</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3.0</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1.0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkI</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Identifier Token Variable ID">k3</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MOD">%</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">5</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkF</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Token Variable Number NUMBER">2.0</span><span class="Token Number Punctuator CARET">^</span><span class="Token Number NUMBER">8</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator PLUS">+</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Expression Token BraceDepth-0 Variable LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Expression Token BraceDepth-0 Variable RPAREN">)</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator MOD">%</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">8</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Token Expression Punctuator DIV">/</span><span class="Token Expression Number NUMBER">2</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator MUL">*</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator MINUS">-</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">5.0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkF</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Token Variable Number NUMBER">2</span><span class="Token Number Punctuator CARET">^</span><span class="Token Number NUMBER">8</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator PLUS">+</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Expression Token BraceDepth-0 Variable LPAREN">(</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Expression Token BraceDepth-0 Variable RPAREN">)</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator MOD">%</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">8</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Token Expression Punctuator DOUBLE_DIV">//</span><span class="Token Expression Number NUMBER">2</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator MUL">*</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator MINUS">-</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">7.0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkI</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">0xF0.0</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator PIPE">|</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">0xCC.0</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator TILDE">~</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">0xAA</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator AMPERSAND">&amp;</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">0xFD</span><span class="Token Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0xF4</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkI</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Expression Punctuator TILDE">~</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Expression Punctuator TILDE">~</span><span class="Identifier Token Variable ID">kFF0</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PIPE">|</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">kFF0</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkI</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Expression Punctuator TILDE">~</span><span class="Token Expression Punctuator TILDE">~</span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1024.0</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1024</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkI</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Token Variable Number NUMBER">100</span><span class="Token Variable Number SPACE"> </span><span class="Token Number Punctuator SHL">&lt;&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Identifier Token Variable ID">k6</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator SHL">&lt;&lt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">4</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator SHR">&gt;&gt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">100</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- borders around MAXARG_sBx ((((1 &lt;&lt; 17) - 1) &gt;&gt; 1) == 65535)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">17</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">sbx</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Expression Token BraceDepth-0 Variable LPAREN">(</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">1</span><span class="Token Variable Number SPACE"> </span><span class="Token Number Punctuator SHL">&lt;&lt;</span><span class="Token Number Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Expression Token BraceDepth-0 Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Punctuator SHR">&gt;&gt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE">   </span><span class="Token Expression Number COMMENT">-- avoid folding</span><span class="Token Expression Number LF">
</span><span class="Token Expression Number SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">border</span><span class="Identifier Token AttributeName SPACE"> </span><span class="AttributeName Token Attribute BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="AttributeName Token Attribute BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Token Attribute SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">65535</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkI</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">border</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">sbx</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkI</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Identifier Token Variable ID">border</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Identifier Token Variable ID">sbx</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkI</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">border</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">sbx</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkK</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">border</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">sbx</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkK</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">border</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">sbx</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">border</span><span class="Identifier Token AttributeName SPACE"> </span><span class="AttributeName Token Attribute BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="AttributeName Token Attribute BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Token Attribute SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">65535.0</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkF</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">border</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">sbx</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0.0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkF</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Identifier Token Variable ID">border</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Identifier Token Variable ID">sbx</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0.0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkF</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">border</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">sbx</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1.0</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkK</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">border</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">sbx</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2.0</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkK</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">border</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">sbx</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1.0</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- immediate operands</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">k1</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">11</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;ADDI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBINI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">127</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">117</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;ADDI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBINI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">128</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator PLUS">+</span><span class="Token Number Punctuator SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0.0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">128.0</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">           </span><span class="String Token STR">&#x27;ADDI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBINI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MUL">*</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">127</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1.0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">127.0</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">           </span><span class="String Token STR">&#x27;MULK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">20</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator MUL">*</span><span class="Token Number Punctuator SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">40</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MULK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator CARET">^</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">2</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0.25</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;POWK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator DIV">/</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">40</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">40</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1.0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;DIVK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator DOUBLE_DIV">//</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10.0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10.0</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">           </span><span class="String Token STR">&#x27;IDIVK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MOD">%</span><span class="Token Expression Punctuator SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">100</span><span class="Token Variable Number SPACE"> </span><span class="Token Number Punctuator MINUS">-</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">91</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">           </span><span class="String Token STR">&#x27;MODK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">k1</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator SHL">&lt;&lt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">8</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;SHLI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBINI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator SHL">&lt;&lt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">127</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;SHRI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBINI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator SHL">&lt;&lt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">127</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;SHRI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBINI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator SHR">&gt;&gt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">128</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">8</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;SHRI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBINI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator SHR">&gt;&gt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">127</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">8</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;SHRI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBINI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">9</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;BANDK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator PIPE">|</span><span class="Token Number Punctuator SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">11</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;BORK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">10</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Punctuator TILDE">~</span><span class="Token Number Punctuator SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">9</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;BXORK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- K operands in arithmetic operations</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0.0</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1.0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;ADDK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">--  check(function (x) return 128 + x end, &#x27;ADDK&#x27;, &#x27;MMBINK&#x27;, &#x27;RETURN1&#x27;)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MUL">*</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">10000</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">20000</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">           </span><span class="String Token STR">&#x27;MULK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">--  check(function (x) return 20 * x end, &#x27;MULK&#x27;, &#x27;MMBINK&#x27;, &#x27;RETURN1&#x27;)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator CARET">^</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0.5</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2.0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;POWK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator DIV">/</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2.0</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2.0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;DIVK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator DOUBLE_DIV">//</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10000</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">10000</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">           </span><span class="String Token STR">&#x27;IDIVK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkR</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MOD">%</span><span class="Token Expression Punctuator SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Variable Number NUMBER">100.0</span><span class="Token Variable Number SPACE"> </span><span class="Token Number Punctuator MINUS">-</span><span class="Token Number Punctuator SPACE"> </span><span class="Token Number NUMBER">10</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">91</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1.0</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">           </span><span class="String Token STR">&#x27;MODK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- no foldings (and immediate operands)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">0.0</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADF&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;UNM&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">k3</span><span class="Token Expression Punctuator DIV">/</span><span class="Token Expression Number NUMBER">0</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;DIVK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Number Punctuator MOD">%</span><span class="Token Number NUMBER">0</span><span class="Token Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MODK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">4</span><span class="Token Number Punctuator DOUBLE_DIV">//</span><span class="Token Number NUMBER">0</span><span class="Token Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;IDIVK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator SHR">&gt;&gt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2.0</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADF&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;SHR&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBIN&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator SHL">&lt;&lt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">128</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;SHL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBIN&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator AMPERSAND">&amp;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2.0</span><span class="Token Expression Number SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADF&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;BAND&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBIN&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- basic &#x27;for&#x27; loops</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Number NUMBER">10</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">10.5</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="String Token STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;FORPREP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;FORLOOP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN0&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">0xfffffff</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">10.0</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="String Token STR">&#x27;LOADK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADF&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;FORPREP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;FORLOOP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN0&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- bug in constant folding for 5.1</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Keyword NIL">nil</span><span class="Token Expression Keyword SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;LOADNIL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;UNM&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN1&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">b</span><span class="Token AttributeName COMMA">,</span><span class="Identifier Token AttributeName ID">c</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">    </span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">c</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable ID">b</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="String Token STR">&#x27;LOADNIL&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="String Token STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;SETTABLE&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="String Token STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;SETTABLE&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="String Token STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token COMMENT">-- no code for a = a</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="String Token STR">&#x27;RETURN0&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- x == nil , x ~= nil</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- checkequal(function (b) if (a==nil) then a=1 end; if a~=nil then a=1 end end,</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">--            function () if (a==9) then a=1 end; if a~=9 then a=1 end end)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- check(function () if a==nil then a=&#x27;a&#x27; end end,</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- &#x27;GETTABUP&#x27;, &#x27;EQ&#x27;, &#x27;JMP&#x27;, &#x27;SETTABUP&#x27;, &#x27;RETURN&#x27;)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">   </span><span class="Token Statement Keyword COMMENT">-- tests for table access in upvalues</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">kx</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix TableKey ID">y</span><span class="Identifier Token VarSuffix TableKey SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;GETTABUP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;SETTABUP&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="FunctionCall Identifier Token Variable ID">a</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="FunctionCall Identifier Token Variable ID">a</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="String Token STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;CALL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;GETUPVAL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;CALL&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="String Token STR">&#x27;GETUPVAL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;GETTABLE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;SETTABLE&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- de morgan</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkequal</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword OR">or</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Statement ASSIGN">=</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">             </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token Statement ASSIGN">=</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkequal</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">l</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">0</span><span class="Token Number SPACE"> </span><span class="Token Number Punctuator LE">&lt;=</span><span class="Token Number Punctuator SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator LE">&lt;=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">l</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">             </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">l</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Expression Token Variable BraceDepth-1 LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator GE">&gt;=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">0</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Token Expression Keyword OR">or</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator LE">&lt;=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">l</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Expression Token Variable BraceDepth-1 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- if-break optimizations</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">check</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">b</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">          </span><span class="Token Statement Keyword WHILE">while</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">            </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword BREAK">break</span><span class="Token Statement Keyword SPACE"> </span><span class="ElseStatement Token Keyword ELSE">else</span><span class="ElseStatement Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">          </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">        </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="String Token STR">&#x27;TEST&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;TEST&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;ADDI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;MMBINI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&#x27;RETURN0&#x27;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkequal</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">6</span><span class="Token Number SPACE"> </span><span class="Token Number Keyword OR">or</span><span class="Token Number Keyword SPACE"> </span><span class="Token Number Keyword TRUE">true</span><span class="Token Number Keyword SPACE"> </span><span class="Token Keyword OR">or</span><span class="Token Keyword SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">             </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">k6</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword OR">or</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">kTrue</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword OR">or</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">kNil</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">checkequal</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Token Number NUMBER">6</span><span class="Token Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Token Number Keyword TRUE">true</span><span class="Token Number Keyword SPACE"> </span><span class="Token Keyword OR">or</span><span class="Token Keyword SPACE"> </span><span class="Token Keyword NIL">nil</span><span class="Token Keyword SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">             </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">k6</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">kTrue</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword OR">or</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">kNil</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">   </span><span class="Token Statement Keyword COMMENT">-- string constants</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">k0</span><span class="Identifier Token AttributeName SPACE"> </span><span class="AttributeName Token Attribute BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="AttributeName Token Attribute BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Token Attribute SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">&quot;00000000000000000000000000000000000000000000000000&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">f1</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">      </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">k</span><span class="Identifier Token AttributeName SPACE"> </span><span class="AttributeName Token Attribute BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">const</span><span class="AttributeName Token Attribute BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Token Attribute SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">k0</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">      </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token LF">
</span><span class="FunctionBody FunctionDefinition Token SPACE">               </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">k</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">             </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">    </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">f2</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">f1</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">f3</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">f2</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">f3</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">k0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">checkK</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">f3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">k0</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Argument VarSuffix COMMENT">-- string is not needed by other functions</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">listk</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">f1</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">listk</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">f2</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="FunctionCall Identifier Token Variable SPACE"> </span><span class="String Token STR">&#x27;OK&#x27;</span></code></pre><h2 id="h2-14"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/14.lua" target="_blank">14.lua</a></h2><pre class="language-lua"><code><span class="Token COMMENT">-- $Id: testes/goto.lua $</span><span class="Token LF">
</span><span class="Token COMMENT">-- See Copyright Notice in file all.lua</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="FunctionCall Identifier Token Variable ID">collectgarbage</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">errmsg</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="Identifier Token ID">code</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">m</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">st</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">msg</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">code</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">st</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Keyword AND">and</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">find</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword COMMENT">-- cannot see label inside block</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">errmsg</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">[[ goto l1; do ::l1:: end ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;label &#x27;l1&#x27;&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">errmsg</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">[[ do ::l1:: end goto l1; ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;label &#x27;l1&#x27;&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- repeated label</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">errmsg</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">[[ ::l1:: ::l1:: ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;label &#x27;l1&#x27;&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">errmsg</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">[[ ::l1:: do ::l1:: end]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;label &#x27;l1&#x27;&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- undefined label</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">errmsg</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">[[ goto l1; local aa ::l1:: ::l2:: print(3) ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;local &#x27;aa&#x27;&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- jumping over variable definition</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">errmsg</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">[[
do local bb, cc; goto l1; end
local aa
::l1:: print(3)
]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;local &#x27;aa&#x27;&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- jumping into a block</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">errmsg</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">[[ do ::l1:: end goto l1 ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;label &#x27;l1&#x27;&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">errmsg</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">[[ goto l1 do ::l1:: end ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;label &#x27;l1&#x27;&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- cannot continue a repeat-until with variables</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">errmsg</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">[[
  repeat
    if x then goto cont end
    local xuxu = 10
    ::cont::
  until xuxu &lt; x
]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="String Token STR">&quot;local &#x27;xuxu&#x27;&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- simple gotos</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">y</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">12</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">l1</span><span class="Identifier Token Statement LF">
</span><span class="Identifier Token Statement SPACE">  </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">l2</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">l3</span><span class="Identifier Token Statement LF">
</span><span class="Identifier Token Statement SPACE">  </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">l1</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">l2</span><span class="Identifier Token Statement LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">l3</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement SPACE"> </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">l3_1</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">13</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- long labels</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">prog</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="String Token STR">[[
  do
    local a = 1
    goto l</span><span class="String Token Format STR">%sa</span><span class="String Token STR">; a = a + 1
   ::l</span><span class="String Token Format STR">%sa</span><span class="String Token STR">:: a = a + 10
    goto l</span><span class="String Token Format STR">%s</span><span class="String Token STR">b; a = a + 2
   ::l</span><span class="String Token Format STR">%s</span><span class="String Token STR">b:: a = a + 20
    return a
  end
  ]]</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">label</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">rep</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;0123456789&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">40</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">format</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">label</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">label</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">label</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">label</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">load</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">31</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword COMMENT">-- ok to jump over local dec. to end of block</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">l1</span><span class="Identifier Token Statement LF">
</span><span class="Identifier Token Statement SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">23</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">l1</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword WHILE">while</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword TRUE">true</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">l4</span><span class="Identifier Token Statement LF">
</span><span class="Identifier Token Statement SPACE">  </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">l1</span><span class="Identifier Token Statement SPACE">  </span><span class="Identifier Token Statement COMMENT">-- ok to jump over local dec. to end of block</span><span class="Identifier Token Statement LF">
</span><span class="Identifier Token Statement SPACE">  </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">l1</span><span class="Identifier Token Statement SPACE">  </span><span class="Identifier Token Statement COMMENT">-- multiple uses of same label</span><span class="Identifier Token Statement LF">
</span><span class="Identifier Token Statement SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">45</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">l1</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement SPACE"> </span><span class="Token Statement SEMI">;</span><span class="Token Statement SEMI">;</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">l4</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">13</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">l1</span><span class="Identifier Token Statement SPACE">   </span><span class="Identifier Token Statement COMMENT">-- ok to jump over local dec. to end of block</span><span class="Identifier Token Statement LF">
</span><span class="Identifier Token Statement SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">error</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="String Token STR">&quot;should not be here&quot;</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">l2</span><span class="Identifier Token Statement SPACE">   </span><span class="Identifier Token Statement COMMENT">-- ok to jump over local dec. to end of block</span><span class="Identifier Token Statement LF">
</span><span class="Identifier Token Statement SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">  </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">l1</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement SPACE"> </span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">l2</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement SPACE"> </span><span class="Token Statement SEMI">;</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="ElseStatement Token Keyword ELSE">else</span><span class="ElseStatement Token Keyword SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword COMMENT">-- to repeat a label in a different function is OK</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">foo</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">l3</span><span class="Identifier Token Statement LF">
</span><span class="Identifier Token Statement SPACE">  </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">l1</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">l2</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">  </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">l2</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">l5</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">  </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">l3</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement LF">
</span><span class="Label Token Statement SPACE">  </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">l3a</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">l1</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">  </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">l4</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">l6</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">  </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">l5</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">l4</span><span class="Token Statement SEMI">;</span><span class="Token Statement LF">
</span><span class="Token Statement SPACE">  </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">l6</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">2</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">3</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword LF">
</span><span class="Token Number Keyword SPACE">              </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">4</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">5</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">5</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">4</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Expression Keyword NOT">not</span><span class="Token Expression Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">6</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">6</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword TRUE">true</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">l3a</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword SPACE">   </span><span class="Token Statement Keyword COMMENT">-- do it twice</span><span class="Token Statement Keyword LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">l6</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">foo</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">   </span><span class="Token Statement Keyword COMMENT">-- bug in 5.2 -&gt; 5.3.2</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">x</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">  </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">L1</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement LF">
</span><span class="Label Token Statement SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">y</span><span class="Identifier Token AttributeName SPACE">             </span><span class="Identifier Token AttributeName COMMENT">-- cannot join this SETNIL with previous one</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword TRUE">true</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Expression Keyword SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number LF">
</span><span class="Token Number SPACE">    </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">L1</span><span class="Identifier Token Statement LF">
</span><span class="Identifier Token Statement SPACE">  </span><span class="ElseStatement Token Keyword ELSE">else</span><span class="ElseStatement Token Keyword LF">
</span><span class="ElseStatement Token Keyword SPACE">    </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number LF">
</span><span class="Token Expression Number SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Expression Number SPACE"> </span><span class="Token Number Keyword AND">and</span><span class="Token Number Keyword SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword TRUE">true</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword COMMENT">-- bug in 5.3</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">first</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword TRUE">true</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword FALSE">false</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">  </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword TRUE">true</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">LBL</span><span class="Identifier Token Statement LF">
</span><span class="Identifier Token Statement SPACE">    </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">loop</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement LF">
</span><span class="Label Token Statement SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword TRUE">true</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">    </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">LBL</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement LF">
</span><span class="Label Token Statement SPACE">    </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">first</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">      </span><span class="Identifier Token Variable ID">first</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword FALSE">false</span><span class="Token Keyword LF">
</span><span class="Token Keyword SPACE">      </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">loop</span><span class="Identifier Token Statement LF">
</span><span class="Identifier Token Statement SPACE">    </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE">   </span><span class="Token Statement Keyword COMMENT">-- compiling infinite loops</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">escape</span><span class="Identifier Token Statement SPACE">   </span><span class="Identifier Token Statement COMMENT">-- do not run the infinite loops</span><span class="Identifier Token Statement LF">
</span><span class="Identifier Token Statement SPACE">  </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">a</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement SPACE"> </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">a</span><span class="Identifier Token Statement LF">
</span><span class="Identifier Token Statement SPACE">  </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">b</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement SPACE"> </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">c</span><span class="Identifier Token Statement LF">
</span><span class="Identifier Token Statement SPACE">  </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">c</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement SPACE"> </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">b</span><span class="Identifier Token Statement LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">escape</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement LF">
</span><span class="Label Token Statement COMMENT">--------------------------------------------------------------------------------</span><span class="Label Token Statement LF">
</span><span class="Label Token Statement COMMENT">-- testing closing of upvalues</span><span class="Label Token Statement LF">
</span><span class="Label Token Statement LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">debug</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">require</span><span class="FunctionCall Identifier Token Variable SPACE"> </span><span class="String Token STR">&#x27;debug&#x27;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">foo</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-0 Statement LPAREN">(</span><span class="FunctionBody Token BraceDepth-0 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">t</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="BraceDepth-0 Token TableConstructor Expression LCURLY_BRACE">{</span><span class="BraceDepth-0 Token TableConstructor Expression RCURLY_BRACE">}</span><span class="Token TableConstructor Expression LF">
</span><span class="Token TableConstructor Expression SPACE">  </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">i</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Number LF">
</span><span class="Token Number SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">c</span><span class="Token AttributeName COMMA">,</span><span class="Token AttributeName SPACE"> </span><span class="Identifier Token AttributeName ID">d</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">  </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">l1</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement LF">
</span><span class="Label Token Statement SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">b</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">  </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">c</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword SPACE">    </span><span class="FunctionBody Token Keyword COMMENT">-- t[2], t[4], t[6]</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">    </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token BraceDepth-0 Expression Punctuator RANGLE_BRACE">&gt;</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">l2</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">      </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">d</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">      </span><span class="Identifier Token Variable ID">t</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token VarSuffix SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-1 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword SPACE">   </span><span class="FunctionBody Token Keyword COMMENT">-- t[3], t[5]</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword SPACE">      </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number LF">
</span><span class="Token Expression Number SPACE">      </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">      </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">l1</span><span class="Identifier Token Statement LF">
</span><span class="Identifier Token Statement SPACE">    </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">l2</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">foo</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token Expression Punctuator HASH">#</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">6</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix COMMENT">-- all functions share same &#x27;a&#x27;</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">6</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalueid</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalueid</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">1</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword COMMENT">-- &#x27;b&#x27; and &#x27;c&#x27; are shared among some of them</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">6</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- only a[1] uses external &#x27;b&#x27;/&#x27;b&#x27;</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalueid</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalueid</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalueid</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalueid</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- inner functions share &#x27;b&#x27;/&#x27;c&#x27; with previous ones</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalueid</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalueid</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalueid</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalueid</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MINUS">-</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Argument VarSuffix COMMENT">-- but not with next ones</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalueid</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalueid</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">2</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalueid</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator NORE">~=</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalueid</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">3</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword COMMENT">-- only external &#x27;d&#x27; is shared</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">6</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalueid</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token VarSuffix Number NUMBER">1</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalueid</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword COMMENT">-- internal &#x27;d&#x27;s are all different</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">i</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">3</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">5</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">2</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword FOR">for</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">j</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">1</span><span class="Token Statement COMMA">,</span><span class="Token Statement SPACE"> </span><span class="Token Number NUMBER">6</span><span class="Token Number SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalueid</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="Token VarSuffix DOT">.</span><span class="Identifier Token VarSuffix FunctionCall ID">upvalueid</span><span class="Token Argument BraceDepth-0 VarSuffix LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token VarSuffix BraceDepth-1 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">j</span><span class="Token VarSuffix BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Number NUMBER">4</span><span class="Token Argument BraceDepth-0 VarSuffix RPAREN">)</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">      </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Identifier Token Variable ID">j</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword COMMENT">--------------------------------------------------------------------------------</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword COMMENT">-- testing if x goto optimizations</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword FUNCTION">function</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">testG</span><span class="Identifier Token Statement SPACE"> </span><span class="FunctionBody Token BraceDepth-1 Statement LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionBody Token BraceDepth-1 Statement RPAREN">)</span><span class="FunctionBody Token Statement LF">
</span><span class="FunctionBody Token Statement SPACE">  </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">l1</span><span class="Identifier Token Statement LF">
</span><span class="Identifier Token Statement SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">error</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;should never be here!&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">  </span><span class="ElseIfStatement Token Keyword ELSEIF">elseif</span><span class="ElseIfStatement Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Expression Number SPACE"> </span><span class="ElseIfStatement Token Keyword THEN">then</span><span class="ElseIfStatement Token Keyword SPACE"> </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">l2</span><span class="Identifier Token Statement LF">
</span><span class="Identifier Token Statement SPACE">  </span><span class="ElseIfStatement Token Keyword ELSEIF">elseif</span><span class="ElseIfStatement Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">3</span><span class="Token Expression Number SPACE"> </span><span class="ElseIfStatement Token Keyword THEN">then</span><span class="ElseIfStatement Token Keyword SPACE"> </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">l3</span><span class="Identifier Token Statement LF">
</span><span class="Identifier Token Statement SPACE">  </span><span class="ElseIfStatement Token Keyword ELSEIF">elseif</span><span class="ElseIfStatement Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">4</span><span class="Token Expression Number SPACE"> </span><span class="ElseIfStatement Token Keyword THEN">then</span><span class="ElseIfStatement Token Keyword LF">
</span><span class="ElseIfStatement Token Keyword SPACE">    </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">l1</span><span class="Identifier Token Statement SPACE">  </span><span class="Identifier Token Statement COMMENT">-- go to inside the block</span><span class="Identifier Token Statement LF">
</span><span class="Identifier Token Statement SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">error</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;should never be here!&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">l1</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator PLUS">+</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">1</span><span class="Token Expression Number SPACE">   </span><span class="Token Expression Number COMMENT">-- must go to &#x27;if&#x27; end</span><span class="Token Expression Number LF">
</span><span class="Token Expression Number SPACE">  </span><span class="ElseStatement Token Keyword ELSE">else</span><span class="ElseStatement Token Keyword LF">
</span><span class="ElseStatement Token Keyword SPACE">    </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">l4</span><span class="Identifier Token Statement LF">
</span><span class="Identifier Token Statement SPACE">    </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">l4a</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator MUL">*</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">2</span><span class="Token Statement SEMI">;</span><span class="Token Statement SPACE"> </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">l4b</span><span class="Identifier Token Statement LF">
</span><span class="Identifier Token Statement SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">error</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;should never be here!&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">l4</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement SPACE"> </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">l4a</span><span class="Identifier Token Statement LF">
</span><span class="Identifier Token Statement SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">error</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="String Token STR">&quot;should never be here!&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">l4b</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement LF">
</span><span class="Label Token Statement SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">l2</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="String Token STR">&quot;2&quot;</span><span class="Token SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">l3</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="String Token STR">&quot;3&quot;</span><span class="Token SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">l1</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement SPACE"> </span><span class="ReturnStatment Token Keyword RETURN">return</span><span class="ReturnStatment Token Keyword SPACE"> </span><span class="String Token STR">&quot;1&quot;</span><span class="Token LF">
</span><span class="FunctionBody Token Keyword END">end</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionBody Token Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">testG</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Token Number NUMBER">1</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;1&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">testG</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Token Number NUMBER">2</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;2&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">testG</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Token Number NUMBER">3</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="String Token STR">&quot;3&quot;</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">testG</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Token Number NUMBER">4</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">5</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="FunctionCall Identifier Token Variable ID">testG</span><span class="BraceDepth-2 Token Argument VarSuffix LPAREN">(</span><span class="Token Number NUMBER">5</span><span class="BraceDepth-2 Token Argument VarSuffix RPAREN">)</span><span class="Token Argument VarSuffix SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Number NUMBER">10</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword COMMENT">-- if x back goto out of scope of upvalue</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">X</span><span class="Identifier Token AttributeName LF">
</span><span class="Identifier Token AttributeName SPACE">  </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">L1</span><span class="Identifier Token Statement LF">
</span><span class="Identifier Token Statement SPACE">  </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">L2</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement SPACE"> </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">L3</span><span class="Identifier Token Statement LF">
</span><span class="Identifier Token Statement SPACE">  </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">L1</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement SPACE"> </span><span class="Token Statement Keyword DO">do</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">    </span><span class="Token Statement Keyword LOCAL">local</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token AttributeName ID">a</span><span class="Identifier Token AttributeName SPACE"> </span><span class="AttributeName Token Attribute BraceDepth-1 LANGLE_BRACE">&lt;</span><span class="Identifier Token Attribute AttributeType ID">close</span><span class="AttributeName Token Attribute BraceDepth-1 RANGLE_BRACE">&gt;</span><span class="AttributeName Token Attribute SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">setmetatable</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Token TableConstructor Expression BraceDepth-2 LCURLY_BRACE">{</span><span class="Token TableConstructor Expression BraceDepth-2 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token TableConstructor Expression BraceDepth-2 LCURLY_BRACE">{</span><span class="Identifier Token Field ID">__close</span><span class="Identifier Token Field SPACE"> </span><span class="Token Field FieldList ASSIGN">=</span><span class="Token Field FieldList SPACE"> </span><span class="FunctionDefinition Token Keyword FUNCTION">function</span><span class="FunctionDefinition Token Keyword SPACE"> </span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 LPAREN">(</span><span class="FunctionBody FunctionDefinition Token BraceDepth-0 RPAREN">)</span><span class="FunctionBody FunctionDefinition Token SPACE"> </span><span class="Identifier Token Variable ID">X</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement ASSIGN">=</span><span class="Token Statement SPACE"> </span><span class="Token Keyword TRUE">true</span><span class="Token Keyword SPACE"> </span><span class="FunctionBody Token Keyword END">end</span><span class="Token TableConstructor Expression BraceDepth-2 RCURLY_BRACE">}</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">X</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword NIL">nil</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Argument VarSuffix SPACE">    </span><span class="Token Statement Keyword IF">if</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Statement Keyword THEN">then</span><span class="Token Statement Keyword SPACE"> </span><span class="Token Statement Keyword GOTO">goto</span><span class="Token Statement Keyword SPACE"> </span><span class="Identifier Token Statement ID">L2</span><span class="Identifier Token Statement SPACE"> </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword SPACE">   </span><span class="Token Statement Keyword COMMENT">-- jumping back out of scope of &#x27;a&#x27;</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword SPACE">  </span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Identifier Token ID">L3</span><span class="Label Token Statement DOUBLE_COLON">::</span><span class="Label Token Statement SPACE"> </span><span class="FunctionCall Identifier Token Variable ID">assert</span><span class="Token Argument VarSuffix BraceDepth-1 LPAREN">(</span><span class="Identifier Token Variable ID">X</span><span class="Identifier Token Variable SPACE"> </span><span class="Token Expression Punctuator EQ">==</span><span class="Token Expression Punctuator SPACE"> </span><span class="Token Expression Keyword TRUE">true</span><span class="Token Argument VarSuffix BraceDepth-1 RPAREN">)</span><span class="Token Argument VarSuffix SPACE">   </span><span class="Token Argument VarSuffix COMMENT">-- checks that &#x27;a&#x27; was correctly closed</span><span class="Token Argument VarSuffix LF">
</span><span class="Token Statement Keyword END">end</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword COMMENT">--------------------------------------------------------------------------------</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="Token Statement Keyword LF">
</span><span class="FunctionCall Identifier Token Variable ID">print</span><span class="String Token STR">&#x27;OK&#x27;</span></code></pre></div>
    <div class="dir-tree"><ul><li><a href="../../md-docs/README" >README</a></li></ul><ul><li><a href="../../用户手册/API" >用户手册</a><ul><li><a href="../../用户手册/API" >API</a></li></ul><ul><li><a href="../../用户手册/全部文法支持" >全部文法支持</a></li></ul><ul><li><a href="../../用户手册/自定义颜色" >自定义颜色</a></li></ul><ul><li><a href="../../用户手册/自定义文法解析" >自定义文法解析</a></li></ul><ul><li><a href="../../用户手册/文法扩展" >文法扩展</a></li></ul><ul><li><a href="../../用户手册/已知问题" >已知问题</a></li></ul></li></ul><ul><li><a href="../../全部文法高亮/C" >全部文法高亮</a><ul><li><a href="../../全部文法高亮/C" >C</a></li></ul><ul><li><a href="../../全部文法高亮/Lua" >Lua</a></li></ul><ul><li><a href="../../全部文法高亮/x86asm" >x86asm</a></li></ul><ul><li><a href="../../全部文法高亮/riscvasm" >riscvasm</a></li></ul><ul><li><a href="../../全部文法高亮/BNF" >BNF</a></li></ul><ul><li><a href="../../全部文法高亮/json" >json</a></li></ul><ul><li><a href="../../全部文法高亮/shell" >shell</a></li></ul><ul><li><a href="../../全部文法高亮/toml" >toml</a></li></ul><ul><li><a href="../../全部文法高亮/xml" >xml</a></li></ul><ul><li><a href="../../全部文法高亮/css" >css</a></li></ul></li></ul><ul><li><a href="../../开发文档/BNF" >开发文档</a><ul><li><a href="../../开发文档/BNF" >BNF</a></li></ul><ul><li><a href="../../开发文档/参考文档" >参考文档</a></li></ul></li></ul></div>
    <div class="zood"><a class="" href="https://github.com/luzhixing12345/zood" target="_blank">zood</a></div>
    <script type="text/javascript" src="../../../js/next_front.js"></script><script>addLink("../../全部文法高亮/C","../../全部文法高亮/x86asm","ab")</script><script type="text/javascript" src="../../../js/change_mode.js"></script><script>addChangeModeButton("../../../img/sun.png","../../../img/moon.png")</script><script type="text/javascript" src="../../../js/copy_code.js"></script><script>addCodeCopy("../../../img/before_copy.png","../../../img/after_copy.png")</script><script type="text/javascript" src="../../../js/navigator.js"></script><script type="text/javascript" src="../../../js/picture_preview.js"></script><script type="text/javascript" src="../../../js/global_js_configuration.js"></script>
</body>

</html>