<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        Document
    </title>
    <link rel='stylesheet' href=../../../css/index.css />
    <link rel='stylesheet' href=../../../css/x86asm.css /><link rel='stylesheet' href=../../../css/json.css /><link rel='stylesheet' href=../../../css/bnf.css /><link rel='stylesheet' href=../../../css/lua.css /><link rel='stylesheet' href=../../../css/dot.css /><link rel='stylesheet' href=../../../css/css.css /><link rel='stylesheet' href=../../../css/c.css /><link rel='stylesheet' href=../../../css/toml.css /><link rel='stylesheet' href=../../../css/riscvasm.css /><link rel='stylesheet' href=../../../css/shell.css /><link rel='stylesheet' href=../../../css/xml.css />
    <link rel="icon" href="https://raw.githubusercontent.com/learner-lu/picbed/master/logo.png">
</head>

<body class="light">
    <a href="https://github.com/luzhixing12345/syntaxlight.git" target="_blank" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    <div class="header-navigator"><ul><li><a href="#h1-0">lua</a><ul><li><a href="#h2-1">1.lua</a></li></ul><ul><li><a href="#h2-2">2.lua</a></li></ul><ul><li><a href="#h2-3">3.lua</a></li></ul><ul><li><a href="#h2-4">4.lua</a></li></ul><ul><li><a href="#h2-5">5.lua</a></li></ul><ul><li><a href="#h2-6">6.lua</a></li></ul><ul><li><a href="#h2-7">7.lua</a></li></ul><ul><li><a href="#h2-8">8.lua</a></li></ul><ul><li><a href="#h2-9">9.lua</a></li></ul><ul><li><a href="#h2-10">10.lua</a></li></ul><ul><li><a href="#h2-11">11.lua</a></li></ul><ul><li><a href="#h2-12">12.lua</a></li></ul><ul><li><a href="#h2-13">13.lua</a></li></ul><ul><li><a href="#h2-14">14.lua</a></li></ul></li></ul></div><div class='markdown-body'><h1 id="h1-0">lua</h1><h2 id="h2-1"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/1.lua" target="_blank">1.lua</a></h2><pre class="language-lua"><code><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">k0aux</span><span class="Identifier AttributeName Token SPACE"> </span><span class="AttributeName Attribute Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier AttributeType Attribute Token ID">const</span><span class="AttributeName Attribute Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Attribute Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Number Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">k0</span><span class="Identifier AttributeName Token SPACE"> </span><span class="AttributeName Attribute Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier AttributeType Attribute Token ID">const</span><span class="AttributeName Attribute Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Attribute Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">k0aux</span><span class="Identifier Token Variable LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">k1</span><span class="Identifier AttributeName Token SPACE"> </span><span class="AttributeName Attribute Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier AttributeType Attribute Token ID">const</span><span class="AttributeName Attribute Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Attribute Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Number Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">k3</span><span class="Identifier AttributeName Token SPACE"> </span><span class="AttributeName Attribute Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier AttributeType Attribute Token ID">const</span><span class="AttributeName Attribute Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Attribute Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Number Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">k6</span><span class="Identifier AttributeName Token SPACE"> </span><span class="AttributeName Attribute Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier AttributeType Attribute Token ID">const</span><span class="AttributeName Attribute Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Attribute Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">k3</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression BraceDepth-0 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">k3</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token SHL">&lt;&lt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">k0</span><span class="Expression BraceDepth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">kFF0</span><span class="Identifier AttributeName Token SPACE"> </span><span class="AttributeName Attribute Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier AttributeType Attribute Token ID">const</span><span class="AttributeName Attribute Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Attribute Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0xFF0</span><span class="Number Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">k3_78</span><span class="Identifier AttributeName Token SPACE"> </span><span class="AttributeName Attribute Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier AttributeType Attribute Token ID">const</span><span class="AttributeName Attribute Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Attribute Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">3.78</span></code></pre><h2 id="h2-2"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/2.lua" target="_blank">2.lua</a></h2><pre class="language-lua"><code><span class="Token COMMENT">-- 1. 变量和数据类型</span><span class="Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">numberVar</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">42</span><span class="Number Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">stringVar</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;Hello, Lua!&quot;</span><span class="Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">booleanVar</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">tableVar</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Number Field Token NUMBER">1</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">3</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName FunctionName Token ID">functionVar</span><span class="Identifier AttributeName FunctionName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MUL">*</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody COMMENT">-- 2. 条件语句</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">numberVar</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">50</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;Number is greater than 50&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Keyword Token ElseIfStatement ELSEIF">elseif</span><span class="Keyword Token ElseIfStatement SPACE"> </span><span class="Identifier Token Variable ID">numberVar</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">50</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token ElseIfStatement THEN">then</span><span class="Keyword Token ElseIfStatement LF">
</span><span class="Keyword Token ElseIfStatement SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;Number is equal to 50&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;Number is less than 50&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- 3. 循环语句</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">5</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;Iteration&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">counter</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Number Token LF">
</span><span class="Statement Keyword Token WHILE">while</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">counter</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression BraceDepth-1 Punctuator Token LANGLE_BRACE">&lt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">5</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">counter</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">counter</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token LF">
</span><span class="Number Expression Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&quot;Counter:&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">counter</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- 4. 函数定义</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionName FuncName Token ID">sayHello</span><span class="Statement BraceDepth-2 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">name</span><span class="Statement BraceDepth-2 Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&quot;Hello,&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">name</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody COMMENT">-- 5. 函数调用</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">sayHello</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&quot;Alice&quot;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- 6. 表(Table)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">person</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-2 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Identifier Field Token ID">name</span><span class="Identifier Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Token String STR">&quot;Bob&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">    </span><span class="Identifier Field Token ID">age</span><span class="Identifier Field Token SPACE"> </span><span class="Field Token ASSIGN">=</span><span class="Field Token SPACE"> </span><span class="Number Field Token NUMBER">30</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">    </span><span class="Identifier Field Token ID">isMale</span><span class="Identifier Field Token SPACE"> </span><span class="Field Token ASSIGN">=</span><span class="Field Token SPACE"> </span><span class="Keyword Field Token TRUE">true</span><span class="Keyword Field Token LF">
</span><span class="Expression TableConstructor Token BraceDepth-2 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">person</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">name</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="VarSuffix Token Argument COMMENT">-- Output: Bob</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- 7. 匿名函数</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName FunctionName Token ID">add</span><span class="Identifier AttributeName FunctionName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">b</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">add</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="VarSuffix Token Argument COMMENT">-- Output: 7</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- 8. 迭代器(Pairs和ipairs)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">fruits</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-2 LCURLY_BRACE">{</span><span class="Token String STR">&quot;apple&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token String STR">&quot;banana&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token String STR">&quot;orange&quot;</span><span class="Expression TableConstructor Token BraceDepth-2 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token ID">index</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">fruit</span><span class="Identifier Token SPACE"> </span><span class="Statement Keyword Token IN">in</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">ipairs</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">fruits</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&quot;Fruit&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">index</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;is&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">fruit</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- 9. 模块(Module)</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">myModule</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-2 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-2 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FuncName Token ID">myModule</span><span class="Statement FuncName Token DOT">.</span><span class="Identifier FunctionName FuncName Token ID">sayGoodbye</span><span class="Statement BraceDepth-2 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">name</span><span class="Statement BraceDepth-2 Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&quot;Goodbye,&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">name</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">myModule</span><span class="Identifier Token Variable LF">
</span></code></pre><h2 id="h2-3"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/3.lua" target="_blank">3.lua</a></h2><pre class="language-lua"><code><span class="Token COMMENT">-- 定义斐波那契数列函数</span><span class="Token LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionName FuncName Token ID">fibonacci</span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">n</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">fib</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Number Field Token NUMBER">0</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">1</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">        </span><span class="Identifier Token Variable ID">fib</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">fib</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">fib</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token LF">
</span><span class="VarSuffix Token SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">fib</span><span class="Identifier Token Variable LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody COMMENT">-- 打印前n个斐波那契数</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionName FuncName Token ID">print_fibonacci</span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">n</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">fib</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">fibonacci</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;前&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token CONCAT">..</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token CONCAT">..</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;个斐波那契数列:&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">        </span><span class="Identifier Token Variable ID">io</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">write</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">fib</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token CONCAT">..</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot; &quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- 换行</span><span class="VarSuffix Token Argument LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody COMMENT">-- 调用函数打印前10个斐波那契数</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">print_fibonacci</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span></code></pre><h2 id="h2-4"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/4.lua" target="_blank">4.lua</a></h2><pre class="language-lua"><code><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionName FuncName Token ID">factorial</span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">n</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token LE">&lt;=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">        </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Number Token LF">
</span><span class="Number Token SPACE">    </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">        </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MUL">*</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">factorial</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">result</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">factorial</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">5</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;Factorial of 5:&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">result</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Number Token LF">
</span><span class="Number Token LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionName FuncName Token ID">modifyGlobal</span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="Number Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionName FuncName Token ID">accessGlobal</span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;Global a:&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">modifyGlobal</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">accessGlobal</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">largeNumber</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Number Punctuator Token CARET">^</span><span class="Number Token NUMBER">100</span><span class="Number Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;Large number:&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">largeNumber</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">largeTable</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Number Punctuator Token CARET">^</span><span class="Number Token NUMBER">6</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">largeTable</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;Large table length:&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">largeTable</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">longString</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="Token LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Number Punctuator Token CARET">^</span><span class="Number Token NUMBER">5</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">longString</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">longString</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token CONCAT">..</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">tostring</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;Length of longString:&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">longString</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">nestedTable</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Identifier Field Token ID">a</span><span class="Identifier Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Number Field Token NUMBER">1</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">    </span><span class="Identifier Field Token ID">b</span><span class="Identifier Field Token SPACE"> </span><span class="Field Token ASSIGN">=</span><span class="Field Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">        </span><span class="Identifier Field Token ID">c</span><span class="Identifier Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Number Field Token NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">        </span><span class="Identifier Field Token ID">d</span><span class="Identifier Field Token SPACE"> </span><span class="Field Token ASSIGN">=</span><span class="Field Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-2 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">            </span><span class="Identifier Field Token ID">e</span><span class="Identifier Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Number Field Token NUMBER">3</span><span class="Number Field Token LF">
</span><span class="Number Field Token SPACE">        </span><span class="Expression TableConstructor Token BraceDepth-2 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;Value of nestedTable.b.d.e:&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">nestedTable</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">b</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">d</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">e</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionName FuncName Token ID">multipleReturns</span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Number Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">b</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">c</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">multipleReturns</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;Values:&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">mixedTable</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Token String STR">&quot;first&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">    </span><span class="Token String STR">&quot;second&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">    </span><span class="Identifier Field Token ID">key1</span><span class="Identifier Field Token SPACE"> </span><span class="Field Token ASSIGN">=</span><span class="Field Token SPACE"> </span><span class="Token String STR">&quot;value1&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">    </span><span class="Identifier Field Token ID">key2</span><span class="Identifier Field Token SPACE"> </span><span class="Field Token ASSIGN">=</span><span class="Field Token SPACE"> </span><span class="Token String STR">&quot;value2&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">    </span><span class="Identifier Field Token ID">key3</span><span class="Identifier Field Token SPACE"> </span><span class="Field Token ASSIGN">=</span><span class="Field Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">        </span><span class="Identifier Field Token ID">key1</span><span class="Identifier Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">        </span><span class="Keyword Token FunctionBody END">end</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">        </span><span class="Identifier Field Token ID">key2</span><span class="Identifier Field Token SPACE"> </span><span class="Field Token ASSIGN">=</span><span class="Field Token SPACE"> </span><span class="Number Field Token NUMBER">1</span><span class="Number Field Token LF">
</span><span class="Number Field Token SPACE">    </span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;Value at index 2:&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">mixedTable</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;Value of key &#x27;key1&#x27;:&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">mixedTable</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">key1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">mixedTable</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">key3</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">key1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">mixedTable</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">key3</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">key2</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">mixedTable</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">key3</span><span class="VarSuffix Token COLON">:</span><span class="Identifier VarSuffix Token FunctionCall ID">asd</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">value</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">42</span><span class="Number Token LF">
</span><span class="Number Token LF">
</span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">value</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;Value is truthy&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;Value is falsy&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span></code></pre><h2 id="h2-5"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/5.lua" target="_blank">5.lua</a></h2><pre class="language-lua"><code><span class="Token LF">
</span><span class="Token COMMENT">-- $Id: testes/all.lua $</span><span class="Token LF">
</span><span class="Token COMMENT">-- See Copyright Notice at the end of this file</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">version</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;Lua 5.4&quot;</span><span class="Token LF">
</span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">_VERSION</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">version</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">io</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">stderr</span><span class="VarSuffix Token COLON">:</span><span class="Identifier VarSuffix Token FunctionCall ID">write</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;This test suite is for &quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">version</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">                  </span><span class="Token String STR">&quot;, not for &quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">_VERSION</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;</span><span class="String Token Control STR">\n</span><span class="Token String STR">Exiting tests&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier Token Variable ID">_G</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">ARG</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">arg</span><span class="Identifier Token Variable SPACE">   </span><span class="Identifier Token Variable COMMENT">-- save arg for other tests</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable COMMENT">-- next variables control the execution of some tests</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable COMMENT">-- true means no test (so an undefined variable does not skip a test)</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable COMMENT">-- defaults are for Linux; test everything.</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable COMMENT">-- Make true to avoid long or memory consuming tests</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable ID">_soft</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">rawget</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">_G</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;_soft&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Keyword Token Expression OR">or</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token Expression FALSE">false</span><span class="Keyword Token Expression LF">
</span><span class="Keyword Token Expression COMMENT">-- Make true to avoid non-portable tests</span><span class="Keyword Token Expression LF">
</span><span class="Identifier Token Variable ID">_port</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">rawget</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">_G</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;_port&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Keyword Token Expression OR">or</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token Expression FALSE">false</span><span class="Keyword Token Expression LF">
</span><span class="Keyword Token Expression COMMENT">-- Make true to avoid messages about tests not performed</span><span class="Keyword Token Expression LF">
</span><span class="Identifier Token Variable ID">_nomsg</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">rawget</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">_G</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;_nomsg&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Keyword Token Expression OR">or</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token Expression FALSE">false</span><span class="Keyword Token Expression LF">
</span><span class="Keyword Token Expression LF">
</span><span class="Keyword Token Expression LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">usertests</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">rawget</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">_G</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;_U&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">usertests</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- tests for sissies ;)  Avoid problems</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">_soft</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">_port</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">_nomsg</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Keyword Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- tests should require debug when needed</span><span class="Statement Keyword Token LF">
</span><span class="Identifier Token Variable ID">debug</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token LF">
</span><span class="Keyword Token LF">
</span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">usertests</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token SPACE">    </span><span class="Keyword Token COMMENT">-- no &quot;internal&quot; tests for user tests</span><span class="Keyword Token LF">
</span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">rawget</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">_G</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;T&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- avoid problems with &#x27;strict&#x27; module</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">--[=[
  example of a long [comment],
  [[spanning several [lines]]]
]=]</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;</span><span class="String Token Control STR">\n</span><span class="String Token Control STR">\t</span><span class="Token String STR">Starting Tests&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- set random seed</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">random_x</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">random_y</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">randomseed</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">format</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;random seeds: </span><span class="Format Token String STR">%d</span><span class="Token String STR">, </span><span class="Format Token String STR">%d</span><span class="Token String STR">&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">random_x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">random_y</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;current path:</span><span class="String Token Control STR">\n</span><span class="Token String STR">****&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token CONCAT">..</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">path</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token CONCAT">..</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;****</span><span class="String Token Control STR">\n</span><span class="Token String STR">&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">initclock</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">os</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">clock</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">lastclock</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">initclock</span><span class="Identifier Token Variable LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">walltime</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">os</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">time</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">collectgarbage</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">collectgarbage</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- (</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- track messages for tests not performed</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">msgs</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionName FuncName Token ID">Message</span><span class="Identifier FunctionName FuncName Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">m</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">_nomsg</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">m</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">msgs</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">msgs</span><span class="Expression Punctuator Token PLUS">+</span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">sub</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">m</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">3</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">os</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">setlocale</span><span class="Token String STR">&quot;C&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">T</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">print</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">format</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">write</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">assert</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">type</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">unpack</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">floor</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">      </span><span class="Identifier Token Variable ID">T</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">print</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">format</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">io</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">write</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">assert</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">type</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">table</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">unpack</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">floor</span><span class="Identifier VarSuffix TableKey Token LF">
</span><span class="Identifier VarSuffix TableKey Token COMMENT">-- use K for 1000 and M for 1000000 (not 2^10 -- 2^20)</span><span class="Identifier VarSuffix TableKey Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">F</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">m</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">round</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">m</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier Token Variable ID">m</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0.04999</span><span class="Number Expression Token LF">
</span><span class="Number Expression Token SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">format</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;%.1f&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">      </span><span class="VarSuffix Token Argument COMMENT">-- keep one decimal digit</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1000</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">m</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token DIV">/</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1000</span><span class="Number Expression Token LF">
</span><span class="Number Expression Token SPACE">    </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression BraceDepth-1 Punctuator Token LANGLE_BRACE">&lt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1000</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">round</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">m</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="Expression Punctuator Token CONCAT">..</span><span class="Token String STR">&quot;K&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">      </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">round</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">m</span><span class="Expression Punctuator Token DIV">/</span><span class="Number Expression Token NUMBER">1000</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="Expression Punctuator Token CONCAT">..</span><span class="Token String STR">&quot;M&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">Cstacklevel</span><span class="Identifier AttributeName Token LF">
</span><span class="Identifier AttributeName Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">showmem</span><span class="Identifier AttributeName Token LF">
</span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">max</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Identifier FunctionName Token Variable ID">showmem</span><span class="Identifier FunctionName Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">m</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&quot;count&quot;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token MUL">*</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1024</span><span class="Number Expression Token LF">
</span><span class="Number Expression Token SPACE">    </span><span class="Identifier Token Variable ID">max</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">m</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">max</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression OR">or</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">max</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">format</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;    ---- total memory: </span><span class="Format Token String STR">%s</span><span class="Token String STR">, max memory: </span><span class="Format Token String STR">%s</span><span class="Token String STR"> ----</span><span class="String Token Control STR">\n</span><span class="Token String STR">&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">          </span><span class="Identifier FunctionCall Token Variable ID">F</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">m</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">F</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">max</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionName Token Variable ID">Cstacklevel</span><span class="Identifier FunctionName Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Number Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody SPACE">   </span><span class="Keyword Token FunctionBody COMMENT">-- no info about stack level</span><span class="Keyword Token FunctionBody LF">
</span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">  </span><span class="Identifier FunctionName Token Variable ID">showmem</span><span class="Identifier FunctionName Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">checkmemory</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">total</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">numblocks</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">maxmem</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">totalmem</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">count</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&quot;count&quot;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">format</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">      </span><span class="Token String STR">&quot;</span><span class="String Token Control STR">\n</span><span class="Token String STR">    ---- total memory: </span><span class="Format Token String STR">%s</span><span class="Token String STR"> (%.0fK), max use: </span><span class="Format Token String STR">%s</span><span class="Token String STR">,  blocks: </span><span class="Format Token String STR">%d</span><span class="String Token Control STR">\n</span><span class="Token String STR">&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">      </span><span class="Identifier FunctionCall Token Variable ID">F</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">total</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">count</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">F</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">maxmem</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">numblocks</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">format</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;</span><span class="String Token Control STR">\t</span><span class="Token String STR">(strings:  </span><span class="Format Token String STR">%d</span><span class="Token String STR">, tables: </span><span class="Format Token String STR">%d</span><span class="Token String STR">, functions: </span><span class="Format Token String STR">%d</span><span class="Token String STR">, &quot;</span><span class="Expression Punctuator Token CONCAT">..</span><span class="Expression Punctuator Token LF">
</span><span class="Expression Punctuator Token SPACE">                 </span><span class="Token String STR">&quot;</span><span class="String Token Control STR">\n</span><span class="String Token Control STR">\t</span><span class="Token String STR">udata: </span><span class="Format Token String STR">%d</span><span class="Token String STR">, threads: </span><span class="Format Token String STR">%d</span><span class="Token String STR">)&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">                 </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">totalmem</span><span class="Token String STR">&quot;string&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">totalmem</span><span class="Token String STR">&quot;table&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">totalmem</span><span class="Token String STR">&quot;function&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">                 </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">totalmem</span><span class="Token String STR">&quot;userdata&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">totalmem</span><span class="Token String STR">&quot;thread&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionName Token Variable ID">Cstacklevel</span><span class="Identifier FunctionName Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">_</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">_</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">ncalls</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">stacklevel</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">ncalls</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable COMMENT">-- number of C calls</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">Cstack</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">Cstacklevel</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">--</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- redefine dofile to run files through dump/undump</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">--</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">report</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement BraceDepth-2 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">n</span><span class="Statement BraceDepth-2 Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&quot;</span><span class="String Token Control STR">\n</span><span class="Token String STR">***** FILE &#x27;&quot;</span><span class="Expression Punctuator Token CONCAT">..</span><span class="Identifier Token Variable ID">n</span><span class="Expression Punctuator Token CONCAT">..</span><span class="Token String STR">&quot;&#x27;*****&quot;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">olddofile</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">dofile</span><span class="Identifier Token Variable LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName FunctionName Token ID">dofile</span><span class="Identifier AttributeName FunctionName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="Identifier Token ID">n</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">strip</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">showmem</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">c</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">os</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">clock</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">format</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;time: </span><span class="Format Token String STR">%g</span><span class="Token String STR"> (+</span><span class="Format Token String STR">%g</span><span class="Token String STR">)&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">initclock</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">lastclock</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">lastclock</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">report</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">f</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">loadfile</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">b</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">dump</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">strip</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&#x27;main.lua&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- trace GC cycles</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">require</span><span class="Token String STR">&quot;tracegc&quot;</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">start</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">report</span><span class="Token String STR">&quot;gc.lua&quot;</span><span class="Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">f</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">loadfile</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;gc.lua&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&#x27;db.lua&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;calls.lua&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">deep</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">deep</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">_G</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">deep</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">olddofile</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&#x27;strings.lua&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">olddofile</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&#x27;literals.lua&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&#x27;tpack.lua&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;attrib.lua&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">27</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&#x27;gengc.lua&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;locals.lua&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">5</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&#x27;constructs.lua&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&#x27;code.lua&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">_soft</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">report</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&#x27;big.lua&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">f</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">coroutine</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">wrap</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">loadfile</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;big.lua&#x27;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;b&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;a&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&#x27;cstack.lua&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&#x27;nextvar.lua&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&#x27;pm.lua&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&#x27;utf8.lua&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&#x27;api.lua&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;events.lua&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">12</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&#x27;vararg.lua&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&#x27;closure.lua&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&#x27;coroutine.lua&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&#x27;goto.lua&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&#x27;errors.lua&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&#x27;math.lua&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&#x27;sort.lua&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&#x27;bitwise.lua&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;verybig.lua&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">dofile</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&#x27;files.lua&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">msgs</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token BraceDepth-2 RANGLE_BRACE">&gt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">m</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">table</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">concat</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">msgs</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;</span><span class="String Token Control STR">\n</span><span class="Token String STR">  &quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">warn</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;#tests not performed:</span><span class="String Token Control STR">\n</span><span class="Token String STR">  &quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;</span><span class="String Token Control STR">\n</span><span class="Token String STR">&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;(there should be two warnings now)&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">warn</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;@on&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">warn</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;#This is &quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;an expected&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot; warning&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">warn</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;@off&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">warn</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;******** THIS WARNING SHOULD NOT APPEAR **********&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">warn</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;******** THIS WARNING ALSO SHOULD NOT APPEAR **********&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">warn</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;@on&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">warn</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;#This is&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot; another one&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- no test module should define &#x27;debug&#x27;</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">debug</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Token String STR">&quot;debug&quot;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">format</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;</span><span class="Format Token String STR">%d</span><span class="Token String STR">-bit integers, </span><span class="Format Token String STR">%d</span><span class="Token String STR">-bit floats&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">        </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">packsize</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&quot;j&quot;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token MUL">*</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">8</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">packsize</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&quot;n&quot;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token MUL">*</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">8</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">sethook</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;string&#x27;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;cr&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- to survive outside block</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">_G</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">showmem</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">showmem</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">Cstack</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">Cstacklevel</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token String STR">&quot;should be at the same C-stack level it was when started the tests&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">--)</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">_G</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">showmem</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">print</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">format</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">clock</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">time</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">difftime</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token LF">
</span><span class="AttributeName Token SPACE">      </span><span class="Identifier AttributeName Token ID">assert</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">open</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">warn</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">      </span><span class="Identifier Token Variable ID">_G</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">showmem</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">format</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">os</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">clock</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">os</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">time</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">os</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">difftime</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">      </span><span class="Identifier Token Variable ID">assert</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">io</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">open</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">warn</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable COMMENT">-- file with time of last performed test</span><span class="Identifier Token Variable LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">fname</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Token String STR">&quot;time-debug.txt&quot;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression OR">or</span><span class="Keyword Token Expression SPACE"> </span><span class="Token String STR">&quot;time.txt&quot;</span><span class="Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">lasttime</span><span class="Identifier AttributeName Token LF">
</span><span class="Identifier AttributeName Token LF">
</span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">usertests</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- open file with time of last performed test</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">f</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">io</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">open</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">fname</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">lasttime</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">tonumber</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="VarSuffix Token COLON">:</span><span class="Identifier VarSuffix Token FunctionCall ID">read</span><span class="Token String STR">&#x27;a&#x27;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">f</span><span class="VarSuffix Token COLON">:</span><span class="Identifier VarSuffix Token FunctionCall ID">close</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token SPACE">   </span><span class="ElseStatement Keyword Token COMMENT">-- no such file; assume it is recording time for first time</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">lasttime</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- erase (almost) all globals</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;cleaning all!!!!&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token ID">n</span><span class="Identifier Token SPACE"> </span><span class="Statement Keyword Token IN">in</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pairs</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">_G</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Expression BraceDepth-0 Token Variable LPAREN">(</span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">___Glob</span><span class="Identifier Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Number Field Token NUMBER">1</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Identifier Field Token ID">tostring</span><span class="Identifier Field Token SPACE"> </span><span class="Field Token ASSIGN">=</span><span class="Field Token SPACE"> </span><span class="Number Field Token NUMBER">1</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Expression BraceDepth-0 Token Variable RPAREN">)</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">n</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">_G</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">n</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">undef</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Identifier FunctionCall Token Variable ID">showmem</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">clocktime</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">clock</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">initclock</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable ID">walltime</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">difftime</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">time</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">walltime</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">format</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;</span><span class="String Token Control STR">\n</span><span class="String Token Control STR">\n</span><span class="Token String STR">total time: %.2fs (wall time: </span><span class="Format Token String STR">%gs</span><span class="Token String STR">)</span><span class="String Token Control STR">\n</span><span class="Token String STR">&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">clocktime</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">walltime</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">usertests</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">lasttime</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">lasttime</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression OR">or</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">clocktime</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable COMMENT">-- if no last time, ignore difference</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable COMMENT">-- check whether current test time differs more than 5% from last time</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">diff</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression BraceDepth-0 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">clocktime</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">lasttime</span><span class="Expression BraceDepth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token DIV">/</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">lasttime</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">tolerance</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0.05</span><span class="Number Token SPACE">    </span><span class="Number Token COMMENT">-- 5%</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Expression BraceDepth-0 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">diff</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token GE">&gt;=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">tolerance</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression OR">or</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">diff</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token LE">&lt;=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Identifier Token Variable ID">tolerance</span><span class="Expression BraceDepth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">warn</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">format</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;#time difference from previous test: %+.1f%%&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">                  </span><span class="Identifier Token Variable ID">diff</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MUL">*</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">100</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">open</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">fname</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;w&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token COLON">:</span><span class="Identifier VarSuffix Token FunctionCall ID">write</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">clocktime</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token COLON">:</span><span class="Identifier VarSuffix Token FunctionCall ID">close</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;final OK !!!&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">--[[
*****************************************************************************
* Copyright (C) 1994-2016 Lua.org, PUC-Rio.
*
* Permission is hereby granted, free of charge, to any person obtaining
* a copy of this software and associated documentation files (the
* &quot;Software&quot;), to deal in the Software without restriction, including
* without limitation the rights to use, copy, modify, merge, publish,
* distribute, sublicense, and/or sell copies of the Software, and to
* permit persons to whom the Software is furnished to do so, subject to
* the following conditions:
*
* The above copyright notice and this permission notice shall be
* included in all copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,
* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
* MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
* IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY
* CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
* TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
* SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
*****************************************************************************
]]</span></code></pre><h2 id="h2-6"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/6.lua" target="_blank">6.lua</a></h2><pre class="language-lua"><code><span class="Token COMMENT">-- $Id: testes/api.lua $</span><span class="Token LF">
</span><span class="Token COMMENT">-- See Copyright Notice in file all.lua</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Expression Punctuator Token EQ">==</span><span class="Keyword Token Expression NIL">nil</span><span class="Keyword Token Expression SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="BraceDepth-0 Token Variable LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">Message</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Keyword Token FunctionCall Expression OR">or</span><span class="Keyword Token FunctionCall Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="BraceDepth-0 Token Variable RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;</span><span class="String Token Control STR">\n</span><span class="Token String STR"> &gt;&gt;&gt; testC not active: skipping API tests &lt;&lt;&lt;</span><span class="String Token Control STR">\n</span><span class="Token String STR">&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token LF">
</span><span class="ReturnStatment Keyword Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">debug</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Token String STR">&quot;debug&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">pack</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">table</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">pack</span><span class="Identifier VarSuffix TableKey Token LF">
</span><span class="Identifier VarSuffix TableKey Token SPACE">  </span><span class="Identifier VarSuffix TableKey Token COMMENT">-- standard error message for memory errors</span><span class="Identifier VarSuffix TableKey Token LF">
</span><span class="Identifier VarSuffix TableKey Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">MEMERRMSG</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;not enough memory&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">tcheck</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">t1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">t2</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t1</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">n</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">t2</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">n</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Keyword Token Expression OR">or</span><span class="Keyword Token Expression SPACE"> </span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">t2</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t1</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">n</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t1</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">t2</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">checkerr</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">f</span><span class="FunctionBody Token ParameterList COMMA">,</span><span class="FunctionBody Token ParameterList SPACE"> </span><span class="Punctuator Token ParameterList VARARGS">...</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">stat</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">err</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token VARARGS">...</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">stat</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">find</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">err</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">msg</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;testing C API&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;pushvalue R; return 1&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">getregistry</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- absindex</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;settop 10; absindex -1; return 1&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;settop 5; absindex -5; return 1&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;settop 10; absindex 1; return 1&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;settop 10; absindex R; return 1&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression BraceDepth-1 Punctuator Token LANGLE_BRACE">&lt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- testing alignment</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">d2s</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">12458954321123.0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">pack</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;d&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">12458954321123.0</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">s2d</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">12458954321123.0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">b</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">c</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;pushnum 1; pushnum 2; pushnum 3; return 2&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">f</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">makeCfunc</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;pushnum 1; pushnum 2; pushnum 3; return 2&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- test that all trues are equal</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;pushbool 1; pushbool 2; pushbool 0; return 3&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression TRUE">true</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression FALSE">false</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="Token String STR">&quot;pushbool 0; pushbool 10; pushnil;\
                        tobool -3; tobool -3; tobool -3; return 3&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Expression Punctuator Token EQ">==</span><span class="Keyword Token Expression FALSE">false</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression Punctuator Token EQ">==</span><span class="Keyword Token Expression TRUE">true</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Expression Punctuator Token EQ">==</span><span class="Keyword Token Expression FALSE">false</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;gettop; return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">30</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">40</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">40</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">5</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">t</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;settop 5; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">n</span><span class="FieldList Field Token ASSIGN">=</span><span class="Number Field Token NUMBER">4</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">3</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;settop 0; settop 15; return 10&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">23</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">n</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">10</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;remove -2; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">n</span><span class="FieldList Field Token ASSIGN">=</span><span class="Number Field Token NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">4</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;insert -1; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">n</span><span class="FieldList Field Token ASSIGN">=</span><span class="Number Field Token NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">3</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;insert 3; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">5</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">n</span><span class="FieldList Field Token ASSIGN">=</span><span class="Number Field Token NUMBER">4</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">5</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">4</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;replace 2; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">5</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">n</span><span class="FieldList Field Token ASSIGN">=</span><span class="Number Field Token NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">5</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">4</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;replace -2; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">5</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">n</span><span class="FieldList Field Token ASSIGN">=</span><span class="Number Field Token NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">5</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;remove 3; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">5</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">n</span><span class="FieldList Field Token ASSIGN">=</span><span class="Number Field Token NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">4</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">5</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;copy 3 4; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">5</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">n</span><span class="FieldList Field Token ASSIGN">=</span><span class="Number Field Token NUMBER">4</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">5</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;copy -3 -1; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">5</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">n</span><span class="FieldList Field Token ASSIGN">=</span><span class="Number Field Token NUMBER">4</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">4</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">3</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- testing &#x27;rotate&#x27;</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">t</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Number Field Token NUMBER">10</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">20</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">30</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">40</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">50</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">60</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">6</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">6</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">s</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">format</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;rotate 2 </span><span class="Format Token String STR">%d</span><span class="Token String STR">; return 7&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">      </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">t1</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">s</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">30</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">40</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">50</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">60</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">      </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">      </span><span class="Identifier Token Variable ID">table</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">insert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">table</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">remove</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;rotate -2 1; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">30</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">40</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Number Field Token NUMBER">10</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">20</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">40</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">30</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;rotate -2 -1; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">30</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">40</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Number Field Token NUMBER">10</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">20</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">40</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">30</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="VarSuffix Token Argument COMMENT">-- some corner cases</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;rotate -1 0; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">30</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">40</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Number Field Token NUMBER">10</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">20</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">30</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">40</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;rotate -1 1; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">30</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">40</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Number Field Token NUMBER">10</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">20</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">30</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">40</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;rotate 5 -1; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">30</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">40</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Number Field Token NUMBER">10</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">20</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">30</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">40</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- testing warnings</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">[[
    warningC &quot;#This shold be a&quot;
    warningC &quot; single &quot;
    warning &quot;warning&quot;
    warningC &quot;#This should be &quot;
    warning &quot;another one&quot;
  ]]</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- testing message handlers</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">f</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">makeCfunc</span><span class="Token String STR">[[
      getglobal error
      pushstring bola
      pcall 1 1 1   # call &#x27;error&#x27; with given handler
      pushstatus
      return 2     # return error message and status
    ]]</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">msg</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">st</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">upper</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">   </span><span class="VarSuffix Token Argument COMMENT">-- function handler</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">st</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;ERRRUN&quot;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">msg</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;BOLA&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">msg</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">st</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">len</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">     </span><span class="VarSuffix Token Argument COMMENT">-- function handler</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">st</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;ERRRUN&quot;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">msg</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">4</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;insert 3; pushvalue 3; remove 3; pushvalue 2; remove 2; \
                    insert 2; pushvalue 1; remove 1; insert 1; \
        insert -2; pushvalue -2; remove -3; return *&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">        </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">5</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">40</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">90</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">n</span><span class="FieldList Field Token ASSIGN">=</span><span class="Number Field Token NUMBER">7</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">4</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">5</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">10</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">40</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">90</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;concat 5; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;alo&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;joao&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">12</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">n</span><span class="FieldList Field Token ASSIGN">=</span><span class="Number Field Token NUMBER">1</span><span class="Punctuator Token COMMA">,</span><span class="Token String STR">&quot;alo23joao12&quot;</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- testing MULTRET</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;call 2,-1; return *&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">       </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Number Token NUMBER">3</span><span class="Token COMMA">,</span><span class="Number Token NUMBER">4</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;alo&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;joao&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">n</span><span class="FieldList Field Token ASSIGN">=</span><span class="Number Field Token NUMBER">6</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">1</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">4</span><span class="Punctuator Token COMMA">,</span><span class="Token String STR">&quot;alo&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token String STR">&quot;joao&quot;</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- test returning more results than fit in the caller stack</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Number Token NUMBER">1000</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Keyword Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">999</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Number Token LF">
</span><span class="Number Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">b</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">[[pcall 1 -1 0; pop 1; tostring -1; return 1]]</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">                      </span><span class="Identifier Token Variable ID">table</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">unpack</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;10&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- testing globals</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">_G</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">AA</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">14</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">BB</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;a31&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-2 LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="Token String STR">[[
    getglobal AA;
    getglobal BB;
    getglobal BB;
    setglobal AA;
    return *
  ]]</span><span class="Expression TableConstructor Token BraceDepth-2 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">14</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">3</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;a31&quot;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">4</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">AA</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;a31&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">_G</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token ID">AA</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token ID">BB</span><span class="Identifier VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Keyword Token COMMENT">-- testing arith</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;pushnum 10; pushnum 20; arith /; return 1&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0.5</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;pushnum 10; pushnum 20; arith -; return 1&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;pushnum 10; pushnum -20; arith *; return 1&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">200</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;pushnum 10; pushnum 3; arith ^; return 1&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1000</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;pushnum 10; pushstring 20; arith /; return 1&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0.5</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;pushstring 10; pushnum 20; arith -; return 1&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;pushstring 10; pushstring -20; arith *; return 1&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">200</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;pushstring 10; pushstring 3; arith ^; return 1&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1000</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;arith /; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10.0</span><span class="Number Punctuator Token DIV">/</span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;pushnum 10; pushint 3; arith </span><span class="String Token Control STR">\\</span><span class="Token String STR">; return 1&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3.0</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">type</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;float&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;pushint 10; pushint 3; arith </span><span class="String Token Control STR">\\</span><span class="Token String STR">; return 1&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">type</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;integer&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;pushint 10; pushint 3; arith +; return 1&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">13</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">type</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;integer&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;pushnum 10; pushint 3; arith +; return 1&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">13</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">type</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;float&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">[[pushnum 1;
                    pushstring 10; arith _;
                    pushstring 5; return 3]]</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">10</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;5&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">mt</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">        </span><span class="Identifier Field Token ID">__add</span><span class="Identifier Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Expression TableConstructor Token BraceDepth-2 LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Expression TableConstructor Token BraceDepth-2 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">mt</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">        </span><span class="Identifier Field Token ID">__mod</span><span class="Identifier Field Token SPACE"> </span><span class="Field Token ASSIGN">=</span><span class="Field Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Expression TableConstructor Token BraceDepth-2 LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token MOD">%</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Expression TableConstructor Token BraceDepth-2 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">mt</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">        </span><span class="Identifier Field Token ID">__unm</span><span class="Identifier Field Token SPACE"> </span><span class="Field Token ASSIGN">=</span><span class="Field Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Expression TableConstructor Token BraceDepth-2 LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Expression Punctuator Token MUL">*</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="Expression TableConstructor Token BraceDepth-2 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">mt</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Number Field Token NUMBER">4</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">mt</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">          </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Number Field Token NUMBER">8</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">mt</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">          </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">3</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">mt</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">x</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">y</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">z</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;arith +; return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">12</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">z</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;arith %; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">4</span><span class="Number Punctuator Token MOD">%</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">3</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;arith _; arith +; arith %; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token LF">
</span><span class="Expression Punctuator Token SPACE">                 </span><span class="Number Expression Token NUMBER">8</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token MOD">%</span><span class="Number Punctuator Token SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Number Token Variable NUMBER">4</span><span class="Number Token Variable SPACE"> </span><span class="Number Punctuator Token PLUS">+</span><span class="Number Punctuator Token SPACE"> </span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">3</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Expression Punctuator Token MUL">*</span><span class="Number Expression Token NUMBER">2</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- errors in arithmetic</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkerr</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;divide by zero&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">testC</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;arith </span><span class="String Token Control STR">\\</span><span class="Token String STR">&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkerr</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;%</span><span class="Format Token String STR">%0</span><span class="Token String STR">&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">testC</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;arith %&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- testing lessthan and lessequal</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;compare LT 2 5, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;compare LE 2 5, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;compare LT 3 4, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;compare LE 3 4, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;compare LT 5 2, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;compare LT 2 -3, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;4&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;3&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;2&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;compare LT -3 2, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;3&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;4&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;2&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- non-valid indices produce false</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;compare LT 1 4, return 1&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;compare LE 9 1, return 1&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;compare EQ 9 9, return 1&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">b</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Identifier Field Token ID">__lt</span><span class="Identifier Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression BraceDepth-1 Punctuator Token LANGLE_BRACE">&lt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Expression TableConstructor Token BraceDepth-2 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a1</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">a3</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">a4</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Number Field Token NUMBER">1</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">                   </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Number Field Token NUMBER">3</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">                   </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Number Field Token NUMBER">4</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;compare LT 2 5, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;compare LE 2 5, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;compare LT 5 -6, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;compare LT 5 -6, return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">20</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression FALSE">false</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;compare LE 5 -6, return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">20</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression FALSE">false</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;compare LE 5 -6, return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">20</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression TRUE">true</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- testing lessthan and lessequal with metamethods</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">mt</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Identifier Field Token ID">__lt</span><span class="Identifier Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression BraceDepth-1 Punctuator Token LANGLE_BRACE">&lt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">                </span><span class="Identifier Field Token ID">__le</span><span class="Identifier Field Token SPACE"> </span><span class="Field Token ASSIGN">=</span><span class="Field Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token LE">&lt;=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">                </span><span class="Identifier Field Token ID">__eq</span><span class="Identifier Field Token SPACE"> </span><span class="Field Token ASSIGN">=</span><span class="Field Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Expression TableConstructor Token BraceDepth-2 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">O</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">      </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">x</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">mt</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">b</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;compare LT 2 3; pushint 10; return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">O</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">O</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression TRUE">true</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">b</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;compare LE 2 3; pushint 10; return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">O</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">3</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">O</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression FALSE">false</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">b</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;compare EQ 2 3; pushint 10; return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">O</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">3</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">O</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">3</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression TRUE">true</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- testing length</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">t</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">x</span><span class="Identifier Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Number Field Token NUMBER">20</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">__len</span><span class="Identifier Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="Identifier Token ID">t</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">x</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">[[
     len 2;
     Llen 2;
     objsize 2;
     return 3
  ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">20</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">20</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">x</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;234&quot;</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">[[
     len 2;
     Llen 2;
     objsize 2;
     return 3
  ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;234&quot;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">234</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">x</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">[[
     len 2;
     objsize 2;
     return 2
  ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- testing __concat</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">x</span><span class="FieldList Field Token ASSIGN">=</span><span class="Token String STR">&quot;u&quot;</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">__concat</span><span class="Identifier Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">x</span><span class="Expression Punctuator Token CONCAT">..</span><span class="Token String STR">&#x27;.&#x27;</span><span class="Expression Punctuator Token CONCAT">..</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">x</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">[[
    pushnum 5
    pushvalue 2;
    pushvalue 2;
    concat 2;
    pushvalue -2;
    return 2;
  ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Expression Punctuator Token CONCAT">..</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">5</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- concat with 0 elements</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;concat 0; return 1&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- concat with 1 element</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;concat 1; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;xuxu&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;xuxu&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- testing lua_is</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">B</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token OR">or</span><span class="Number Keyword Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Number Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">count</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">n</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression OR">or</span><span class="Keyword Token Expression SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="Number Expression Token LF">
</span><span class="Number Expression Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">prog</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">[[
      isnumber </span><span class="Format Token String STR">%d</span><span class="Token String STR">;
      isstring </span><span class="Format Token String STR">%d</span><span class="Token String STR">;
      isfunction </span><span class="Format Token String STR">%d</span><span class="Token String STR">;
      iscfunction </span><span class="Format Token String STR">%d</span><span class="Token String STR">;
      istable </span><span class="Format Token String STR">%d</span><span class="Token String STR">;
      isuserdata </span><span class="Format Token String STR">%d</span><span class="Token String STR">;
      isnil </span><span class="Format Token String STR">%d</span><span class="Token String STR">;
      isnull </span><span class="Format Token String STR">%d</span><span class="Token String STR">;
      return 8
    ]]</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">format</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">b</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">c</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">d</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">e</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">f</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">g</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">h</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">B</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Expression Punctuator Token PLUS">+</span><span class="Identifier FunctionCall Token Variable ID">B</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Expression Punctuator Token PLUS">+</span><span class="Identifier FunctionCall Token Variable ID">B</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Expression Punctuator Token PLUS">+</span><span class="Identifier FunctionCall Token Variable ID">B</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">d</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Expression Punctuator Token PLUS">+</span><span class="Identifier FunctionCall Token Variable ID">B</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">e</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Expression Punctuator Token PLUS">+</span><span class="Identifier FunctionCall Token Variable ID">B</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Expression Punctuator Token PLUS">+</span><span class="Identifier FunctionCall Token Variable ID">B</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">g</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression BraceDepth-0 Token Variable LPAREN">(</span><span class="Number Token Variable NUMBER">100</span><span class="Number Punctuator Token MUL">*</span><span class="Identifier FunctionCall Token Variable ID">B</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">h</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Expression BraceDepth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">count</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">3</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">count</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;alo&#x27;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">count</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;32&#x27;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">count</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Expression TableConstructor Token BraceDepth-2 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-2 RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">count</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">print</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">count</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">count</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Keyword Token NIL">nil</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">count</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">io</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">stdin</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">count</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">15</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">100</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- testing lua_to...</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">to</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">s</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">n</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression OR">or</span><span class="Keyword Token Expression SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="Number Expression Token LF">
</span><span class="Number Expression Token SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">format</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;</span><span class="Format Token String STR">%s</span><span class="Token String STR"> </span><span class="Format Token String STR">%d</span><span class="Token String STR">; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">s</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">null</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">pushuserdata</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">hfunc</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">gmatch</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">    </span><span class="VarSuffix Token Argument COMMENT">-- a &quot;heavy C function&quot; (with upvalues)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">getupvalue</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">hfunc</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;tostring&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-2 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-2 RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;tostring&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;alo&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;alo&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;tostring&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">12</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;12&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;tostring&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">12</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;objsize&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-2 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-2 RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;objsize&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-2 LCURLY_BRACE">{</span><span class="Number Field Token NUMBER">1</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">3</span><span class="Expression TableConstructor Token BraceDepth-2 RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;objsize&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;alo\0\0a&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">6</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;objsize&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">newuserdata</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Number Token NUMBER">0</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;objsize&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">newuserdata</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Number Token NUMBER">101</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">101</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;objsize&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">124</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;objsize&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;tonumber&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-2 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-2 RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;tonumber&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;12&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">12</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;tonumber&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;s2&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;tonumber&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">null</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">null</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">null</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;abc&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">null</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">rep</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&quot;x&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token LF">
</span><span class="Expression Punctuator Token SPACE">         </span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">rep</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&quot;x&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">    </span><span class="VarSuffix Token Argument COMMENT">-- short strings</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token COMMENT">-- long strings</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">s1</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">rep</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;x&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">300</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">s2</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">rep</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;x&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">300</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">s1</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">s2</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">pushuserdata</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Number Token NUMBER">20</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">null</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">io</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">read</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">null</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">           </span><span class="VarSuffix Token Argument COMMENT">-- light C function</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">hfunc</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">null</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">        </span><span class="VarSuffix Token Argument COMMENT">-- &quot;heavy&quot; C function</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">null</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">   </span><span class="VarSuffix Token Argument COMMENT">-- Lua function</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;topointer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">io</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">stdin</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">null</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">   </span><span class="VarSuffix Token Argument COMMENT">-- full userdata</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;func2num&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;func2num&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">pushuserdata</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Number Token NUMBER">10</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;func2num&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">io</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">read</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">     </span><span class="VarSuffix Token Argument COMMENT">-- light C function</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;func2num&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">hfunc</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- &quot;heavy&quot; C function (with upvalue)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">to</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;tocfunction&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">deg</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">3</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">deg</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">3</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">deg</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;testing panic function&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token COMMENT">-- trivial error</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">checkpanic</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;pushstring hi; error&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;hi&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="VarSuffix Token Argument COMMENT">-- using the stack inside panic</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">checkpanic</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;pushstring hi; error;&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">      </span><span class="Token String STR">[[checkstack 5 XX
        pushstring &#x27; alo&#x27;
        pushstring &#x27; mundo&#x27;
        concat 3]]</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;hi alo mundo&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="VarSuffix Token Argument COMMENT">-- &quot;argerror&quot; without frames</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">checkpanic</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;loadstring 4&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token LF">
</span><span class="Expression Punctuator Token SPACE">        </span><span class="Token String STR">&quot;bad argument #4 (string expected, got no value)&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="VarSuffix Token Argument COMMENT">-- memory error</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">totalmem</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">totalmem</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Expression Punctuator Token PLUS">+</span><span class="Number Expression Token NUMBER">10000</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">   </span><span class="VarSuffix Token Argument COMMENT">-- set low memory limit (+10k)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">checkpanic</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;newuserdata 20000&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">MEMERRMSG</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">totalmem</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">          </span><span class="VarSuffix Token Argument COMMENT">-- restore high limit</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="VarSuffix Token Argument COMMENT">-- stack error</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">_soft</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">msg</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">checkpanic</span><span class="Token String STR">[[
        pushstring &quot;function f() f() end&quot;
        loadstring -1; call 0 0
        getglobal f; call 0 0
      ]]</span><span class="Token LF">
</span><span class="Token SPACE">      </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">find</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;stack overflow&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token COMMENT">-- exit in panic still close to-be-closed variables</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">checkpanic</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">[[
      pushstring &quot;return {__close = function () Y = &#x27;ho&#x27;; end}&quot;
      newtable
      loadstring -2
      call 0 1
      setmetatable -2
      toclose -1
      pushstring &quot;hi&quot;
      error
    ]]</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">[[
      getglobal Y
      concat 2         # concat original error with global Y
    ]]</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;hiho&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- testing deep C stack</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">_soft</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;testing stack overflow&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;stop&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">checkerr</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;XXXX&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">testC</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;checkstack 1000023 XXXX&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">   </span><span class="VarSuffix Token Argument COMMENT">-- too deep</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="VarSuffix Token Argument COMMENT">-- too deep (with no message)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">checkerr</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;^stack overflow$&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">testC</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;checkstack 1000023 &#x27;&#x27;&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">s</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">rep</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;pushnil;checkstack 1 XX;&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1000000</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">checkerr</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;overflow&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">testC</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">s</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;restart&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Token String STR">&#x27;+&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">lim</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">_soft</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Number Expression Token NUMBER">500</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token OR">or</span><span class="Number Keyword Token SPACE"> </span><span class="Number Token NUMBER">12000</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">prog</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Token String STR">&quot;checkstack &quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token CONCAT">..</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MUL">*</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token PLUS">+</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">100</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token CONCAT">..</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;msg&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token String STR">&quot;newtable&quot;</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">prog</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;pushnum &quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token CONCAT">..</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable ID">prog</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;pushnum &quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token CONCAT">..</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MUL">*</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="Number Expression Token LF">
</span><span class="Number Expression Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;rawgeti R 2&quot;</span><span class="Token SPACE">   </span><span class="Token COMMENT">-- get global table in registry</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;insert &quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token CONCAT">..</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression BraceDepth-0 Token Variable LPAREN">(</span><span class="Number Token Variable NUMBER">2</span><span class="Number Punctuator Token MUL">*</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="Expression BraceDepth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">prog</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;settable &quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token CONCAT">..</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression BraceDepth-0 Token Variable LPAREN">(</span><span class="Number Token Variable NUMBER">2</span><span class="Number Punctuator Token MUL">*</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Expression BraceDepth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;return 2&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">table</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">concat</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;;&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">g</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">t</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">g</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Expression Punctuator Token MUL">*</span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">undef</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">next</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">g</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Keyword Token COMMENT">-- testing errors</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">[[
    loadstring 2; pcall 0 1 0;
    pushvalue 3; insert -2; pcall 1 1 0;
    pcall 0 0 0;
    return 1
  ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;XX=150&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Expression Punctuator Token EQ">==</span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Number Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;string&#x27;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">XX</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">150</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">_G</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">XX</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">check3</span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">p</span><span class="FunctionBody Token ParameterList COMMA">,</span><span class="FunctionBody Token ParameterList SPACE"> </span><span class="Punctuator Token ParameterList VARARGS">...</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">arg</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression Punctuator Token VARARGS">...</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">arg</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">find</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">arg</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">3</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check3</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;:1:&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;loadstring 2; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;x=&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check3</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;%.&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;loadfile 2; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;.&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check3</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;xxxx&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;loadfile 2; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;xxxx&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- test errors in non protected threads</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">checkerrnopro</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">code</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">msg</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">th</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">coroutine</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">create</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- create new thread</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">stt</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">err</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">testC</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">th</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">code</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">   </span><span class="VarSuffix Token Argument COMMENT">-- run code there</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">stt</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">find</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">err</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">msg</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">_soft</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;stop&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">   </span><span class="VarSuffix Token Argument COMMENT">-- avoid __gc with full stack</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">checkerrnopro</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;pushnum 3; call 0 0&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;attempt to call&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Token String STR">&quot;testing stack overflow in unprotected thread&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionName FuncName Token ID">F</span><span class="Identifier FunctionName FuncName Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">F</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">checkerrnopro</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;getglobal &#x27;F&#x27;; call 0 0;&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;stack overflow&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">F</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;restart&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Token String STR">&quot;+&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token COMMENT">-- testing table access</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- getp/setp</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a1</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;rawsetp 2 1; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">pushuserdata</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Number Token NUMBER">1</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">20</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a1</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">res</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;rawgetp -1 1; return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a1</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">20</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- using the table itself as index</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Number Token LF">
</span><span class="Number Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">prog</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;gettable -1; return *&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">res</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">prog</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;settable -2; return *&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">res</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">20</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="VarSuffix Token Argument COMMENT">-- raw</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Number Token LF">
</span><span class="Number Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">prog</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;rawget -1; return *&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">res</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">prog</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;rawset -2; return *&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">res</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">20</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="VarSuffix Token Argument COMMENT">-- using the table as the value to set</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">prog</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;rawset -1; return *&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">res</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">30</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">30</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">prog</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;settable -1; return *&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">res</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">40</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">40</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">prog</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;rawseti -1 100; return *&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">res</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">100</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">prog</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;seti -1 200; return *&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">res</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">200</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Identifier Field Token ID">x</span><span class="FieldList Field Token ASSIGN">=</span><span class="Number Field Token NUMBER">0</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Identifier Field Token ID">y</span><span class="Field Token ASSIGN">=</span><span class="Number Field Token NUMBER">12</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;gettable 2; pushvalue 4; gettable 2; return 2&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">                  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;y&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;x&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">12</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;settable -5&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;x&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">15</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">x</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">15</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;gettable 2; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- table and key are the same object!</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;settable 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;x&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">    </span><span class="VarSuffix Token Argument COMMENT">-- table and key are the same object!</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;x&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">p</span><span class="Identifier Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">getmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token DOT">.</span><span class="TableKey VarSuffix Identifier Token FunctionName ID">__index</span><span class="TableKey VarSuffix Identifier Token FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">i</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">p</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">k</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">x</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;gettable 3, return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">35</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;x&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">15</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">k</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">35</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">k</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;getfield 2 y, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">k</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">12</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">getmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token DOT">.</span><span class="TableKey VarSuffix Identifier Token FunctionName ID">__index</span><span class="TableKey VarSuffix Identifier Token FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">i</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier Token Variable ID">getmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token DOT">.</span><span class="TableKey VarSuffix Identifier Token FunctionName ID">__newindex</span><span class="TableKey VarSuffix Identifier Token FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">i</span><span class="Token COMMA">,</span><span class="Identifier Token ID">v</span><span class="Identifier Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">v</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;insert 2; gettable -5; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;y&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">12</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">k</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;settable -5, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;x&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">16</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">x</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">16</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">k</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">4</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&#x27;xuxu&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;gettable 2, return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;xuxu&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;settable 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">19</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">19</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">--</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- testing getfield/setfield with long keys</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">t</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Identifier Field Token ID">_012345678901234567890123456789012345678901234567890123456789</span><span class="Identifier Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Number Field Token NUMBER">32</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">[[
      getfield 2 _012345678901234567890123456789012345678901234567890123456789
      return 1
    ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">32</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">[[
      pushnum 33
      setglobal _012345678901234567890123456789012345678901234567890123456789
    ]]</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">_012345678901234567890123456789012345678901234567890123456789</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">33</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">_012345678901234567890123456789012345678901234567890123456789</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- testing next</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;next; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">n</span><span class="FieldList Field Token ASSIGN">=</span><span class="Number Field Token NUMBER">1</span><span class="Punctuator Token COMMA">,</span><span class="Identifier Token Variable ID">a</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Identifier Field Token ID">a</span><span class="FieldList Field Token ASSIGN">=</span><span class="Number Field Token NUMBER">3</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;next; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">n</span><span class="FieldList Field Token ASSIGN">=</span><span class="Number Field Token NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Identifier Token Variable ID">a</span><span class="Punctuator Token COMMA">,</span><span class="Token String STR">&#x27;a&#x27;</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">3</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;next; pop 1; next; return *&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">tcheck</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">n</span><span class="FieldList Field Token ASSIGN">=</span><span class="Number Field Token NUMBER">1</span><span class="Punctuator Token COMMA">,</span><span class="Identifier Token Variable ID">a</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- testing upvalues</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">A</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="Token String STR">[[ pushnum 10; pushnum 20; pushcclosure 2; return 1]]</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">A</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">[[pushvalue U0; pushvalue U1; pushvalue U2; return 3]]</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">20</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;table&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">A</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">[[tostring U3; tonumber U4; return 2]]</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">A</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">[[pushnum 100; pushnum 200; replace U2; replace U1]]</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">A</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">[[pushvalue U1; pushvalue U2; return 2]]</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">100</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">200</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">A</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">[[replace U2; replace U1]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">x</span><span class="FieldList Field Token ASSIGN">=</span><span class="Number Field Token NUMBER">1</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">x</span><span class="FieldList Field Token ASSIGN">=</span><span class="Number Field Token NUMBER">2</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">A</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">[[pushvalue U1; pushvalue U2; return 2]]</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">x</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">x</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">checkmemory</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- testing absent upvalues from C-function pointers</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="Token String STR">[[isnull U1; return 1]]</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression TRUE">true</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="Token String STR">[[isnull U100; return 1]]</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression TRUE">true</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="Token String STR">[[pushvalue U1; return 1]]</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">f</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="Token String STR">[[ pushnum 10; pushnum 20; pushcclosure 2; return 1]]</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalue</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token LF">
</span><span class="Number Keyword Token SPACE">         </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalue</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">20</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token LF">
</span><span class="Number Keyword Token SPACE">         </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalue</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalue</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;xuxu&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalue</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;xuxu&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- large closures</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">A</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;checkstack 300 msg;&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token CONCAT">..</span><span class="Expression Punctuator Token LF">
</span><span class="Expression Punctuator Token SPACE">              </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">rep</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;pushnum 10;&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">255</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token CONCAT">..</span><span class="Expression Punctuator Token LF">
</span><span class="Expression Punctuator Token SPACE">              </span><span class="Token String STR">&quot;pushcclosure 255; return 1&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">A</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Number Token NUMBER">255</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">A</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Token String STR">&quot;pushvalue U</span><span class="Format Token String STR">%d</span><span class="Token String STR">; return 1&quot;</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token COLON">:</span><span class="Identifier VarSuffix Token FunctionCall ID">format</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">A</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;isnull U256; return 1&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">A</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;isnil U256; return 1&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- testing get/setuservalue</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- bug in 5.1.2</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkerr</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;got number&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">setuservalue</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkerr</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;got nil&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">setuservalue</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkerr</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;got light userdata&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">setuservalue</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">pushuserdata</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- testing multiple user values</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">b</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">newuserdata</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">v</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">p</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">getuservalue</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">v</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- indices out of range</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">v</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">p</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">getuservalue</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">2</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">v</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">v</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">p</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">getuservalue</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">11</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">v</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">t</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Keyword Field Token TRUE">true</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Keyword Field Token FALSE">false</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">4.56</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token String STR">&quot;XYZ&quot;</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token ID">k</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">v</span><span class="Identifier Token SPACE"> </span><span class="Statement Keyword Token IN">in</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">ipairs</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">setuservalue</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">v</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">k</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token ID">k</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">v</span><span class="Identifier Token SPACE"> </span><span class="Statement Keyword Token IN">in</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">ipairs</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">v1</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">p</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">getuservalue</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">k</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">v1</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">v</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">getuservalue</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">4</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">setuservalue</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Number Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">   </span><span class="VarSuffix Token Argument COMMENT">-- function should not be collected</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">getuservalue</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">setuservalue</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">134</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">   </span><span class="VarSuffix Token Argument COMMENT">-- number should not be a problem for collector</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">getuservalue</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">134</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- test barrier for uservalues</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">oldmode</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;incremental&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">gcstate</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;atomic&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">gccolor</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;black&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">setuservalue</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">x</span><span class="Identifier Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Number Field Token NUMBER">100</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">gcstate</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;pause&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- complete collection</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">getuservalue</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">x</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">100</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- uvalue should be there</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">oldmode</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- long chain of userdata</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1000</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">bb</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">newuserdata</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">setuservalue</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bb</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">bb</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">     </span><span class="VarSuffix Token Argument COMMENT">-- nothing should not be collected</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1000</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">getuservalue</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">getuservalue</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">x</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">100</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Keyword Token COMMENT">-- testing locks (refs)</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Keyword Token COMMENT">-- reuse of references</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">i</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">ref</span><span class="TableConstructor BraceDepth-0 Token Argument LCURLY_BRACE">{</span><span class="TableConstructor BraceDepth-0 Token Argument RCURLY_BRACE">}</span><span class="TableConstructor Token Argument LF">
</span><span class="TableConstructor Token Argument SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">unref</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">ref</span><span class="TableConstructor BraceDepth-1 Token Argument LCURLY_BRACE">{</span><span class="TableConstructor BraceDepth-1 Token Argument RCURLY_BRACE">}</span><span class="TableConstructor Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">Arr</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">Lim</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">100</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Identifier Token Variable ID">Lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- lock many objects</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">Arr</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">ref</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">ref</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Keyword Token NIL">nil</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">getref</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">unref</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">unref</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Identifier Token Variable ID">Lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- unlock all them</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">unref</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">Arr</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">printlocks</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">f</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">makeCfunc</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;gettable R; return 1&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">n</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;n&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;n&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">0</span><span class="Statement Token COMMA">,</span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Identifier Token Variable ID">Lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- lock many objects</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">Arr</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">ref</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Identifier Token Variable ID">Lim</span><span class="Statement Token COMMA">,</span><span class="Number Token NUMBER">2</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- unlock half of them</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">unref</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">Arr</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">getref</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">Arr</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">2</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;table&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">getref</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">ref</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">getref</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;table&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- colect in cl the `val&#x27; of all collected userdata</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">tt</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">cl</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Identifier Field Token ID">n</span><span class="FieldList Field Token ASSIGN">=</span><span class="Number Field Token NUMBER">0</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">B</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">F</span><span class="Identifier AttributeName Token LF">
</span><span class="Identifier AttributeName Token SPACE">  </span><span class="Identifier FunctionName Token Variable ID">F</span><span class="Identifier FunctionName Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">udval</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">udataval</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">table</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">insert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">cl</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">udval</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">d</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">newuserdata</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">100</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">   </span><span class="VarSuffix Token Argument COMMENT">-- create garbage</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">getmetatable</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">__gc</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">F</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;table.insert({}, {})&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">   </span><span class="VarSuffix Token Argument COMMENT">-- create more garbage</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">    </span><span class="VarSuffix Token Argument COMMENT">-- GC during GC (no op)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">dummy</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Expression TableConstructor Token COMMENT">-- create more garbage during GC</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="Keyword Token Expression SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">A</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;userdata&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">      </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">udataval</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">A</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">B</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">      </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">getmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">A</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">    </span><span class="VarSuffix Token Argument COMMENT">-- just access it</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE">   </span><span class="Identifier Token Variable COMMENT">-- ressurect userdata</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable ID">B</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">udval</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Number Token NUMBER">3</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier Token Variable ID">tt</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">__gc</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">F</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable COMMENT">-- test whether udate collection frees memory in the right time</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">x</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;count&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">newuserdata</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">5001</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;objsize 2; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">5001</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;count&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token GE">&gt;=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Expression Punctuator Token PLUS">+</span><span class="Number Expression Token NUMBER">4</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;count&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token LE">&lt;=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Expression Punctuator Token PLUS">+</span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="VarSuffix Token Argument COMMENT">-- udata without finalizer</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;count&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;stop&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Number Token NUMBER">1000</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">newuserdata</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;count&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression BraceDepth-1 Punctuator Token RANGLE_BRACE">&gt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Expression Punctuator Token PLUS">+</span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;count&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token LE">&lt;=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Expression Punctuator Token PLUS">+</span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="VarSuffix Token Argument COMMENT">-- udata with finalizer</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;count&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;stop&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Identifier Field Token ID">__gc</span><span class="Identifier Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Number Token NUMBER">1000</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">setmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">newuserdata</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;count&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token GE">&gt;=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Expression Punctuator Token PLUS">+</span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- this collection only calls TM, without freeing memory</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;count&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token GE">&gt;=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Expression Punctuator Token PLUS">+</span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- now frees memory</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;count&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token LE">&lt;=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Expression Punctuator Token PLUS">+</span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;restart&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;stop&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- create 3 userdatas with tag `tt&#x27;</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">newuserdata</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">setmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">tt</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">na</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">udataval</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">newuserdata</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">setmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">tt</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">nb</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">udataval</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">newuserdata</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">setmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">tt</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">nc</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">udataval</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- create userdata without meta table</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">newuserdata</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">4</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">newuserdata</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkerr</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;FILE%* expected, got userdata&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">io</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">input</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkerr</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;FILE%* expected, got userdata&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">io</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">input</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">getmetatable</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">getmetatable</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">y</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">d</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">ref</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">e</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">ref</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">f</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">ref</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">getref</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">d</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">getref</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">e</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">getref</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">3</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Statement Token ASSIGN">=</span><span class="Keyword Token NIL">nil</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Statement Token ASSIGN">=</span><span class="Keyword Token NIL">nil</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Statement Token ASSIGN">=</span><span class="Keyword Token NIL">nil</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">unref</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">e</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">unref</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- check that unref objects have been collected</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">cl</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">cl</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">nc</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">getref</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">d</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;userdata&#x27;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">getmetatable</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">tt</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">tt</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">b</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable COMMENT">-- create cycle</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable ID">tt</span><span class="Statement Token ASSIGN">=</span><span class="Keyword Token NIL">nil</span><span class="Keyword Token SPACE">    </span><span class="Keyword Token COMMENT">-- frees tt for GC</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">unref</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">d</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">n5</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">newuserdata</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">setmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">n5</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">__gc</span><span class="FieldList Field Token ASSIGN">=</span><span class="Identifier Token Variable ID">F</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">n5</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">udataval</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">n5</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">cl</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">4</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- check order of collection</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">cl</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">n5</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">cl</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">3</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">nb</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">cl</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">4</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">na</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="Token String STR">&quot;restart&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">na</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">30</span><span class="Statement Token COMMA">,</span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">newuserdata</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">setmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">__gc</span><span class="FieldList Field Token ASSIGN">=</span><span class="Identifier Token Variable ID">F</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">na</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">udataval</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">cl</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-2 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-2 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">cl</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">30</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Number Token NUMBER">30</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">cl</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">na</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">na</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">2</span><span class="Statement Token COMMA">,</span><span class="Identifier Token Variable ID">Lim</span><span class="Statement Token COMMA">,</span><span class="Number Token NUMBER">2</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- unlock the other half</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">unref</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">Arr</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">newuserdata</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">41</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">setmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">__gc</span><span class="FieldList Field Token ASSIGN">=</span><span class="Identifier Token Variable ID">F</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;objsize 2; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">41</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">cl</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="FieldList BraceDepth-1 Field Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">x</span><span class="FieldList BraceDepth-1 Field Token RSQUAR_PAREN">]</span><span class="FieldList Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Number Field Token NUMBER">1</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">udataval</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- old `x&#x27; cannot be collected (`a&#x27; still uses it)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">cl</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token ID">n</span><span class="Identifier Token SPACE"> </span><span class="Statement Keyword Token IN">in</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pairs</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">n</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">undef</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">cl</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">cl</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">   </span><span class="VarSuffix Token Argument COMMENT">-- old `x&#x27; must be collected</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- testing lua_equal</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;compare EQ 2 4; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;compare EQ 3 2; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;alo&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;alo&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;compare EQ 2 3; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;compare EQ 2 3; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-2 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-2 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-2 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-2 RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;compare EQ 2 3; return 1&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;compare EQ 2 3; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- testing lua_equal with fallbacks</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">map</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">t</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Identifier Field Token ID">__eq</span><span class="Identifier Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">map</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">map</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">f</span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">      </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">u</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">newuserdata</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">      </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">setmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">u</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">      </span><span class="Identifier Token Variable ID">map</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">u</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">      </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">u</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">10</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">10</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">10</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">11</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;compare EQ 2 3; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Number Token NUMBER">10</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Number Token NUMBER">10</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;compare EQ 2 3; return 1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Number Token NUMBER">10</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Number Token NUMBER">20</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">__eq</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">10</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">10</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Token String STR">&#x27;+&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token COMMENT">-- testing changing hooks during hooks</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">_G</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">TT</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">sethook</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">[[
    # set a line hook after 3 count hooks
    sethook 4 0 &#x27;
      getglobal TT;
      pushvalue -3; append -2
      pushvalue -2; append -2
    &#x27;]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;c&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Number Token SPACE">   </span><span class="Number Token COMMENT">-- counting</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Number Token SPACE">   </span><span class="Number Token COMMENT">-- counting</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Number Token SPACE">   </span><span class="Number Token COMMENT">-- count hook (set line hook)</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Number Token SPACE">   </span><span class="Number Token COMMENT">-- line hook</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Number Token SPACE">   </span><span class="Number Token COMMENT">-- line hook</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">sethook</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">t</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">TT</span><span class="Identifier VarSuffix TableKey Token LF">
</span><span class="Identifier VarSuffix TableKey Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;line&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">line</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">2</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token LF">
</span><span class="VarSuffix Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">3</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;line&quot;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">4</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">line</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">5</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;line&quot;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">6</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">line</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">7</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">_G</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">TT</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Keyword Token COMMENT">-------------------------------------------------------------------------</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- testing errors during GC</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">warn</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;@off&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;stop&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Number Token NUMBER">20</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">newuserdata</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">   </span><span class="VarSuffix Token Argument COMMENT">-- creates several udata</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Number Token NUMBER">20</span><span class="Statement Token COMMA">,</span><span class="Number Token NUMBER">2</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- mark half of them to raise errors during GC</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">setmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">        </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">__gc</span><span class="Identifier Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">error</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&quot;@expected error in gc&quot;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">2</span><span class="Statement Token COMMA">,</span><span class="Number Token NUMBER">20</span><span class="Statement Token COMMA">,</span><span class="Number Token NUMBER">2</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- mark the other half to count and to create more garbage</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">setmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">__gc</span><span class="Identifier Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&quot;A=A+1&quot;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">_G</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">A</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Number Token LF">
</span><span class="Number Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- number of normal collections</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;restart&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">warn</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;@on&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">_G</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">A</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Keyword Token COMMENT">-------------------------------------------------------------------------</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Keyword Token COMMENT">-- test for userdata vals</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">lim</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">30</span><span class="Number Token LF">
</span><span class="Number Token SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">0</span><span class="Statement Token COMMA">,</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">pushuserdata</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">0</span><span class="Statement Token COMMA">,</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">udataval</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">0</span><span class="Statement Token COMMA">,</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">pushuserdata</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">0</span><span class="Statement Token COMMA">,</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">0</span><span class="Statement Token COMMA">,</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">pushuserdata</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">tostring</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;string&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-------------------------------------------------------------------------</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- testing multiple states</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">closestate</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">newstate</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Identifier Token Variable ID">L1</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">newstate</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">doremote</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;X=&#x27;a&#x27;; return &#x27;a&#x27;&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;a&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">doremote</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;function f () return &#x27;alo&#x27;, 3 end; f()&quot;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">doremote</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;return f()&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;alo&#x27;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;3&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">doremote</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;_ERRORMESSAGE = nil&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- error: `sin&#x27; is not defined</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">doremote</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;return sin(1)&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">   </span><span class="VarSuffix Token Argument COMMENT">-- 2 == run-time error</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- error: syntax error</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">doremote</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;return a+&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;string&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">   </span><span class="VarSuffix Token Argument COMMENT">-- 3 == syntax error</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">loadlib</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">doremote</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">[[
    string = require&#x27;string&#x27;
    a = require&#x27;_G&#x27;; assert(a == _G and require(&quot;_G&quot;) == a)
    io = require&#x27;io&#x27;; assert(type(io.read) == &quot;function&quot;)
    assert(require(&quot;io&quot;) == io)
    a = require&#x27;table&#x27;; assert(type(a.insert) == &quot;function&quot;)
    a = require&#x27;debug&#x27;; assert(type(a.getlocal) == &quot;function&quot;)
    a = require&#x27;math&#x27;; assert(type(a.sin) == &quot;function&quot;)
    return string.sub(&#x27;okinama&#x27;, 1, 2)
  ]]</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;ok&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">closestate</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Identifier Token Variable ID">L1</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">newstate</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">loadlib</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">doremote</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;a = {}&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">[[getglobal &quot;a&quot;; pushstring &quot;x&quot;; pushint 1;
               settable -3]]</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">doremote</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;return a.x&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;1&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">closestate</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">L1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">L1</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;+&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-------------------------------------------------------------------------</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- testing to-be-closed variables</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-------------------------------------------------------------------------</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Token String STR">&quot;testing to-be-closed variables&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">openresource</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">newresource</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">      </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">x</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Number Field Token NUMBER">10</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">__close</span><span class="Identifier Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="Identifier Token ID">y</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">        </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">openresource</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">openresource</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">        </span><span class="Identifier Token Variable ID">openresource</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">openresource</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">        </span><span class="Identifier Token Variable ID">y</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token LF">
</span><span class="Number Expression Token SPACE">      </span><span class="Keyword Token FunctionBody END">end</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">      </span><span class="Identifier Token Variable ID">openresource</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">openresource</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">      </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">b</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">[[
      call 0 1   # create resource
      pushnil
      toclose -2  # mark call result to be closed
      toclose -1  # mark nil to be closed (will be ignored)
      return 2
    ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">newresource</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">11</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">openresource</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">    </span><span class="VarSuffix Token Argument COMMENT">-- was closed</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="VarSuffix Token Argument COMMENT">-- repeat the test, but calling function in a &#x27;multret&#x27; context</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">[[
      call 0 1   # create resource
      toclose 2 # mark it to be closed
      return 2
    ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">newresource</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;string&quot;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">11</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">openresource</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">    </span><span class="VarSuffix Token Argument COMMENT">-- was closed</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="VarSuffix Token Argument COMMENT">-- closing by error</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">b</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">makeCfunc</span><span class="Token String STR">[[
      call 0 1   # create resource
      toclose -1 # mark it to be closed
      error       # resource is the error object
    ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">newresource</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression FALSE">false</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">11</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">openresource</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">    </span><span class="VarSuffix Token Argument COMMENT">-- was closed</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="VarSuffix Token Argument COMMENT">-- non-closable value</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">b</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">makeCfunc</span><span class="Token String STR">[[
      newtable   # create non-closable object
      toclose -1 # mark it to be closed (should raise an error)
      abort  # will not be executed
    ]]</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression FALSE">false</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">      </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">find</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;non%-closable value&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">check</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">n</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">      </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">openresource</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Keyword Token FunctionBody COMMENT">-- closing resources with &#x27;closeslot&#x27;</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Identifier Token Variable ID">_ENV</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">xxx</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">[[
      pushvalue 2  # stack: S, NR, CH, NR
      call 0 1   # create resource; stack: S, NR, CH, R
      toclose -1 # mark it to be closed
      pushvalue 2  #  stack: S, NR, CH, R, NR
      call 0 1   # create another resource; stack: S, NR, CH, R, R
      toclose -1 # mark it to be closed
      pushvalue 3  # stack: S, NR, CH, R, R, CH
      pushint 2   # there should be two open resources
      call 1 0  #  stack: S, NR, CH, R, R
      closeslot -1   # close second resource
      pushvalue 3  # stack: S, NR, CH, R, R, CH
      pushint 1   # there should be one open resource
      call 1 0  # stack: S, NR, CH, R, R
      closeslot 4
      setglobal &quot;xxx&quot;  # previous op. erased the slot
      pop 1       # pop other resource from the stack
      pushint *
      return 1    # return stack size
    ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">newresource</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">_ENV</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">xxx</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">   </span><span class="VarSuffix Token Argument COMMENT">-- no extra items left in the stack</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="VarSuffix Token Argument COMMENT">-- closing resources with &#x27;pop&#x27;</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">[[
      pushvalue 2  # stack: S, NR, CH, NR
      call 0 1   # create resource; stack: S, NR, CH, R
      toclose -1 # mark it to be closed
      pushvalue 2  #  stack: S, NR, CH, R, NR
      call 0 1   # create another resource; stack: S, NR, CH, R, R
      toclose -1 # mark it to be closed
      pushvalue 3  # stack: S, NR, CH, R, R, CH
      pushint 2   # there should be two open resources
      call 1 0  #  stack: S, NR, CH, R, R
      pop 1   # pop second resource
      pushvalue 3  # stack: S, NR, CH, R, CH
      pushint 1   # there should be one open resource
      call 1 0  # stack: S, NR, CH, R
      pop 1       # pop other resource from the stack
      pushvalue 3  # stack: S, NR, CH, CH
      pushint 0   # there should be no open resources
      call 1 0  # stack: S, NR, CH
      pushint *
      return 1    # return stack size
    ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">newresource</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">   </span><span class="VarSuffix Token Argument COMMENT">-- no extra items left in the stack</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="VarSuffix Token Argument COMMENT">-- non-closable value</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">b</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">makeCfunc</span><span class="Token String STR">[[
      pushint 32
      toclose -1
    ]]</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">find</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;(C temporary)&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">--[[
  ** {==================================================================
  ** Testing memory limits
  ** ===================================================================
  --]]</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;memory-allocation errors&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkerr</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;block too big&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">newuserdata</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">maxinteger</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">f</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="Token String STR">&quot;local a={}; for i=1,100000 do a[i]=i end&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">alloccount</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkerr</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">MEMERRMSG</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">alloccount</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">          </span><span class="VarSuffix Token Argument COMMENT">-- remove limit</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- test memory errors; increase limit for maximum memory by steps,</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- o that we get memory errors in all allocations of a given</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- task, until there is enough memory to complete the task without</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- errors.</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">testbytes</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">s</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">f</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">M</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">totalmem</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">oldM</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">M</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">b</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">    </span><span class="Statement Keyword Token WHILE">while</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token TRUE">true</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">      </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">totalmem</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">M</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">      </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;pcall 0 1 0; pushstatus; return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">      </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">totalmem</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- remove limit</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">      </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;OK&quot;</span><span class="Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token BREAK">break</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE">       </span><span class="Statement Keyword Token COMMENT">-- stop when no more errors</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;OK&quot;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">MEMERRMSG</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token COMMENT">-- not a memory error?</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">        </span><span class="Identifier FunctionCall Token Variable ID">error</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">   </span><span class="VarSuffix Token Argument COMMENT">-- propagate it</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">      </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Identifier Token Variable ID">M</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">M</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">7</span><span class="Number Expression Token SPACE">   </span><span class="Number Expression Token COMMENT">-- increase memory limit</span><span class="Number Expression Token LF">
</span><span class="Number Expression Token SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">format</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;minimum memory for </span><span class="Format Token String STR">%s</span><span class="Token String STR">: </span><span class="Format Token String STR">%d</span><span class="Token String STR"> bytes&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">s</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">M</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">oldM</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Keyword Token FunctionBody COMMENT">-- test memory errors; increase limit for number of allocations one</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Keyword Token FunctionBody COMMENT">-- by one, so that we get memory errors in all allocations of a given</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Keyword Token FunctionBody COMMENT">-- task, until there is enough allocations to complete the task without</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Keyword Token FunctionBody COMMENT">-- errors.</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">testalloc</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">s</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">f</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">M</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Number Token LF">
</span><span class="Number Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">b</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">    </span><span class="Statement Keyword Token WHILE">while</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token TRUE">true</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">      </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">alloccount</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">M</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">      </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;pcall 0 1 0; pushstatus; return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">      </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">alloccount</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- remove limit</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">      </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;OK&quot;</span><span class="Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token BREAK">break</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE">       </span><span class="Statement Keyword Token COMMENT">-- stop when no more errors</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;OK&quot;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">MEMERRMSG</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token COMMENT">-- not a memory error?</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">        </span><span class="Identifier FunctionCall Token Variable ID">error</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">   </span><span class="VarSuffix Token Argument COMMENT">-- propagate it</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">      </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Identifier Token Variable ID">M</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">M</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE">   </span><span class="Number Expression Token COMMENT">-- increase allocation limit</span><span class="Number Expression Token LF">
</span><span class="Number Expression Token SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">format</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;minimum allocations for </span><span class="Format Token String STR">%s</span><span class="Token String STR">: </span><span class="Format Token String STR">%d</span><span class="Token String STR"> allocations&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">s</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">M</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">testamem</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">s</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">f</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">testalloc</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">s</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">testbytes</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">s</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Keyword Token FunctionBody COMMENT">-- doing nothing</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;doing nothing&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Number Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- testing memory errors when creating a new state</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;state creation&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">st</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">newstate</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">st</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">closestate</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">st</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- close new state</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">st</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;empty-table creation&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;string creation&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Token String STR">&quot;XXX&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token CONCAT">..</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;YYY&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;coroutine creation&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">             </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">coroutine</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">create</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">print</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- testing to-be-closed variables</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;to-be-closed variables&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">flag</span><span class="Identifier AttributeName Token LF">
</span><span class="Identifier AttributeName Token SPACE">    </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">x</span><span class="Identifier AttributeName Token SPACE"> </span><span class="AttributeName BraceDepth-1 Attribute Token LANGLE_BRACE">&lt;</span><span class="Identifier AttributeType Attribute Token ID">close</span><span class="AttributeName BraceDepth-1 Attribute Token RANGLE_BRACE">&gt;</span><span class="AttributeName Attribute Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">                </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Expression TableConstructor Token BraceDepth-2 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-2 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-2 LCURLY_BRACE">{</span><span class="Identifier Field Token ID">__close</span><span class="Identifier Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Identifier Token Variable ID">flag</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Expression TableConstructor Token BraceDepth-2 RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">      </span><span class="Identifier Token Variable ID">flag</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FALSE">false</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">      </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">x</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">flag</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- testing threads</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- get main thread from registry (at index LUA_RIDX_MAINTHREAD == 1)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">mt</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;rawgeti R 1; return 1&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">mt</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;thread&quot;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">coroutine</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">running</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">mt</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">expand</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">n</span><span class="Token COMMA">,</span><span class="Identifier Token ID">s</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">0</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">e</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">rep</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;=&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">format</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;T.doonnewstack([</span><span class="Format Token String STR">%s</span><span class="Token String STR">[ </span><span class="Format Token String STR">%s</span><span class="Token String STR">;</span><span class="String Token Control STR">\n</span><span class="Token String STR"> collectgarbage(); </span><span class="Format Token String STR">%s</span><span class="Token String STR">]</span><span class="Format Token String STR">%s</span><span class="Token String STR">])</span><span class="String Token Control STR">\n</span><span class="Token String STR">&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">                                </span><span class="Identifier Token Variable ID">e</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">s</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">expand</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">s</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">e</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier Token Variable ID">G</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">0</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;count&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">expand</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">20</span><span class="Token COMMA">,</span><span class="Token String STR">&quot;G=G+1&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">G</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">20</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE">  </span><span class="Statement Token COMMENT">-- assert(gcinfo() &lt;= a+1)</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Identifier Token Variable ID">G</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;running code on new thread&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">doonnewstack</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;local x=1&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="Number Expression Token SPACE">  </span><span class="Number Expression Token COMMENT">-- try to create thread</span><span class="Number Expression Token LF">
</span><span class="Number Expression Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- testing memory x compiler</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;loadstring&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;x=1&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- try to do load a string</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">testprog</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">[[
  local function foo () return end
  local t = {&quot;x&quot;}
  AA = &quot;aaa&quot;
  for i = 1, #t do AA = AA .. t[i] end
  return true
  ]]</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token COMMENT">-- testing memory x dofile</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">_G</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">AA</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">t</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Identifier Token Variable ID">os</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">tmpname</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">f</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">io</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">open</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;w&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">f</span><span class="VarSuffix Token COLON">:</span><span class="Identifier VarSuffix Token FunctionCall ID">write</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">testprog</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">f</span><span class="VarSuffix Token COLON">:</span><span class="Identifier VarSuffix Token FunctionCall ID">close</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;dofile&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">loadfile</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">os</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">remove</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">_G</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">AA</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;aaax&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- other generic tests</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;gsub&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">b</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">gsub</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;alo alo&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;(a)&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Expression Punctuator Token CONCAT">..</span><span class="Token String STR">&#x27;b&#x27;</span><span class="Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;ablo ablo&#x27;</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;dump/undump&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">testprog</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">b</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">dump</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">_G</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">AA</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">t</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">os</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">tmpname</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;file creation&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">f</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">io</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">open</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;w&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">io</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">open</span><span class="Token String STR">&quot;nomenaoexistente&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">io</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">close</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">loadfile</span><span class="Token String STR">&#x27;nomenaoexistente&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">os</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">remove</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;table creation&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">lim</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Number Token LF">
</span><span class="Number Token SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Expression Punctuator Token CONCAT">..</span><span class="Token String STR">&#x27;a&#x27;</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Expression TableConstructor Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">lim</span><span class="Expression Punctuator Token CONCAT">..</span><span class="Token String STR">&#x27;a&#x27;</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;table&#x27;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">lim</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">lim</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;constructors&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Number Field Token NUMBER">10</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">20</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">30</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">40</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">50</span><span class="Punctuator Token SEMI">;</span><span class="Punctuator Token SPACE"> </span><span class="Identifier Field Token ID">a</span><span class="Field Token ASSIGN">=</span><span class="Number Field Token NUMBER">1</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Identifier Field Token ID">b</span><span class="Field Token ASSIGN">=</span><span class="Number Field Token NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Identifier Field Token ID">c</span><span class="Field Token ASSIGN">=</span><span class="Number Field Token NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Identifier Field Token ID">d</span><span class="Field Token ASSIGN">=</span><span class="Number Field Token NUMBER">4</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Identifier Field Token ID">e</span><span class="Field Token ASSIGN">=</span><span class="Number Field Token NUMBER">5</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;table&#x27;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">e</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">5</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">close</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;closure creation&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionName FuncName Token ID">close</span><span class="Identifier FunctionName FuncName Token SPACE"> </span><span class="Statement BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">b</span><span class="Statement BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">     </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">close</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Number Token NUMBER">2</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Number Token NUMBER">4</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">6</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;using coroutines&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">coroutine</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">wrap</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">                </span><span class="Identifier Token Variable ID">coroutine</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">yield</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">rep</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;a&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">                </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-2 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-2 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">              </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">len</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- auxiliary buffer</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">lim</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">100</span><span class="Number Token LF">
</span><span class="Number Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;01234567890123456789&quot;</span><span class="Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;auxiliary buffer&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">      </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">table</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">concat</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;,&quot;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">20</span><span class="Number Punctuator Token MUL">*</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">    </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">testamem</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;growing stack&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">foo</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">n</span><span class="Statement BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">      </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Number Token SPACE"> </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token PLUS">+</span><span class="Number Punctuator Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">100</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- }==================================================================</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- testing failing in &#x27;lua_checkstack&#x27;</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">res</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">[[rawcheckstack 500000; return 1]]</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression FALSE">false</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">L</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">newstate</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">alloccount</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">   </span><span class="VarSuffix Token Argument COMMENT">-- will be unable to reallocate the stack</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">L</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">[[rawcheckstack 5000; return 1]]</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">alloccount</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">closestate</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">L</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression FALSE">false</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- closing state with no extra memory</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">L</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">newstate</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">alloccount</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">closestate</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">L</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">alloccount</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- garbage collection with no extra memory</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">L</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">newstate</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">loadlib</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">L</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">res</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression BraceDepth-0 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">doremote</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">L</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">[[
      _ENV = require&quot;_G&quot;
      local T = require&quot;T&quot;
      local a = {}
      for i = 1, 1000 do a[i] = &#x27;i&#x27; .. i end    -- grow string table
      local stsize, stuse = T.querystr()
      assert(stuse &gt; 1000)
      local function foo (n)
        if n &gt; 0 then foo(n - 1) end
      end
      foo(180)    -- grow stack
      local _, stksize = T.stacklevel()
      assert(stksize &gt; 180)
      a = nil
      T.alloccount(0)
      collectgarbage()
      T.alloccount()
      -- stack and string table could not be reallocated,
      -- so they kept their sizes (without errors)
      assert(select(2, T.stacklevel()) == stksize)
      assert(T.querystr() == stsize)
      return &#x27;ok&#x27;
    ]]</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Expression BraceDepth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;ok&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">closestate</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">L</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Token String STR">&#x27;+&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token COMMENT">-- testing some auxlib functions</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">gsub</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">c</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;gsub 2 3 4; gettop; return 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">5</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">gsub</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;alo.alo.uhuh.&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;.&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;//&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;alo//alo//uhuh//&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">gsub</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;alo.alo.uhuh.&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;alo&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;//&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;//.//.uhuh.&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">gsub</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;alo&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;//&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">gsub</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;...&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;.&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;/.&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;/././.&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">gsub</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;...&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;...&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- testing luaL_newmetatable</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">mt_xuxu</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">res</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">top</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;newmetatable xuxu; gettop; return 3&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">mt_xuxu</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;table&quot;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">top</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">d</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">res</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">top</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;newmetatable xuxu; gettop; return 3&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">mt_xuxu</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">top</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">d</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">top</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;newmetatable xuxu1; gettop; return 3&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">mt_xuxu</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">top</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">newuserdata</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">newuserdata</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;pushstring xuxu; gettable R; setmetatable 2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">getmetatable</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">mt_xuxu</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- testing luaL_testudata</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- correct metatable</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">res1</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">res2</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">top</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">[[testudata -1 xuxu
                        testudata 2 xuxu
                    gettop
                    return 3]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">res1</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">res2</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">top</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">4</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- wrong metatable</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">res1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">res2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">top</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">[[testudata -1 xuxu1
                  testudata 2 xuxu1
                  gettop
                  return 3]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">res1</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">res2</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">top</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">4</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- non-existent type</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">res1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">res2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">top</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">[[testudata -1 xuxu2
                  testudata 2 xuxu2
                  gettop
                  return 3]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">res1</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">res2</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">top</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">4</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- userdata has no metatable</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">res1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">res2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">top</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">testC</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">[[testudata -1 xuxu
                  testudata 2 xuxu
                  gettop
                  return 3]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">res1</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">res2</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">top</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">4</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- erase metatables</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">r</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">getregistry</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">r</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">xuxu</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">mt_xuxu</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">r</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">xuxu1</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">r</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">xuxu</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">r</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">xuxu1</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Token String STR">&#x27;OK&#x27;</span></code></pre><h2 id="h2-7"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/7.lua" target="_blank">7.lua</a></h2><pre class="language-lua"><code><span class="Token COMMENT">-- $Id: testes/attrib.lua $</span><span class="Token LF">
</span><span class="Token COMMENT">-- See Copyright Notice in file all.lua</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Token String STR">&quot;testing require&quot;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;string&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;math&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;table&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">table</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;io&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">io</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;os&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">os</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;coroutine&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">coroutine</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">path</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;string&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">cpath</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;string&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">loaded</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;table&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">preload</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;table&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">config</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;string&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;package config: &quot;</span><span class="Expression Punctuator Token CONCAT">..</span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">gsub</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">config</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;</span><span class="String Token Control STR">\n</span><span class="Token String STR">&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;|&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- create a path with &#x27;max&#x27; templates,</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- each with 1-10 repetitions of &#x27;?&#x27;</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">max</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">_soft</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Number Expression Token NUMBER">100</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token OR">or</span><span class="Number Keyword Token SPACE"> </span><span class="Number Token NUMBER">2000</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">t</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Identifier Token Variable ID">max</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">rep</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;?&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Expression Punctuator Token MOD">%</span><span class="Number Expression Token NUMBER">10</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token PLUS">+</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;;&quot;</span><span class="Token SPACE">    </span><span class="Token COMMENT">-- empty template</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">path</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">table</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">concat</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;;&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- use that path in a search</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">s</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">err</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">searchpath</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;xuxu&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">path</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- search fails; check that message has an occurrence of</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- &#x27;??????????&#x27; with ? replaced by xuxu and at least &#x27;max&#x27; lines</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">s</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression LF">
</span><span class="Keyword Token Expression SPACE">         </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">find</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">err</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">rep</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&quot;xuxu&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression LF">
</span><span class="Keyword Token Expression SPACE">         </span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">gsub</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">err</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;[^</span><span class="String Token Control STR">\n</span><span class="Token String STR">]&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token GE">&gt;=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">max</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- path with one very long template</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">path</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">rep</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;?&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">max</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">s</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">err</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">searchpath</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;xuxu&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">path</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">s</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">find</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">err</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">rep</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&#x27;xuxu&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">max</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">oldpath</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">path</span><span class="Identifier VarSuffix TableKey Token LF">
</span><span class="Identifier VarSuffix TableKey Token SPACE">  </span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">path</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">s</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">err</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">require</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;no-such-file&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">s</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">find</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">err</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;package.path&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">path</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">oldpath</span><span class="Identifier Token Variable LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Token String STR">&quot;testing &#x27;require&#x27; message&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">oldpath</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">path</span><span class="Identifier VarSuffix TableKey Token LF">
</span><span class="Identifier VarSuffix TableKey Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">oldcpath</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">cpath</span><span class="Identifier VarSuffix TableKey Token LF">
</span><span class="Identifier VarSuffix TableKey Token SPACE">  </span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">path</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;?.lua;?/?&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">cpath</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;?.so;?/init&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">st</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">msg</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">require</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;XXX&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">expected</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">[[module &#x27;XXX&#x27; not found:
    no field package.preload[&#x27;XXX&#x27;]
    no file &#x27;XXX.lua&#x27;
    no file &#x27;XXX/XXX&#x27;
    no file &#x27;XXX.so&#x27;
    no file &#x27;XXX/init&#x27;]]</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">msg</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">expected</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">path</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">oldpath</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">cpath</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">oldcpath</span><span class="Identifier Token Variable LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;+&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- The next tests for &#x27;require&#x27; assume some specific directories and</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- libraries.</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">_port</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token COMMENT">--[</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">dirsep</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">match</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">config</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;^([^</span><span class="String Token Control STR">\n</span><span class="Token String STR">]+)</span><span class="String Token Control STR">\n</span><span class="Token String STR">&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- auxiliary directory with C modules and temporary files</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">DIR</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;libs&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token CONCAT">..</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">dirsep</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable COMMENT">-- prepend DIR to a name and correct directory separators</span><span class="Identifier Token Variable LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">D</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">x</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">gsub</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;/&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">dirsep</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">DIR</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token CONCAT">..</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody COMMENT">-- prepend DIR and pospend proper C lib. extension to a name</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">DC</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">ext</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression BraceDepth-0 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">dirsep</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;</span><span class="String Token Control STR">\\</span><span class="Token String STR">&#x27;</span><span class="Expression BraceDepth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Token String STR">&quot;.dll&quot;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression OR">or</span><span class="Keyword Token Expression SPACE"> </span><span class="Token String STR">&quot;.so&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token CONCAT">..</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">ext</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">createfiles</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">files</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">preextras</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">posextras</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token ID">n</span><span class="Token COMMA">,</span><span class="Identifier Token ID">c</span><span class="Identifier Token SPACE"> </span><span class="Statement Keyword Token IN">in</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pairs</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">files</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">io</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">output</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">io</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">write</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">format</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">preextras</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">io</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">write</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">io</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">write</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">format</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">posextras</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">io</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">close</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">io</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">output</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">removefiles</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">files</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token ID">n</span><span class="Identifier Token SPACE"> </span><span class="Statement Keyword Token IN">in</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pairs</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">files</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">os</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">remove</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">files</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="FieldList BraceDepth-1 Field Token LSQUAR_PAREN">[</span><span class="Token String STR">&quot;names.lua&quot;</span><span class="FieldList BraceDepth-1 Field Token RSQUAR_PAREN">]</span><span class="FieldList Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Token String STR">&quot;do return {...} end</span><span class="String Token Control STR">\n</span><span class="Token String STR">&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">  </span><span class="BraceDepth-1 Field Token LSQUAR_PAREN">[</span><span class="Token String STR">&quot;err.lua&quot;</span><span class="BraceDepth-1 Field Token RSQUAR_PAREN">]</span><span class="Field Token SPACE"> </span><span class="Field Token ASSIGN">=</span><span class="Field Token SPACE"> </span><span class="Token String STR">&quot;B = 15; a = a + 1;&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">  </span><span class="BraceDepth-1 Field Token LSQUAR_PAREN">[</span><span class="Token String STR">&quot;synerr.lua&quot;</span><span class="BraceDepth-1 Field Token RSQUAR_PAREN">]</span><span class="Field Token SPACE"> </span><span class="Field Token ASSIGN">=</span><span class="Field Token SPACE"> </span><span class="Token String STR">&quot;B =&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">  </span><span class="BraceDepth-1 Field Token LSQUAR_PAREN">[</span><span class="Token String STR">&quot;A.lua&quot;</span><span class="BraceDepth-1 Field Token RSQUAR_PAREN">]</span><span class="Field Token SPACE"> </span><span class="Field Token ASSIGN">=</span><span class="Field Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">  </span><span class="BraceDepth-1 Field Token LSQUAR_PAREN">[</span><span class="Token String STR">&quot;B.lua&quot;</span><span class="BraceDepth-1 Field Token RSQUAR_PAREN">]</span><span class="Field Token SPACE"> </span><span class="Field Token ASSIGN">=</span><span class="Field Token SPACE"> </span><span class="Token String STR">&quot;assert(...==&#x27;B&#x27;);require &#x27;A&#x27;&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">  </span><span class="BraceDepth-1 Field Token LSQUAR_PAREN">[</span><span class="Token String STR">&quot;A.lc&quot;</span><span class="BraceDepth-1 Field Token RSQUAR_PAREN">]</span><span class="Field Token SPACE"> </span><span class="Field Token ASSIGN">=</span><span class="Field Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">  </span><span class="BraceDepth-1 Field Token LSQUAR_PAREN">[</span><span class="Token String STR">&quot;A&quot;</span><span class="BraceDepth-1 Field Token RSQUAR_PAREN">]</span><span class="Field Token SPACE"> </span><span class="Field Token ASSIGN">=</span><span class="Field Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">  </span><span class="BraceDepth-1 Field Token LSQUAR_PAREN">[</span><span class="Token String STR">&quot;L&quot;</span><span class="BraceDepth-1 Field Token RSQUAR_PAREN">]</span><span class="Field Token SPACE"> </span><span class="Field Token ASSIGN">=</span><span class="Field Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">  </span><span class="BraceDepth-1 Field Token LSQUAR_PAREN">[</span><span class="Token String STR">&quot;XXxX&quot;</span><span class="BraceDepth-1 Field Token RSQUAR_PAREN">]</span><span class="Field Token SPACE"> </span><span class="Field Token ASSIGN">=</span><span class="Field Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">  </span><span class="BraceDepth-1 Field Token LSQUAR_PAREN">[</span><span class="Token String STR">&quot;C.lua&quot;</span><span class="BraceDepth-1 Field Token RSQUAR_PAREN">]</span><span class="Field Token SPACE"> </span><span class="Field Token ASSIGN">=</span><span class="Field Token SPACE"> </span><span class="Token String STR">&quot;package.loaded[...] = 25; require&#x27;C&#x27;&quot;</span><span class="FieldList Punctuator Token COMMA">,</span><span class="FieldList Punctuator Token LF">
</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token LF">
</span><span class="Identifier Token Variable ID">AA</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">extras</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">[[
NAME = &#x27;</span><span class="Format Token String STR">%s</span><span class="Token String STR">&#x27;
REQUIRED = ...
return AA]]</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">createfiles</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">files</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">extras</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- testing explicit &quot;dir&quot; separator in &#x27;searchpath&#x27;</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">searchpath</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;C.lua&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Token String STR">&quot;?&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Token String STR">&quot;C.lua&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">searchpath</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;C.lua&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Token String STR">&quot;?&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;.&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;.&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Token String STR">&quot;C.lua&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">searchpath</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;--x-&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Token String STR">&quot;?&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;-&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;X&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Token String STR">&quot;XXxX&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">searchpath</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;---xX&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Token String STR">&quot;?&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;---&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;XX&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Token String STR">&quot;XXxX&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">searchpath</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Token String STR">&quot;C.lua&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;?&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">dirsep</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Token String STR">&quot;C.lua&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">searchpath</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;.</span><span class="String Token Control STR">\\</span><span class="Token String STR">C.lua&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Token String STR">&quot;?&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;</span><span class="String Token Control STR">\\</span><span class="Token String STR">&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Token String STR">&quot;./C.lua&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">oldpath</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">path</span><span class="Identifier VarSuffix TableKey Token LF">
</span><span class="Identifier VarSuffix TableKey Token LF">
</span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">path</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">gsub</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;D/?.lua;D/?.lc;D/?;D/??x?;D/L&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;D/&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">DIR</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName FunctionName Token ID">try</span><span class="Identifier AttributeName FunctionName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">p</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">n</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">r</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">ext</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">  </span><span class="Identifier Token Variable ID">NAME</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">rr</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">x</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">p</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">NAME</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">REQUIRED</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">rr</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">r</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">ext</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;names&quot;</span><span class="Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;names&quot;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Token String STR">&quot;names.lua&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">st</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">msg</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">require</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;err&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">st</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">find</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;arithmetic&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">B</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">15</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">st</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">msg</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">require</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;synerr&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">st</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">find</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;error loading module&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">searchpath</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;C&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">path</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Token String STR">&quot;C.lua&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;C&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">25</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;C&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">25</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">AA</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">try</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;B&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;B.lua&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;libs/B.lua&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">loaded</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">B</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;B&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression TRUE">true</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">loaded</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">A</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;C&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">25</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">loaded</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">A</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">try</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;B&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">   </span><span class="VarSuffix Token Argument COMMENT">-- should not reload package</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">try</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;A&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;A.lua&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;libs/A.lua&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">loaded</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">A</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Identifier Token Variable ID">os</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">remove</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Token String STR">&#x27;A.lua&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">AA</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">try</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;A&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;A.lc&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">AA</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;libs/A.lc&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- now must find second option</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">searchpath</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;A&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">path</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Token String STR">&quot;A.lc&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;A&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">AA</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">AA</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FALSE">false</span><span class="Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">try</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;K&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;L&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token FALSE">false</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;libs/L&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">     </span><span class="VarSuffix Token Argument COMMENT">-- default option</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">try</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;K&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;L&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token FALSE">false</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;libs/L&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">     </span><span class="VarSuffix Token Argument COMMENT">-- default option (should reload it)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">rawget</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">_G</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;_REQUIREDNAME&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">AA</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;x&quot;</span><span class="Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">try</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;X&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;XXxX&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">AA</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;libs/XXxX&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">removefiles</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">files</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">NAME</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">REQUIRED</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">AA</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">B</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token LF">
</span><span class="Keyword Token LF">
</span><span class="Keyword Token COMMENT">-- testing require of sub-packages</span><span class="Keyword Token LF">
</span><span class="Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">_G</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">path</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">gsub</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;D/?.lua;D/?/init.lua&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;D/&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">DIR</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">files</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="FieldList BraceDepth-1 Field Token LSQUAR_PAREN">[</span><span class="Token String STR">&quot;P1/init.lua&quot;</span><span class="FieldList BraceDepth-1 Field Token RSQUAR_PAREN">]</span><span class="FieldList Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Token String STR">&quot;AA = 10&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">  </span><span class="BraceDepth-1 Field Token LSQUAR_PAREN">[</span><span class="Token String STR">&quot;P1/xuxu.lua&quot;</span><span class="BraceDepth-1 Field Token RSQUAR_PAREN">]</span><span class="Field Token SPACE"> </span><span class="Field Token ASSIGN">=</span><span class="Field Token SPACE"> </span><span class="Token String STR">&quot;AA = 20&quot;</span><span class="FieldList Punctuator Token COMMA">,</span><span class="FieldList Punctuator Token LF">
</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">createfiles</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">files</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;_ENV = {}</span><span class="String Token Control STR">\n</span><span class="Token String STR">&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;</span><span class="String Token Control STR">\n</span><span class="Token String STR">return _ENV</span><span class="String Token Control STR">\n</span><span class="Token String STR">&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">AA</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Number Token LF">
</span><span class="Number Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">m</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">ext</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;P1&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">ext</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;libs/P1/init.lua&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">AA</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">AA</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;P1&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;P1&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">searchpath</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;P1.xuxu&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">path</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">D</span><span class="Token String STR">&quot;P1/xuxu.lua&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">m</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token ID">xuxu</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">ext</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;P1.xuxu&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">AA</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">xuxu</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">AA</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">20</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">ext</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;libs/P1/xuxu.lua&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;P1.xuxu&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">xuxu</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;P1.xuxu&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">xuxu</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;P1&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">AA</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">removefiles</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">files</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">AA</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token LF">
</span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">path</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">require</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;file_does_not_exist&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">path</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;??\0?&quot;</span><span class="Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">require</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;file_does_not_exist1&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">path</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">oldpath</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable COMMENT">-- check &#x27;require&#x27; error message</span><span class="Identifier Token Variable LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">fname</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;file_does_not_exist2&quot;</span><span class="Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">m</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">err</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">require</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">fname</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token ID">t</span><span class="Identifier Token SPACE"> </span><span class="Statement Keyword Token IN">in</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">gmatch</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">path</span><span class="Expression Punctuator Token CONCAT">..</span><span class="Token String STR">&quot;;&quot;</span><span class="Expression Punctuator Token CONCAT">..</span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">cpath</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;[^;]+&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">gsub</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;?&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">fname</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">find</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">err</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- testing &#x27;package.searchers&#x27; not being a table</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">searchers</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">searchers</span><span class="Identifier VarSuffix TableKey Token LF">
</span><span class="Identifier VarSuffix TableKey Token SPACE">  </span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">searchers</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">st</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">msg</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">require</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;a&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">st</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">find</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;must be a table&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">searchers</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">searchers</span><span class="Identifier Token Variable LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">import</span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Punctuator Token FunctionBody VARARGS">...</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">f</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression Punctuator Token VARARGS">...</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">m</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody COMMENT">-- cannot change environment of a C function</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">module</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;XUXU&#x27;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- testing require of C libraries</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">p</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="Token SPACE">   </span><span class="Token COMMENT">-- On Mac OS X, redefine this to &quot;_&quot;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token COMMENT">-- check whether loadlib works in this system</span><span class="Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">st</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">err</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">when</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">loadlib</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">DC</span><span class="Token String STR">&quot;lib1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;*&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">st</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">f</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">err</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">when</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">loadlib</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;donotexist&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="Expression Punctuator Token CONCAT">..</span><span class="Token String STR">&quot;xuxu&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">err</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;string&quot;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">when</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;absent&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Token SEMI">;</span><span class="BraceDepth-0 Token Variable LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">Message</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Keyword Token FunctionCall Expression OR">or</span><span class="Keyword Token FunctionCall Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="BraceDepth-0 Token Variable RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;</span><span class="String Token Control STR">\n</span><span class="Token String STR"> &gt;&gt;&gt; cannot load dynamic library &lt;&lt;&lt;</span><span class="String Token Control STR">\n</span><span class="Token String STR">&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">err</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">when</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">  </span><span class="ElseStatement Keyword Token COMMENT">-- tests for loadlib</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">f</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">loadlib</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">DC</span><span class="Token String STR">&quot;lib1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="Expression Punctuator Token CONCAT">..</span><span class="Token String STR">&quot;onefunction&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">b</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">15</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">25</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">25</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">15</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">loadlib</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">DC</span><span class="Token String STR">&quot;lib1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="Expression Punctuator Token CONCAT">..</span><span class="Token String STR">&quot;anotherfunc&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;10</span><span class="Format Token String STR">%20</span><span class="String Token Control STR">\n</span><span class="Token String STR">&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- check error messages</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">f</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">err</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">when</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">loadlib</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">DC</span><span class="Token String STR">&quot;lib1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="Expression Punctuator Token CONCAT">..</span><span class="Token String STR">&quot;xuxu&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">err</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;string&quot;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">when</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;init&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">err</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">when</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">loadlib</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;donotexist&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="Expression Punctuator Token CONCAT">..</span><span class="Token String STR">&quot;xuxu&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">err</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;string&quot;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">when</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;open&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- symbols from &#x27;lib1&#x27; must be visible to other libraries</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">loadlib</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">DC</span><span class="Token String STR">&quot;lib11&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="Expression Punctuator Token CONCAT">..</span><span class="Token String STR">&quot;luaopen_lib11&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;exported&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- test C modules with prefixes in names</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">cpath</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">DC</span><span class="Token String STR">&quot;?&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">lib2</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">ext</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;lib2-v2&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">find</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">ext</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;libs/lib2-v2&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- check correct access to global environment and correct</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- parameters</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">_ENV</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">x</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;lib2-v2&quot;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">_ENV</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">y</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">DC</span><span class="Token String STR">&quot;lib2-v2&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">lib2</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">id</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;x&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression TRUE">true</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">   </span><span class="VarSuffix Token Argument COMMENT">-- a different &quot;id&quot; implementation</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- test C submodules</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">fs</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">ext</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;lib1.sub&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">_ENV</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">x</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;lib1.sub&quot;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">_ENV</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">y</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">DC</span><span class="Token String STR">&quot;lib1&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">find</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">ext</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;libs/lib1&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">fs</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">id</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">45</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">45</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">_ENV</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">_ENV</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token ID">y</span><span class="Identifier VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier Token Variable ID">_ENV</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable COMMENT">-- testing preload</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">p</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">package</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable ID">package</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="Identifier Token Variable ID">p</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">preload</span><span class="VarSuffix Token DOT">.</span><span class="TableKey VarSuffix Identifier Token FunctionName ID">pl</span><span class="TableKey VarSuffix Identifier Token FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Punctuator Token FunctionBody VARARGS">...</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">_ENV</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression Punctuator Token VARARGS">...</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionName FuncName Token ID">xuxu</span><span class="Identifier FunctionName FuncName Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Expression Punctuator Token PLUS">+</span><span class="Number Expression Token NUMBER">20</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">_ENV</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">pl</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">ext</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;pl&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;pl&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">pl</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">pl</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">xuxu</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">10</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">30</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">pl</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;pl&quot;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">pl</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;:preload:&quot;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">ext</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;:preload:&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">package</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">p</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">path</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;string&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;+&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">--]</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;testing assignments, logical operators, and constructors&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">res</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">res2</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">27</span><span class="Number Token LF">
</span><span class="Number Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">b</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Number Punctuator Token PLUS">+</span><span class="Number Token NUMBER">3</span><span class="Number Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">5</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Statement Token ASSIGN">=</span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">f</span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">11</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">12</span><span class="Number Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">x</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">2</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Expression Punctuator Token PLUS">+</span><span class="Number Expression Token NUMBER">3</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;x&#x27;</span><span class="Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">10</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">13</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;x&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName FunctionName Token ID">f</span><span class="Identifier AttributeName FunctionName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">n</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">x</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Statement Token ASSIGN">=</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">                         </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">table</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">unpack</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">b</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">c</span><span class="Identifier AttributeName Token LF">
</span><span class="Identifier AttributeName Token SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Token COMMA">,</span><span class="Number Token NUMBER">5</span><span class="Token COMMA">,</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">4</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">0</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">5</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Token COMMA">,</span><span class="Number Token NUMBER">5</span><span class="Token COMMA">,</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">0</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">5</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Expression Punctuator Token EQ">==</span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">b</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">c</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">d</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Number Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Number Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Number Token SPACE"> </span><span class="Number Keyword Token OR">or</span><span class="Number Keyword Token SPACE"> </span><span class="Number Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression BraceDepth-0 Token Variable LPAREN">(</span><span class="Number Token Variable NUMBER">1</span><span class="Number Token Variable SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Keyword Token Variable NIL">nil</span><span class="Keyword Token Variable SPACE"> </span><span class="Keyword Token OR">or</span><span class="Keyword Token SPACE"> </span><span class="Number Keyword Token NUMBER">1</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression BraceDepth-0 Token Variable RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">6</span><span class="Number Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">6</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="Number Token LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">10</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">11</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">12</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Expression Punctuator Token EQ">==</span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">10</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Expression BraceDepth-1 Punctuator Token LANGLE_BRACE">&lt;</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression FALSE">false</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Expression BraceDepth-1 Punctuator Token RANGLE_BRACE">&gt;</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression TRUE">true</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Number Token Variable NUMBER">10</span><span class="Number Token Variable SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Number Token Variable NUMBER">10</span><span class="Number Token Variable SPACE"> </span><span class="Number Keyword Token OR">or</span><span class="Number Keyword Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Number Token Variable NUMBER">10</span><span class="Number Token Variable SPACE"> </span><span class="Number Keyword Token OR">or</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Keyword Token NIL">nil</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Keyword Token Variable NIL">nil</span><span class="Keyword Token Variable SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Keyword Token NIL">nil</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Keyword Token Variable NIL">nil</span><span class="Keyword Token Variable SPACE"> </span><span class="Keyword Token OR">or</span><span class="Keyword Token SPACE"> </span><span class="Token String STR">&quot;alo&quot;</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;alo&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Keyword Token Variable NIL">nil</span><span class="Keyword Token Variable SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Number Keyword Token NUMBER">10</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Keyword Token Variable FALSE">false</span><span class="Keyword Token Variable SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Number Keyword Token NUMBER">10</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression FALSE">false</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Keyword Token Variable TRUE">true</span><span class="Keyword Token Variable SPACE"> </span><span class="Keyword Token OR">or</span><span class="Keyword Token SPACE"> </span><span class="Number Keyword Token NUMBER">10</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression TRUE">true</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Keyword Token Variable FALSE">false</span><span class="Keyword Token Variable SPACE"> </span><span class="Keyword Token OR">or</span><span class="Keyword Token SPACE"> </span><span class="Number Keyword Token NUMBER">10</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token FALSE">false</span><span class="Keyword Token SPACE"> </span><span class="Keyword Punctuator Token NORE">~=</span><span class="Keyword Punctuator Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token NIL">nil</span><span class="Keyword Token SPACE"> </span><span class="Keyword Punctuator Token NORE">~=</span><span class="Keyword Punctuator Token SPACE"> </span><span class="Keyword Token FALSE">false</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Punctuator Token EQ">==</span><span class="Keyword Punctuator Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Punctuator Token EQ">==</span><span class="Keyword Punctuator Token SPACE"> </span><span class="Keyword Token FALSE">false</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token EQ">==</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Keyword Token TRUE">true</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression TRUE">true</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Number Token Variable NUMBER">6</span><span class="Number Token Variable SPACE"> </span><span class="Number Keyword Token OR">or</span><span class="Number Keyword Token SPACE"> </span><span class="Number Keyword Token NIL">nil</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression TRUE">true</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Keyword Token Variable NIL">nil</span><span class="Keyword Token Variable SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Number Keyword Token NUMBER">56</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression FALSE">false</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Keyword Token Variable NIL">nil</span><span class="Keyword Token Variable SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression FALSE">false</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token EQ">==</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Keyword Token FALSE">false</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Expression TableConstructor Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression FALSE">false</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Number Expression Token NUMBER">0.5</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token EQ">==</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Keyword Token FALSE">false</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Token String STR">&quot;x&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression FALSE">false</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Expression TableConstructor Token SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;+&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Keyword VarSuffix Token TRUE">true</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="Number Token LF">
</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Keyword VarSuffix Token FALSE">false</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Number Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="Number BraceDepth-2 Punctuator Token LANGLE_BRACE">&lt;</span><span class="Number Token NUMBER">2</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">20</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="Number BraceDepth-2 Punctuator Token RANGLE_BRACE">&gt;</span><span class="Number Token NUMBER">2</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionName FuncName Token ID">f</span><span class="Statement BraceDepth-2 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Statement BraceDepth-2 Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-2 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-2 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">3000</span><span class="Statement Token COMMA">,</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">3000</span><span class="Statement Token COMMA">,</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0.0</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">10e30</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;alo&quot;</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Keyword VarSuffix Token TRUE">true</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Keyword VarSuffix Token FALSE">false</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="Number Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">10e30</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;alo&#x27;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">20</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">10</span><span class="Number BraceDepth-1 Punctuator Token LANGLE_BRACE">&lt;</span><span class="Number Token NUMBER">20</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">3000</span><span class="Statement Token COMMA">,</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">3000</span><span class="Statement Token COMMA">,</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">print</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">assert</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">print</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">print</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">f</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">print</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Keyword VarSuffix Token NIL">nil</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Number Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="FieldList BraceDepth-1 Field Token LSQUAR_PAREN">[</span><span class="Keyword Field Token NIL">nil</span><span class="FieldList BraceDepth-1 Field Token RSQUAR_PAREN">]</span><span class="FieldList Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Number Field Token NUMBER">10</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Keyword VarSuffix Token NIL">nil</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">undef</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">b</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">c</span><span class="Identifier AttributeName Token LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Number Field Token NUMBER">10</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">9</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">8</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">7</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">6</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">5</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">4</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">2</span><span class="Punctuator Token SEMI">;</span><span class="Punctuator Token SPACE"> </span><span class="Field Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">3</span><span class="Field Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Field Token ASSIGN">=</span><span class="Token String STR">&#x27;a&#x27;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Field Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">f</span><span class="Field Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Field Token ASSIGN">=</span><span class="Identifier Token Variable ID">print</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Identifier Field Token ID">a</span><span class="Field Token ASSIGN">=</span><span class="Token String STR">&#x27;a&#x27;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Identifier Field Token ID">b</span><span class="Field Token ASSIGN">=</span><span class="Token String STR">&#x27;ab&#x27;</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token ID">y</span><span class="Identifier VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">3</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">10</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">3</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="Expression Punctuator Token EQ">==</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">a</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">f</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="Expression Punctuator Token EQ">==</span><span class="Identifier Token Variable ID">print</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">x</span><span class="Expression Punctuator Token EQ">==</span><span class="Token String STR">&#x27;a&#x27;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">y</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="FieldList BraceDepth-2 Field Token LSQUAR_PAREN">[</span><span class="Token String STR">&#x27;alo&#x27;</span><span class="FieldList BraceDepth-2 Field Token RSQUAR_PAREN">]</span><span class="FieldList Field Token ASSIGN">=</span><span class="Identifier Token Variable ID">assert</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">6</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">23</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Number Token LF">
</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">alo</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">2</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">10</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">10</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Expression Punctuator Token EQ">==</span><span class="Identifier Token Variable ID">print</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">aVeryLongName012345678901234567890123456789012345678901234567890123456789</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Number Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">foo</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Statement BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">aVeryLongName012345678901234567890123456789012345678901234567890123456789</span><span class="Identifier VarSuffix TableKey Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">foo</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token LF">
</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">aVeryLongName012345678901234567890123456789012345678901234567890123456789</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token LF">
</span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- _ENV constant</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">foo</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Statement BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">_ENV</span><span class="Identifier AttributeName Token SPACE"> </span><span class="AttributeName Attribute Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier AttributeType Attribute Token ID">const</span><span class="AttributeName Attribute Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Attribute Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">11</span><span class="Number Token LF">
</span><span class="Number Token SPACE">    </span><span class="Identifier Token Variable ID">X</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;hi&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">st</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">msg</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">foo</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">st</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">find</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;number&quot;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- test of large float/integer indices</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- compute maximum integer where all bits fit in a float</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">maxint</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">maxinteger</span><span class="Identifier VarSuffix TableKey Token LF">
</span><span class="Identifier VarSuffix TableKey Token LF">
</span><span class="Identifier VarSuffix TableKey Token COMMENT">-- trim (if needed) to fit in a float</span><span class="Identifier VarSuffix TableKey Token LF">
</span><span class="Statement Keyword Token WHILE">while</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">maxint</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">maxint</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0.0</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Keyword Token Expression OR">or</span><span class="Keyword Token Expression SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">maxint</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">maxint</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1.0</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">maxint</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">maxint</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token DOUBLE_DIV">//</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="Number Expression Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">maxintF</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">maxint</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0.0</span><span class="Number Expression Token SPACE">   </span><span class="Number Expression Token COMMENT">-- float version</span><span class="Number Expression Token LF">
</span><span class="Number Expression Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">maxintF</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">maxint</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">type</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">maxintF</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;float&quot;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression LF">
</span><span class="Keyword Token Expression SPACE">       </span><span class="Identifier Token Variable ID">maxintF</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token GE">&gt;=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2.0</span><span class="Number Punctuator Token CARET">^</span><span class="Number Token NUMBER">14</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- floats and integers must index the same places</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">maxintF</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">maxintF</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1.0</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">11</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Expression Punctuator Token MINUS">-</span><span class="Identifier Token Variable ID">maxintF</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">12</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Expression Punctuator Token MINUS">-</span><span class="Identifier Token Variable ID">maxintF</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1.0</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">13</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">maxint</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">maxint</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">11</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token LF">
</span><span class="Number Keyword Token SPACE">       </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Expression Punctuator Token MINUS">-</span><span class="Identifier Token Variable ID">maxint</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">12</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Expression Punctuator Token MINUS">-</span><span class="Identifier Token Variable ID">maxint</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">13</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">maxint</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="Number Token LF">
</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Expression Punctuator Token MINUS">-</span><span class="Identifier Token Variable ID">maxint</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">22</span><span class="Number Token LF">
</span><span class="Number Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">maxintF</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">20</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">maxintF</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1.0</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">11</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token LF">
</span><span class="Number Keyword Token SPACE">       </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Expression Punctuator Token MINUS">-</span><span class="Identifier Token Variable ID">maxintF</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">22</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Expression Punctuator Token MINUS">-</span><span class="Identifier Token Variable ID">maxintF</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1.0</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">13</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token LF">
</span><span class="Keyword Token LF">
</span><span class="Keyword Token COMMENT">-- test conflicts in multiple assignment</span><span class="Keyword Token LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">i</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">j</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">b</span><span class="Identifier AttributeName Token LF">
</span><span class="Identifier AttributeName Token SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Token String STR">&#x27;a&#x27;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;b&#x27;</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">1</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">j</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">2</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Statement Token ASSIGN">=</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">j</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">j</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Expression Punctuator Token PLUS">+</span><span class="Identifier Token Variable ID">j</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">j</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">j</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">j</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">2</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token LF">
</span><span class="Number Keyword Token SPACE">         </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">3</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">foo</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Statement BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Token FunctionBody COMMENT">-- assigining to upvalues</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">foo</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">20</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">x</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- repeat test with upvalues</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">i</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">j</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">b</span><span class="Identifier AttributeName Token LF">
</span><span class="Identifier AttributeName Token SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Token String STR">&#x27;a&#x27;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;b&#x27;</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">1</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">j</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">2</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Statement Token ASSIGN">=</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">foo</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Statement BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">j</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">j</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Expression Punctuator Token PLUS">+</span><span class="Identifier Token Variable ID">j</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">j</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">j</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">foo</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">j</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">2</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token LF">
</span><span class="Number Keyword Token SPACE">         </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">3</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">t</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="BraceDepth-1 Token Variable LPAREN">(</span><span class="Keyword FunctionDefinition Token FunctionCall FUNCTION">function</span><span class="Keyword FunctionDefinition Token FunctionCall SPACE"> </span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="Identifier FunctionCall Token ID">a</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number FunctionCall Token NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number FunctionCall Token NUMBER">20</span><span class="Number FunctionCall Token SPACE">  </span><span class="Keyword FunctionCall Token FunctionBody END">end</span><span class="BraceDepth-1 Token Variable RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- bug in 5.2 beta</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">foo</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Statement BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token LF">
</span><span class="Identifier AttributeName Token SPACE">  </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">b</span><span class="Identifier AttributeName Token LF">
</span><span class="Identifier AttributeName Token SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">14</span><span class="Number Token SPACE">    </span><span class="Number Token COMMENT">-- local and upvalue have same index</span><span class="Number Token LF">
</span><span class="Number Token SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">b</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">14</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;OK&#x27;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">res</span></code></pre><h2 id="h2-8"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/8.lua" target="_blank">8.lua</a></h2><pre class="language-lua"><code><span class="Token COMMENT">-- $Id: testes/big.lua $</span><span class="Token LF">
</span><span class="Token COMMENT">-- See Copyright Notice in file all.lua</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">_soft</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Token String STR">&#x27;a&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Token String STR">&quot;testing large tables&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">debug</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&quot;debug&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">lim</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Number Punctuator Token CARET">^</span><span class="Number Token NUMBER">18</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token PLUS">+</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">1000</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">prog</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token SPACE"> </span><span class="Token String STR">&quot;local y = {0&quot;</span><span class="Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;}</span><span class="String Token Control STR">\n</span><span class="Token String STR">&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;X = y</span><span class="String Token Control STR">\n</span><span class="Token String STR">&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression BraceDepth-0 Token Variable LPAREN">(</span><span class="Token String STR">&quot;assert(X[</span><span class="Format Token String STR">%d</span><span class="Token String STR">] == </span><span class="Format Token String STR">%d</span><span class="Token String STR">)&quot;</span><span class="Expression BraceDepth-0 Token Variable RPAREN">)</span><span class="VarSuffix Token COLON">:</span><span class="Identifier VarSuffix Token FunctionCall ID">format</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;return 0&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">table</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">concat</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;;&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">env</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Identifier Field Token ID">string</span><span class="Identifier Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Identifier Field Token ID">assert</span><span class="Identifier Field Token SPACE"> </span><span class="Field Token ASSIGN">=</span><span class="Field Token SPACE"> </span><span class="Identifier Token Variable ID">assert</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">f</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">env</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">env</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">X</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">lim</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">env</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">X</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">lim</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token ID">k</span><span class="Identifier Token SPACE"> </span><span class="Statement Keyword Token IN">in</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pairs</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">env</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">env</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">k</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">undef</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- yields during accesses larger than K (in RK)</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">env</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Identifier Field Token ID">__index</span><span class="Identifier Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="Identifier Token ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">n</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Identifier Token Variable ID">coroutine</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">yield</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&#x27;g&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">n</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">    </span><span class="Identifier Field Token ID">__newindex</span><span class="Identifier Field Token SPACE"> </span><span class="Field Token ASSIGN">=</span><span class="Field Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="Identifier Token ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">n</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">v</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Identifier Token Variable ID">coroutine</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">yield</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&#x27;s&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">n</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">v</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="FieldList Punctuator Token COMMA">,</span><span class="FieldList Punctuator Token LF">
</span><span class="FieldList Punctuator Token SPACE">  </span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">X</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">co</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">coroutine</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">wrap</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">co</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;s&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">co</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;g&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">co</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;g&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">co</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">X</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">lim</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">X</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">lim</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">lim</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- errors in accesses larger than K (in RK)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">getmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">env</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token DOT">.</span><span class="TableKey VarSuffix Identifier Token FunctionName ID">__index</span><span class="TableKey VarSuffix Identifier Token FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier Token Variable ID">getmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">env</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token DOT">.</span><span class="TableKey VarSuffix Identifier Token FunctionName ID">__newindex</span><span class="TableKey VarSuffix Identifier Token FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">e</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">m</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">e</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="VarSuffix Token COLON">:</span><span class="Identifier VarSuffix Token FunctionCall ID">find</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;global &#x27;X&#x27;&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- errors in metamethods</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">getmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">env</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token DOT">.</span><span class="TableKey VarSuffix Identifier Token FunctionName ID">__newindex</span><span class="TableKey VarSuffix Identifier Token FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">error</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;hi&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">e</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">m</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">xpcall</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">traceback</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">e</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="VarSuffix Token COLON">:</span><span class="Identifier VarSuffix Token FunctionCall ID">find</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;&#x27;newindex&#x27;&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">X</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">coroutine</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">yield</span><span class="Token String STR">&#x27;b&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Number Statement Token NUMBER">2</span><span class="Number Punctuator Token CARET">^</span><span class="Number Token NUMBER">32</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token EQ">==</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- (small integers) {</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Token String STR">&quot;testing string length overflow&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">repstrings</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">192</span><span class="Number Token SPACE">          </span><span class="Number Token COMMENT">-- number of strings to be concatenated</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">ssize</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">ceil</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">2.0</span><span class="Number Punctuator Token CARET">^</span><span class="Number Token NUMBER">32</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token DIV">/</span><span class="Number Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">repstrings</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE">   </span><span class="Number Expression Token COMMENT">-- size of each string</span><span class="Number Expression Token LF">
</span><span class="Number Expression Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">repstrings</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MUL">*</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">ssize</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression BraceDepth-1 Punctuator Token RANGLE_BRACE">&gt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2.0</span><span class="Number Punctuator Token CARET">^</span><span class="Number Token NUMBER">32</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- it should be larger than maximum size</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">longs</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">rep</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;\0&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">ssize</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">   </span><span class="VarSuffix Token Argument COMMENT">-- create one long string</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- create function to concatenate &#x27;repstrings&#x27; copies of its argument</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">rep</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Token String STR">&quot;local a = ...; return &quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token CONCAT">..</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">rep</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&quot;a&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">repstrings</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;..&quot;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">b</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">rep</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">longs</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">   </span><span class="VarSuffix Token Argument COMMENT">-- call that function</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- it should fail without creating string (result would be too large)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">find</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;overflow&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- }</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Token String STR">&#x27;OK&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Token String STR">&#x27;a&#x27;</span></code></pre><h2 id="h2-9"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/9.lua" target="_blank">9.lua</a></h2><pre class="language-lua"><code><span class="Token COMMENT">-- $Id: testes/bitwise.lua $</span><span class="Token LF">
</span><span class="Token COMMENT">-- See Copyright Notice in file all.lua</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;testing bitwise operations&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Token String STR">&quot;bwcoercion&quot;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">numbits</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">packsize</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;j&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token MUL">*</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">8</span><span class="Number Expression Token LF">
</span><span class="Number Expression Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token TILDE">~</span><span class="Number Expression Token NUMBER">0</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token EQ">==</span><span class="Number Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Number Token Variable NUMBER">1</span><span class="Number Token Variable SPACE"> </span><span class="Number Punctuator Token SHL">&lt;&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">numbits</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">mininteger</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- basic tests for bitwise operators;</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- use variables to avoid constant folding</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">b</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">c</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">d</span><span class="Identifier AttributeName Token LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0xFFFFFFFFFFFFFFFF</span><span class="Number Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token EQ">==</span><span class="Number Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">35</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token EQ">==</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">35</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0xF0F0F0F0F0F0F0F0</span><span class="Number Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PIPE">|</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token EQ">==</span><span class="Number Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token TILDE">~</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token TILDE">~</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token EQ">==</span><span class="Number Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token TILDE">~</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token TILDE">~</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token SHR">&gt;&gt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">4</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token EQ">==</span><span class="Number Punctuator Token SPACE"> </span><span class="Expression Punctuator Token TILDE">~</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0xF0</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0xCC</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0xAA</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0xFD</span><span class="Number Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PIPE">|</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token TILDE">~</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xF4</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0xF0.0</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0xCC.0</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;0xAA.0&quot;</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;0xFD.0&quot;</span><span class="Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PIPE">|</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token TILDE">~</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xF4</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0xF0000000</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0xCC000000</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0xAA000000</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0xFD000000</span><span class="Number Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PIPE">|</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token TILDE">~</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xF4000000</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token TILDE">~</span><span class="Expression Punctuator Token TILDE">~</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Expression Punctuator Token TILDE">~</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token TILDE">~</span><span class="Number Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token TILDE">~</span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token SHL">&lt;&lt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">32</span><span class="Number Expression Token LF">
</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token SHL">&lt;&lt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">32</span><span class="Number Expression Token LF">
</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token SHL">&lt;&lt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">32</span><span class="Number Expression Token LF">
</span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token SHL">&lt;&lt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">32</span><span class="Number Expression Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PIPE">|</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token TILDE">~</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xF4000000</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token SHL">&lt;&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">32</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token TILDE">~</span><span class="Expression Punctuator Token TILDE">~</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Expression Punctuator Token TILDE">~</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token TILDE">~</span><span class="Number Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token TILDE">~</span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- constant folding</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">code</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">format</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;return -1 &gt;&gt; </span><span class="Format Token String STR">%d</span><span class="Token String STR">&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">maxinteger</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">code</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">code</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">format</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;return -1 &gt;&gt; </span><span class="Format Token String STR">%d</span><span class="Token String STR">&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">mininteger</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">code</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">code</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">format</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;return -1 &lt;&lt; </span><span class="Format Token String STR">%d</span><span class="Token String STR">&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">maxinteger</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">code</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">code</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">format</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;return -1 &lt;&lt; </span><span class="Format Token String STR">%d</span><span class="Token String STR">&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">mininteger</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">code</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token SHR">&gt;&gt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token EQ">==</span><span class="Number Punctuator Token SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Number Token Variable NUMBER">1</span><span class="Number Token Variable SPACE"> </span><span class="Number Punctuator Token SHL">&lt;&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">numbits</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token SHL">&lt;&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">31</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token EQ">==</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">0x80000000</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token SHR">&gt;&gt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">numbits</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token SHR">&gt;&gt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">numbits</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token LF">
</span><span class="Number Keyword Token SPACE">       </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token SHR">&gt;&gt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Identifier Token Variable ID">numbits</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token LF">
</span><span class="Number Keyword Token SPACE">       </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token SHL">&lt;&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">numbits</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token LF">
</span><span class="Number Keyword Token SPACE">       </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token SHL">&lt;&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Identifier Token Variable ID">numbits</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">1</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token SHR">&gt;&gt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">mininteger</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">1</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token SHR">&gt;&gt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">maxinteger</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">1</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token SHL">&lt;&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">mininteger</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">1</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token SHL">&lt;&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">maxinteger</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Number Token Variable NUMBER">2</span><span class="Number Punctuator Token CARET">^</span><span class="Number Token NUMBER">30</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token MINUS">-</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token SHL">&lt;&lt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="Number Punctuator Token CARET">^</span><span class="Number Token NUMBER">30</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token EQ">==</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Number Token Variable NUMBER">2</span><span class="Number Punctuator Token CARET">^</span><span class="Number Token NUMBER">30</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token MINUS">-</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token SHR">&gt;&gt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="Number Punctuator Token CARET">^</span><span class="Number Token NUMBER">30</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token EQ">==</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">1</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token SHR">&gt;&gt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">3</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token EQ">==</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token SHL">&lt;&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Number Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Number Token NUMBER">1000</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token SHR">&gt;&gt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">5</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token EQ">==</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">1000</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token SHL">&lt;&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">5</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- coercion from strings to integers</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;0xffffffffffffffff&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token PIPE">|</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token EQ">==</span><span class="Number Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;0xfffffffffffffffe&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;-1&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">2</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot; </span><span class="String Token Control STR">\t</span><span class="Token String STR">-0xfffffffffffffffe</span><span class="String Token Control STR">\n</span><span class="String Token Control STR">\t</span><span class="Token String STR">&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;-1&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;   </span><span class="String Token Control STR">\n</span><span class="Token String STR">  -45  </span><span class="String Token Control STR">\t</span><span class="Token String STR"> &quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token SHR">&gt;&gt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;  -2  &quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">45</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token MUL">*</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;1234.0&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token SHL">&lt;&lt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;5.0&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1234</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token MUL">*</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">32</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;0xffff.0&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token TILDE">~</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;0xAAAA&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0x5555</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token TILDE">~</span><span class="Token String STR">&quot;0x0.000p4&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Token String STR">&quot;7&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token CONCAT">..</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token SHL">&lt;&lt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token EQ">==</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">146</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0xffffffff</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token SHR">&gt;&gt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Number Token Variable NUMBER">1</span><span class="Number Token Variable SPACE"> </span><span class="Number Punctuator Token CONCAT">..</span><span class="Number Punctuator Token SPACE"> </span><span class="Token String STR">&quot;9&quot;</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0x1fff</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">10</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token PIPE">|</span><span class="Number Punctuator Token SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Number Token Variable NUMBER">1</span><span class="Number Token Variable SPACE"> </span><span class="Number Punctuator Token CONCAT">..</span><span class="Number Punctuator Token SPACE"> </span><span class="Token String STR">&quot;9&quot;</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">27</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">st</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">msg</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token AMPERSAND">&amp;</span><span class="Number Punctuator Token SPACE"> </span><span class="Token String STR">&quot;a&quot;</span><span class="Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">find</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;&#x27;band&#x27;&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">st</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">msg</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression Punctuator Token TILDE">~</span><span class="Token String STR">&quot;a&quot;</span><span class="Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">find</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;&#x27;bnot&#x27;&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- out of range number</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Token String STR">&quot;0xffffffffffffffff.0&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token PIPE">|</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- embedded zeros</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Token String STR">&quot;0xffffffffffffffff\0&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token PIPE">|</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Token String STR">&#x27;+&#x27;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Identifier Token Variable ID">package</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">preload</span><span class="VarSuffix Token DOT">.</span><span class="TableKey VarSuffix Identifier Token FunctionName ID">bit32</span><span class="TableKey VarSuffix Identifier Token FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE">     </span><span class="FunctionDefinition Token FunctionBody COMMENT">--{</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody COMMENT">-- no built-in &#x27;bit32&#x27; library: implement it using bitwise operators</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">bit</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FuncName Token ID">bit</span><span class="Statement FuncName Token DOT">.</span><span class="Identifier FunctionName FuncName Token ID">bnot</span><span class="Identifier FunctionName FuncName Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression Punctuator Token TILDE">~</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xFFFFFFFF</span><span class="Number Expression Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody COMMENT">--</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody COMMENT">-- in all vararg functions, avoid creating &#x27;arg&#x27; table when there are</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody COMMENT">-- only 2 (or less) parameters, as 2 parameters is the common case</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody COMMENT">--</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FuncName Token ID">bit</span><span class="Statement FuncName Token DOT">.</span><span class="Identifier FunctionName FuncName Token ID">band</span><span class="Identifier FunctionName FuncName Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">z</span><span class="FunctionBody Token ParameterList COMMA">,</span><span class="FunctionBody Token ParameterList SPACE"> </span><span class="Punctuator Token ParameterList VARARGS">...</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">z</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression BraceDepth-0 Token Variable LPAREN">(</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression OR">or</span><span class="Keyword Token Expression SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression OR">or</span><span class="Keyword Token Expression SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression BraceDepth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xFFFFFFFF</span><span class="Number Expression Token LF">
</span><span class="Number Expression Token SPACE">  </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">arg</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression Punctuator Token VARARGS">...</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">res</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">z</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">arg</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">arg</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xFFFFFFFF</span><span class="Number Expression Token LF">
</span><span class="Number Expression Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FuncName Token ID">bit</span><span class="Statement FuncName Token DOT">.</span><span class="Identifier FunctionName FuncName Token ID">bor</span><span class="Identifier FunctionName FuncName Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">z</span><span class="FunctionBody Token ParameterList COMMA">,</span><span class="FunctionBody Token ParameterList SPACE"> </span><span class="Punctuator Token ParameterList VARARGS">...</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">z</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression BraceDepth-0 Token Variable LPAREN">(</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression OR">or</span><span class="Keyword Token Expression SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token PIPE">|</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression OR">or</span><span class="Keyword Token Expression SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression BraceDepth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xFFFFFFFF</span><span class="Number Expression Token LF">
</span><span class="Number Expression Token SPACE">  </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">arg</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression Punctuator Token VARARGS">...</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">res</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PIPE">|</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PIPE">|</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">z</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">arg</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PIPE">|</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">arg</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xFFFFFFFF</span><span class="Number Expression Token LF">
</span><span class="Number Expression Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FuncName Token ID">bit</span><span class="Statement FuncName Token DOT">.</span><span class="Identifier FunctionName FuncName Token ID">bxor</span><span class="Identifier FunctionName FuncName Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">z</span><span class="FunctionBody Token ParameterList COMMA">,</span><span class="FunctionBody Token ParameterList SPACE"> </span><span class="Punctuator Token ParameterList VARARGS">...</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">z</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression BraceDepth-0 Token Variable LPAREN">(</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression OR">or</span><span class="Keyword Token Expression SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token TILDE">~</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression OR">or</span><span class="Keyword Token Expression SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression BraceDepth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xFFFFFFFF</span><span class="Number Expression Token LF">
</span><span class="Number Expression Token SPACE">  </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">arg</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression Punctuator Token VARARGS">...</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">res</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token TILDE">~</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token TILDE">~</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">z</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">arg</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token TILDE">~</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">arg</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xFFFFFFFF</span><span class="Number Expression Token LF">
</span><span class="Number Expression Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FuncName Token ID">bit</span><span class="Statement FuncName Token DOT">.</span><span class="Identifier FunctionName FuncName Token ID">btest</span><span class="Identifier FunctionName FuncName Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Punctuator Token FunctionBody VARARGS">...</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">bit</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">band</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token VARARGS">...</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="Number Expression Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FuncName Token ID">bit</span><span class="Statement FuncName Token DOT">.</span><span class="Identifier FunctionName FuncName Token ID">lshift</span><span class="Identifier FunctionName FuncName Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">b</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression BraceDepth-0 Token Variable LPAREN">(</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xFFFFFFFF</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token SHL">&lt;&lt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression BraceDepth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xFFFFFFFF</span><span class="Number Expression Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FuncName Token ID">bit</span><span class="Statement FuncName Token DOT">.</span><span class="Identifier FunctionName FuncName Token ID">rshift</span><span class="Identifier FunctionName FuncName Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">b</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression BraceDepth-0 Token Variable LPAREN">(</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xFFFFFFFF</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token SHR">&gt;&gt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression BraceDepth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xFFFFFFFF</span><span class="Number Expression Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FuncName Token ID">bit</span><span class="Statement FuncName Token DOT">.</span><span class="Identifier FunctionName FuncName Token ID">arshift</span><span class="Identifier FunctionName FuncName Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">b</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xFFFFFFFF</span><span class="Number Expression Token LF">
</span><span class="Number Expression Token SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token LE">&lt;=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token OR">or</span><span class="Number Keyword Token SPACE"> </span><span class="Expression BraceDepth-0 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0x80000000</span><span class="Expression BraceDepth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression BraceDepth-0 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token SHR">&gt;&gt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression BraceDepth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xFFFFFFFF</span><span class="Number Expression Token LF">
</span><span class="Number Expression Token SPACE">  </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression BraceDepth-0 Token Variable LPAREN">(</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token SHR">&gt;&gt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token PIPE">|</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token TILDE">~</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Number Token Variable NUMBER">0xFFFFFFFF</span><span class="Number Token Variable SPACE"> </span><span class="Number Punctuator Token SHR">&gt;&gt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression BraceDepth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xFFFFFFFF</span><span class="Number Expression Token LF">
</span><span class="Number Expression Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FuncName Token ID">bit</span><span class="Statement FuncName Token DOT">.</span><span class="Identifier FunctionName FuncName Token ID">lrotate</span><span class="Identifier FunctionName FuncName Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Identifier Token SPACE"> </span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">31</span><span class="Number Expression Token LF">
</span><span class="Number Expression Token SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xFFFFFFFF</span><span class="Number Expression Token LF">
</span><span class="Number Expression Token SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression BraceDepth-0 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token SHL">&lt;&lt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression BraceDepth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token PIPE">|</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression BraceDepth-0 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token SHR">&gt;&gt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Number Token Variable NUMBER">32</span><span class="Number Token Variable SPACE"> </span><span class="Number Punctuator Token MINUS">-</span><span class="Number Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression BraceDepth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">  </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xFFFFFFFF</span><span class="Number Expression Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FuncName Token ID">bit</span><span class="Statement FuncName Token DOT">.</span><span class="Identifier FunctionName FuncName Token ID">rrotate</span><span class="Identifier FunctionName FuncName Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">b</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">bit</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">lrotate</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">checkfield</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">w</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Identifier Token Variable ID">w</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">w</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression OR">or</span><span class="Keyword Token Expression SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token LF">
</span><span class="Number Expression Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token GE">&gt;=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;field cannot be negative&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">w</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression BraceDepth-1 Punctuator Token RANGLE_BRACE">&gt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;width must be positive&quot;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">w</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token LE">&lt;=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">32</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;trying to access non-existent bits&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token TILDE">~</span><span class="Expression BraceDepth-0 Token Variable LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token SHL">&lt;&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">w</span><span class="Expression BraceDepth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FuncName Token ID">bit</span><span class="Statement FuncName Token DOT">.</span><span class="Identifier FunctionName FuncName Token ID">extract</span><span class="Identifier FunctionName FuncName Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">w</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">f</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">mask</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">checkfield</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">w</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression BraceDepth-0 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token SHR">&gt;&gt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="Expression BraceDepth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">mask</span><span class="Identifier Token Variable LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FuncName Token ID">bit</span><span class="Statement FuncName Token DOT">.</span><span class="Identifier FunctionName FuncName Token ID">replace</span><span class="Identifier FunctionName FuncName Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">v</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">w</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">f</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">mask</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">checkfield</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">w</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">v</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">v</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">mask</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression BraceDepth-0 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token TILDE">~</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">mask</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token SHL">&lt;&lt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression BraceDepth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token PIPE">|</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression BraceDepth-0 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">v</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token SHL">&lt;&lt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">f</span><span class="Expression BraceDepth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">  </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xFFFFFFFF</span><span class="Number Expression Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">bit</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Keyword Token FunctionBody COMMENT">--}</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;testing bitwise library&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">bit32</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&#x27;bit32&#x27;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">band</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">bnot</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">btest</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression TRUE">true</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">bor</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">bxor</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">band</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">band</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0xffffffff</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">band</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Number Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- out-of-range numbers</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">band</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xffffffff</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">band</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Number Token Variable NUMBER">1</span><span class="Number Token Variable SPACE"> </span><span class="Number Punctuator Token SHL">&lt;&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">33</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xffffffff</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">band</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Number Token Variable NUMBER">1</span><span class="Number Token Variable SPACE"> </span><span class="Number Punctuator Token SHL">&lt;&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">33</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xffffffff</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">band</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Number Token Variable NUMBER">1</span><span class="Number Token Variable SPACE"> </span><span class="Number Punctuator Token SHL">&lt;&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">33</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">band</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Number Token Variable NUMBER">1</span><span class="Number Token Variable SPACE"> </span><span class="Number Punctuator Token SHL">&lt;&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">33</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">band</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Number Token Variable NUMBER">1</span><span class="Number Token Variable SPACE"> </span><span class="Number Punctuator Token SHL">&lt;&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">40</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">band</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">1</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token SHL">&lt;&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">40</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">band</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Number Token Variable NUMBER">1</span><span class="Number Token Variable SPACE"> </span><span class="Number Punctuator Token SHL">&lt;&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">40</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xfffffffe</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">band</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Number Token Variable NUMBER">1</span><span class="Number Token Variable SPACE"> </span><span class="Number Punctuator Token SHL">&lt;&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">40</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">4</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xfffffffc</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">lrotate</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">lrotate</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">7</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">lrotate</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0x12345678</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">lrotate</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">32</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0x12345678</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">lrotate</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0x23456781</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">rrotate</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">4</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0x23456781</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">lrotate</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">8</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0x78123456</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">rrotate</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">8</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0x78123456</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">lrotate</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0xaaaaaaaa</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xaaaaaaaa</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">lrotate</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0xaaaaaaaa</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xaaaaaaaa</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">50</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">50</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">lrotate</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x89abcdef</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">lrotate</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x89abcdef</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Expression Punctuator Token MOD">%</span><span class="Number Expression Token NUMBER">32</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">lshift</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0x23456780</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">lshift</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">8</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0x34567800</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">lshift</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">4</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0x01234567</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">lshift</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">8</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0x00123456</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">lshift</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">32</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">lshift</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">32</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">rshift</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0x01234567</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">rshift</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">8</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0x00123456</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">rshift</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">32</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">rshift</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">32</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">arshift</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0x12345678</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">arshift</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0x12345678</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token DOUBLE_DIV">//</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">arshift</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0x12345678</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token MUL">*</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">arshift</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xffffffff</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">arshift</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">24</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xffffffff</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">arshift</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">32</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xffffffff</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">arshift</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">band</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token MUL">*</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0xffffffff</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x12345678</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token SHL">&lt;&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token EQ">==</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">0x123456780</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x12345678</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token SHL">&lt;&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">8</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token EQ">==</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">0x1234567800</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x12345678</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token SHL">&lt;&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">4</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token EQ">==</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">0x01234567</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x12345678</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token SHL">&lt;&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">8</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token EQ">==</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">0x00123456</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x12345678</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token SHL">&lt;&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">32</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token EQ">==</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">0x1234567800000000</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x12345678</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token SHL">&lt;&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">32</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token EQ">==</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x12345678</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token SHR">&gt;&gt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token EQ">==</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">0x01234567</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x12345678</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token SHR">&gt;&gt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">8</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token EQ">==</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">0x00123456</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x12345678</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token SHR">&gt;&gt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">32</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token EQ">==</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x12345678</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token SHR">&gt;&gt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">32</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token EQ">==</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">0x1234567800000000</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;+&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- some special cases</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">c</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Number Field Token NUMBER">0</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">1</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">10</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">0x80000000</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">0xaaaaaaaa</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">0x55555555</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">           </span><span class="Number Field Token NUMBER">0xffffffff</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">0x7fffffff</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token ID">_</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">b</span><span class="Identifier Token SPACE"> </span><span class="Statement Keyword Token IN">in</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pairs</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">band</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">band</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">band</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">btest</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">band</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">band</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token TILDE">~</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">btest</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">band</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">bnot</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">bor</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">bnot</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">bnot</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">bor</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">bor</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">bor</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">bor</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token TILDE">~</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xffffffff</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">bxor</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">bxor</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">bxor</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">bxor</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">bxor</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">bnot</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">bnot</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">bnot</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">bnot</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Number Token Variable NUMBER">1</span><span class="Number Token Variable SPACE"> </span><span class="Number Punctuator Token SHL">&lt;&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">32</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token MINUS">-</span><span class="Number Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">lrotate</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">32</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">rrotate</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">32</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">lshift</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">lshift</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">4</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">band</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">bnot</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Number Token NUMBER">0xf</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">rshift</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">rshift</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">4</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">band</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">bnot</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Number Token NUMBER">0xf</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- for this test, use at most 24 bits (mantissa of a single float)</span><span class="Statement Keyword Token LF">
</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Number Field Token NUMBER">0</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">1</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">10</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">0x800000</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">0xaaaaaa</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">0x555555</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">0xffffff</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">0x7fffff</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token ID">_</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">b</span><span class="Identifier Token SPACE"> </span><span class="Statement Keyword Token IN">in</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pairs</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">40</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">40</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">x</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">lshift</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">y</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">floor</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">fmod</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MUL">*</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2.0</span><span class="Number Punctuator Token CARET">^</span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2.0</span><span class="Number Punctuator Token CARET">^</span><span class="Number Token NUMBER">32</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">fmod</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2.0</span><span class="Number Punctuator Token CARET">^</span><span class="Number Token NUMBER">32</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">band</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-2 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-2 RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">bnot</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;a&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">lshift</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">45</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">lshift</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">45</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">rshift</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">45</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;+&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- testing extract/replace</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">extract</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">8</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">extract</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">7</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">extract</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0xa0001111</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">28</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xa</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">extract</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0xa0001111</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">31</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">extract</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x50000111</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">31</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">extract</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0xf2345679</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">32</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xf2345679</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">extract</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">extract</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">32</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">extract</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">33</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">extract</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">31</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">replace</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">5</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">28</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0x52345678</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">replace</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0x12345678</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0x87654321</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">32</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0x87654321</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">replace</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="Number Punctuator Token CARET">^</span><span class="Number Token NUMBER">2</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">replace</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="Number Punctuator Token CARET">^</span><span class="Number Token NUMBER">4</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">replace</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">31</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Number Token Variable NUMBER">1</span><span class="Number Token Variable SPACE"> </span><span class="Number Punctuator Token SHL">&lt;&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">31</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">replace</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Number Token Variable NUMBER">1</span><span class="Number Token Variable SPACE"> </span><span class="Number Punctuator Token SHL">&lt;&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">32</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">7</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- testing conversion of floats</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">bor</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">3.0</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">bor</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">4.0</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xfffffffc</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- large floats and large-enough integers?</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Number Statement Token NUMBER">2.0</span><span class="Number Punctuator Token CARET">^</span><span class="Number Token NUMBER">50</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">2.0</span><span class="Number Punctuator Token CARET">^</span><span class="Number Token NUMBER">50</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token PLUS">+</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">1.0</span><span class="Number Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Number Token NUMBER">2.0</span><span class="Number Punctuator Token CARET">^</span><span class="Number Token NUMBER">50</span><span class="Number Token SPACE"> </span><span class="Number BraceDepth-1 Punctuator Token LANGLE_BRACE">&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token SHR">&gt;&gt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">bor</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">2.0</span><span class="Number Punctuator Token CARET">^</span><span class="Number Token NUMBER">32</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token MINUS">-</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">5.0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xfffffffb</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">bor</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">2.0</span><span class="Number Punctuator Token CARET">^</span><span class="Number Token NUMBER">32</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token MINUS">-</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">6.0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xfffffffa</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">bor</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">2.0</span><span class="Number Punctuator Token CARET">^</span><span class="Number Token NUMBER">48</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token MINUS">-</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">5.0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xfffffffb</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">bit32</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">bor</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">2.0</span><span class="Number Punctuator Token CARET">^</span><span class="Number Token NUMBER">48</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token MINUS">-</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">6.0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0xfffffffa</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Token String STR">&#x27;OK&#x27;</span></code></pre><h2 id="h2-10"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/10.lua" target="_blank">10.lua</a></h2><pre class="language-lua"><code><span class="Token COMMENT">-- BUG: built in function 无法识别</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">tonumber</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">tointeger</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">tonumber</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">tointeger</span><span class="Identifier VarSuffix TableKey Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">type</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">getmetatable</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">rawget</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">error</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">type</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">getmetatable</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">rawget</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">error</span><span class="Identifier Token Variable LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">strsub</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">sub</span><span class="Identifier VarSuffix TableKey Token LF">
</span><span class="Identifier VarSuffix TableKey Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">print</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable ID">_ENV</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token LF">
</span><span class="Keyword Token COMMENT">-- Try to convert a value to an integer, without assuming any coercion.</span><span class="Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">toint</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">tonumber</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">   </span><span class="VarSuffix Token Argument COMMENT">-- handle numerical strings</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Keyword Token FALSE">false</span><span class="Keyword Token SPACE">    </span><span class="Keyword Token COMMENT">-- not coercible to a number</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">tointeger</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody COMMENT">-- If operation fails, maybe second operand has a metamethod that should</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody COMMENT">-- have been called if not for this string metamethod, so try to</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody COMMENT">-- call it.</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">trymt</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">mtname</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">y</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;string&quot;</span><span class="Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token COMMENT">-- avoid recalling original metamethod</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">mt</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">getmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">y</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">mm</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">mt</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">rawget</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">mt</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">mtname</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">mm</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">mm</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- if any test fails, there is no other metamethod to be called</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">error</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;attempt to &#x27;&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token CONCAT">..</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">strsub</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">mtname</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token CONCAT">..</span><span class="Expression Punctuator Token LF">
</span><span class="Expression Punctuator Token SPACE">        </span><span class="Token String STR">&quot;&#x27; a &quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token CONCAT">..</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token CONCAT">..</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot; with a &quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token CONCAT">..</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">y</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">checkargs</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">mtname</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">xi</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">toint</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">yi</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">toint</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">y</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">xi</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">yi</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">xi</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">yi</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">trymt</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">mtname</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">smt</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">getmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">smt</span><span class="VarSuffix Token DOT">.</span><span class="TableKey VarSuffix Identifier Token FunctionName ID">__band</span><span class="TableKey VarSuffix Identifier Token FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">x</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">y</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">checkargs</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;__band&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression OR">or</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier Token Variable ID">smt</span><span class="VarSuffix Token DOT">.</span><span class="TableKey VarSuffix Identifier Token FunctionName ID">__bor</span><span class="TableKey VarSuffix Identifier Token FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">x</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">y</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">checkargs</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;__bor&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PIPE">|</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression OR">or</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier Token Variable ID">smt</span><span class="VarSuffix Token DOT">.</span><span class="TableKey VarSuffix Identifier Token FunctionName ID">__bxor</span><span class="TableKey VarSuffix Identifier Token FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">x</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">y</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">checkargs</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;__bxor&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token TILDE">~</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression OR">or</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier Token Variable ID">smt</span><span class="VarSuffix Token DOT">.</span><span class="TableKey VarSuffix Identifier Token FunctionName ID">__shl</span><span class="TableKey VarSuffix Identifier Token FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">x</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">y</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">checkargs</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;__shl&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token SHL">&lt;&lt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression OR">or</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier Token Variable ID">smt</span><span class="VarSuffix Token DOT">.</span><span class="TableKey VarSuffix Identifier Token FunctionName ID">__shr</span><span class="TableKey VarSuffix Identifier Token FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">x</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">y</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">checkargs</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;__shr&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token SHR">&gt;&gt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression OR">or</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier Token Variable ID">smt</span><span class="VarSuffix Token DOT">.</span><span class="TableKey VarSuffix Identifier Token FunctionName ID">__bnot</span><span class="TableKey VarSuffix Identifier Token FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">x</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">y</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">checkargs</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;__bnot&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Expression Punctuator Token TILDE">~</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression OR">or</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable LF">
</span><span class="Keyword Token FunctionBody END">end</span></code></pre><h2 id="h2-11"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/11.lua" target="_blank">11.lua</a></h2><pre class="language-lua"><code><span class="Token COMMENT">-- $Id: testes/calls.lua $</span><span class="Token LF">
</span><span class="Token COMMENT">-- See Copyright Notice in file all.lua</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;testing functions and calls&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">debug</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Token String STR">&quot;debug&quot;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token COMMENT">-- get the opportunity to test &#x27;type&#x27; too ;)</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">1</span><span class="Number BraceDepth-2 Punctuator Token LANGLE_BRACE">&lt;</span><span class="Number Token NUMBER">2</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;boolean&#x27;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token TRUE">true</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;boolean&#x27;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token FALSE">false</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;boolean&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;nil&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">   </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">3</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;number&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">   </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="Token String STR">&#x27;x&#x27;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;string&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">   </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="TableConstructor BraceDepth-0 Token Argument LCURLY_BRACE">{</span><span class="TableConstructor BraceDepth-0 Token Argument RCURLY_BRACE">}</span><span class="TableConstructor Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;table&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">   </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">type</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;function&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">f</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement BraceDepth-2 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Statement BraceDepth-2 Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token COLON">:</span><span class="Identifier VarSuffix Token FunctionCall ID">x</span><span class="Identifier VarSuffix Token FunctionCall SPACE"> </span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;function&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">type</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- testing local-function recursion</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">fact</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FALSE">false</span><span class="Keyword Token LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">res</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">fact</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement BraceDepth-2 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">n</span><span class="Statement BraceDepth-2 Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">0</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">res</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Expression Punctuator Token MUL">*</span><span class="Identifier FunctionCall Token Variable ID">fact</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">fact</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">5</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">120</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">fact</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression FALSE">false</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">fact</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token LF">
</span><span class="Keyword Token COMMENT">-- testing declarations</span><span class="Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-2 LCURLY_BRACE">{</span><span class="Identifier Field Token ID">i</span><span class="Identifier Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Number Field Token NUMBER">10</span><span class="Expression TableConstructor Token BraceDepth-2 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">self</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="Number Token LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionName FuncName Token ID">a</span><span class="Statement FuncName Token COLON">:</span><span class="Identifier FuncName Token ID">x</span><span class="Identifier FuncName Token SPACE"> </span><span class="Statement BraceDepth-2 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Statement BraceDepth-2 Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Expression Punctuator Token PLUS">+</span><span class="Identifier Token Variable ID">self</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">i</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FuncName Token ID">a</span><span class="Statement FuncName Token DOT">.</span><span class="Identifier FunctionName FuncName Token ID">y</span><span class="Identifier FunctionName FuncName Token SPACE"> </span><span class="Statement BraceDepth-2 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Statement BraceDepth-2 Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Expression Punctuator Token PLUS">+</span><span class="Identifier Token Variable ID">self</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token COLON">:</span><span class="Identifier VarSuffix Token FunctionCall ID">x</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Expression Punctuator Token PLUS">+</span><span class="Number Expression Token NUMBER">10</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token EQ">==</span><span class="Number Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">y</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">t</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-2 LCURLY_BRACE">{</span><span class="Identifier Field Token ID">i</span><span class="FieldList Field Token ASSIGN">=</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">100</span><span class="Expression TableConstructor Token BraceDepth-2 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Token String STR">&quot;t&quot;</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token DOT">.</span><span class="TableKey VarSuffix Identifier Token FunctionName ID">x</span><span class="TableKey VarSuffix Identifier Token FunctionName SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="Identifier Token ID">self</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">self</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">i</span><span class="Expression Punctuator Token PLUS">+</span><span class="Identifier Token Variable ID">a</span><span class="Expression Punctuator Token PLUS">+</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">t</span><span class="VarSuffix Token COLON">:</span><span class="Identifier VarSuffix Token FunctionCall ID">x</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Number Token NUMBER">3</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">95</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">x</span><span class="FieldList Field Token ASSIGN">=</span><span class="Number Field Token NUMBER">0</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionName FuncName Token ID">a</span><span class="Statement FuncName Token COLON">:</span><span class="Identifier FuncName Token ID">add</span><span class="Identifier FuncName Token SPACE"> </span><span class="Statement BraceDepth-2 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Statement BraceDepth-2 Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Identifier Token Variable ID">self</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token ID">y</span><span class="Identifier VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">self</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">x</span><span class="Expression Punctuator Token PLUS">+</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">self</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token COLON">:</span><span class="Identifier VarSuffix Token FunctionCall ID">add</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token COLON">:</span><span class="Identifier VarSuffix Token FunctionCall ID">add</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">20</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token COLON">:</span><span class="Identifier VarSuffix Token FunctionCall ID">add</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">30</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">x</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">60</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">y</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">20</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-2 LCURLY_BRACE">{</span><span class="Identifier Field Token ID">b</span><span class="FieldList Field Token ASSIGN">=</span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Identifier Field Token ID">c</span><span class="FieldList Field Token ASSIGN">=</span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token BraceDepth-2 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FuncName Token ID">a</span><span class="Statement FuncName Token DOT">.</span><span class="Identifier FuncName Token ID">b</span><span class="Statement FuncName Token DOT">.</span><span class="Identifier FuncName Token ID">c</span><span class="Statement FuncName Token DOT">.</span><span class="Identifier FunctionName FuncName Token ID">f1</span><span class="Identifier FunctionName FuncName Token SPACE"> </span><span class="Statement BraceDepth-2 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Statement BraceDepth-2 Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Expression Punctuator Token PLUS">+</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FuncName Token ID">a</span><span class="Statement FuncName Token DOT">.</span><span class="Identifier FuncName Token ID">b</span><span class="Statement FuncName Token DOT">.</span><span class="Identifier FunctionName FuncName Token ID">c</span><span class="Statement FuncName Token COLON">:</span><span class="Identifier FuncName Token ID">f2</span><span class="Identifier FuncName Token SPACE"> </span><span class="Statement BraceDepth-2 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Identifier Token ID">y</span><span class="Statement BraceDepth-2 Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Identifier Token Variable ID">self</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">b</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">c</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">f1</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">4</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">5</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">b</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">c</span><span class="VarSuffix Token COLON">:</span><span class="Identifier VarSuffix Token FunctionCall ID">f2</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&#x27;k&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">12</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">b</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">c</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">k</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">12</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&#x27;+&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token SPACE">   </span><span class="Keyword Token COMMENT">-- &#x27;declare&#x27; t</span><span class="Keyword Token LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionName FuncName Token ID">f</span><span class="Statement BraceDepth-2 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token ID">c</span><span class="Statement BraceDepth-2 Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">d</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&#x27;a&#x27;</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Statement Token ASSIGN">=</span><span class="Expression TableConstructor Token BraceDepth-2 LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">a</span><span class="Punctuator Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Punctuator Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Punctuator Token COMMA">,</span><span class="Identifier Token Variable ID">d</span><span class="Expression TableConstructor Token BraceDepth-2 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="VarSuffix Token Argument SPACE">      </span><span class="VarSuffix Token Argument COMMENT">-- this line change must be valid</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Number Token NUMBER">2</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">2</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">3</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">4</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;a&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE">   </span><span class="Token COMMENT">-- this one too</span><span class="Token LF">
</span><span class="Token SPACE">      </span><span class="Number Token NUMBER">3</span><span class="Token COMMA">,</span><span class="Number Token NUMBER">4</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">2</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">3</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">4</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;a&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token SPACE">   </span><span class="Keyword Token COMMENT">-- delete &#x27;t&#x27;</span><span class="Keyword Token LF">
</span><span class="Keyword Token LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionName FuncName Token ID">fat</span><span class="Statement BraceDepth-2 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Statement BraceDepth-2 Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token LE">&lt;=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Expression Punctuator Token MUL">*</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&quot;return fat(&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token CONCAT">..</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token CONCAT">..</span><span class="Number Punctuator Token SPACE"> </span><span class="Token String STR">&quot;)&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Token String STR">&quot;load &#x27;assert(fat(6)==720)&#x27; () &quot;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&#x27;return fat(5), 3&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">b</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">120</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">fat</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&#x27;+&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">err_on_n</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement BraceDepth-2 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">n</span><span class="Statement BraceDepth-2 Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">0</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">error</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">exit</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Number Token NUMBER">1</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">err_on_n</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">exit</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Number Token NUMBER">1</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">dummy</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement BraceDepth-2 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">n</span><span class="Statement BraceDepth-2 Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token BraceDepth-2 RANGLE_BRACE">&gt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">err_on_n</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">      </span><span class="Identifier FunctionCall Token Variable ID">dummy</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">dummy</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier Token Variable ID">_G</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">deep</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token SPACE">   </span><span class="Keyword Token COMMENT">-- &quot;declaration&quot;  (used by &#x27;all.lua&#x27;)</span><span class="Keyword Token LF">
</span><span class="Keyword Token LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionName FuncName Token ID">deep</span><span class="Identifier FunctionName FuncName Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">n</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Expression Punctuator Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Number Expression Token NUMBER">0</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">deep</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">deep</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">10</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">deep</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">180</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Token String STR">&quot;testing tail calls&quot;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionName FuncName Token ID">deep</span><span class="Identifier FunctionName FuncName Token SPACE"> </span><span class="Statement BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">n</span><span class="Statement BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Expression BraceDepth-1 Punctuator Token RANGLE_BRACE">&gt;</span><span class="Number Expression Token NUMBER">0</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">deep</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">101</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">deep</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">30000</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">101</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-2 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-2 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionName FuncName Token ID">a</span><span class="Statement FuncName Token COLON">:</span><span class="Identifier FuncName Token ID">deep</span><span class="Identifier FuncName Token SPACE"> </span><span class="Statement BraceDepth-2 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">n</span><span class="Statement BraceDepth-2 Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Expression Punctuator Token BraceDepth-2 RANGLE_BRACE">&gt;</span><span class="Number Expression Token NUMBER">0</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">self</span><span class="VarSuffix Token COLON">:</span><span class="Identifier VarSuffix Token FunctionCall ID">deep</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">101</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token COLON">:</span><span class="Identifier VarSuffix Token FunctionCall ID">deep</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">30000</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">101</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- tail calls x varargs</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">foo</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionBody Token ParameterList COMMA">,</span><span class="FunctionBody Token ParameterList SPACE"> </span><span class="Punctuator Token ParameterList VARARGS">...</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression Punctuator Token VARARGS">...</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">2</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">foo1</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">b</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">c</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo1</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">2</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">2</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- tail calls x metamethods</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">t</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">__call</span><span class="Identifier Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Identifier Token Variable ID">foo</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">foo2</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">t</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo2</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">100</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">100</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression BraceDepth-0 Token Variable LPAREN">(</span><span class="Keyword FunctionDefinition Token FunctionCall FUNCTION">function</span><span class="Keyword FunctionDefinition Token FunctionCall SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token FunctionCall RETURN">return</span><span class="ReturnStatment Keyword Token FunctionCall SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Keyword FunctionCall Token FunctionBody END">end</span><span class="Expression BraceDepth-0 Token Variable RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">X</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">Y</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">A</span><span class="Identifier AttributeName Token LF">
</span><span class="Identifier AttributeName Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">foo</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="FunctionBody Token ParameterList COMMA">,</span><span class="FunctionBody Token ParameterList SPACE"> </span><span class="Punctuator Token ParameterList VARARGS">...</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Identifier Token Variable ID">X</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">Y</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression Punctuator Token VARARGS">...</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">foo1</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Punctuator Token FunctionBody VARARGS">...</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token VARARGS">...</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">b</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">c</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo1</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">X</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">Y</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo1</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">X</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">Y</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo1</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">X</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">Y</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">20</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo1</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">30</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">X</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">Y</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">20</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">A</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">30</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- C-stack overflow while handling C-stack overflow</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">loop</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">loop</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">err</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">msg</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">xpcall</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">loop</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">loop</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">err</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">find</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;error&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- tail calls x chain of __call</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">n</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">10000</span><span class="Number Token SPACE">   </span><span class="Number Token COMMENT">-- depth</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">foo</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">1023</span><span class="Number Token LF">
</span><span class="Number Token SPACE">    </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Keyword Token FunctionBody COMMENT">-- build a chain of __call metamethods ending in function &#x27;foo&#x27;</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">100</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">foo</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">__call</span><span class="Identifier Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Identifier Token Variable ID">foo</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- call the first one as a tail call in a new coroutine</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- (to ensure stack is not preallocated)</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">coroutine</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">wrap</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1023</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;+&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- testing chains of &#x27;__call&#x27;</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">N</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">u</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">table</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">pack</span><span class="Identifier VarSuffix TableKey Token LF">
</span><span class="Identifier VarSuffix TableKey Token SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">N</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">u</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">i</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">__call</span><span class="Identifier Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Identifier Token Variable ID">u</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">Res</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">u</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;a&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;b&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;c&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">Res</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">n</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">N</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">N</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">Res</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">Res</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">N</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;a&quot;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">Res</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">N</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;b&quot;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">Res</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">N</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;c&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="BraceDepth-0 Token Variable LPAREN">(</span><span class="Keyword FunctionDefinition Token FunctionCall FUNCTION">function</span><span class="Keyword FunctionDefinition Token FunctionCall SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier FunctionCall Token ID">x</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="Statement Token ASSIGN">=</span><span class="Identifier FunctionCall Token Variable ID">x</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Keyword FunctionCall Token FunctionBody END">end</span><span class="BraceDepth-0 Token Variable RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">23</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">23</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Keyword FunctionDefinition Token FunctionCall FUNCTION">function</span><span class="Keyword FunctionDefinition Token FunctionCall SPACE"> </span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="Identifier FunctionCall Token ID">x</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token FunctionCall RETURN">return</span><span class="ReturnStatment Keyword Token FunctionCall SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">x</span><span class="Expression Punctuator Token FunctionCall MUL">*</span><span class="Number Expression Token FunctionCall NUMBER">2</span><span class="Number Expression Token FunctionCall SPACE"> </span><span class="Keyword FunctionCall Token FunctionBody END">end</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">20</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">40</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- testing closures</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- fixed-point operator</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName FunctionName Token ID">Z</span><span class="Identifier AttributeName FunctionName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">le</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">      </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">a</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">f</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">        </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">le</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">      </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">      </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody COMMENT">-- non-recursive factorial</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName FunctionName Token ID">F</span><span class="Identifier AttributeName FunctionName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">f</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">      </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">n</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">               </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Number Token LF">
</span><span class="Number Token SPACE">               </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">n</span><span class="Expression Punctuator Token MUL">*</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">n</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">             </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">fat</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">Z</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">F</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">fat</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">fat</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">4</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">24</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">Z</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">F</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">5</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">5</span><span class="Number Punctuator Token MUL">*</span><span class="Identifier FunctionCall Token Variable ID">Z</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">F</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">4</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">g</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">z</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">f</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token ID">c</span><span class="Token COMMA">,</span><span class="Identifier Token ID">d</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Identifier Token ID">y</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Expression Punctuator Token PLUS">+</span><span class="Identifier Token Variable ID">b</span><span class="Expression Punctuator Token PLUS">+</span><span class="Identifier Token Variable ID">c</span><span class="Expression Punctuator Token PLUS">+</span><span class="Identifier Token Variable ID">d</span><span class="Expression Punctuator Token PLUS">+</span><span class="Identifier Token Variable ID">a</span><span class="Expression Punctuator Token PLUS">+</span><span class="Identifier Token Variable ID">x</span><span class="Expression Punctuator Token PLUS">+</span><span class="Identifier Token Variable ID">y</span><span class="Expression Punctuator Token PLUS">+</span><span class="Identifier Token Variable ID">z</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">z</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">z</span><span class="Expression Punctuator Token PLUS">+</span><span class="Number Expression Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">z</span><span class="Expression Punctuator Token PLUS">+</span><span class="Number Expression Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">z</span><span class="Expression Punctuator Token PLUS">+</span><span class="Number Expression Token NUMBER">3</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">f</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">g</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">9</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">16</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="Number Punctuator Token PLUS">+</span><span class="Number Token NUMBER">11</span><span class="Number Punctuator Token PLUS">+</span><span class="Number Token NUMBER">12</span><span class="Number Punctuator Token PLUS">+</span><span class="Number Token NUMBER">13</span><span class="Number Punctuator Token PLUS">+</span><span class="Number Token NUMBER">10</span><span class="Number Punctuator Token PLUS">+</span><span class="Number Token NUMBER">9</span><span class="Number Punctuator Token PLUS">+</span><span class="Number Token NUMBER">16</span><span class="Number Punctuator Token PLUS">+</span><span class="Number Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;+&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- testing multiple returns</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">unlpack</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">i</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression OR">or</span><span class="Keyword Token Expression SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token LF">
</span><span class="Number Expression Token SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Expression BraceDepth-0 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token LE">&lt;=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">t</span><span class="Expression BraceDepth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">unlpack</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Expression Punctuator Token PLUS">+</span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">equaltab</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">t1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">t2</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">t1</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">t2</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">t1</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t1</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">t2</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName FunctionName Token ID">pack</span><span class="Identifier AttributeName FunctionName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Punctuator Token FunctionBody VARARGS">...</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression BraceDepth-0 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">table</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">pack</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Expression Punctuator Token VARARGS">...</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Expression BraceDepth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">f</span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Number Token NUMBER">30</span><span class="Token COMMA">,</span><span class="Number Token NUMBER">4</span><span class="Number Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">ret2</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">b</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">c</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">d</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">unlpack</span><span class="TableConstructor BraceDepth-0 Token Argument LCURLY_BRACE">{</span><span class="Number Field Token NUMBER">1</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">3</span><span class="TableConstructor BraceDepth-0 Token Argument RCURLY_BRACE">}</span><span class="TableConstructor Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">2</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">3</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Expression Punctuator Token EQ">==</span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Number Field Token NUMBER">1</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">4</span><span class="Punctuator Token COMMA">,</span><span class="Keyword Field Token FALSE">false</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">10</span><span class="Punctuator Token COMMA">,</span><span class="Token String STR">&#x27;alo&#x27;</span><span class="Punctuator Token COMMA">,</span><span class="Keyword Field Token FALSE">false</span><span class="Punctuator Token COMMA">,</span><span class="Identifier Token Variable ID">assert</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">equaltab</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">unlpack</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">equaltab</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">unlpack</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Number Field Token NUMBER">1</span><span class="Punctuator Token COMMA">,</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">ret2</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">ret2</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">2</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Expression Punctuator Token EQ">==</span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">unlpack</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">ret2</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">ret2</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">2</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Expression Punctuator Token EQ">==</span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">unlpack</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">pack</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">ret2</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">ret2</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression Punctuator Token EQ">==</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Expression Punctuator Token EQ">==</span><span class="Keyword Token Expression NIL">nil</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Expression Punctuator Token EQ">==</span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">ret2</span><span class="TableConstructor BraceDepth-0 Token Argument LCURLY_BRACE">{</span><span class="TableConstructor Token Argument SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">unlpack</span><span class="TableConstructor BraceDepth-1 Token Argument LCURLY_BRACE">{</span><span class="Number Field Token NUMBER">1</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">3</span><span class="TableConstructor BraceDepth-1 Token Argument RCURLY_BRACE">}</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">unlpack</span><span class="TableConstructor BraceDepth-1 Token Argument LCURLY_BRACE">{</span><span class="Number Field Token NUMBER">3</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">1</span><span class="TableConstructor BraceDepth-1 Token Argument RCURLY_BRACE">}</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">unlpack</span><span class="TableConstructor BraceDepth-1 Token Argument LCURLY_BRACE">{</span><span class="Token String STR">&quot;a&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token String STR">&quot;b&quot;</span><span class="TableConstructor BraceDepth-1 Token Argument RCURLY_BRACE">}</span><span class="TableConstructor BraceDepth-0 Token Argument RCURLY_BRACE">}</span><span class="TableConstructor Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">3</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;a&quot;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">4</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;b&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- testing calls with &#x27;incorrect&#x27; arguments</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">rawget</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;x&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">rawset</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;x&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">sin</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Number Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">sin</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">table</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">sort</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Number Field Token NUMBER">10</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">9</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">8</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">4</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">19</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">23</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">0</span><span class="Punctuator Token COMMA">,</span><span class="Number Field Token NUMBER">0</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Expression BraceDepth-1 Punctuator Token LANGLE_BRACE">&lt;</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;extra arg&quot;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- test for generic load</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">x</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;-- a comment\0\0\0</span><span class="String Token Control STR">\n</span><span class="Token String STR">  x = 10 + </span><span class="String Token Control STR">\n</span><span class="Token String STR">23; \
     local a = function () x = &#x27;hi&#x27; end; \
     return &#x27;\0&#x27;&quot;</span><span class="Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">read1</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">i</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Identifier Token Variable ID">i</span><span class="Expression Punctuator Token PLUS">+</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token LF">
</span><span class="Number Expression Token SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">sub</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">cannotload</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">find</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">msg</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">read1</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;modname&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;t&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;\0&quot;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">x</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">33</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">getinfo</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">source</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;modname&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- cannot read text in binary mode</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">cannotload</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;attempt to load a text chunk&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">read1</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;modname&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;b&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-2 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-2 RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">cannotload</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;attempt to load a text chunk&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;modname&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;b&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- empty chunk</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- small bug</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">t</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Keyword Field Token NIL">nil</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token String STR">&quot;return &quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token String STR">&quot;3&quot;</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">msg</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">table</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">remove</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">   </span><span class="VarSuffix Token Argument COMMENT">-- should read the empty chunk</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- another small bug (in 5.2.1)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">dump</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Number Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;b&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">type</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;function&quot;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- another bug (in 5.4.0)</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- loading a binary long string interrupted by GC cycles</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">f</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">dump</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Token String STR">&#x27;01234567890123456789012345678901234567890123456789&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">read1</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;01234567890123456789012345678901234567890123456789&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- another bug (since 5.2)</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- corrupted binary dump: list of upvalue names is larger than number</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- of upvalues, overflowing the array of upvalues.</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">code</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">   </span><span class="Token String STR">&quot;\x1b\x4c\x75\x61\x54\x00\x19\x93\x0d\x0a\x1a\x0a\x04\x08\x08\x78\x56\z
    \x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x28\x77\x40\x00\x86\x40\z
    \x74\x65\x6d\x70\x81\x81\x01\x00\x02\x82\x48\x00\x02\x00\xc7\x00\x01\z
    \x00\x80\x80\x80\x82\x00\x00\x80\x81\x82\x78\x80\x82\x81\x86\x40\x74\z
    \x65\x6d\x70&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">code</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">   </span><span class="VarSuffix Token Argument COMMENT">-- segfaults in previous versions</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">dump</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;x = 1; return x&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">read1</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;b&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">x</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">cannotload</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;attempt to load a binary chunk&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">read1</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;t&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">cannotload</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;attempt to load a binary chunk&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;t&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">_G</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">x</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">dump</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- no dump of C functions</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">cannotload</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;unexpected symbol&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">read1</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&quot;*a = 123&quot;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">cannotload</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;unexpected symbol&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;*a = 123&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">cannotload</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;hhi&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">error</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&quot;hhi&quot;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- any value is valid for _ENV</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;return _ENV&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">123</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">123</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- load when _ENV is not first upvalue</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">x</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">XX</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">123</span><span class="Number Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">h</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">y</span><span class="Statement Token ASSIGN">=</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE">   </span><span class="Identifier Token Variable COMMENT">-- use &#x27;x&#x27;, so that it becomes 1st upvalue</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">XX</span><span class="Identifier Token Variable SPACE">   </span><span class="Identifier Token Variable COMMENT">-- global name</span><span class="Identifier Token Variable LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">d</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">dump</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">h</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">d</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;b&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">getupvalue</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;_ENV&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">setupvalue</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">_G</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">x</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">123</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Token String STR">&quot;return XX + ...&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Identifier Field Token ID">XX</span><span class="Identifier Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Number Field Token NUMBER">13</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">4</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">17</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">XX</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token LF">
</span><span class="Keyword Token COMMENT">-- test generic load with nested functions</span><span class="Keyword Token LF">
</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">[[
  return function (x)
    return function (y)
     return function (z)
       return x+y+z
     end
   end
  end
]]</span><span class="Token LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">read1</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;read&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;t&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">3</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">10</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">15</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- repeat the test loading a binary chunk</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">dump</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">read1</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;read&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;b&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">3</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">10</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">15</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- test for dump/undump with upvalues</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">b</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">30</span><span class="Number Token LF">
</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">dump</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;set&quot;</span><span class="Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Number Punctuator Token PLUS">+</span><span class="Identifier Token Variable ID">b</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression Punctuator Token PLUS">+</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">  </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;b&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">x</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">setupvalue</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;hi&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;a&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">x</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;hi&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">setupvalue</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">13</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;b&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">setupvalue</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">   </span><span class="VarSuffix Token Argument COMMENT">-- only 2 upvalues</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">x</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;set&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">x</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">23</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">x</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;set&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">x</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">24</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- test for dump/undump with many upvalues</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">nup</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">200</span><span class="Number Token SPACE">    </span><span class="Number Token COMMENT">-- maximum number of local variables</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">prog</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Token String STR">&quot;local a1&quot;</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">nup</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;, a&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token CONCAT">..</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot; = 1&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">nup</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;, &quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token CONCAT">..</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">sum</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;; return function () return a1&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">nup</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">prog</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot; + a&quot;</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token CONCAT">..</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">sum</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">sum</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot; end&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">table</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">concat</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">f</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">sum</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">f</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">dump</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">   </span><span class="VarSuffix Token Argument COMMENT">-- main chunk now has many upvalues</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName FunctionName Token ID">h</span><span class="Identifier AttributeName FunctionName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">nup</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvaluejoin</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">h</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token MUL">*</span><span class="Number Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">nup</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- test for long method names</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">t</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-2 LCURLY_BRACE">{</span><span class="Identifier Field Token ID">x</span><span class="Identifier Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Number Field Token NUMBER">1</span><span class="Expression TableConstructor Token BraceDepth-2 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionName FuncName Token ID">t</span><span class="Statement FuncName Token COLON">:</span><span class="Identifier FuncName Token ID">_012345678901234567890123456789012345678901234567890123456789</span><span class="Identifier FuncName Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">self</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">x</span><span class="Identifier VarSuffix TableKey Token LF">
</span><span class="Identifier VarSuffix TableKey Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token COLON">:</span><span class="Identifier VarSuffix Token FunctionCall ID">_012345678901234567890123456789012345678901234567890123456789</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- test for bug in parameter adjustment</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Keyword FunctionDefinition Token FunctionCall FUNCTION">function</span><span class="Keyword FunctionDefinition Token FunctionCall SPACE"> </span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token FunctionCall RETURN">return</span><span class="ReturnStatment Keyword Token FunctionCall SPACE"> </span><span class="Keyword Token FunctionCall NIL">nil</span><span class="Keyword Token FunctionCall SPACE"> </span><span class="Keyword FunctionCall Token FunctionBody END">end</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">4</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Keyword FunctionDefinition Token FunctionCall FUNCTION">function</span><span class="Keyword FunctionDefinition Token FunctionCall SPACE"> </span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Statement Keyword Token FunctionCall LOCAL">local</span><span class="Statement Keyword Token FunctionCall SPACE"> </span><span class="Identifier AttributeName Token FunctionCall ID">a</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="ReturnStatment Keyword Token FunctionCall RETURN">return</span><span class="ReturnStatment Keyword Token FunctionCall SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Keyword FunctionCall Token FunctionBody END">end</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">4</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Keyword FunctionDefinition Token FunctionCall FUNCTION">function</span><span class="Keyword FunctionDefinition Token FunctionCall SPACE"> </span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="Identifier FunctionCall Token ID">a</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token FunctionCall RETURN">return</span><span class="ReturnStatment Keyword Token FunctionCall SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Keyword FunctionCall Token FunctionBody END">end</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;testing binary chunks&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">header</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">pack</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;c4BBc6BBB&quot;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&quot;\27Lua&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE">                                  </span><span class="Token COMMENT">-- signature</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Number Token NUMBER">0x54</span><span class="Token COMMA">,</span><span class="Token SPACE">                                      </span><span class="Token COMMENT">-- version 5.4 (0x54)</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Number Token NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE">                                         </span><span class="Token COMMENT">-- format</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&quot;\x19\x93\r</span><span class="String Token Control STR">\n</span><span class="Token String STR">\x1a</span><span class="String Token Control STR">\n</span><span class="Token String STR">&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE">                      </span><span class="Token COMMENT">-- data</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Number Token NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE">                                         </span><span class="Token COMMENT">-- size of instruction</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">packsize</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;j&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE">                      </span><span class="Token COMMENT">-- sizeof(lua integer)</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">packsize</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;n&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">                       </span><span class="VarSuffix Token Argument COMMENT">-- sizeof(lua number)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">c</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">dump</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">b</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName FunctionName Token ID">f</span><span class="Identifier AttributeName FunctionName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">_ENV</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">c</span><span class="ReturnStatment Token Block SEMI">;</span><span class="ReturnStatment Token Block SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Keyword Token FunctionBody COMMENT">-- upvalues</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">s1</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;a constant&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">s2</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;another constant&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MUL">*</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3</span><span class="Number Expression Token LF">
</span><span class="Number Expression Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- check header</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">sub</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">header</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">header</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- check LUAC_INT and LUAC_NUM</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">ci</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">cn</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">unpack</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;jn&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">header</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">ci</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0x5678</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">cn</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">370.5</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- corrupted header</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">header</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">s</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">sub</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token CONCAT">..</span><span class="Expression Punctuator Token LF">
</span><span class="Expression Punctuator Token SPACE">              </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">char</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">byte</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">sub</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token CONCAT">..</span><span class="Expression Punctuator Token LF">
</span><span class="Expression Punctuator Token SPACE">              </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">sub</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">s</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">c</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">s</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- loading truncated binary chunks</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">st</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">msg</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">sub</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">st</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">find</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;truncated&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;OK&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">deep</span></code></pre><h2 id="h2-12"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/12.lua" target="_blank">12.lua</a></h2><pre class="language-lua"><code><span class="Token COMMENT">-- $Id: testes/closure.lua $</span><span class="Token LF">
</span><span class="Token COMMENT">-- See Copyright Notice in file all.lua</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Token String STR">&quot;testing closures&quot;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">A</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">B</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Token COMMA">,</span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Identifier Field Token ID">g</span><span class="FieldList Field Token ASSIGN">=</span><span class="Number Field Token NUMBER">10</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">f</span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Number Token NUMBER">1000</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">y</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Number Token LF">
</span><span class="Number Token SPACE">    </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Identifier Token Variable ID">B</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">g</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">B</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">g</span><span class="Expression Punctuator Token PLUS">+</span><span class="Number Expression Token NUMBER">1</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Expression Punctuator Token PLUS">+</span><span class="Identifier Token Variable ID">x</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Expression Punctuator Token PLUS">+</span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName FunctionName Token ID">dummy</span><span class="Identifier AttributeName FunctionName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">A</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">dummy</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">3</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">B</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">g</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">12</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- force a GC in this level</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">x</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="FieldList BraceDepth-1 Field Token LSQUAR_PAREN">[</span><span class="Number Field Token NUMBER">1</span><span class="FieldList BraceDepth-1 Field Token RSQUAR_PAREN">]</span><span class="FieldList Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token SPACE">   </span><span class="Expression TableConstructor Token COMMENT">-- to detect a GC</span><span class="Expression TableConstructor Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Field Token ID">__mode</span><span class="Identifier Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Token String STR">&#x27;kv&#x27;</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token WHILE">while</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- repeat until GC</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">A</span><span class="Expression Punctuator Token CONCAT">..</span><span class="Identifier Token Variable ID">A</span><span class="Expression Punctuator Token CONCAT">..</span><span class="Identifier Token Variable ID">A</span><span class="Expression Punctuator Token CONCAT">..</span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable COMMENT">-- create garbage</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable ID">A</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">A</span><span class="Expression Punctuator Token PLUS">+</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">20</span><span class="Number Punctuator Token PLUS">+</span><span class="Identifier Token Variable ID">A</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">30</span><span class="Number Punctuator Token PLUS">+</span><span class="Identifier Token Variable ID">A</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="Number Punctuator Token PLUS">+</span><span class="Identifier Token Variable ID">A</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">20</span><span class="Number Punctuator Token PLUS">+</span><span class="Identifier Token Variable ID">A</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">30</span><span class="Number Punctuator Token PLUS">+</span><span class="Identifier Token Variable ID">A</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">3</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">20</span><span class="Number Punctuator Token PLUS">+</span><span class="Identifier Token Variable ID">A</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">8</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="Number Punctuator Token PLUS">+</span><span class="Identifier Token Variable ID">A</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">getmetatable</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">__mode</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;kv&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">B</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">g</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">19</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- testing equality</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">5</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">_ENV</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">3</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">4</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">4</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">5</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName FunctionName Token ID">a</span><span class="Identifier AttributeName FunctionName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE">  </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">sin</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">_ENV</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">x</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">f</span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- testing closures with &#x27;for&#x27; control variable</span><span class="Statement Keyword Token LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Number Token NUMBER">10</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Identifier Field Token ID">set</span><span class="Identifier Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Identifier Field Token ID">get</span><span class="Identifier Field Token SPACE"> </span><span class="Field Token ASSIGN">=</span><span class="Field Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token BREAK">break</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">4</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">undef</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">set</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">get</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">2</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">set</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;a&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">3</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">get</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">get</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;a&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">t</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Token String STR">&quot;a&quot;</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Token String STR">&quot;b&quot;</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">k</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token LF">
</span><span class="VarSuffix Token SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Identifier Field Token ID">set</span><span class="Identifier Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Identifier Token Variable ID">x</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">k</span><span class="Statement Token ASSIGN">=</span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token LF">
</span><span class="Punctuator Token SPACE">          </span><span class="Identifier Field Token ID">get</span><span class="Identifier Field Token SPACE"> </span><span class="Field Token ASSIGN">=</span><span class="Field Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">k</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token BREAK">break</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">set</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">r</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">s</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">2</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">get</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">r</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">s</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;b&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">r</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">s</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">get</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">r</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">s</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">20</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">2</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">set</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;a&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;b&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">r</span><span class="Token COMMA">,</span><span class="Identifier Token Variable ID">s</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">2</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">get</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">r</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;a&quot;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">s</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;b&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- testing closures with &#x27;for&#x27; control variable x break</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">f</span><span class="Identifier AttributeName Token LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Number Token NUMBER">3</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionName Token Variable ID">f</span><span class="Identifier FunctionName Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token BREAK">break</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">k</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">v</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">k</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token LF">
</span><span class="VarSuffix Token SPACE">  </span><span class="Identifier FunctionName Token Variable ID">f</span><span class="Identifier FunctionName Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">k</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">v</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token BREAK">break</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Expression TableConstructor Token BraceDepth-2 LCURLY_BRACE">{</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Expression TableConstructor Token BraceDepth-2 RCURLY_BRACE">}</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Expression TableConstructor Token BraceDepth-2 LCURLY_BRACE">{</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Expression TableConstructor Token BraceDepth-2 RCURLY_BRACE">}</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;a&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- testing closure x break x return x errors</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">b</span><span class="Identifier AttributeName Token LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionName FuncName Token ID">f</span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">first</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Statement Keyword Token WHILE">while</span><span class="Statement Keyword Token SPACE"> </span><span class="Number Statement Token NUMBER">1</span><span class="Number Statement Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">first</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&#x27;xuxu&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Identifier FunctionName Token Variable ID">b</span><span class="Identifier FunctionName Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">op</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">y</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">          </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">op</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;set&#x27;</span><span class="Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">            </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Expression Punctuator Token PLUS">+</span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">          </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">            </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">          </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">        </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token BREAK">break</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Keyword Token ElseIfStatement ELSEIF">elseif</span><span class="Keyword Token ElseIfStatement SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token ElseIfStatement THEN">then</span><span class="Keyword Token ElseIfStatement SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token LF">
</span><span class="ReturnStatment Keyword Token SPACE">    </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">error</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">first</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Number Token NUMBER">3</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;get&#x27;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;xuxu&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;set&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;get&#x27;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="Number Punctuator Token PLUS">+</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;get&#x27;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&#x27;xuxu&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;set&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;get&#x27;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">14</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">y</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">w</span><span class="Identifier AttributeName Token LF">
</span><span class="Identifier AttributeName Token COMMENT">-- testing multi-level closure</span><span class="Identifier AttributeName Token LF">
</span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier FunctionName FuncName Token ID">f</span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">y</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">z</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">w</span><span class="Expression Punctuator Token PLUS">+</span><span class="Identifier Token Variable ID">x</span><span class="Expression Punctuator Token PLUS">+</span><span class="Identifier Token Variable ID">y</span><span class="Expression Punctuator Token PLUS">+</span><span class="Identifier Token Variable ID">z</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">w</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1.345</span><span class="Number Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">y</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">20</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Number Token NUMBER">30</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">60</span><span class="Number Punctuator Token PLUS">+</span><span class="Identifier Token Variable ID">w</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- testing closures x break</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">X</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">Y</span><span class="Identifier AttributeName Token LF">
</span><span class="Identifier AttributeName Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">sin</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token WHILE">while</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">b</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Number Token LF">
</span><span class="Number Token SPACE">    </span><span class="Identifier FunctionName Token Variable ID">X</span><span class="Identifier FunctionName Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody SPACE">   </span><span class="Keyword Token FunctionBody COMMENT">-- closure with upvalue</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token BREAK">break</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">b</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="Number Token LF">
</span><span class="Number Token SPACE">    </span><span class="Identifier FunctionName Token Variable ID">Y</span><span class="Identifier FunctionName Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody SPACE">   </span><span class="Keyword Token FunctionBody COMMENT">-- closure with upvalue</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- upvalues must be different</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">X</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">Y</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">20</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- testing closures x repeat-until</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">i</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Number Token LF">
</span><span class="Statement Keyword Token REPEAT">repeat</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">x</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Expression Punctuator Token PLUS">+</span><span class="Number Expression Token NUMBER">1</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token UNTIL">until</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token OR">or</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">11</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">3</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">4</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- testing closures created in &#x27;then&#x27; and &#x27;else&#x27; parts of &#x27;if&#x27;s</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MOD">%</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token EQ">==</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">y</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Number Token LF">
</span><span class="Number Token SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">t</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Keyword Token ElseIfStatement ELSEIF">elseif</span><span class="Keyword Token ElseIfStatement SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MOD">%</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token EQ">==</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Number Token SPACE"> </span><span class="Keyword Token ElseIfStatement THEN">then</span><span class="Keyword Token ElseIfStatement LF">
</span><span class="Keyword Token ElseIfStatement SPACE">    </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">L1</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">error</span><span class="Token String STR">&#x27;not here&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">L1</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token LF">
</span><span class="Statement Label Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">y</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Number Token LF">
</span><span class="Number Token SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">t</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Keyword Token ElseIfStatement ELSEIF">elseif</span><span class="Keyword Token ElseIfStatement SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MOD">%</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token EQ">==</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Number Token SPACE"> </span><span class="Keyword Token ElseIfStatement THEN">then</span><span class="Keyword Token ElseIfStatement LF">
</span><span class="Keyword Token ElseIfStatement SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">t</span><span class="Identifier AttributeName Token LF">
</span><span class="Identifier AttributeName Token SPACE">    </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l4</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">    </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l4a</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l4b</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">error</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;should never be here!&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l4</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token LF">
</span><span class="Statement Label Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">y</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Number Token LF">
</span><span class="Number Token SPACE">    </span><span class="Identifier FunctionName Token Variable ID">t</span><span class="Identifier FunctionName Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">t</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l4a</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">error</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;should never be here!&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l4b</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token LF">
</span><span class="Statement Label Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MUL">*</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MOD">%</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MUL">*</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Token String STR">&#x27;+&#x27;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token COMMENT">-- test for correctly closing upvalues in tail calls of vararg functions</span><span class="Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">t</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Statement BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">c</span><span class="Statement BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="Statement BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Expression Punctuator Token EQ">==</span><span class="Token String STR">&quot;test&quot;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression Punctuator Token EQ">==</span><span class="Token String STR">&quot;OK&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">v</span><span class="Statement BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">f</span><span class="FunctionBody Token ParameterList COMMA">,</span><span class="FunctionBody Token ParameterList SPACE"> </span><span class="Punctuator Token ParameterList VARARGS">...</span><span class="Statement BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">c</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;test&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Token String STR">&quot;FAILED&quot;</span><span class="Token SPACE"> </span><span class="Keyword Token Expression OR">or</span><span class="Keyword Token Expression SPACE"> </span><span class="Token String STR">&quot;OK&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">x</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">v</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">t</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- test for debug manipulation of upvalues</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">debug</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Token String STR">&#x27;debug&#x27;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">foo1</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">foo2</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">foo3</span><span class="Identifier AttributeName Token LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">b</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">c</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">5</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">7</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Identifier FunctionName Token Variable ID">foo1</span><span class="Identifier FunctionName Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Expression Punctuator Token PLUS">+</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Identifier FunctionName Token Variable ID">foo2</span><span class="Identifier FunctionName Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression Punctuator Token PLUS">+</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Number Token LF">
</span><span class="Number Token SPACE">    </span><span class="Identifier FunctionName Token Variable ID">foo3</span><span class="Identifier FunctionName Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Expression Punctuator Token PLUS">+</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalueid</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalueid</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalueid</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalueid</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalueid</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">foo2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalueid</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalueid</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">foo2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalueid</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">foo3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalueid</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalueid</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">foo3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalueid</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalueid</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">foo3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalueid</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">gmatch</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;x&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;x&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">foo1</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token PLUS">+</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">5</span><span class="Number Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo2</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">5</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token PLUS">+</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvaluejoin</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">foo1</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token PLUS">+</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Number Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo2</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">5</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token PLUS">+</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">foo3</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token PLUS">+</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">5</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvaluejoin</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">foo3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">foo3</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token PLUS">+</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">5</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvaluejoin</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">foo3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">foo3</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token PLUS">+</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">upvaluejoin</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">upvaluejoin</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">upvaluejoin</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">upvaluejoin</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">upvaluejoin</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">pcall</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">upvaluejoin</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">foo1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Token String STR">&#x27;OK&#x27;</span></code></pre><h2 id="h2-13"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/13.lua" target="_blank">13.lua</a></h2><pre class="language-lua"><code><span class="Token COMMENT">-- $Id: testes/code.lua $</span><span class="Token LF">
</span><span class="Token COMMENT">-- See Copyright Notice in file all.lua</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="Expression Punctuator Token EQ">==</span><span class="Keyword Token Expression NIL">nil</span><span class="Keyword Token Expression SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="BraceDepth-0 Token Variable LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">Message</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Keyword Token FunctionCall Expression OR">or</span><span class="Keyword Token FunctionCall Expression SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="BraceDepth-0 Token Variable RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&#x27;</span><span class="String Token Control STR">\n</span><span class="Token String STR"> &gt;&gt;&gt; testC not active: skipping opcode tests &lt;&lt;&lt;</span><span class="String Token Control STR">\n</span><span class="Token String STR">&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token LF">
</span><span class="ReturnStatment Keyword Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Token String STR">&quot;testing code generation and optimizations&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token COMMENT">-- to test constant propagation</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">k0aux</span><span class="Identifier AttributeName Token SPACE"> </span><span class="AttributeName Attribute Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier AttributeType Attribute Token ID">const</span><span class="AttributeName Attribute Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Attribute Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">k0</span><span class="Identifier AttributeName Token SPACE"> </span><span class="AttributeName Attribute Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier AttributeType Attribute Token ID">const</span><span class="AttributeName Attribute Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Attribute Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">k0aux</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">k1</span><span class="Identifier AttributeName Token SPACE"> </span><span class="AttributeName Attribute Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier AttributeType Attribute Token ID">const</span><span class="AttributeName Attribute Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Attribute Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">k3</span><span class="Identifier AttributeName Token SPACE"> </span><span class="AttributeName Attribute Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier AttributeType Attribute Token ID">const</span><span class="AttributeName Attribute Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Attribute Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">k6</span><span class="Identifier AttributeName Token SPACE"> </span><span class="AttributeName Attribute Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier AttributeType Attribute Token ID">const</span><span class="AttributeName Attribute Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Attribute Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">k3</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression BraceDepth-0 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">k3</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token SHL">&lt;&lt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">k0</span><span class="Expression BraceDepth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">kFF0</span><span class="Identifier AttributeName Token SPACE"> </span><span class="AttributeName Attribute Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier AttributeType Attribute Token ID">const</span><span class="AttributeName Attribute Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Attribute Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0xFF0</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">k3_78</span><span class="Identifier AttributeName Token SPACE"> </span><span class="AttributeName Attribute Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier AttributeType Attribute Token ID">const</span><span class="AttributeName Attribute Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Attribute Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">3.78</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">x</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">k3_78_4</span><span class="Identifier AttributeName Token SPACE"> </span><span class="AttributeName Attribute Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier AttributeType Attribute Token ID">const</span><span class="AttributeName Attribute Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Attribute Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">k3_78</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token DIV">/</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">4</span><span class="Number Expression Token LF">
</span><span class="Number Expression Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">kx</span><span class="Identifier AttributeName Token SPACE"> </span><span class="AttributeName Attribute Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier AttributeType Attribute Token ID">const</span><span class="AttributeName Attribute Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Attribute Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;x&quot;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">kTrue</span><span class="Identifier AttributeName Token SPACE"> </span><span class="AttributeName Attribute Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier AttributeType Attribute Token ID">const</span><span class="AttributeName Attribute Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Attribute Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">kFalse</span><span class="Identifier AttributeName Token SPACE"> </span><span class="AttributeName Attribute Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier AttributeType Attribute Token ID">const</span><span class="AttributeName Attribute Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Attribute Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FALSE">false</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">kNil</span><span class="Identifier AttributeName Token SPACE"> </span><span class="AttributeName Attribute Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier AttributeType Attribute Token ID">const</span><span class="AttributeName Attribute Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Attribute Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Keyword Token COMMENT">-- this code gave an error for the code checker</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">f</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token ID">k</span><span class="Token COMMA">,</span><span class="Identifier Token ID">v</span><span class="Token COMMA">,</span><span class="Identifier Token ID">w</span><span class="Identifier Token SPACE"> </span><span class="Statement Keyword Token IN">in</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- testing reuse in constant table</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">checkKlist</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">func</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">list</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">k</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">listk</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">func</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">k</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">list</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">k</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">k</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">list</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">type</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">k</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">type</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">list</span><span class="VarSuffix Token BraceDepth-2 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-2 RSQUAR_PAREN">]</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">foo</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token LF">
</span><span class="Identifier AttributeName Token SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">k3</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0.0</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">7</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token PLUS">+</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">7</span><span class="Number Token LF">
</span><span class="Number Token SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">k3_78</span><span class="Expression Punctuator Token DIV">/</span><span class="Number Expression Token NUMBER">4</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">k3_78_4</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Identifier Token Variable ID">k3_78</span><span class="Expression Punctuator Token DIV">/</span><span class="Number Expression Token NUMBER">4</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">k3_78</span><span class="Expression Punctuator Token DIV">/</span><span class="Number Expression Token NUMBER">4</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">3.78</span><span class="Number Punctuator Token DIV">/</span><span class="Number Token NUMBER">4</span><span class="Number Token LF">
</span><span class="Number Token SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">3.79</span><span class="Number Punctuator Token DIV">/</span><span class="Number Token NUMBER">4</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0.0</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">0</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">k3</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">3.0</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">3.0</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkKlist</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">foo</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Number Field Token NUMBER">3.78</span><span class="Number Punctuator Token DIV">/</span><span class="Number Token NUMBER">4</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">3.78</span><span class="Number Punctuator Token DIV">/</span><span class="Number Token NUMBER">4</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">3.79</span><span class="Number Punctuator Token DIV">/</span><span class="Number Token NUMBER">4</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionName Token Variable ID">foo</span><span class="Identifier FunctionName Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">a</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">          </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">100</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token MUL">*</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">1000</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">          </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">100.0</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token MUL">*</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">1000</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">          </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">100</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token MUL">*</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">1000</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">          </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">100</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token MUL">*</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">1000.0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">          </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">100000</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">          </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Number Token NUMBER">100000.0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">          </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">100000</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">          </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">100000.0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">        </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkKlist</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">foo</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Number Field Token NUMBER">100000</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">100000.0</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">100000</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">100000.0</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- floats x integers</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionName Token Variable ID">foo</span><span class="Identifier FunctionName Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">t</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">a</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1.0</span><span class="Number Token LF">
</span><span class="Number Token SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1.0</span><span class="Number Token LF">
</span><span class="Number Token SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">2.0</span><span class="Number Token LF">
</span><span class="Number Token SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0.0</span><span class="Number Token LF">
</span><span class="Number Token SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1.0</span><span class="Number Token LF">
</span><span class="Number Token SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">2.0</span><span class="Number Token LF">
</span><span class="Number Token SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0.0</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkKlist</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">foo</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Number Field Token NUMBER">1</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">1.0</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">2</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">2.0</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">0</span><span class="Punctuator Token COMMA">,</span><span class="Punctuator Token SPACE"> </span><span class="Number Field Token NUMBER">0.0</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- testing opcodes</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- check that &#x27;f&#x27; opcodes match &#x27;...&#x27;</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">check</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">f</span><span class="FunctionBody Token ParameterList COMMA">,</span><span class="FunctionBody Token ParameterList SPACE"> </span><span class="Punctuator Token ParameterList VARARGS">...</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">arg</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression Punctuator Token VARARGS">...</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">c</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">listcode</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Statement Token ASSIGN">=</span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">arg</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">opcode</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">match</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;</span><span class="Format Token String STR">%u</span><span class="Token String STR">%w+&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">      </span><span class="VarSuffix Token Argument COMMENT">-- print(arg[i], opcode)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">      </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">arg</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">opcode</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">c</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">arg</span><span class="Expression Punctuator Token PLUS">+</span><span class="Number Expression Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">undef</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Keyword Token FunctionBody COMMENT">-- check that &#x27;f&#x27; opcodes match &#x27;...&#x27; and that &#x27;f(p) == r&#x27;.</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">checkR</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">p</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">r</span><span class="FunctionBody Token ParameterList COMMA">,</span><span class="FunctionBody Token ParameterList SPACE"> </span><span class="Punctuator Token ParameterList VARARGS">...</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">r1</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">p</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">r</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">r1</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">type</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">r</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">math</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">type</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">r1</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">f</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token VARARGS">...</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Keyword Token FunctionBody COMMENT">-- check that &#x27;a&#x27; and &#x27;b&#x27; has the same opcodes</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">checkequal</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">b</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">listcode</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">listcode</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">gsub</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;%b()&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">   </span><span class="VarSuffix Token Argument COMMENT">-- remove line number</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">      </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">gsub</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;%b()&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">   </span><span class="VarSuffix Token Argument COMMENT">-- remove line number</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">      </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Keyword Token FunctionBody COMMENT">-- some basic instructions</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE">   </span><span class="FunctionDefinition Token FunctionBody COMMENT">-- function does not create upvalues</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="BraceDepth-1 Token Variable LPAREN">(</span><span class="Keyword FunctionDefinition Token FunctionCall FUNCTION">function</span><span class="Keyword FunctionDefinition Token FunctionCall SPACE"> </span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Keyword FunctionCall Token FunctionBody END">end</span><span class="BraceDepth-1 Token Variable RPAREN">)</span><span class="TableConstructor BraceDepth-1 Token Argument LCURLY_BRACE">{</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="TableConstructor BraceDepth-1 Token Argument RCURLY_BRACE">}</span><span class="TableConstructor Token Argument LF">
</span><span class="TableConstructor Token Argument SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;CLOSURE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;NEWTABLE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;EXTRAARG&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;GETTABUP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;CALL&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">       </span><span class="Token String STR">&#x27;SETLIST&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;CALL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN0&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE">   </span><span class="FunctionDefinition Token FunctionBody COMMENT">-- function creates upvalues</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="BraceDepth-1 Token Variable LPAREN">(</span><span class="Keyword FunctionDefinition Token FunctionCall FUNCTION">function</span><span class="Keyword FunctionDefinition Token FunctionCall SPACE"> </span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 LPAREN">(</span><span class="FunctionDefinition Token FunctionBody BraceDepth-2 RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token FunctionCall RETURN">return</span><span class="ReturnStatment Keyword Token FunctionCall SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">x</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Keyword FunctionCall Token FunctionBody END">end</span><span class="BraceDepth-1 Token Variable RPAREN">)</span><span class="TableConstructor BraceDepth-1 Token Argument LCURLY_BRACE">{</span><span class="Identifier FunctionCall Token Variable ID">f</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="TableConstructor BraceDepth-1 Token Argument RCURLY_BRACE">}</span><span class="TableConstructor Token Argument LF">
</span><span class="TableConstructor Token Argument SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;CLOSURE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;NEWTABLE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;EXTRAARG&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;GETTABUP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;CALL&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">       </span><span class="Token String STR">&#x27;SETLIST&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;CALL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- sequence of LOADNILs</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">kNil</span><span class="Identifier AttributeName Token SPACE"> </span><span class="AttributeName BraceDepth-1 Attribute Token LANGLE_BRACE">&lt;</span><span class="Identifier AttributeType Attribute Token ID">const</span><span class="AttributeName BraceDepth-1 Attribute Token RANGLE_BRACE">&gt;</span><span class="AttributeName Attribute Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">b</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">c</span><span class="Identifier AttributeName Token LF">
</span><span class="Identifier AttributeName Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">d</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">e</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">f</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">g</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">h</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">    </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Statement Token ASSIGN">=</span><span class="Keyword Token NIL">nil</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Statement Token ASSIGN">=</span><span class="Keyword Token NIL">nil</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Statement Token ASSIGN">=</span><span class="Identifier Token Variable ID">kNil</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Statement Token ASSIGN">=</span><span class="Keyword Token NIL">nil</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADNIL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN0&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">b</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">c</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">d</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Number Token NUMBER">1</span><span class="Number Token LF">
</span><span class="Number Token SPACE">    </span><span class="Identifier Token Variable ID">d</span><span class="Statement Token ASSIGN">=</span><span class="Keyword Token NIL">nil</span><span class="Statement Token SEMI">;</span><span class="Identifier Token Variable ID">c</span><span class="Statement Token ASSIGN">=</span><span class="Keyword Token NIL">nil</span><span class="Statement Token SEMI">;</span><span class="Identifier Token Variable ID">b</span><span class="Statement Token ASSIGN">=</span><span class="Keyword Token NIL">nil</span><span class="Statement Token SEMI">;</span><span class="Identifier Token Variable ID">a</span><span class="Statement Token ASSIGN">=</span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADNIL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN0&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">b</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">c</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">d</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Number Token NUMBER">1</span><span class="Number Token LF">
</span><span class="Number Token SPACE">    </span><span class="Identifier Token Variable ID">d</span><span class="Statement Token ASSIGN">=</span><span class="Keyword Token NIL">nil</span><span class="Statement Token SEMI">;</span><span class="Identifier Token Variable ID">c</span><span class="Statement Token ASSIGN">=</span><span class="Keyword Token NIL">nil</span><span class="Statement Token SEMI">;</span><span class="Identifier Token Variable ID">b</span><span class="Statement Token ASSIGN">=</span><span class="Keyword Token NIL">nil</span><span class="Statement Token SEMI">;</span><span class="Identifier Token Variable ID">a</span><span class="Statement Token ASSIGN">=</span><span class="Keyword Token NIL">nil</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token AND">and</span><span class="Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- single return</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token ID">c</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- infinite loops</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Statement Keyword Token WHILE">while</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">kTrue</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN0&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Statement Keyword Token WHILE">while</span><span class="Statement Keyword Token SPACE"> </span><span class="Number Statement Token NUMBER">1</span><span class="Number Statement Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN0&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Statement Keyword Token REPEAT">repeat</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">x</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token UNTIL">until</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token TRUE">true</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN0&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- concat optimization</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Identifier Token ID">b</span><span class="Token COMMA">,</span><span class="Identifier Token ID">c</span><span class="Token COMMA">,</span><span class="Identifier Token ID">d</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Expression Punctuator Token CONCAT">..</span><span class="Identifier Token Variable ID">b</span><span class="Expression Punctuator Token CONCAT">..</span><span class="Identifier Token Variable ID">c</span><span class="Expression Punctuator Token CONCAT">..</span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;CONCAT&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- not</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADFALSE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">kFalse</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADFALSE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token Expression TRUE">true</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADTRUE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">k3</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADTRUE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- direct access to locals</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">b</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">c</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">d</span><span class="Identifier AttributeName Token LF">
</span><span class="Identifier AttributeName Token SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression Punctuator Token MUL">*</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable ID">c</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Expression Punctuator Token DIV">/</span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token CARET">^</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">x</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;LOADNIL&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;MUL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBIN&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;DIV&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBIN&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;ADD&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBIN&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;GETTABLE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SUB&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBIN&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;GETFIELD&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;POW&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBIN&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;UNM&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SETTABLE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SETFIELD&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN0&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- direct access to constants</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">b</span><span class="Identifier AttributeName Token LF">
</span><span class="Identifier AttributeName Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">c</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">kNil</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">kx</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">3.2</span><span class="Number Token LF">
</span><span class="Number Token SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">x</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&#x27;x&#x27;</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;LOADNIL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SETFIELD&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SETFIELD&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SETTABLE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN0&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- &quot;get/set table&quot; with numeric indices</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">k255</span><span class="Identifier AttributeName Token SPACE"> </span><span class="AttributeName BraceDepth-1 Attribute Token LANGLE_BRACE">&lt;</span><span class="Identifier AttributeType Attribute Token ID">const</span><span class="AttributeName BraceDepth-1 Attribute Token RANGLE_BRACE">&gt;</span><span class="AttributeName Attribute Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">255</span><span class="Number Token LF">
</span><span class="Number Token SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">100</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token LF">
</span><span class="VarSuffix Token SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">k255</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">256</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token LF">
</span><span class="VarSuffix Token SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">256</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">5</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;GETI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SETI&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;GETTABLE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SETI&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SETTABLE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE">  </span><span class="Token String STR">&#x27;RETURN0&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">b</span><span class="Identifier AttributeName Token LF">
</span><span class="Identifier AttributeName Token SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Expression Punctuator Token DIV">/</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">5</span><span class="Number Punctuator Token MINUS">-</span><span class="Number Token NUMBER">4</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;LOADNIL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SUB&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBIN&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;DIV&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBIN&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN0&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">b</span><span class="Identifier AttributeName Token LF">
</span><span class="Identifier AttributeName Token SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">kTrue</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FALSE">false</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;LOADNIL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADTRUE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SETTABLE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN0&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- equalities</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;EQI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">4.0</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token EQ">==</span><span class="Number Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;EQI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;hi&quot;</span><span class="Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;EQK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10000</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;EQK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">   </span><span class="VarSuffix Token Argument COMMENT">-- number too large</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">10000</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token EQ">==</span><span class="Number Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">10000</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;EQK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">   </span><span class="VarSuffix Token Argument COMMENT">-- number too large</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- comparisons</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">10</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token LE">&lt;=</span><span class="Number Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;GEI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Number Statement Token NUMBER">128.0</span><span class="Number Statement Token SPACE"> </span><span class="Number BraceDepth-1 Punctuator Token RANGLE_BRACE">&gt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">129</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;LTI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">127.0</span><span class="Number Expression Token SPACE"> </span><span class="Number BraceDepth-1 Punctuator Token LANGLE_BRACE">&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">127</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;GTI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Number Statement Token NUMBER">10</span><span class="Number Statement Token SPACE"> </span><span class="Number BraceDepth-1 Punctuator Token LANGLE_BRACE">&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">11</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;GTI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Number Statement Token NUMBER">129</span><span class="Number Statement Token SPACE"> </span><span class="Number BraceDepth-1 Punctuator Token LANGLE_BRACE">&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">130</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LT&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token GE">&gt;=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">23.0</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">25</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;GEI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token GE">&gt;=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">23.1</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;LOADK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression BraceDepth-1 Punctuator Token RANGLE_BRACE">&gt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2300.0</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;LOADF&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LT&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- constant folding</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">checkK</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">func</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">val</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">func</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">checkKlist</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">func</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Identifier Token Variable ID">val</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">func</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">val</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">checkI</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">func</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">val</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">func</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">checkKlist</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">func</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">func</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">val</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">checkF</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">func</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">val</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">func</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADF&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">checkKlist</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">func</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor BraceDepth-1 Token LCURLY_BRACE">{</span><span class="Expression TableConstructor BraceDepth-1 Token RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">func</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">val</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkF</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">0.0</span><span class="Number Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0.0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkI</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">k0</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkI</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Identifier Token Variable ID">k0</span><span class="Expression Punctuator Token DOUBLE_DIV">//</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkK</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Number Punctuator Token CARET">^</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Number Punctuator Token DIV">/</span><span class="Number Token NUMBER">3</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkK</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Number Token Variable NUMBER">1</span><span class="Number Token Variable SPACE"> </span><span class="Number Punctuator Token PLUS">+</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Punctuator Token CARET">^</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Number Token Variable NUMBER">50</span><span class="Number Token Variable SPACE"> </span><span class="Number Punctuator Token PLUS">+</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">50</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Number Punctuator Token CARET">^</span><span class="Number Token NUMBER">100</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkK</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">2</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Punctuator Token CARET">^</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Number Token Variable NUMBER">31</span><span class="Number Token Variable SPACE"> </span><span class="Number Punctuator Token MINUS">-</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">0x20000000</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token PLUS">+</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">0.0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkF</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Identifier Token Variable ID">k3</span><span class="Expression Punctuator Token CARET">^</span><span class="Number Expression Token NUMBER">0</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token PLUS">+</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">5</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token DOUBLE_DIV">//</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3.0</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1.0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkI</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Identifier Token Variable ID">k3</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MOD">%</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">5</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkF</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Number Token Variable NUMBER">2.0</span><span class="Number Punctuator Token CARET">^</span><span class="Number Token NUMBER">8</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token PLUS">+</span><span class="Number Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression BraceDepth-0 Token Variable LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Expression BraceDepth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token MOD">%</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">8</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Punctuator Token DIV">/</span><span class="Number Expression Token NUMBER">2</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token MUL">*</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token MINUS">-</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Number Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">5.0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkF</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Number Token Variable NUMBER">2</span><span class="Number Punctuator Token CARET">^</span><span class="Number Token NUMBER">8</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token PLUS">+</span><span class="Number Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression BraceDepth-0 Token Variable LPAREN">(</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Expression BraceDepth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token MOD">%</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">8</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Punctuator Token DOUBLE_DIV">//</span><span class="Number Expression Token NUMBER">2</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token MUL">*</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token MINUS">-</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Number Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">7.0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkI</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">0xF0.0</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token PIPE">|</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">0xCC.0</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token TILDE">~</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">0xAA</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token AMPERSAND">&amp;</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">0xFD</span><span class="Number Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0xF4</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkI</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression Punctuator Token TILDE">~</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Expression Punctuator Token TILDE">~</span><span class="Identifier Token Variable ID">kFF0</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PIPE">|</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">kFF0</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkI</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression Punctuator Token TILDE">~</span><span class="Expression Punctuator Token TILDE">~</span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1024.0</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1024</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkI</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Number Token Variable NUMBER">100</span><span class="Number Token Variable SPACE"> </span><span class="Number Punctuator Token SHL">&lt;&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">k6</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token SHL">&lt;&lt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">4</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token SHR">&gt;&gt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">100</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- borders around MAXARG_sBx ((((1 &lt;&lt; 17) - 1) &gt;&gt; 1) == 65535)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">17</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">sbx</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression BraceDepth-0 Token Variable LPAREN">(</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Number Token Variable NUMBER">1</span><span class="Number Token Variable SPACE"> </span><span class="Number Punctuator Token SHL">&lt;&lt;</span><span class="Number Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Expression BraceDepth-0 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Expression Punctuator Token SHR">&gt;&gt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE">   </span><span class="Number Expression Token COMMENT">-- avoid folding</span><span class="Number Expression Token LF">
</span><span class="Number Expression Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">border</span><span class="Identifier AttributeName Token SPACE"> </span><span class="AttributeName Attribute Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier AttributeType Attribute Token ID">const</span><span class="AttributeName Attribute Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Attribute Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">65535</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkI</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">border</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">sbx</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkI</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Identifier Token Variable ID">border</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Identifier Token Variable ID">sbx</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkI</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">border</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">sbx</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkK</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">border</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">sbx</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkK</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">border</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">sbx</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">border</span><span class="Identifier AttributeName Token SPACE"> </span><span class="AttributeName Attribute Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier AttributeType Attribute Token ID">const</span><span class="AttributeName Attribute Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Attribute Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">65535.0</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkF</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">border</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">sbx</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0.0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkF</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Identifier Token Variable ID">border</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Identifier Token Variable ID">sbx</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0.0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkF</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">border</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">sbx</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1.0</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkK</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">border</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">sbx</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2.0</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkK</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">border</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">sbx</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1.0</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- immediate operands</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">k1</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">11</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;ADDI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">127</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">117</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;ADDI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">128</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token PLUS">+</span><span class="Number Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0.0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">128.0</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">           </span><span class="Token String STR">&#x27;ADDI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MUL">*</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">127</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1.0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">127.0</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">           </span><span class="Token String STR">&#x27;MULK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">20</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token MUL">*</span><span class="Number Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">40</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MULK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token CARET">^</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">2</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0.25</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;POWK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token DIV">/</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">40</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">40</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1.0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;DIVK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token DOUBLE_DIV">//</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">10.0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">10.0</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">           </span><span class="Token String STR">&#x27;IDIVK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MOD">%</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Number Token Variable NUMBER">100</span><span class="Number Token Variable SPACE"> </span><span class="Number Punctuator Token MINUS">-</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">91</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">           </span><span class="Token String STR">&#x27;MODK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">k1</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token SHL">&lt;&lt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">8</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SHLI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token SHL">&lt;&lt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">127</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SHRI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token SHL">&lt;&lt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">127</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SHRI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token SHR">&gt;&gt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">128</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">8</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SHRI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token SHR">&gt;&gt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">127</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">8</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SHRI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">9</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;BANDK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token PIPE">|</span><span class="Number Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">11</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;BORK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">10</span><span class="Number Expression Token SPACE"> </span><span class="Number Punctuator Token TILDE">~</span><span class="Number Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">9</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;BXORK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- K operands in arithmetic operations</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0.0</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1.0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;ADDK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">--  check(function (x) return 128 + x end, &#x27;ADDK&#x27;, &#x27;MMBINK&#x27;, &#x27;RETURN1&#x27;)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MUL">*</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">10000</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">20000</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">           </span><span class="Token String STR">&#x27;MULK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">--  check(function (x) return 20 * x end, &#x27;MULK&#x27;, &#x27;MMBINK&#x27;, &#x27;RETURN1&#x27;)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token CARET">^</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0.5</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2.0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;POWK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token DIV">/</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2.0</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2.0</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;DIVK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token DOUBLE_DIV">//</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10000</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">10000</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">           </span><span class="Token String STR">&#x27;IDIVK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkR</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MOD">%</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Number Token Variable NUMBER">100.0</span><span class="Number Token Variable SPACE"> </span><span class="Number Punctuator Token MINUS">-</span><span class="Number Punctuator Token SPACE"> </span><span class="Number Token NUMBER">10</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">91</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1.0</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">           </span><span class="Token String STR">&#x27;MODK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- no foldings (and immediate operands)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">0.0</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADF&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;UNM&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">k3</span><span class="Expression Punctuator Token DIV">/</span><span class="Number Expression Token NUMBER">0</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;DIVK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Number Punctuator Token MOD">%</span><span class="Number Token NUMBER">0</span><span class="Number Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MODK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">4</span><span class="Number Punctuator Token DOUBLE_DIV">//</span><span class="Number Token NUMBER">0</span><span class="Number Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;IDIVK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token SHR">&gt;&gt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2.0</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADF&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SHR&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBIN&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token SHL">&lt;&lt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">128</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SHL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBIN&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">x</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token AMPERSAND">&amp;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2.0</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADF&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;BAND&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBIN&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- basic &#x27;for&#x27; loops</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Number Expression Token NUMBER">10</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">10.5</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;FORPREP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;FORLOOP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN0&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">0xfffffff</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">10.0</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token String STR">&#x27;LOADK&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADF&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;FORPREP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;FORLOOP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN0&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- bug in constant folding for 5.1</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Keyword Token Expression NIL">nil</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;LOADNIL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;UNM&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN1&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">b</span><span class="AttributeName Token COMMA">,</span><span class="Identifier AttributeName Token ID">c</span><span class="Identifier AttributeName Token LF">
</span><span class="Identifier AttributeName Token SPACE">    </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">c</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable ID">b</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;LOADNIL&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SETTABLE&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SETTABLE&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token COMMENT">-- no code for a = a</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;RETURN0&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- x == nil , x ~= nil</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- checkequal(function (b) if (a==nil) then a=1 end; if a~=nil then a=1 end end,</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">--            function () if (a==9) then a=1 end; if a~=9 then a=1 end end)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- check(function () if a==nil then a=&#x27;a&#x27; end end,</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- &#x27;GETTABUP&#x27;, &#x27;EQ&#x27;, &#x27;JMP&#x27;, &#x27;SETTABUP&#x27;, &#x27;RETURN&#x27;)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- tests for table access in upvalues</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">t</span><span class="Identifier AttributeName Token LF">
</span><span class="Identifier AttributeName Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">kx</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix TableKey Token ID">y</span><span class="Identifier VarSuffix TableKey Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;GETTABUP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SETTABUP&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier FunctionCall Token Variable ID">a</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;CALL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;GETUPVAL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MOVE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;CALL&#x27;</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Token String STR">&#x27;GETUPVAL&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;GETTABLE&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;SETTABLE&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- de morgan</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkequal</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression OR">or</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Statement Token ASSIGN">=</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">             </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Statement Token ASSIGN">=</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkequal</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">l</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">0</span><span class="Number Token SPACE"> </span><span class="Number Punctuator Token LE">&lt;=</span><span class="Number Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token LE">&lt;=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">l</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">             </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">l</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Expression BraceDepth-1 Token Variable LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token GE">&gt;=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">0</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Keyword Token Expression OR">or</span><span class="Keyword Token Expression SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token LE">&lt;=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">l</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Expression BraceDepth-1 Token Variable RPAREN">)</span><span class="Expression Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- if-break optimizations</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">check</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">b</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">          </span><span class="Statement Keyword Token WHILE">while</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">            </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token BREAK">break</span><span class="Statement Keyword Token SPACE"> </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">          </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">        </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token String STR">&#x27;TEST&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;TEST&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;ADDI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;MMBINI&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;JMP&#x27;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&#x27;RETURN0&#x27;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkequal</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">6</span><span class="Number Token SPACE"> </span><span class="Number Keyword Token OR">or</span><span class="Number Keyword Token SPACE"> </span><span class="Number Keyword Token TRUE">true</span><span class="Number Keyword Token SPACE"> </span><span class="Keyword Token OR">or</span><span class="Keyword Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">             </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">k6</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression OR">or</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">kTrue</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression OR">or</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">kNil</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">checkequal</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Number Token NUMBER">6</span><span class="Number Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Number Keyword Token TRUE">true</span><span class="Number Keyword Token SPACE"> </span><span class="Keyword Token OR">or</span><span class="Keyword Token SPACE"> </span><span class="Keyword Token NIL">nil</span><span class="Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Token COMMA">,</span><span class="Token LF">
</span><span class="Token SPACE">             </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">k6</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">kTrue</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression OR">or</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">kNil</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- string constants</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">k0</span><span class="Identifier AttributeName Token SPACE"> </span><span class="AttributeName Attribute Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier AttributeType Attribute Token ID">const</span><span class="AttributeName Attribute Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Attribute Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">&quot;00000000000000000000000000000000000000000000000000&quot;</span><span class="Token LF">
</span><span class="Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">f1</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">      </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">k</span><span class="Identifier AttributeName Token SPACE"> </span><span class="AttributeName Attribute Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Identifier AttributeType Attribute Token ID">const</span><span class="AttributeName Attribute Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="AttributeName Attribute Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">k0</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">      </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody LF">
</span><span class="FunctionDefinition Token FunctionBody SPACE">               </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">k</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">             </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">f2</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f1</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">f3</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">f2</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">f3</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">k0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">checkK</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">f3</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">k0</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="VarSuffix Token Argument COMMENT">-- string is not needed by other functions</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">listk</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">f1</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">T</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">listk</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">f2</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Token String STR">&#x27;OK&#x27;</span></code></pre><h2 id="h2-14"><a href="https://github.com/luzhixing12345/syntaxlight/tree/main/test/lua/14.lua" target="_blank">14.lua</a></h2><pre class="language-lua"><code><span class="Token COMMENT">-- $Id: testes/goto.lua $</span><span class="Token LF">
</span><span class="Token COMMENT">-- See Copyright Notice in file all.lua</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">collectgarbage</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">errmsg</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Identifier Token ID">code</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token ID">m</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">st</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">msg</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">code</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">st</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token Expression AND">and</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">find</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">msg</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">m</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody COMMENT">-- cannot see label inside block</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">errmsg</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">[[ goto l1; do ::l1:: end ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;label &#x27;l1&#x27;&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">errmsg</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">[[ do ::l1:: end goto l1; ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;label &#x27;l1&#x27;&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- repeated label</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">errmsg</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">[[ ::l1:: ::l1:: ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;label &#x27;l1&#x27;&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">errmsg</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">[[ ::l1:: do ::l1:: end]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;label &#x27;l1&#x27;&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- undefined label</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">errmsg</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">[[ goto l1; local aa ::l1:: ::l2:: print(3) ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;local &#x27;aa&#x27;&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- jumping over variable definition</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">errmsg</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">[[
do local bb, cc; goto l1; end
local aa
::l1:: print(3)
]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;local &#x27;aa&#x27;&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- jumping into a block</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">errmsg</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">[[ do ::l1:: end goto l1 ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;label &#x27;l1&#x27;&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">errmsg</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">[[ goto l1 do ::l1:: end ]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;label &#x27;l1&#x27;&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- cannot continue a repeat-until with variables</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">errmsg</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">[[
  repeat
    if x then goto cont end
    local xuxu = 10
    ::cont::
  until xuxu &lt; x
]]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token String STR">&quot;local &#x27;xuxu&#x27;&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- simple gotos</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">x</span><span class="Identifier AttributeName Token LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">y</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">12</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l1</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l2</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l3</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l1</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l2</span><span class="Identifier Statement Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l3</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l3_1</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">13</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- long labels</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">prog</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Token String STR">[[
  do
    local a = 1
    goto l</span><span class="Format Token String STR">%sa</span><span class="Token String STR">; a = a + 1
   ::l</span><span class="Format Token String STR">%sa</span><span class="Token String STR">:: a = a + 10
    goto l</span><span class="Format Token String STR">%s</span><span class="Token String STR">b; a = a + 2
   ::l</span><span class="Format Token String STR">%s</span><span class="Token String STR">b:: a = a + 20
    return a
  end
  ]]</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">label</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">rep</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;0123456789&quot;</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">40</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">prog</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">string</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">format</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">label</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">label</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">label</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">label</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">load</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">prog</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">31</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- ok to jump over local dec. to end of block</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l1</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">23</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable LF">
</span><span class="Identifier Token Variable SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l1</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token WHILE">while</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token TRUE">true</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l4</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">  </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l1</span><span class="Identifier Statement Token SPACE">  </span><span class="Identifier Statement Token COMMENT">-- ok to jump over local dec. to end of block</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">  </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l1</span><span class="Identifier Statement Token SPACE">  </span><span class="Identifier Statement Token COMMENT">-- multiple uses of same label</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">x</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">45</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l1</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Statement Token SEMI">;</span><span class="Statement Token SEMI">;</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l4</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">13</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">print</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l1</span><span class="Identifier Statement Token SPACE">   </span><span class="Identifier Statement Token COMMENT">-- ok to jump over local dec. to end of block</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">error</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Token String STR">&quot;should not be here&quot;</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l2</span><span class="Identifier Statement Token SPACE">   </span><span class="Identifier Statement Token COMMENT">-- ok to jump over local dec. to end of block</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">x</span><span class="Identifier AttributeName Token LF">
</span><span class="Identifier AttributeName Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l1</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l2</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Statement Token SEMI">;</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- to repeat a label in a different function is OK</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">foo</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l3</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l1</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l2</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l2</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l5</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l3</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token LF">
</span><span class="Statement Label Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l3a</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l1</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l4</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l6</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l5</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">5</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l4</span><span class="Statement Token SEMI">;</span><span class="Statement Token LF">
</span><span class="Statement Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l6</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">2</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">3</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token LF">
</span><span class="Number Keyword Token SPACE">              </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">4</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">5</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">5</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">4</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Keyword Token Expression NOT">not</span><span class="Keyword Token Expression SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">6</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">6</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l3a</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- do it twice</span><span class="Statement Keyword Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l6</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- bug in 5.2 -&gt; 5.3.2</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">x</span><span class="Identifier AttributeName Token LF">
</span><span class="Identifier AttributeName Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">L1</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token LF">
</span><span class="Statement Label Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">y</span><span class="Identifier AttributeName Token SPACE">             </span><span class="Identifier AttributeName Token COMMENT">-- cannot join this SETNIL with previous one</span><span class="Identifier AttributeName Token LF">
</span><span class="Identifier AttributeName Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="Keyword Token Expression SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Number Token LF">
</span><span class="Number Token SPACE">    </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">L1</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">  </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">    </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token LF">
</span><span class="Number Expression Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">x</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="Number Expression Token SPACE"> </span><span class="Number Keyword Token AND">and</span><span class="Number Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">y</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression TRUE">true</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- bug in 5.3</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">first</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FALSE">false</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token TRUE">true</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">LBL</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">    </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">loop</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token LF">
</span><span class="Statement Label Token SPACE">    </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">    </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">LBL</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token LF">
</span><span class="Statement Label Token SPACE">    </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">first</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Identifier Token Variable ID">first</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token FALSE">false</span><span class="Keyword Token LF">
</span><span class="Keyword Token SPACE">      </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">loop</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- compiling infinite loops</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">escape</span><span class="Identifier Statement Token SPACE">   </span><span class="Identifier Statement Token COMMENT">-- do not run the infinite loops</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">a</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">a</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">b</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">c</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">c</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">b</span><span class="Identifier Statement Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">escape</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token LF">
</span><span class="Statement Label Token COMMENT">--------------------------------------------------------------------------------</span><span class="Statement Label Token LF">
</span><span class="Statement Label Token COMMENT">-- testing closing of upvalues</span><span class="Statement Label Token LF">
</span><span class="Statement Label Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">debug</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">require</span><span class="Identifier FunctionCall Token Variable SPACE"> </span><span class="Token String STR">&#x27;debug&#x27;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">foo</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="Statement Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">t</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Expression TableConstructor Token LF">
</span><span class="Expression TableConstructor Token SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">i</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Number Token LF">
</span><span class="Number Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">b</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">c</span><span class="AttributeName Token COMMA">,</span><span class="AttributeName Token SPACE"> </span><span class="Identifier AttributeName Token ID">d</span><span class="Identifier AttributeName Token LF">
</span><span class="Identifier AttributeName Token SPACE">  </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l1</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token LF">
</span><span class="Statement Label Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">b</span><span class="Identifier AttributeName Token LF">
</span><span class="Identifier AttributeName Token SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">c</span><span class="Identifier AttributeName Token LF">
</span><span class="Identifier AttributeName Token SPACE">    </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Keyword Token FunctionBody COMMENT">-- t[2], t[4], t[6]</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">    </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l2</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">      </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">d</span><span class="Identifier AttributeName Token LF">
</span><span class="Identifier AttributeName Token SPACE">      </span><span class="Identifier Token Variable ID">t</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="VarSuffix Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="FunctionDefinition BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">b</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">c</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Identifier Token Variable ID">d</span><span class="Identifier Token Variable SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody SPACE">   </span><span class="Keyword Token FunctionBody COMMENT">-- t[3], t[5]</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody SPACE">      </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token LF">
</span><span class="Number Expression Token SPACE">      </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token LF">
</span><span class="Identifier AttributeName Token SPACE">      </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l1</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">    </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l2</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">t</span><span class="Identifier Token Variable LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">foo</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Expression Punctuator Token HASH">#</span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">6</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument COMMENT">-- all functions share same &#x27;a&#x27;</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">6</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalueid</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalueid</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- &#x27;b&#x27; and &#x27;c&#x27; are shared among some of them</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">6</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- only a[1] uses external &#x27;b&#x27;/&#x27;b&#x27;</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalueid</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalueid</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalueid</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalueid</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">5</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- inner functions share &#x27;b&#x27;/&#x27;c&#x27; with previous ones</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalueid</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalueid</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalueid</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalueid</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MINUS">-</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="VarSuffix Token Argument COMMENT">-- but not with next ones</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalueid</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalueid</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalueid</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token NORE">~=</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalueid</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- only external &#x27;d&#x27; is shared</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">6</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalueid</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Number VarSuffix Token NUMBER">1</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalueid</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- internal &#x27;d&#x27;s are all different</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">i</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">3</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">5</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">2</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token FOR">for</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">j</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">1</span><span class="Statement Token COMMA">,</span><span class="Statement Token SPACE"> </span><span class="Number Token NUMBER">6</span><span class="Number Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalueid</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">i</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">debug</span><span class="VarSuffix Token DOT">.</span><span class="Identifier VarSuffix Token FunctionCall ID">upvalueid</span><span class="VarSuffix BraceDepth-0 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">a</span><span class="VarSuffix BraceDepth-1 Token LSQUAR_PAREN">[</span><span class="Identifier Token Variable ID">j</span><span class="VarSuffix BraceDepth-1 Token RSQUAR_PAREN">]</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Number Token NUMBER">4</span><span class="VarSuffix BraceDepth-0 Token Argument RPAREN">)</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="Expression Token Variable LF">
</span><span class="Expression Token Variable SPACE">      </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Expression Token Variable BraceDepth-2 LPAREN">(</span><span class="Identifier Token Variable ID">i</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Identifier Token Variable ID">j</span><span class="Expression Token Variable BraceDepth-2 RPAREN">)</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">--------------------------------------------------------------------------------</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">-- testing if x goto optimizations</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token FUNCTION">function</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">testG</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement BraceDepth-1 Token FunctionBody LPAREN">(</span><span class="Identifier Token ID">a</span><span class="Statement BraceDepth-1 Token FunctionBody RPAREN">)</span><span class="Statement Token FunctionBody LF">
</span><span class="Statement Token FunctionBody SPACE">  </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l1</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">error</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;should never be here!&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">  </span><span class="Keyword Token ElseIfStatement ELSEIF">elseif</span><span class="Keyword Token ElseIfStatement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token ElseIfStatement THEN">then</span><span class="Keyword Token ElseIfStatement SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l2</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">  </span><span class="Keyword Token ElseIfStatement ELSEIF">elseif</span><span class="Keyword Token ElseIfStatement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">3</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token ElseIfStatement THEN">then</span><span class="Keyword Token ElseIfStatement SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l3</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">  </span><span class="Keyword Token ElseIfStatement ELSEIF">elseif</span><span class="Keyword Token ElseIfStatement SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">4</span><span class="Number Expression Token SPACE"> </span><span class="Keyword Token ElseIfStatement THEN">then</span><span class="Keyword Token ElseIfStatement LF">
</span><span class="Keyword Token ElseIfStatement SPACE">    </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l1</span><span class="Identifier Statement Token SPACE">  </span><span class="Identifier Statement Token COMMENT">-- go to inside the block</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">error</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;should never be here!&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l1</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token PLUS">+</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">1</span><span class="Number Expression Token SPACE">   </span><span class="Number Expression Token COMMENT">-- must go to &#x27;if&#x27; end</span><span class="Number Expression Token LF">
</span><span class="Number Expression Token SPACE">  </span><span class="ElseStatement Keyword Token ELSE">else</span><span class="ElseStatement Keyword Token LF">
</span><span class="ElseStatement Keyword Token SPACE">    </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l4</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">    </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l4a</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token MUL">*</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">2</span><span class="Statement Token SEMI">;</span><span class="Statement Token SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l4b</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">error</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;should never be here!&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l4</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">l4a</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">error</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Token String STR">&quot;should never be here!&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l4b</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token LF">
</span><span class="Statement Label Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l2</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Token String STR">&quot;2&quot;</span><span class="Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l3</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Token String STR">&quot;3&quot;</span><span class="Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">l1</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="ReturnStatment Keyword Token RETURN">return</span><span class="ReturnStatment Keyword Token SPACE"> </span><span class="Token String STR">&quot;1&quot;</span><span class="Token LF">
</span><span class="Keyword Token FunctionBody END">end</span><span class="Keyword Token FunctionBody LF">
</span><span class="Keyword Token FunctionBody LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">testG</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Number Token NUMBER">1</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;1&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">testG</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Number Token NUMBER">2</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;2&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">testG</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Number Token NUMBER">3</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Token String STR">&quot;3&quot;</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">testG</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Number Token NUMBER">4</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">5</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier FunctionCall Token Variable ID">testG</span><span class="VarSuffix Token Argument BraceDepth-2 LPAREN">(</span><span class="Number Token NUMBER">5</span><span class="VarSuffix Token Argument BraceDepth-2 RPAREN">)</span><span class="VarSuffix Token Argument SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Number Expression Token NUMBER">10</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token COMMENT">-- if x back goto out of scope of upvalue</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">X</span><span class="Identifier AttributeName Token LF">
</span><span class="Identifier AttributeName Token SPACE">  </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">L1</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">L2</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">L3</span><span class="Identifier Statement Token LF">
</span><span class="Identifier Statement Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">L1</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Statement Keyword Token DO">do</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">    </span><span class="Statement Keyword Token LOCAL">local</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier AttributeName Token ID">a</span><span class="Identifier AttributeName Token SPACE"> </span><span class="AttributeName BraceDepth-1 Attribute Token LANGLE_BRACE">&lt;</span><span class="Identifier AttributeType Attribute Token ID">close</span><span class="AttributeName BraceDepth-1 Attribute Token RANGLE_BRACE">&gt;</span><span class="AttributeName Attribute Token SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">setmetatable</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Expression TableConstructor Token BraceDepth-2 LCURLY_BRACE">{</span><span class="Expression TableConstructor Token BraceDepth-2 RCURLY_BRACE">}</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Expression TableConstructor Token BraceDepth-2 LCURLY_BRACE">{</span><span class="Identifier Field Token ID">__close</span><span class="Identifier Field Token SPACE"> </span><span class="FieldList Field Token ASSIGN">=</span><span class="FieldList Field Token SPACE"> </span><span class="Keyword FunctionDefinition Token FUNCTION">function</span><span class="Keyword FunctionDefinition Token SPACE"> </span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody LPAREN">(</span><span class="FunctionDefinition Token BraceDepth-0 FunctionBody RPAREN">)</span><span class="FunctionDefinition Token FunctionBody SPACE"> </span><span class="Identifier Token Variable ID">X</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Token ASSIGN">=</span><span class="Statement Token SPACE"> </span><span class="Keyword Token TRUE">true</span><span class="Keyword Token SPACE"> </span><span class="Keyword Token FunctionBody END">end</span><span class="Expression TableConstructor Token BraceDepth-2 RCURLY_BRACE">}</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">X</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression NIL">nil</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument LF">
</span><span class="VarSuffix Token Argument SPACE">    </span><span class="Statement Keyword Token IF">if</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Token Variable ID">a</span><span class="Identifier Token Variable SPACE"> </span><span class="Statement Keyword Token THEN">then</span><span class="Statement Keyword Token SPACE"> </span><span class="Statement Keyword Token GOTO">goto</span><span class="Statement Keyword Token SPACE"> </span><span class="Identifier Statement Token ID">L2</span><span class="Identifier Statement Token SPACE"> </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token SPACE">   </span><span class="Statement Keyword Token COMMENT">-- jumping back out of scope of &#x27;a&#x27;</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token SPACE">  </span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Identifier Label Token ID">L3</span><span class="Statement Label Token DOUBLE_COLON">::</span><span class="Statement Label Token SPACE"> </span><span class="Identifier FunctionCall Token Variable ID">assert</span><span class="VarSuffix BraceDepth-1 Token Argument LPAREN">(</span><span class="Identifier Token Variable ID">X</span><span class="Identifier Token Variable SPACE"> </span><span class="Expression Punctuator Token EQ">==</span><span class="Expression Punctuator Token SPACE"> </span><span class="Keyword Token Expression TRUE">true</span><span class="VarSuffix BraceDepth-1 Token Argument RPAREN">)</span><span class="VarSuffix Token Argument SPACE">   </span><span class="VarSuffix Token Argument COMMENT">-- checks that &#x27;a&#x27; was correctly closed</span><span class="VarSuffix Token Argument LF">
</span><span class="Statement Keyword Token END">end</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token COMMENT">--------------------------------------------------------------------------------</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Statement Keyword Token LF">
</span><span class="Identifier FunctionCall Token Variable ID">print</span><span class="Token String STR">&#x27;OK&#x27;</span></code></pre></div>
    <div class="dir-tree"><ul><li><a href="../../md-docs/README" >README</a></li></ul><ul><li><a href="../../用户手册/API" >用户手册</a><ul><li><a href="../../用户手册/API" >API</a></li></ul><ul><li><a href="../../用户手册/全部文法支持" >全部文法支持</a></li></ul><ul><li><a href="../../用户手册/自定义颜色" >自定义颜色</a></li></ul><ul><li><a href="../../用户手册/自定义文法解析" >自定义文法解析</a></li></ul><ul><li><a href="../../用户手册/文法扩展" >文法扩展</a></li></ul><ul><li><a href="../../用户手册/已知问题" >已知问题</a></li></ul></li></ul><ul><li><a href="../../全部文法高亮/C" >全部文法高亮</a><ul><li><a href="../../全部文法高亮/C" >C</a></li></ul><ul><li><a href="../../全部文法高亮/Lua" >Lua</a></li></ul><ul><li><a href="../../全部文法高亮/x86asm" >x86asm</a></li></ul><ul><li><a href="../../全部文法高亮/riscvasm" >riscvasm</a></li></ul><ul><li><a href="../../全部文法高亮/BNF" >BNF</a></li></ul><ul><li><a href="../../全部文法高亮/json" >json</a></li></ul><ul><li><a href="../../全部文法高亮/shell" >shell</a></li></ul><ul><li><a href="../../全部文法高亮/toml" >toml</a></li></ul><ul><li><a href="../../全部文法高亮/xml" >xml</a></li></ul><ul><li><a href="../../全部文法高亮/css" >css</a></li></ul><ul><li><a href="../../全部文法高亮/dot" >dot</a></li></ul></li></ul><ul><li><a href="../../开发文档/BNF" >开发文档</a><ul><li><a href="../../开发文档/BNF" >BNF</a></li></ul><ul><li><a href="../../开发文档/参考文档" >参考文档</a></li></ul></li></ul></div>
    <div class="zood"><a class="" href="https://github.com/luzhixing12345/zood" target="_blank">zood</a></div>
    <script type="text/javascript" src="../../../js/next_front.js"></script><script>addLink("../../全部文法高亮/C","../../全部文法高亮/x86asm","ab")</script><script type="text/javascript" src="../../../js/change_mode.js"></script><script>addChangeModeButton("../../../img/sun.png","../../../img/moon.png")</script><script type="text/javascript" src="../../../js/copy_code.js"></script><script>addCodeCopy("../../../img/before_copy.png","../../../img/after_copy.png")</script><script type="text/javascript" src="../../../js/navigator.js"></script><script type="text/javascript" src="../../../js/picture_preview.js"></script><script type="text/javascript" src="../../../js/global_js_configuration.js"></script>
</body>

</html>